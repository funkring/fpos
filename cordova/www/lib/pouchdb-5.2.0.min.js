!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(f,h,c){function d(m,i){if(!h[m]){if(!f[m]){var e="function"==typeof require&&require;if(!i&&e){return e(m,!0)}if(j){return j(m,!0)}var l=new Error("Cannot find module '"+m+"'");throw l.code="MODULE_NOT_FOUND",l}var k=h[m]={exports:{}};f[m][0].call(k.exports,function(o){var n=f[m][1][o];return d(n?n:o)},k,k.exports,a,f,h,c)}return h[m].exports}for(var j="function"==typeof require&&require,g=0;g<c.length;g++){d(c[g])}return d}({1:[function(c,f,d){function g(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}f.exports=g},{}],2:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+f.humanize(this.diff),!n){return e}var p="color: "+this.color;e=[e[0],p,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(i++,"%c"===q&&(o=i))}),e.splice(o,0,p),e}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(3),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{3:3}],3:[function(l,v,h){function d(){return h.colors[k++%h.colors.length]}function g(i){function e(){}function f(){var u=f,o=+new Date,x=o-(m||o);u.diff=x,u.prev=m,u.curr=o,m=o,null==u.useColors&&(u.useColors=h.useColors()),null==u.color&&u.useColors&&(u.color=d());var s=Array.prototype.slice.call(arguments);s[0]=h.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var r=0;s[0]=s[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}r++;var w=h.formatters[B];if("function"==typeof w){var C=s[r];D=w.call(u,C),s.splice(r,1),r--}return D}),"function"==typeof h.formatArgs&&(s=h.formatArgs.apply(u,s));var t=f.log||h.log||console.log.bind(console);t.apply(u,s)}e.enabled=!1,f.enabled=!0;var n=h.enabled(i)?f:e;return n.namespace=i,n}function j(f){h.save(f);for(var i=(f||"").split(/[\s,]+/),e=i.length,n=0;e>n;n++){i[n]&&(f=i[n].replace(/\*/g,".*?"),"-"===f[0]?h.skips.push(new RegExp("^"+f.substr(1)+"$")):h.names.push(new RegExp("^"+f+"$")))}}function p(){h.enable("")}function c(i){var e,f;for(e=0,f=h.skips.length;f>e;e++){if(h.skips[e].test(i)){return !1}}for(e=0,f=h.names.length;f>e;e++){if(h.names[e].test(i)){return !0}}return !1}function q(e){return e instanceof Error?e.stack||e.message:e}h=v.exports=g,h.coerce=q,h.disable=p,h.enable=j,h.enabled=c,h.humanize=l(9),h.names=[],h.skips=[],h.formatters={};var m,k=0},{9:9}],4:[function(j,l,f){function k(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(e){return"function"==typeof e}function c(e){return"number"==typeof e}function g(e){return"object"==typeof e&&null!==e}function h(e){return void 0===e}l.exports=k,k.EventEmitter=k,k.prototype._events=void 0,k.prototype._maxListeners=void 0,k.defaultMaxListeners=10,k.prototype.setMaxListeners=function(e){if(!c(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},k.prototype.emit=function(i){var p,e,m,o,q,n;if(this._events||(this._events={}),"error"===i&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(p=arguments[1],p instanceof Error){throw p}throw TypeError('Uncaught, unspecified "error" event.')}if(e=this._events[i],h(e)){return !1}if(d(e)){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),e.apply(this,o)}}else{if(g(e)){for(o=Array.prototype.slice.call(arguments,1),n=e.slice(),m=n.length,q=0;m>q;q++){n[q].apply(this,o)}}}return !0},k.prototype.addListener=function(m,i){var e;if(!d(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,d(i.listener)?i.listener:i),this._events[m]?g(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,g(this._events[m])&&!this._events[m].warned&&(e=h(this._maxListeners)?k.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},k.prototype.on=k.prototype.addListener,k.prototype.once=function(m,e){function n(){this.removeListener(m,n),i||(i=!0,e.apply(this,arguments))}if(!d(e)){throw TypeError("listener must be a function")}var i=!1;return n.listener=e,this.on(m,n),this},k.prototype.removeListener=function(m,p){var o,n,e,i;if(!d(p)){throw TypeError("listener must be a function")}if(!this._events||!this._events[m]){return this}if(o=this._events[m],e=o.length,n=-1,o===p||d(o.listener)&&o.listener===p){delete this._events[m],this._events.removeListener&&this.emit("removeListener",m,p)}else{if(g(o)){for(i=e;i-->0;){if(o[i]===p||o[i].listener&&o[i].listener===p){n=i;break}}if(0>n){return this}1===o.length?(o.length=0,delete this._events[m]):o.splice(n,1),this._events.removeListener&&this.emit("removeListener",m,p)}}return this},k.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],d(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},k.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?d(this._events[i])?[this._events[i]]:this._events[i].slice():[]},k.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(d(e)){return 1}if(e){return e.length}}return 0},k.listenerCount=function(i,e){return i.listenerCount(e)}},{}],5:[function(f,d,c){(function(t){function k(){q=!0;for(var i,n,l=m.length;l;){for(n=m,m=[],i=-1;++i<l;){n[i]()}l=m.length}q=!1}function g(i){1!==m.push(i)||q||h()}var h,p=t.MutationObserver||t.WebKitMutationObserver;if(p){var v=0,e=new p(k),w=t.document.createTextNode("");e.observe(w,{characterData:!0}),h=function(){w.data=v=++v%2}}else{if(t.setImmediate||"undefined"==typeof t.MessageChannel){h="document" in t&&"onreadystatechange" in t.document.createElement("script")?function(){var i=t.document.createElement("script");i.onreadystatechange=function(){k(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},t.document.documentElement.appendChild(i)}:function(){setTimeout(k,0)}}else{var j=new t.MessageChannel;j.port1.onmessage=k,h=function(){j.port2.postMessage(0)}}}var q,m=[];d.exports=g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(f,d,c){"function"==typeof Object.create?d.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:d.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],7:[function(f,d,c){(function(e){e("object"==typeof c?c:this)}).call(this,function(h){var e=Array.prototype.slice,i=Array.prototype.forEach,g=function(j){if("object"!=typeof j){throw j+" is not an object"}var k=e.call(arguments,1);return i.call(k,function(l){if(l){for(var m in l){"object"==typeof l[m]&&j[m]?g.call(j,j[m],l[m]):j[m]=l[m]}}}),j};h.extend=g})},{}],8:[function(q,k,E){function x(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=J,this.queue=[],this.outcome=void 0,e!==x&&g(this,e)}function F(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function z(f,e,h){B(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function H(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(m,i){function f(o){e||(e=!0,d.reject(m,o))}function l(o){e||(e=!0,d.resolve(m,o))}function h(){i(l,f)}var e=!1,n=A(h);"error"===n.status&&f(n.value)}function A(i,f){var e={};try{e.value=i(f),e.status="success"}catch(h){e.status="error",e.value=h}return e}function G(e){return e instanceof this?e:d.resolve(new this(x),e)}function D(f){var e=new this(x);return d.reject(e,f)}function I(f){function h(r,s){function t(u){p[s]=u,++n!==i||m||(m=!0,d.resolve(o,p))}l.resolve(r).then(t,function(u){m||(m=!0,d.reject(o,u))})}var l=this;if("[object Array]"!==Object.prototype.toString.call(f)){return this.reject(new TypeError("must be an array"))}var i=f.length,m=!1;if(!i){return this.resolve([])}for(var p=new Array(i),n=0,e=-1,o=new this(x);++e<i;){h(f[e],e)}return o}function w(m){function i(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(l,p))},function(p){e||(e=!0,d.reject(l,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(m)){return this.reject(new TypeError("must be an array"))}var h=m.length,e=!1;if(!h){return this.resolve([])}for(var n=-1,l=new this(x);++n<h;){i(m[n])}return l}var B=q(5),d={},c=["REJECTED"],C=["FULFILLED"],J=["PENDING"];k.exports=E=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(h,f){if("function"!=typeof h&&this.state===C||"function"!=typeof f&&this.state===c){return this}var e=new this.constructor(x);if(this.state!==J){var i=this.state===C?h:f;z(e,i,this.outcome)}else{this.queue.push(new F(e,h,f))}return e},F.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},F.prototype.otherCallFulfilled=function(e){z(this.promise,this.onFulfilled,e)},F.prototype.callRejected=function(e){d.reject(this.promise,e)},F.prototype.otherCallRejected=function(e){z(this.promise,this.onRejected,e)},d.resolve=function(l,f){var h=A(H,f);if("error"===h.status){return d.reject(l,h.value)}var i=h.value;if(i){g(l,i)}else{l.state=C,l.outcome=f;for(var m=-1,e=l.queue.length;++m<e;){l.queue[m].callFulfilled(f)}}return l},d.reject=function(i,f){i.state=c,i.outcome=f;for(var e=-1,h=i.queue.length;++e<h;){i.queue[e].callRejected(f)}return i},E.resolve=G,E.reject=D,E.all=I,E.race=w},{5:5}],9:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],10:[function(v,m,z){function C(l){if(null!==l){switch(typeof l){case"boolean":return l?1:0;case"number":return g(l);case"string":return l.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var e=Array.isArray(l),i=e?l:Object.keys(l),n=-1,f=i.length,o="";if(e){for(;++n<f;){o+=z.toIndexableString(i[n])}}else{for(;++n<f;){var h=i[n];o+=z.toIndexableString(h)+z.toIndexableString(l[h])}}return o}}return""}function j(l,r){var h,e=r,f="1"===l[r];if(f){h=0,r++}else{var i="0"===l[r];r++;var o="",s=l.substring(r,r+k),p=parseInt(s,10)+x;for(i&&(p=-p),r+=k;;){var n=l[r];if("\x00"===n){break}o+=n,r++}o=o.split("."),h=1===o.length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),i&&(h-=10),0!==p&&(h=parseFloat(h+"e"+p))}return{num:h,length:r-e}}function d(i,n){var e=i.pop();if(n.length){var o=n[n.length-1];e===o.element&&(n.pop(),o=n[n.length-1]);var f=o.element,l=o.index;if(Array.isArray(f)){f.push(e)}else{if(l===i.length-2){var h=i.pop();f[h]=e}else{i.push(e)}}}}function y(h,e){for(var f=Math.min(h.length,e.length),i=0;f>i;i++){var l=z.collate(h[i],e[i]);if(0!==l){return l}}return h.length===e.length?0:h.length>e.length?1:-1}function B(f,e){return f===e?0:f>e?1:-1}function w(l,e){for(var i=Object.keys(l),n=Object.keys(e),f=Math.min(i.length,n.length),o=0;f>o;o++){var h=z.collate(i[o],n[o]);if(0!==h){return h}if(h=z.collate(l[i[o]],e[n[o]]),0!==h){return h}}return i.length===n.length?0:i.length>n.length?1:-1}function c(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function g(r){if(0===r){return"1"}var h=r.toExponential().split(/e\+?/),o=parseInt(h[1],10),l=0>r,n=l?"0":"2",p=(l?-o:o)-x,e=q.padLeft(p.toString(),"0",k);n+=A+e;var i=Math.abs(parseFloat(h[0]));l&&(i=10-i);var f=i.toFixed(20);return f=f.replace(/\.?0+$/,""),n+=A+f}var x=-324,k=3,A="",q=v(11);z.collate=function(h,e){if(h===e){return 0}h=z.normalizeKey(h),e=z.normalizeKey(e);var f=c(h),i=c(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return B(h,e)}return Array.isArray(h)?y(h,e):w(h,e)},z.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var e=0;i>e;e++){l[e]=z.normalizeKey(h[e])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var n in h){if(h.hasOwnProperty(n)){var f=h[n];"undefined"!=typeof f&&(l[n]=z.normalizeKey(f))}}}}}return l},z.toIndexableString=function(f){var e="\x00";return f=z.normalizeKey(f),c(f)+A+C(f)+e},z.parseIndexableString=function(l){for(var r=[],f=[],e=0;;){var o=l[e++];if("\x00"!==o){switch(o){case"1":r.push(null);break;case"2":r.push("1"===l[e]),e++;break;case"3":var s=j(l,e);r.push(s.num),e+=s.length;break;case"4":for(var p="";;){var n=l[e];if("\x00"===n){break}p+=n,e++}p=p.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),r.push(p);break;case"5":var i={element:[],index:r.length};r.push(i.element),f.push(i);break;case"6":var h={element:{},index:r.length};r.push(h.element),f.push(h);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+o)}}else{if(1===r.length){return r.pop()}d(r,f)}}}},{11:11}],11:[function(c,f,d){function g(e,j,i){for(var k="",h=i-e.length;k.length<h;){k+=j}return k}d.padLeft=function(h,e,j){var i=g(h,e,j);return i+h},d.padRight=function(h,e,j){var i=g(h,e,j);return h+i},d.stringLexCompare=function(p,j){var h,m=p.length,l=j.length;for(h=0;m>h;h++){if(h===l){return 1}var k=p.charAt(h),e=j.charAt(h);if(k!==e){return e>k?-1:1}}return l>m?-1:0},d.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],12:[function(h,f,d){function g(){this.store={}}function c(i){if(this.store=new g,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}d.Map=g,d.Set=c,g.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},g.prototype.unmangle=function(e){return e.substring(1)},g.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},g.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},g.prototype.has=function(i){var e=this.mangle(i);return e in this.store},g.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},g.prototype.forEach=function(k){for(var e=Object.keys(this.store),l=0,j=e.length;j>l;l++){var i=e[l],m=this.store[i];i=this.unmangle(i),k(m,i)}},c.prototype.add=function(e){return this.store.set(e,!0)},c.prototype.has=function(e){return this.store.has(e)},c.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],13:[function(p,x,h){function d(){m=!1,c.length?q=c.concat(q):j=-1,q.length&&g()}function g(){if(!m){var f=setTimeout(d);m=!0;for(var e=q.length;e;){for(c=q,q=[];++j<e;){c&&c[j].run()}j=-1,e=q.length}c=null,m=!1,clearTimeout(f)}}function k(f,e){this.fun=f,this.array=e}function v(){}var c,w=x.exports={},q=[],m=!1,j=-1;w.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){e[i-1]=arguments[i]}}q.push(new k(f,e)),1!==q.length||m||setTimeout(g,0)},k.prototype.run=function(){this.fun.apply(null,this.array)},w.title="browser",w.browser=!0,w.env={},w.argv=[],w.version="",w.versions={},w.on=v,w.addListener=v,w.once=v,w.off=v,w.removeListener=v,w.removeAllListeners=v,w.emit=v,w.binding=function(e){throw new Error("process.binding is not supported")},w.cwd=function(){return"/"},w.chdir=function(e){throw new Error("process.chdir is not supported")},w.umask=function(){return 0}},{}],14:[function(f,d,c){(function(){var e={}.hasOwnProperty,g=[].slice;d.exports=function(l,k){var j,i,m,h;i=[],h=[];for(j in k){e.call(k,j)&&(m=k[j],"this"!==j&&(i.push(j),h.push(m)))}return Function.apply(null,g.call(i).concat([l])).apply(k["this"],h)}}).call(this)},{}],15:[function(d,c,e){!function(g){if("object"==typeof e){c.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(J){function q(m,h,n,l,i,g){return h=K(K(h,m),K(l,g)),K(h<<i|h>>>32-i,n)}function D(m,h,l,i,n,o,g){return q(h&l|~h&i,m,h,n,o,g)}function z(m,h,l,i,n,o,g){return q(h&i|l&~i,m,h,n,o,g)}function B(m,h,l,i,n,o,g){return q(h^l^i,m,h,n,o,g)}function G(m,h,l,i,n,o,g){return q(l^(h|~i),m,h,n,o,g)}function M(m,h){var n=m[0],l=m[1],g=m[2],i=m[3];n=D(n,l,g,i,h[0],7,-680876936),i=D(i,n,l,g,h[1],12,-389564586),g=D(g,i,n,l,h[2],17,606105819),l=D(l,g,i,n,h[3],22,-1044525330),n=D(n,l,g,i,h[4],7,-176418897),i=D(i,n,l,g,h[5],12,1200080426),g=D(g,i,n,l,h[6],17,-1473231341),l=D(l,g,i,n,h[7],22,-45705983),n=D(n,l,g,i,h[8],7,1770035416),i=D(i,n,l,g,h[9],12,-1958414417),g=D(g,i,n,l,h[10],17,-42063),l=D(l,g,i,n,h[11],22,-1990404162),n=D(n,l,g,i,h[12],7,1804603682),i=D(i,n,l,g,h[13],12,-40341101),g=D(g,i,n,l,h[14],17,-1502002290),l=D(l,g,i,n,h[15],22,1236535329),n=z(n,l,g,i,h[1],5,-165796510),i=z(i,n,l,g,h[6],9,-1069501632),g=z(g,i,n,l,h[11],14,643717713),l=z(l,g,i,n,h[0],20,-373897302),n=z(n,l,g,i,h[5],5,-701558691),i=z(i,n,l,g,h[10],9,38016083),g=z(g,i,n,l,h[15],14,-660478335),l=z(l,g,i,n,h[4],20,-405537848),n=z(n,l,g,i,h[9],5,568446438),i=z(i,n,l,g,h[14],9,-1019803690),g=z(g,i,n,l,h[3],14,-187363961),l=z(l,g,i,n,h[8],20,1163531501),n=z(n,l,g,i,h[13],5,-1444681467),i=z(i,n,l,g,h[2],9,-51403784),g=z(g,i,n,l,h[7],14,1735328473),l=z(l,g,i,n,h[12],20,-1926607734),n=B(n,l,g,i,h[5],4,-378558),i=B(i,n,l,g,h[8],11,-2022574463),g=B(g,i,n,l,h[11],16,1839030562),l=B(l,g,i,n,h[14],23,-35309556),n=B(n,l,g,i,h[1],4,-1530992060),i=B(i,n,l,g,h[4],11,1272893353),g=B(g,i,n,l,h[7],16,-155497632),l=B(l,g,i,n,h[10],23,-1094730640),n=B(n,l,g,i,h[13],4,681279174),i=B(i,n,l,g,h[0],11,-358537222),g=B(g,i,n,l,h[3],16,-722521979),l=B(l,g,i,n,h[6],23,76029189),n=B(n,l,g,i,h[9],4,-640364487),i=B(i,n,l,g,h[12],11,-421815835),g=B(g,i,n,l,h[15],16,530742520),l=B(l,g,i,n,h[2],23,-995338651),n=G(n,l,g,i,h[0],6,-198630844),i=G(i,n,l,g,h[7],10,1126891415),g=G(g,i,n,l,h[14],15,-1416354905),l=G(l,g,i,n,h[5],21,-57434055),n=G(n,l,g,i,h[12],6,1700485571),i=G(i,n,l,g,h[3],10,-1894986606),g=G(g,i,n,l,h[10],15,-1051523),l=G(l,g,i,n,h[1],21,-2054922799),n=G(n,l,g,i,h[8],6,1873313359),i=G(i,n,l,g,h[15],10,-30611744),g=G(g,i,n,l,h[6],15,-1560198380),l=G(l,g,i,n,h[13],21,1309151649),n=G(n,l,g,i,h[4],6,-145523070),i=G(i,n,l,g,h[11],10,-1120210379),g=G(g,i,n,l,h[2],15,718787259),l=G(l,g,i,n,h[9],21,-343485551),m[0]=K(n,m[0]),m[1]=K(l,m[1]),m[2]=K(g,m[2]),m[3]=K(i,m[3])}function I(i){var h,g=[];for(h=0;64>h;h+=4){g[h>>2]=i.charCodeAt(h)+(i.charCodeAt(h+1)<<8)+(i.charCodeAt(h+2)<<16)+(i.charCodeAt(h+3)<<24)}return g}function E(i){var h,g=[];for(h=0;64>h;h+=4){g[h>>2]=i[h]+(i[h+1]<<8)+(i[h+2]<<16)+(i[h+3]<<24)}return g}function x(g){var p,l,i,r,m,h,o=g.length,n=[1732584193,-271733879,-1732584194,271733878];for(p=64;o>=p;p+=64){M(n,I(g.substring(p-64,p)))}for(g=g.substring(p-64),l=g.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;l>p;p+=1){i[p>>2]|=g.charCodeAt(p)<<(p%4<<3)}if(i[p>>2]|=128<<(p%4<<3),p>55){for(M(n,i),p=0;16>p;p+=1){i[p]=0}}return r=8*o,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),h=parseInt(r[1],16)||0,i[14]=m,i[15]=h,M(n,i),n}function A(g){var h,l,i,r,m,p,o=g.length,n=[1732584193,-271733879,-1732584194,271733878];for(h=64;o>=h;h+=64){M(n,E(g.subarray(h-64,h)))}for(g=o>h-64?g.subarray(h-64):new Uint8Array(0),l=g.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h=0;l>h;h+=1){i[h>>2]|=g[h]<<(h%4<<3)}if(i[h>>2]|=128<<(h%4<<3),h>55){for(M(n,i),h=0;16>h;h+=1){i[h]=0}}return r=8*o,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),p=parseInt(r[1],16)||0,i[14]=m,i[15]=p,M(n,i),n}function w(i){var h,g="";for(h=0;4>h;h+=1){g+=L[i>>8*h+4&15]+L[i>>8*h&15]}return g}function C(h){var g;for(g=0;g<h.length;g+=1){h[g]=w(h[g])}return h.join("")}function H(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(m,h){var n,l=m.length,i=new ArrayBuffer(l),g=new Uint8Array(i);for(n=0;l>n;n+=1){g[n]=m.charCodeAt(n)}return h?g:i}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(l,g,h){var i=new Uint8Array(l.byteLength+g.byteLength);return i.set(new Uint8Array(l)),i.set(new Uint8Array(g),l.byteLength),h?i:i.buffer}function N(l){var g,h=[],i=l.length;for(g=0;i-1>g;g+=2){h.push(parseInt(l.substr(g,2),16))}return String.fromCharCode.apply(String,h)}function F(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==C(x("hello"))&&(K=function(l,g){var h=(65535&l)+(65535&g),i=(l>>16)+(g>>16)+(h>>16);return i<<16|65535&h}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(h,i){return h=0|h||0,0>h?Math.max(h+i,0):Math.min(h,i)}ArrayBuffer.prototype.slice=function(h,r){var o,s,n,l,p=this.byteLength,i=g(h,p),m=p;return r!==J&&(m=g(r,p)),i>m?new ArrayBuffer(0):(o=m-i,s=new ArrayBuffer(o),n=new Uint8Array(s),l=new Uint8Array(this,i,o),n.set(l),s)}}(),F.prototype.append=function(g){return this.appendBinary(H(g)),this},F.prototype.appendBinary=function(i){this._buff+=i,this._length+=i.length;var h,g=this._buff.length;for(h=64;g>=h;h+=64){M(this._hash,I(this._buff.substring(h-64,h)))}return this._buff=this._buff.substring(h-64),this},F.prototype.end=function(m){var h,n,l=this._buff,i=l.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;i>h;h+=1){g[h>>2]|=l.charCodeAt(h)<<(h%4<<3)}return this._finish(g,i),n=C(this._hash),m&&(n=N(n)),this.reset(),n},F.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},F.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},F.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},F.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},F.prototype._finish=function(m,h){var n,l,i,g=h;if(m[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,m),g=0;16>g;g+=1){m[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),l=parseInt(n[2],16),i=parseInt(n[1],16)||0,m[14]=l,m[15]=i,M(this._hash,m)},F.hash=function(h,g){return F.hashBinary(H(h),g)},F.hashBinary=function(l,g){var h=x(l),i=C(h);return g?N(i):i},F.ArrayBuffer=function(){this.reset()},F.ArrayBuffer.prototype.append=function(l){var g,h=f(this._buff.buffer,l,!0),i=h.length;for(this._length+=l.byteLength,g=64;i>=g;g+=64){M(this._hash,E(h.subarray(g-64,g)))}return this._buff=i>g-64?new Uint8Array(h.buffer.slice(g-64)):new Uint8Array(0),this},F.ArrayBuffer.prototype.end=function(m){var h,n,l=this._buff,i=l.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;i>h;h+=1){g[h>>2]|=l[h]<<(h%4<<3)}return this._finish(g,i),n=C(this._hash),m&&(n=N(n)),this.reset(),n},F.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},F.ArrayBuffer.prototype.getState=function(){var g=F.prototype.getState.call(this);return g.buff=j(g.buff),g},F.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),F.prototype.setState.call(this,g)},F.ArrayBuffer.prototype.destroy=F.prototype.destroy,F.ArrayBuffer.prototype._finish=F.prototype._finish,F.ArrayBuffer.hash=function(l,g){var h=A(new Uint8Array(l)),i=C(h);return g?N(i):i},F})},{}],16:[function(c,f,d){function g(p,j,h){var m=h[h.length-1];p===m.element&&(h.pop(),m=h[h.length-1]);var l=m.element,k=m.index;if(Array.isArray(l)){l.push(p)}else{if(k===j.length-2){var e=j.pop();l[e]=p}else{j.push(p)}}}d.stringify=function(A){var x=[];x.push({obj:A});for(var q,h,B,m,w,p,v,e,z,k,j,y="";q=x.pop();){if(h=q.obj,B=q.prefix||"",m=q.val||"",y+=B,m){y+=m}else{if("object"!=typeof h){y+="undefined"==typeof h?null:JSON.stringify(h)}else{if(null===h){y+="null"}else{if(Array.isArray(h)){for(x.push({val:"]"}),w=h.length-1;w>=0;w--){p=0===w?"":",",x.push({obj:h[w],prefix:p})}x.push({val:"["})}else{v=[];for(e in h){h.hasOwnProperty(e)&&v.push(e)}for(x.push({val:"}"}),w=v.length-1;w>=0;w--){z=v[w],k=h[z],j=w>0?",":"",j+=JSON.stringify(z)+":",x.push({obj:k,prefix:j})}x.push({val:"{"})}}}}}return y},d.parse=function(z){for(var r,j,e,m,q,w,v,k,y,h=[],p=[],x=0;;){if(r=z[x++],"}"!==r&&"]"!==r&&"undefined"!=typeof r){switch(r){case" ":case"	":case"\n":case":":case",":break;case"n":x+=3,g(null,h,p);break;case"t":x+=3,g(!0,h,p);break;case"f":x+=4,g(!1,h,p);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(j="",x--;;){if(e=z[x++],!/[\d\.\-e\+]/.test(e)){x--;break}j+=e}g(parseFloat(j),h,p);break;case'"':for(m="",q=void 0,w=0;;){if(v=z[x++],'"'===v&&("\\"!==q||w%2!==1)){break}m+=v,q=v,"\\"===q?w++:w=0}g(JSON.parse('"'+m+'"'),h,p);break;case"[":k={element:[],index:h.length},h.push(k.element),p.push(k);break;case"{":y={element:{},index:h.length},h.push(y.element),p.push(y);break;default:throw new Error("unexpectedly reached end of input: "+r)}}else{if(1===h.length){return h.pop()}g(h.pop(),h,p)}}}},{}],17:[function(f,d,c){(function(bV,dH){function cI(k,i){k=k||[],i=i||{};try{return new Blob(k,i)}catch(h){if("TypeError"!==h.name){throw h}for(var j="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,l=new j,g=0;g<k.length;g+=1){l.append(k[g])}return l.getBlob(i.type)}}function dj(g,i){if("undefined"==typeof FileReader){return i((new FileReaderSync).readAsArrayBuffer(g))}var h=new FileReader;h.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);i(k)},h.readAsArrayBuffer(g)}function bl(){for(var h={},j=new e2(function(k,l){h.resolve=k,h.reject=l}),i=new Array(arguments.length),g=0;g<i.length;g++){i[g]=arguments[g]}return h.promise=j,e2.resolve().then(function(){return fetch.apply(null,i)}).then(function(k){h.resolve(k)})["catch"](function(k){h.reject(k)}),h}function c4(l,h){var i,k,m,j=new Headers,g={method:l.method,credentials:"include",headers:j};return l.json&&(j.set("Accept","application/json"),j.set("Content-Type",l.headers["Content-Type"]||"application/json")),l.body&&l.body instanceof Blob?dj(l.body,function(n){g.body=n}):l.body&&l.processData&&"string"!=typeof l.body?g.body=JSON.stringify(l.body):"body" in l?g.body=l.body:g.body=null,Object.keys(l.headers).forEach(function(n){l.headers.hasOwnProperty(n)&&j.set(n,l.headers[n])}),i=bl(l.url,g),l.timeout>0&&(k=setTimeout(function(){i.reject(new Error("Load timeout for resource: "+l.url))},l.timeout)),i.promise.then(function(n){return m={statusCode:n.status},l.timeout>0&&clearTimeout(k),m.statusCode>=200&&m.statusCode<300?l.binary?n.blob():n.text():n.json()}).then(function(n){m.statusCode>=200&&m.statusCode<300?h(null,m,n):h(n,m)})["catch"](function(n){h(n,m)}),{abort:i.reject}}function aR(m,j){var i,l,g=function(){i.abort()};i=m.xhr?new m.xhr:new XMLHttpRequest;try{i.open(m.method,m.url)}catch(k){j(k,{statusCode:413})}i.withCredentials="withCredentials" in m?m.withCredentials:!0,"GET"===m.method?delete m.headers["Content-Type"]:m.json&&(m.headers.Accept="application/json",m.headers["Content-Type"]=m.headers["Content-Type"]||"application/json",m.body&&m.processData&&"string"!=typeof m.body&&(m.body=JSON.stringify(m.body))),m.binary&&(i.responseType="arraybuffer"),"body" in m||(m.body=null);for(var h in m.headers){m.headers.hasOwnProperty(h)&&i.setRequestHeader(h,m.headers[h])}return m.timeout>0&&(l=setTimeout(g,m.timeout),i.onprogress=function(){clearTimeout(l),l=setTimeout(g,m.timeout)},"undefined"!=typeof i.upload&&(i.upload.onprogress=i.onprogress)),i.onreadystatechange=function(){if(4===i.readyState){var p={statusCode:i.status};if(i.status>=200&&i.status<300){var n;n=m.binary?cI([i.response||""],{type:i.getResponseHeader("Content-Type")}):i.responseText,j(null,p,n)}else{var q={};try{q=JSON.parse(i.response)}catch(o){}j(q,p)}}},m.body&&m.body instanceof Blob?dj(m.body,function(n){i.send(n)}):i.send(m.body),{abort:g}}function jz(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function c6(g,h){return c7||g.xhr?aR(g,h):c4(g,h)}function aL(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function ea(h,j,i){function g(k){for(var l in h){"function"!=typeof h[l]&&(this[l]=h[l])}void 0!==i&&(this.name=i),void 0!==k&&(this.reason=k)}return g.prototype=aL.prototype,new g(j)}function d0(k){var i,h,j,l,g;return h=k.error===!0&&"string"==typeof k.name?k.name:k.error,g=k.reason,j=cH("name",h,g),k.missing||"missing"===g||"deleted"===g||"not_found"===h?j=bd:"doc_validation"===h?(j=ay,l=g):"bad_request"===h&&j.message!==g&&(j=jx),j||(j=cH("status",k.status,g)||bY),i=ea(j,g,h),l&&(i.message=l),k.id&&(i.id=k.id),k.status&&(i.status=k.status),k.missing&&(i.missing=k.missing),i}function jZ(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function aW(h){if("function"==typeof h.slice){return h.slice(0)}var j=new ArrayBuffer(h.byteLength),i=new Uint8Array(j),g=new Uint8Array(h);return i.set(g),j}function d9(g){if(g instanceof ArrayBuffer){return aW(g)}var i=g.size,h=g.type;return"function"==typeof g.slice?g.slice(0,i,h):g.webkitSlice(0,i,h)}function dY(j){var h,g,i;if(!j||"object"!=typeof j){return j}if(Array.isArray(j)){for(h=[],g=0,i=j.length;i>g;g++){h[g]=dY(j[g])}return h}if(j instanceof Date){return j.toISOString()}if(jZ(j)){return d9(j)}h={};for(g in j){if(Object.prototype.hasOwnProperty.call(j,g)){var k=dY(j[g]);"undefined"!=typeof k&&(h[g]=k)}}return h}function ad(){return""}function aO(j,h){function g(o,n,l){if(!j.binary&&j.json&&"string"==typeof o){try{o=JSON.parse(o)}catch(m){return l(m)}}Array.isArray(o)&&(o=o.map(function(p){return p.error||p.missing?d0(p):p})),j.binary&&ej(o,n),l(null,o,n)}function i(n,l){var p,m;if(n.code&&n.status){var o=new Error(n.message||n.code);return o.status=n.status,l(o)}try{p=JSON.parse(n.responseText),m=d0(p)}catch(q){m=d0(n)}l(m)}j=dY(j);var k={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return j=bS.extend(k,j),j.json&&(j.binary||(j.headers.Accept="application/json"),j.headers["Content-Type"]=j.headers["Content-Type"]||"application/json"),j.binary&&(j.encoding=null,j.json=!1),j.processData||(j.json=!1),c6(j,function(n,r,p){if(n){return n.status=r?r.statusCode:400,i(n,h)}var l,q=r.headers&&r.headers["content-type"],o=p||ad();if(!j.binary&&(j.json||!j.processData)&&"object"!=typeof o&&(/json/.test(q)||/^[\s]*\{/.test(o)&&/\}[\s]*$/.test(o))){try{o=JSON.parse(o.toString())}catch(m){}}r.statusCode>=200&&r.statusCode<300?g(o,r,h):(l=d0(o),l.status=r.statusCode,h(l))})}function dO(n,g){var k=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",h=-1!==k.indexOf("safari")&&-1===k.indexOf("chrome"),i=-1!==k.indexOf("msie"),j=h&&"POST"===n.method||i&&"GET"===n.method,m="cache" in n?n.cache:!0;if(j||!m){var l=-1!==n.url.indexOf("?");n.url+=(l?"&":"?")+"_nonce="+Date.now()}return aO(n,g)}function jF(g){var h=!1;return jA(function(i){if(h){throw new Error("once called more than once")}h=!0,g.apply(this,i)})}function jB(g){return jA(function(j){j=dY(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(m,n){bV.nextTick(function(){i(m,n)})});var h=new e2(function(n,m){var p;try{var o=jF(function(r,s){r?m(r):n(s)});j.push(o),p=g.apply(l,j),p&&"function"==typeof p.then&&n(p)}catch(q){m(q)}});return k&&h.then(function(m){k(null,m)},k),h})}function cj(g,i){function h(l,j,n){if(fG.enabled){for(var k=[l._db_name,j],m=0;m<n.length-1;m++){k.push(n[m])}fG.apply(null,k);var o=n[n.length-1];n[n.length-1]=function(r,p){var q=[l._db_name,j];q=q.concat(r?["error",r]:["success",p]),fG.apply(null,q),o(r,p)}}}return jB(jA(function(j){if(this._closed){return e2.reject(new Error("database is closed"))}var k=this;return h(k,g,j),this.taskqueue.isReady?i.apply(this,j):new e2(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[g].apply(k,j))})})}))}function jE(k,i){for(var h={},j=0,l=i.length;l>j;j++){var g=i[j];g in k&&(h[g]=k[g])}return h}function dy(g,i,h){return new e2(function(j,k){g.get(i,function(m,o){if(m){if(404!==m.status){return k(m)}o={}}var n=o._rev,l=h(o);return l?(l._id=i,l._rev=n,void j(jL(g,l,h))):j({updated:!1,rev:n})})})}function jL(g,i,h){return g.put(i).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return dy(g,i._id,h)})}function ds(r){for(var h,k,i,j,m=r.rev_tree.slice();j=m.pop();){var s=j.ids,n=s[2],g=j.pos;if(n.length){for(var q=0,o=n.length;o>q;q++){m.push({pos:g+1,ids:n[q]})}}else{var l=!!s[1].deleted,p=s[0];(!h||(i!==l?i:k!==g?g>k:p>h))&&(h=p,k=g,i=l)}}return k+"-"+h}function al(g){return g.ids}function b4(j,h){h||(h=ds(j));for(var g,i=h.substring(h.indexOf("-")+1),k=j.rev_tree.map(al);g=k.pop();){if(g[0]===i){return !!g[1].deleted}k=k.concat(g[2])}}function bP(g){return ck("return "+g+";",{})}function aa(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function jG(g){if(!g){return null}var h=g.split("/");return 2===h.length?h:1===h.length?[g,g]:null}function jR(g){var h=jG(g);return h?h.join("/"):null}function ef(h,j){for(var o,l=h.slice();o=l.pop();){for(var m=o.pos,g=o.ids,i=g[2],k=j(0===i.length,m,g[0],o.ctx,g[1]),n=0,p=i.length;p>n;n++){l.push({pos:m+1,ids:i[n],ctx:k})}}}function di(g,h){return g.pos-h.pos}function aw(h){var j=[];ef(h,function(n,k,m,o,l){n&&j.push({rev:k+"-"+m,pos:k,opts:l})}),j.sort(di).reverse();for(var i=0,g=j.length;g>i;i++){delete j[i].pos}return j}function jI(m){for(var k=ds(m),g=aw(m.rev_tree),l=[],i=0,j=g.length;j>i;i++){var h=g[i];h.rev===k||h.opts.deleted||l.push(h.rev)}return l}function jW(m,k,g){function l(){i.cancel()}jq.EventEmitter.call(this);var i=this;this.db=m,k=k?dY(k):{};var j=k.complete=jF(function(n,o){n?i.emit("error",n):i.emit("complete",o),i.removeAllListeners(),m.removeListener("destroyed",l)});g&&(i.on("complete",function(n){g(null,n)}),i.on("error",g)),m.once("destroyed",l),k.onChange=function(n){k.isCancelled||(i.emit("change",n),i.startSeq&&i.startSeq<=n.seq&&(i.startSeq=!1))};var h=new e2(function(n,o){k.complete=function(p,q){p?o(p):n(q)}});i.once("cancel",function(){m.removeListener("destroyed",l),k.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){j(null,n)},j),m.taskqueue.isReady?i.doChanges(k):m.taskqueue.addTask(function(){i.isCancelled?i.emit("cancel"):i.doChanges(k)})}function aU(j,h,g){var i=[{rev:j._rev}];"all_docs"===g.style&&(i=aw(h.rev_tree).map(function(l){return{rev:l.rev}}));var k={id:h.id,changes:i,doc:j};return b4(h,j._rev)&&(k.deleted=!0),g.conflicts&&(k.doc._conflicts=jI(h),k.doc._conflicts.length||delete k.doc._conflicts),k}function dl(p,j,n){function l(){var r=[];o.forEach(function(s){s.docs.forEach(function(u){r.push({id:s.id,docs:[u]})})}),n(null,{results:r})}function k(){++h===q&&l()}function m(r,u,s){o[r]={id:u,docs:s},k()}var g=Array.isArray(j)?j:j.docs,i={};g.forEach(function(r){r.id in i?i[r.id].push(r):i[r.id]=[r]});var q=Object.keys(i).length,h=0,o=new Array(q);Object.keys(i).forEach(function(u,v){var w=i[u],s=jE(w[0],["atts_since","attachments"]);s.open_revs=w.map(function(x){return x.rev}),s.open_revs=s.open_revs.filter(function(x){return x});var r=function(x){return x};0===s.open_revs.length&&(delete s.open_revs,r=function(x){return[{ok:x}]}),["revs","attachments","binary"].forEach(function(x){x in j&&(s[x]=j[x])}),p.get(u,s,function(y,x){m(v,u,y?[{error:y}]:r(x))})})}function c2(g){return/^_local/.test(g)}function jS(r){for(var h,k=[],i=r.slice();h=i.pop();){var j=h.pos,m=h.ids,s=m[0],n=m[1],g=m[2],q=0===g.length,o=h.history?h.history.slice():[];o.push({id:s,opts:n}),q&&k.push({pos:j+1-o.length,ids:o});for(var l=0,p=g.length;p>l;l++){i.push({pos:j+1,ids:g[l],history:o})}}return k.reverse()}function cW(g){return 0|Math.random()*g}function jy(h,j){j=j||az.length;var i="",g=-1;if(h){for(;++g<h;){i+=az[cW(j)]}return i}for(;++g<36;){switch(g){case 8:case 13:case 18:case 23:i+="-";break;case 19:i+=az[3&cW(16)|8];break;default:i+=az[cW(16)]}}return i}function jo(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function jU(g){var h;if(g?"string"!=typeof g?h=ea(eZ):/^_/.test(g)&&!/^_(design|local)/.test(g)&&(h=ea(dz)):h=ea(a9),h){throw h}}function aq(h){if(!/^\d+\-./.test(h)){return ea(jX)}var j=h.indexOf("-"),i=h.substring(0,j),g=h.substring(j+1);return{prefix:parseInt(i,10),id:g}}function jM(m,k){for(var g=m.start-m.ids.length+1,l=m.ids,i=[l[0],k,[]],j=1,h=l.length;h>j;j++){i=[l[j],{status:"missing"},[i]]}return[{pos:g,ids:i}]}function bj(h,j){var o,l,m,g={status:"available"};if(h._deleted&&(g.deleted=!0),j){if(h._id||(h._id=jy()),l=jy(32,16).toLowerCase(),h._rev){if(m=aq(h._rev),m.error){return m}h._rev_tree=[{pos:m.prefix,ids:[m.id,{status:"missing"},[[l,g,[]]]]}],o=m.prefix+1}else{h._rev_tree=[{pos:1,ids:[l,g,[]]}],o=1}}else{if(h._revisions&&(h._rev_tree=jM(h._revisions,g),o=h._revisions.start,l=h._revisions.ids[0]),!h._rev_tree){if(m=aq(h._rev),m.error){return m}o=m.prefix,l=m.id,h._rev_tree=[{pos:o,ids:[l,g,[]]}]}}jU(h._id),h._rev=o+"-"+l;var i={metadata:{},data:{}};for(var k in h){if(Object.prototype.hasOwnProperty.call(h,k)){var n="_"===k[0];if(n&&!cD[k]){var p=ea(ay,k);throw p.message=ay.message+": "+k,p}n&&!cp[k]?i.metadata[k.slice(1)]=h[k]:i.data[k]=h[k]}}return i}function eS(g,h){return h>g?-1:g>h?1:0}function bk(g,i){for(var h=0;h<g.length;h++){if(i(g[h],h)===!0){return g[h]}}}function cS(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function bH(k){for(var i=0;i<k.length;i++){var h=k[i];if(h._deleted){delete h._attachments}else{if(h._attachments){for(var j=Object.keys(h._attachments),l=0;l<j.length;l++){var g=j[l];h._attachments[g]=jE(h._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function c0(j,h){var g=eS(j._id,h._id);if(0!==g){return g}var i=j._revisions?j._revisions.start:0,k=h._revisions?h._revisions.start:0;return eS(i,k)}function bw(g){var i={},h=[];return ef(g,function(n,m,j,l){var k=m+"-"+j;return n&&(i[k]=0),void 0!==l&&h.push({from:l,to:k}),k}),h.reverse(),h.forEach(function(j){void 0===i[j.from]?i[j.from]=1+i[j.to]:i[j.from]=Math.min(i[j.from],1+i[j.to])}),i}function aT(j,h,g){var i="limit" in h?h.keys.slice(h.skip,h.limit+h.skip):h.skip>0?h.keys.slice(h.skip):h.keys;if(h.descending&&i.reverse(),!i.length){return j._allDocs({limit:0},g)}var k={offset:h.skip};return e2.all(i.map(function(m){var l=bS.extend({key:m,deleted:"ok"},h);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new e2(function(n,o){j._allDocs(l,function(q,p){return q?o(q):(k.total_rows=p.total_rows,void n(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return k.rows=l,k})}function dK(h){var j=h._compactionQueue[0],g=j.opts,i=j.callback;h.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(g.last_seq=k.last_seq),h._compact(g,function(l,m){l?i(l):i(null,m),bV.nextTick(function(){h._compactionQueue.shift(),h._compactionQueue.length&&dK(h)})})})}function eY(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function ba(){jq.EventEmitter.call(this)}function fC(){this.isReady=!1,this.failed=!1,this.queue=[]}function cL(g){g&&dH.debug&&console.error(g)}function fI(m,k){function g(){j.emit("destroyed",i),j.emit(i,"destroyed")}function l(){m.removeListener("destroyed",g),m.emit("destroyed",m)}var i=k.originalName,j=m.constructor,h=j._destructionListeners;m.once("destroyed",g),h.has(i)||h.set(i,[]),h.get(i).push(l)}function cE(k,i,h){if(!(this instanceof cE)){return new cE(k,i,h)}var j=this;("function"==typeof i||"undefined"==typeof i)&&(h=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),"undefined"==typeof h&&(h=cL),k=k||i.name,i=dY(i),delete i.name,this.__opts=i;var l=h;j.auto_compaction=i.auto_compaction,j.prefix=cE.prefix,ba.call(j),j.taskqueue=new fC;var g=new e2(function(n,q){h=function(r,s){return r?q(r):(delete s.then,void n(s))},i=dY(i);var o,m,p=i.name||k;return function(){try{if("string"!=typeof p){throw m=new Error("Missing/invalid DB name"),m.code=400,m}if(o=cE.parseAdapter(p,i),i.originalName=p,i.name=o.name,i.prefix&&"http"!==o.adapter&&"https"!==o.adapter&&(i.name=i.prefix+i.name),i.adapter=i.adapter||o.adapter,j._adapter=i.adapter,bg("pouchdb:adapter")("Picked adapter: "+i.adapter),j._db_name=p,!cE.adapters[i.adapter]){throw m=new Error("Adapter is missing"),m.code=404,m}if(!cE.adapters[i.adapter].valid()){throw m=new Error("Invalid Adapter"),m.code=404,m}}catch(r){j.taskqueue.fail(r)}}(),m?q(m):(j.adapter=i.adapter,j.replicate={},j.replicate.from=function(r,u,s){return j.constructor.replicate(r,j,u,s)},j.replicate.to=function(r,u,s){return j.constructor.replicate(j,r,u,s)},j.sync=function(r,u,s){return j.constructor.sync(j,r,u,s)},j.replicate.sync=j.sync,void cE.adapters[i.adapter].call(j,i,function(r){return r?(j.taskqueue.fail(r),void h(r)):(fI(j,i),j.emit("created",j),cE.emit("created",i.originalName),j.taskqueue.ready(j),void h(null,j))}))});g.then(function(m){l(null,m)},l),j.then=g.then.bind(g),j["catch"]=g["catch"].bind(g)}function jJ(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function a8(){return eA}function e8(g){Object.keys(jq.EventEmitter.prototype).forEach(function(i){"function"==typeof jq.EventEmitter.prototype[i]&&(g[i]=fL[i].bind(fL))});var h=g._destructionListeners=new cQ.Map;g.on("destroyed",function(i){h.has(i)&&(h.get(i).forEach(function(j){j()}),h["delete"](i))})}function aH(j){for(var h=j.length,g=new ArrayBuffer(h),i=new Uint8Array(g),k=0;h>k;k++){i[k]=j.charCodeAt(k)}return g}function c5(g,h){return cI([aH(g)],{type:h})}function bh(m){for(var k=ac.exec(m),g={},l=14;l--;){var i=aV[l],j=k[l]||"",h=-1!==["user","password"].indexOf(i);g[i]=h?decodeURIComponent(j):j}return g[bE]={},g[aV[12]].replace(b1,function(n,o,p){o&&(g[bE][o]=p)}),g}function aB(j,h,g){try{return !j(h,g)}catch(i){var k="Filter function threw: "+i.toString();return ea(jx,k)}}function jl(g){var i={},h=g.filter&&"function"==typeof g.filter;return i.query=g.query_params,function(k){k.doc||(k.doc={});var l=h&&aB(g.filter,k.doc,i);if("object"==typeof l){return l}if(l){return !1}if(g.include_docs){if(!g.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function cB(g,h){"console" in dH&&"info" in console&&console.info("The above "+g+" is totally normal. "+h)}function by(j,h,g,i,k){return j.get(h)["catch"](function(l){if(404===l.status){return"http"===j.type()&&cB(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:i,_id:h,history:[],replicator:bq,version:cA}}throw l}).then(function(l){return k.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==i}),l.history.unshift({last_seq:g,session_id:i}),l.history=l.history.slice(0,dI),l.version=cA,l.replicator=bq,l.session_id=i,l.last_seq=g,j.put(l)["catch"](function(m){if(409===m.status){return by(j,h,g,i,k)}throw m}))})}function jV(h,j,i,g){this.src=h,this.target=j,this.id=i,this.returnValue=g}function cG(h,j){if(h.session_id===j.session_id){return{last_seq:h.last_seq,history:h.history||[]}}var i=h.history||[],g=j.history||[];return eJ(i,g)}function eJ(n,g){var k=n[0],h=n.slice(1),i=g[0],j=g.slice(1);if(!k||0===g.length){return{last_seq:cZ,history:[]}}var m=k.session_id;if(bR(m,g)){return{last_seq:k.last_seq,history:n}}var l=i.session_id;return bR(l,h)?{last_seq:i.last_seq,history:j}:eJ(h,j)}function bR(h,j){var i=j[0],g=j.slice(1);return h&&0!==j.length?h===i.session_id?!0:bR(h,g):!1}function jK(h,j){h=parseInt(h,10)||0,j=parseInt(j,10),j!==j||h>=j?j=(h||1)<<1:j+=1;var i=Math.random(),g=j-h;return ~~(g*i+h)}function aP(g){var h=0;return g||(h=2000),jK(g,h)}function eU(h,j,i,g){return h.retry===!1?(j.emit("error",i),void j.removeAllListeners()):("function"!=typeof h.back_off_function&&(h.back_off_function=aP),j.emit("requestError",i),("active"===j.state||"pending"===j.state)&&(j.emit("paused",i),j.state="stopped",j.once("active",function(){h.current_back_off=dm})),h.current_back_off=h.current_back_off||dm,h.current_back_off=h.back_off_function(h.current_back_off),void setTimeout(g,h.current_back_off))}function dk(g){return cR(g)}function dc(h,j,i,g){(i>0||g<j.byteLength)&&(j=new Uint8Array(j,i,Math.min(g,j.byteLength)-i)),h.append(j)}function bO(h,j,i,g){(i>0||g<j.length)&&(j=j.substring(i,g)),h.appendBinary(j)}function ch(g){return Object.keys(g).sort(cT.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function eh(m,k,g){var l=g.doc_ids?g.doc_ids.sort(cT.collate):"",i=g.filter?g.filter.toString():"",j="",h="";return g.filter&&g.query_params&&(j=JSON.stringify(ch(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),e2.all([m.id(),k.id()]).then(function(o){var n=o[0]+o[1]+i+h+j+l;return aK(n)}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function dA(g){return/^1-/.test(g)}function bC(g){var h=[];return Object.keys(g).forEach(function(j){var i=g[j].missing;i.forEach(function(k){h.push({id:j,rev:k})})}),{docs:h,revs:!0,attachments:!0,binary:!0}}function cP(o,g,l){function j(){var p=bC(g);if(p.docs.length){return o.bulkGet(p).then(function(q){if(l.cancelled){throw new Error("cancelled")}q.results.forEach(function(r){r.docs.forEach(function(s){s.ok&&m.push(s.ok)})})})}}function k(p){return p._attachments&&Object.keys(p._attachments).length>0}function n(p){return o.allDocs({keys:p,include_docs:!0}).then(function(q){if(l.cancelled){throw new Error("cancelled")}q.rows.forEach(function(r){!r.deleted&&r.doc&&dA(r.value.rev)&&!k(r.doc)&&(m.push(r.doc),delete g[r.id])})})}function h(){var p=Object.keys(g).filter(function(q){var r=g[q].missing;return 1===r.length&&dA(r[0])});return p.length>0?n(p):void 0}function i(){return m}g=dY(g);var m=[];return e2.resolve().then(h).then(j).then(i)}function d4(w,x,N,G,M){function h(){return k?e2.resolve():eh(w,x,N).then(function(T){A=T,k=new jV(w,x,A,G)})}function J(){if(p=[],0!==m.docs.length){var T=m.docs;return x.bulkDocs({docs:T,new_edits:!1}).then(function(W){if(G.cancelled){throw i(),new Error("cancelled")}var Y=[],V={};W.forEach(function(Z){Z.error&&(M.doc_write_failures++,Y.push(Z),V[Z.id]=Z)}),B=B.concat(Y),M.docs_written+=m.docs.length-Y.length;var U=Y.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=V[Z._id];ae?G.emit("denied",dY(ae)):p.push(Z)}),U.length>0){var X=new Error("bulkDocs error");throw X.other_errors=Y,F("target.bulkDocs failed to write docs",X),new Error("bulkWrite partial failure")}},function(U){throw M.doc_write_failures+=T.length,U})}}function z(){M.last_seq=n=m.seq;var T=dY(M);return p.length&&(T.docs=p,G.emit("change",T)),j=!0,k.writeCheckpoint(m.seq,D).then(function(){if(j=!1,G.cancelled){throw i(),new Error("cancelled")}m=void 0,P()})["catch"](function(U){throw j=!1,F("writeCheckpoint completed with error",U),U})}function s(){var T={};return m.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),x.revsDiff(T).then(function(U){if(G.cancelled){throw i(),new Error("cancelled")}m.diffs=U})}function H(){return cP(w,m.diffs,G).then(function(T){T.forEach(function(U){delete m.diffs[U._id],M.docs_read++,m.docs.push(U)})})}function u(){if(!G.cancelled&&!m){if(0===R.length){return void Q(!0)}m=R.shift(),s().then(H).then(J).then(z).then(u)["catch"](function(T){F("batch processing terminated with error",T)})}}function Q(T){return 0===K.changes.length?void (0!==R.length||m||((g&&y.live||E)&&(G.state="pending",G.emit("paused")),E&&i())):void ((T||E||K.changes.length>=C)&&(R.push(K),K={seq:0,changes:[],docs:[]},("pending"===G.state||"stopped"===G.state)&&(G.state="active",G.emit("active")),u()))}function F(T,U){O||(U.message||(U.message=T),M.ok=!1,M.status="aborting",M.errors.push(U),B=B.concat(U),R=[],K={seq:0,changes:[],docs:[]},i())}function i(){if(!(O||G.cancelled&&(M.status="cancelled",j))){M.status=M.status||"complete",M.end_time=new Date,M.last_seq=n,O=!0;var T=B.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(T.length>0){var U=B.pop();B.length>0&&(U.other_errors=B),U.result=M,eU(N,G,U,function(){d4(w,x,N,G)})}else{M.errors=B,G.emit("complete",M),G.removeAllListeners()}}}function L(T){if(G.cancelled){return i()}var U=jl(N)(T);U&&(K.seq=T.seq,K.changes.push(T),Q(0===R.length))}function r(T){return v=!1,G.cancelled?i():(T.results.length>0?(y.since=T.last_seq,P()):g?(y.live=!0,P()):E=!0,void Q(!0))}function S(T){return v=!1,G.cancelled?i():void F("changes rejected",T)}function P(){function T(){V.cancel()}function U(){G.removeListener("cancel",T)}if(!v&&!E&&R.length<q){v=!0,G._changes&&(G.removeListener("cancel",G._abortChanges),G._changes.cancel()),G.once("cancel",T);var V=w.changes(y).on("change",L);V.then(U,U),V.then(r)["catch"](S),N.retry&&(G._changes=V,G._abortChanges=T)}}function o(){h().then(function(){return G.cancelled?void i():k.getCheckpoint().then(function(T){n=T,y={since:n,limit:C,batch_size:C,style:"all_docs",doc_ids:l,return_docs:!0},N.filter&&("string"!=typeof N.filter?y.include_docs=!0:y.filter=N.filter),"heartbeat" in N&&(y.heartbeat=N.heartbeat),"timeout" in N&&(y.timeout=N.timeout),N.query_params&&(y.query_params=N.query_params),N.view&&(y.view=N.view),P()})})["catch"](function(T){F("getCheckpoint rejected with ",T)})}function I(T){throw j=!1,F("writeCheckpoint completed with error",T),T}var m,A,k,R=[],K={seq:0,changes:[],docs:[]},j=!1,E=!1,O=!1,n=0,g=N.continuous||N.live||!1,C=N.batch_size||100,q=N.batches_limit||10,v=!1,l=N.doc_ids,B=[],p=[],D=jy();M=M||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var y={};return G.ready(w,x),G.cancelled?void i():(G._addedListeners||(G.once("cancel",i),"function"==typeof N.complete&&(G.once("error",N.complete),G.once("complete",function(T){N.complete(null,T)})),G._addedListeners=!0),void ("undefined"==typeof N.since?o():h().then(function(){return j=!0,k.writeCheckpoint(N.since,D)}).then(function(){return j=!1,G.cancelled?void i():(n=N.since,void o())})["catch"](I)))}function bX(){jq.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var g=this,h=new e2(function(i,j){g.once("complete",i),g.once("error",j)});g.then=function(i,j){return h.then(i,j)},g["catch"]=function(i){return h["catch"](i)},g["catch"](function(){})}function dF(g,i){var h=i.PouchConstructor;return"string"==typeof g?new h(g,i):g}function b5(m,k,g,l){if("function"==typeof g&&(l=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw ea(jx,"`doc_ids` filter parameter is not a list.")}g.complete=l,g=dY(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var i=new bX(g),j=dF(m,g),h=dF(k,g);return d4(j,h,g,i),i}function e(h,j,i,g){return"function"==typeof i&&(g=i,i={}),"undefined"==typeof i&&(i={}),i=dY(i),i.PouchConstructor=i.PouchConstructor||this,h=eB.toPouch(h,i),j=eB.toPouch(j,i),new dq(h,j,i,g)}function dq(n,v,w,p){function u(z){l.emit("change",{direction:"pull",change:z})}function k(z){l.emit("change",{direction:"push",change:z})}function s(z){l.emit("denied",{direction:"push",doc:z})}function x(z){l.emit("denied",{direction:"pull",doc:z})}function i(){l.pushPaused=!0,l.pullPaused&&l.emit("paused")}function q(){l.pullPaused=!0,l.pushPaused&&l.emit("paused")}function m(){l.pushPaused=!1,l.pullPaused&&l.emit("active",{direction:"push"})}function y(){l.pullPaused=!1,l.pushPaused&&l.emit("active",{direction:"pull"})}function o(z){return function(D,C){var A="change"===D&&(C===u||C===k),F="denied"===D&&(C===x||C===s),B="paused"===D&&(C===q||C===i),E="active"===D&&(C===y||C===m);(A||F||B||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&l.removeAllListeners(D))}}var l=this;this.canceled=!1;var r=w.push?bS.extend({},w,w.push):w,h=w.pull?bS.extend({},w,w.pull):w;this.push=dU(n,v,r),this.pull=dU(v,n,h),this.pushPaused=!0,this.pullPaused=!0;var g={};w.live&&(this.push.on("complete",l.pull.cancel.bind(l.pull)),this.pull.on("complete",l.push.cancel.bind(l.push))),this.on("newListener",function(z){"change"===z?(l.pull.on("change",u),l.push.on("change",k)):"denied"===z?(l.pull.on("denied",x),l.push.on("denied",s)):"active"===z?(l.pull.on("active",y),l.push.on("active",m)):"paused"===z&&(l.pull.on("paused",q),l.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(l.pull.removeListener("change",u),l.push.removeListener("change",k)):"denied"===z?(l.pull.removeListener("denied",x),l.push.removeListener("denied",s)):"active"===z?(l.pull.removeListener("active",y),l.push.removeListener("active",m)):"paused"===z&&(l.pull.removeListener("paused",q),l.push.removeListener("paused",i))}),this.pull.on("removeListener",o("pull")),this.push.on("removeListener",o("push"));var j=e2.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return l.emit("complete",z),p&&p(null,z),l.removeAllListeners(),z},function(z){if(l.cancel(),p?p(z):l.emit("error",z),l.removeAllListeners(),p){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function e3(g,h){return c5(aI(g),h)}function dL(j){for(var h="",g=new Uint8Array(j),i=g.byteLength,k=0;i>k;k++){h+=String.fromCharCode(g[k])}return h}function jm(h,j){if("undefined"==typeof FileReader){return j(dL((new FileReaderSync).readAsArrayBuffer(h)))}var i=new FileReader,g="function"==typeof i.readAsBinaryString;i.onloadend=function(k){var l=k.target.result||"";return g?j(l):void j(dL(l))},g?i.readAsBinaryString(h):i.readAsArrayBuffer(h)}function aX(g){return new e2(function(h){jm(g,function(i){h(cR(i))})})}function jH(h){for(var j=[],i=0,g=h.length;g>i;i++){j=j.concat(h[i])}return j}function jD(g){var h=g.doc&&g.doc._attachments;h&&Object.keys(h).forEach(function(i){var j=h[i];j.data=e3(j.data,j.content_type)})}function e0(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function e6(g){return g._attachments&&Object.keys(g._attachments)?e2.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?aX(i.data).then(function(j){i.data=j}):void 0})):e2.resolve()}function b0(g){var i=bh(g);(i.user||i.password)&&(i.auth={username:i.user,password:i.password});var h=i.path.replace(/(^\/|\/$)/g,"").split("/");return i.db=h.pop(),-1===i.db.indexOf("%")&&(i.db=encodeURIComponent(i.db)),i.path=h.join("/"),i}function cc(g,h){return cl(g,g.db+"/"+h)}function cl(g,i){var h=g.path?"/":"";return g.protocol+"://"+g.host+(g.port?":"+g.port:"")+"/"+g.path+h+i}function bz(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function dE(j,q){function o(x,z,y){var A=x.ajax||{},w=bS.extend(dY(n),A,z);return bU(w.method+" "+w.url),bu.ajax(w,y)}function i(x,w){return new e2(function(z,y){o(x,w,function(A,B){return A?y(A):void z(B)})})}function k(x,w){return cj(x,jA(function(y){u().then(function(z){return w.apply(this,y)})["catch"](function(z){var A=y.pop();A(z)})}))}function u(){if(j.skipSetup||j.skip_setup){return e2.resolve()}if(r){return r}var w={method:"GET",url:v};return r=i({},w)["catch"](function(x){return x&&x.status&&404===x.status?(cB(404,"PouchDB is just detecting if the remote exists."),i({},{method:"PUT",url:v})):e2.reject(x)})["catch"](function(x){return x&&x.status&&412===x.status?!0:e2.reject(x)}),r["catch"](function(){r=null}),r}function p(w){return w.split("/").map(encodeURIComponent).join("/")}var g=this,m=b0;j.getHost&&(m=j.getHost);var l=m(j.name,j),v=cc(l,"");j=dY(j);var n=j.ajax||{};if(g.getUrl=function(){return v},g.getHeaders=function(){return n.headers||{}},j.auth||l.auth){var s=j.auth||l.auth,h=cR(s.username+":"+s.password);n.headers=n.headers||{},n.headers.Authorization="Basic "+h}var r;setTimeout(function(){q(null,g)}),g.type=function(){return"http"},g.id=k("id",function(w){o({},{method:"GET",url:cl(l,"")},function(x,z){var y=z&&z.uuid?z.uuid+l.db:cc(l,"");w(null,y)})}),g.request=k("request",function(x,w){x.url=cc(l,x.url),o({},x,w)}),g.compact=k("compact",function(x,w){"function"==typeof x&&(w=x,x={}),x=dY(x),o(x,{url:cc(l,"_compact"),method:"POST"},function(){function y(){g.info(function(z,A){A&&!A.compact_running?w(null,{ok:!0}):setTimeout(y,x.interval||200)})}y()})}),g.bulkGet=cj("bulkGet",function(y,B){function A(E){var D={};y.revs&&(D.revs=!0),y.attachments&&(D.attachments=!0),o({},{url:cc(l,"_bulk_get"+bz(D)),method:"POST",body:{docs:y.docs}},E)}function w(){function G(K){return function(L,M){J[K]=M.results,++H===E&&B(null,{results:jH(J)})}}for(var D=dw,E=Math.ceil(y.docs.length/D),H=0,J=new Array(E),I=0;E>I;I++){var F=jE(y,["revs","attachments"]);F.docs=y.docs.slice(I*D,Math.min(y.docs.length,(I+1)*D)),dl(z,F,G(I))}}var z=this,x=cl(l,""),C=cN[x];"boolean"!=typeof C?A(function(D,E){if(D){var F=Math.floor(D.status/100);4===F||5===F?(cN[x]=!1,cB(D.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),w()):B(D)}else{cN[x]=!0,B(null,E)}}):C?A(B):w()}),g._info=function(w){u().then(function(){o({},{method:"GET",url:cc(l,"")},function(x,y){return x?w(x):(y.host=cc(l,""),void w(null,y))})})["catch"](w)},g.get=k("get",function(y,B,A){function w(E){var F=E._attachments,D=F&&Object.keys(F);return F&&D.length?e2.all(D.map(function(I){var G=F[I],H=e0(E._id)+"/"+p(I)+"?rev="+E._rev;return i(B,{method:"GET",url:cc(l,H),binary:!0}).then(function(J){return B.binary?J:aX(J)}).then(function(J){delete G.stub,delete G.length,G.data=J})})):void 0}function z(D){return Array.isArray(D)?e2.all(D.map(function(E){return E.ok?w(E.ok):void 0})):w(D)}"function"==typeof B&&(A=B,B={}),B=dY(B);var C={};B.revs&&(C.revs=!0),B.revs_info&&(C.revs_info=!0),B.open_revs&&("all"!==B.open_revs&&(B.open_revs=JSON.stringify(B.open_revs)),C.open_revs=B.open_revs),B.rev&&(C.rev=B.rev),B.conflicts&&(C.conflicts=B.conflicts),y=e0(y);var x={method:"GET",url:cc(l,y+bz(C))};i(B,x).then(function(D){return e2.resolve().then(function(){return B.attachments?z(D):void 0}).then(function(){A(null,D)})})["catch"](A)}),g.remove=k("remove",function(A,x,z,B){var w;"string"==typeof x?(w={_id:A,_rev:x},"function"==typeof z&&(B=z,z={})):(w=A,"function"==typeof x?(B=x,z={}):(B=z,z=x));var y=w._rev||z.rev;o(z,{method:"DELETE",url:cc(l,e0(w._id))+"?rev="+y},B)}),g.getAttachment=k("getAttachment",function(A,z,B,x){"function"==typeof B&&(x=B,B={});var w=B.rev?"?rev="+B.rev:"",y=cc(l,e0(A))+"/"+p(z)+w;o(B,{method:"GET",url:y,binary:!0},x)}),g.removeAttachment=k("removeAttachment",function(x,z,w,y){var A=cc(l,e0(x)+"/"+p(z))+"?rev="+w;o({},{method:"DELETE",url:A},y)}),g.putAttachment=k("putAttachment",function(x,A,C,E,F,B){"function"==typeof F&&(B=F,F=E,E=C,C=null);var z=e0(x)+"/"+p(A),w=cc(l,z);if(C&&(w+="?rev="+C),"string"==typeof E){var G;try{G=aI(E)}catch(D){return B(ea(cJ,"Attachment is not a valid base64 string"))}E=G?c5(G,F):""}var y={headers:{"Content-Type":F},method:"PUT",url:w,processData:!1,body:E,timeout:n.timeout||60000};o({},y,B)}),g._bulkDocs=function(w,x,y){w.new_edits=x.new_edits,u().then(function(){return e2.all(w.docs.map(e6))}).then(function(){o(x,{method:"POST",url:cc(l,"_bulk_docs"),body:w},function(A,z){return A?y(A):(z.forEach(function(B){B.ok=!0}),void y(null,z))})})["catch"](y)},g.allDocs=k("allDocs",function(y,A){"function"==typeof y&&(A=y,y={}),y=dY(y);var B,w={},z="GET";y.conflicts&&(w.conflicts=!0),y.descending&&(w.descending=!0),y.include_docs&&(w.include_docs=!0),y.attachments&&(w.attachments=!0),y.key&&(w.key=JSON.stringify(y.key)),y.start_key&&(y.startkey=y.start_key),y.startkey&&(w.startkey=JSON.stringify(y.startkey)),y.end_key&&(y.endkey=y.end_key),y.endkey&&(w.endkey=JSON.stringify(y.endkey)),"undefined"!=typeof y.inclusive_end&&(w.inclusive_end=!!y.inclusive_end),"undefined"!=typeof y.limit&&(w.limit=y.limit),"undefined"!=typeof y.skip&&(w.skip=y.skip);var x=bz(w);if("undefined"!=typeof y.keys){var C="keys="+encodeURIComponent(JSON.stringify(y.keys));C.length+x.length+1<=jv?x+="&"+C:(z="POST",B={keys:y.keys})}i(y,{method:z,url:cc(l,"_all_docs"+x),body:B}).then(function(D){y.include_docs&&y.attachments&&y.binary&&D.rows.forEach(jD),A(null,D)})["catch"](A)}),g._changes=function(F){var G="batch_size" in F?F.batch_size:c3;F=dY(F),F.timeout="timeout" in F?F.timeout:"timeout" in n?n.timeout:30000;var J,H=F.timeout?{timeout:F.timeout-5000}:{},z="undefined"!=typeof F.limit?F.limit:!1;J="return_docs" in F?F.return_docs:"returnDocs" in F?F.returnDocs:!0;var C=z;if(F.style&&(H.style=F.style),(F.include_docs||F.filter&&"function"==typeof F.filter)&&(H.include_docs=!0),F.attachments&&(H.attachments=!0),F.continuous&&(H.feed="longpoll"),F.conflicts&&(H.conflicts=!0),F.descending&&(H.descending=!0),"heartbeat" in F?F.heartbeat&&(H.heartbeat=F.heartbeat):H.heartbeat=10000,F.filter&&"string"==typeof F.filter&&(H.filter=F.filter,"_view"===F.filter&&F.view&&"string"==typeof F.view&&(H.view=F.view)),F.query_params&&"object"==typeof F.query_params){for(var x in F.query_params){F.query_params.hasOwnProperty(x)&&(H[x]=F.query_params[x])}}var B,y="GET";if(F.doc_ids){H.filter="_doc_ids";var A=JSON.stringify(F.doc_ids);A.length<jv?H.doc_ids=A:(y="POST",B={doc_ids:F.doc_ids})}var K,D,E=function(L,N){if(!F.aborted){H.since=L,"object"==typeof H.since&&(H.since=JSON.stringify(H.since)),F.descending?z&&(H.limit=C):H.limit=!z||C>G?G:C;var M={method:y,url:cc(l,"_changes"+bz(H)),timeout:F.timeout,body:B};D=L,F.aborted||u().then(function(){K=o(F,M,N)})["catch"](N)}},I={results:[]},w=function(P,M){if(!F.aborted){var L=0;if(M&&M.results){L=M.results.length,I.last_seq=M.last_seq;var N={};N.query=F.query_params,M.results=M.results.filter(function(Q){C--;var R=jl(F)(Q);return R&&(F.include_docs&&F.attachments&&F.binary&&jD(Q),J&&I.results.push(Q),F.onChange(Q)),R})}else{if(P){return F.aborted=!0,void F.complete(P)}}M&&M.last_seq&&(D=M.last_seq);var O=z&&0>=C||M&&G>L||F.descending;(!F.continuous||z&&0>=C)&&O?F.complete(null,I):setTimeout(function(){E(D,w)},0)}};return E(F.since||0,w),{cancel:function(){F.aborted=!0,K&&K.abort()}}},g.revsDiff=k("revsDiff",function(w,x,y){"function"==typeof x&&(y=x,x={}),o(x,{method:"POST",url:cc(l,"_revs_diff"),body:w},y)}),g._close=function(w){w()},g._destroy=function(w,x){o(w,{url:cc(l,""),method:"DELETE"},function(z,y){return z&&z.status&&404!==z.status?x(z):(g.emit("destroyed"),g.constructor.emit("destroyed",j.name),void x(null,y))})}}function b9(){this.promise=new e2(function(g){g()})}function am(g){return aS.hash(g)}function js(n){var g=n.db,k=n.viewName,h=n.map,i=n.reduce,j=n.temporary,m=h.toString()+(i&&i.toString())+"undefined";if(!j&&g._cachedViews){var l=g._cachedViews[m];if(l){return e2.resolve(l)}}return g.info().then(function(p){function o(u){u.views=u.views||{};var r=k;-1===r.indexOf("/")&&(r=k+"/"+k);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(j?"temp":am(m));return dy(g,"_local/mrviews",o).then(function(){return g.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:g,adapter:g.adapter,mapFun:h,reduceFun:i};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,j||(g._cachedViews=g._cachedViews||{},g._cachedViews[m]=r,r.db.once("destroyed",function(){delete g._cachedViews[m]})),r})})})})}function fM(k,i,h,j,l,g){return ck("return ("+k.replace(/;\s*$/,"")+");",{emit:i,sum:h,log:j,isArray:l,toJSON:g})}function cU(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function bv(g){return 1===g.length&&/^1-/.test(g[0].rev)}function c8(g,i){try{g.emit("error",i)}catch(h){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(i)}}function d6(h,j,i){try{return{output:j.apply(null,i)}}catch(g){return c8(h,g),{error:g}}}function bJ(g,i){var h=bK(g.key,i.key);return 0!==h?h:bK(g.value,i.value)}function bB(g,i,h){return h=h||0,"number"==typeof i?g.slice(h,i+h):h>0?g.slice(h):g}function jr(g){var i=g.value,h=i&&"object"==typeof i&&i._id||g.id;return h}function eL(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=e3(k.data,k.content_type)})})}function ci(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&eL(h),h}}function e1(g){var h="builtin "+g+" function requires map values to be numbers or number arrays";return new fB(h)}function eO(n){for(var g=0,k=0,h=n.length;h>k;k++){var i=n[k];if("number"!=typeof i){if(!Array.isArray(i)){throw e1("_sum")}g="number"==typeof g?[g]:g;for(var j=0,m=i.length;m>j;j++){var l=i[j];if("number"!=typeof l){throw e1("_sum")}"undefined"==typeof g[j]?g.push(l):g[j]+=l}}else{"number"==typeof g?g+=i:g[0]+=i}}return g}function bf(j,h,g,i){var k=h[j];"undefined"!=typeof k&&(i&&(k=encodeURIComponent(JSON.stringify(k))),g.push(j+"="+k))}function b8(g){if("undefined"!=typeof g){var h=Number(g);return isNaN(h)||h!==parseInt(g,10)?g:h}}function eg(g){return g.group_level=b8(g.group_level),g.limit=b8(g.limit),g.skip=b8(g.skip),g}function d5(g){if(g){if("number"!=typeof g){return new ag('Invalid value for integer: "'+g+'"')}if(0>g){return new ag('Invalid value for positive integer: "'+g+'"')}}}function aC(h,j){var i=h.descending?"endkey":"startkey",g=h.descending?"startkey":"endkey";if("undefined"!=typeof h[i]&&"undefined"!=typeof h[g]&&bK(h[i],h[g])>0){throw new ag("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(j.reduce&&h.reduce!==!1){if(h.include_docs){throw new ag("{include_docs:true} is invalid for reduce")}if(h.keys&&h.keys.length>1&&!h.group&&!h.group_level){throw new ag("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=d5(h[k]);if(l){throw l}})}function aj(o,g,l){var j,k=[],n="GET";if(bf("reduce",l,k),bf("include_docs",l,k),bf("attachments",l,k),bf("limit",l,k),bf("descending",l,k),bf("group",l,k),bf("group_level",l,k),bf("skip",l,k),bf("stale",l,k),bf("conflicts",l,k),bf("startkey",l,k,!0),bf("start_key",l,k,!0),bf("endkey",l,k,!0),bf("end_key",l,k,!0),bf("inclusive_end",l,k),bf("key",l,k,!0),k=k.join("&"),k=""===k?"":"?"+k,"undefined"!=typeof l.keys){var h=2000,i="keys="+encodeURIComponent(JSON.stringify(l.keys));i.length+k.length+1<=h?k+=("?"===k[0]?"&":"?")+i:(n="POST","string"==typeof g?j={keys:l.keys}:g.keys=l.keys)}if("string"==typeof g){var m=cU(g);return o.request({method:n,url:"_design/"+m[0]+"/_view/"+m[1]+k,body:j}).then(ci(l))}return j=j||{},Object.keys(g).forEach(function(p){Array.isArray(g[p])?j[p]=g[p]:j[p]=g[p].toString()}),o.request({method:"POST",url:"_temp_view"+k,body:j}).then(ci(l))}function dZ(g,i,h){return new e2(function(j,k){g._query(i,h,function(m,l){return m?k(m):void j(l)})})}function aM(g){return new e2(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function ek(g){return function(h){if(404===h.status){return g}throw h}}function cq(p,j,n){function l(){return bv(o)?e2.resolve(i):j.db.get(g)["catch"](ek(i))}function k(r){return r.keys.length?j.db.allDocs({keys:r.keys,include_docs:!0}):e2.resolve({rows:[]})}function m(z,B){for(var v=[],s={},u=0,w=B.rows.length;w>u;u++){var y=B.rows[u],r=y.doc;if(r&&(v.push(r),s[r._id]=!0,r._deleted=!h[r._id],!r._deleted)){var A=h[r._id];"value" in A&&(r.value=A.value)}}var x=Object.keys(h);return x.forEach(function(C){if(!s[C]){var E={_id:C},D=h[C];"value" in D&&(E.value=D.value),v.push(E)}}),z.keys=d8(x.concat(z.keys)),v.push(z),v}var g="_local/doc_"+p,i={_id:g,keys:[]},q=n[p],h=q.indexableKeysToKeyValues,o=q.changes;return l().then(function(r){return k(r).then(function(s){return m(r,s)})})}function fN(h,j,i){var g="_local/lastSeq";return h.db.get(g)["catch"](ek({_id:g,seq:0})).then(function(k){var l=Object.keys(j);return e2.all(l.map(function(m){return cq(m,h,j)})).then(function(n){var m=jH(n);return k.seq=i,m.push(k),h.db.bulkDocs({docs:m})})})}function jY(g){var i="string"==typeof g?g:g.name,h=dG[i];return h||(h=dG[i]=new b9),h}function cK(g){return eW(jY(g),function(){return b3(g)})()}function b3(o){function g(p,r){var q={id:k._id,key:dD(p)};"undefined"!=typeof r&&null!==r&&(q.value=dD(r)),j.push(q)}function l(q,p){return function(){return fN(o,q,p)}}var j,k,n;if("function"==typeof o.mapFun&&2===o.mapFun.length){var h=o.mapFun;n=function(p){return h(p,g)}}else{n=fM(o.mapFun.toString(),g,eO,aG,Array.isArray,JSON.parse)}var i=o.seq||0,m=new b9;return new e2(function(p,s){function r(){m.finish().then(function(){o.seq=i,p()})}function q(){function u(v){s(v)}o.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:i,limit:dp}).on("complete",function(F){var A=F.results;if(!A.length){return r()}for(var B={},x=0,v=A.length;v>x;x++){var C=A[x];if("_"!==C.doc._id[0]){j=[],k=C.doc,k._deleted||d6(o.sourceDB,n,[k]),j.sort(bJ);for(var z,D={},H=0,G=j.length;G>H;H++){var w=j[H],y=[w.key,w.id];0===bK(w.key,z)&&y.push(H);var E=cx(y);D[E]=w,z=w.key}B[C.doc._id]={indexableKeysToKeyValues:D,changes:C.changes}}i=C.seq}return m.add(l(B,i)),A.length<dp?r():q()}).on("error",u)}q()})}function bc(p,j,n){0===n.group_level&&delete n.group_level;var l,k=n.group||n.group_level;l=dX[p.reduceFun]?dX[p.reduceFun]:fM(p.reduceFun.toString(),null,eO,aG,Array.isArray,JSON.parse);var m=[],g=n.group_level;j.forEach(function(r){var u=m[m.length-1],s=k?r.key:null;return k&&Array.isArray(s)&&"number"==typeof g&&(s=s.length>g?s.slice(0,g):s),u&&0===bK(u.key[0][0],s)?(u.key.push([s,r.id]),void u.value.push(r.value)):void m.push({key:[[s,r.id]],value:[r.value]})});for(var i=0,q=m.length;q>i;i++){var h=m[i],o=d6(p.sourceDB,l,[h.key,h.value,!1]);if(o.error&&o.error instanceof fB){throw o.error}h.value=o.error?null:o.output,h.key=h.key[0][0]}return{rows:bB(m,n.limit,n.skip)}}function fD(g,h){return eW(jY(g),function(){return cY(g,h)})()}function cY(r,h){function k(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return j=v.total_rows,v.rows.map(function(z){if("value" in z.doc&&"object"==typeof z.doc.value&&null!==z.doc.value){var x=Object.keys(z.doc.value).sort(),w=["id","key","value"];if(!(w>x||x>w)){return z.doc.value}}var y=dP(z.doc._id);return{key:y[0],id:y[1],value:"value" in z.doc?z.doc.value:null}})})}function i(w){var v;if(v=m?bc(r,w,h):{total_rows:j,offset:s,rows:w},h.include_docs){var u=d8(w.map(jr));return r.sourceDB.allDocs({keys:u,include_docs:!0,conflicts:h.conflicts,attachments:h.attachments,binary:h.binary}).then(function(y){var x={};return y.rows.forEach(function(z){z.doc&&(x["$"+z.id]=z.doc)}),w.forEach(function(A){var B=jr(A),z=x["$"+B];z&&(A.doc=z)}),v})}return v}var j,m=r.reduceFun&&h.reduce!==!1,s=h.skip||0;if("undefined"==typeof h.keys||h.keys.length||(h.limit=0,delete h.keys),"undefined"!=typeof h.keys){var n=h.keys,g=n.map(function(u){var v={startkey:cx([u]),endkey:cx([u,{}])};return k(v)});return e2.all(g).then(jH).then(i)}var q={descending:h.descending};if(h.start_key&&(h.startkey=h.start_key),h.end_key&&(h.endkey=h.end_key),"undefined"!=typeof h.startkey&&(q.startkey=cx(h.descending?[h.startkey,{}]:[h.startkey])),"undefined"!=typeof h.endkey){var o=h.inclusive_end!==!1;h.descending&&(o=!o),q.endkey=cx(o?[h.endkey,{}]:[h.endkey])}if("undefined"!=typeof h.key){var l=cx([h.key]),p=cx([h.key,{}]);q.descending?(q.endkey=l,q.startkey=p):(q.startkey=l,q.endkey=p)}return m||("number"==typeof h.limit&&(q.limit=h.limit),q.skip=s),k(q).then(i)}function dN(g){return g.request({method:"POST",url:"_view_cleanup"})}function fA(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(l){var n=cU(l),k="_design/"+n[0],m=n[1];j[k]=j[k]||{},j[k][m]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(l){var m={};l.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){m[v]=m[v]||s})})});var k=Object.keys(m).filter(function(o){return !m[o]}),n=k.map(function(o){return eW(jY(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return e2.all(n).then(function(){return{ok:!0}})})},ek({ok:!0}))}function ed(i,l,n){if("http"===i.type()){return aj(i,l,n)}if("function"==typeof i._query){return dZ(i,l,n)}if("string"!=typeof l){aC(n,l);var k={db:i,viewName:"temp_view/temp_view",map:l.map,reduce:l.reduce,temporary:!0};return cg.add(function(){return js(k).then(function(o){function p(){return o.db.destroy()}return aY(cK(o).then(function(){return fD(o,n)}),p)})}),cg.finish()}var g=l,m=cU(g),h=m[0],j=m[1];return i.get("_design/"+h).then(function(o){var p=o.views&&o.views[j];if(!p||"string"!=typeof p.map){throw new j0("ddoc "+h+" has no view named "+j)}aC(n,p);var q={db:i,viewName:g,map:p.map,reduce:p.reduce};return js(q).then(function(r){return"ok"===n.stale||"update_after"===n.stale?("update_after"===n.stale&&bV.nextTick(function(){cK(r)}),fD(r,n)):cK(r).then(function(){return fD(r,n)})})})}function ag(g){this.status=400,this.name="query_parse_error",this.message=g,this.error=!0;try{Error.captureStackTrace(this,ag)}catch(h){}}function j0(g){this.status=404,this.name="not_found",this.message=g,this.error=!0;try{Error.captureStackTrace(this,j0)}catch(h){}}function fB(g){this.status=500,this.name="invalid_value",this.message=g,this.error=!0;try{Error.captureStackTrace(this,fB)}catch(h){}}function eM(g){return"'"+g+"'"}function cm(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function bA(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jQ(g){return delete g._id,delete g._rev,JSON.stringify(g)}function eP(g,i,h){return g=JSON.parse(g),g._id=i,g._rev=h,g}function bi(g){for(var h="(";g--;){h+="?",g&&(h+=",")}return h+")"}function fK(j,h,g,i,k){return"SELECT "+j+" FROM "+("string"==typeof h?h:h.join(" JOIN "))+(g?" ON "+g:"")+(i?" WHERE "+("string"==typeof i?i:i.join(" AND ")):"")+(k?" ORDER BY "+k:"")}function cV(m,k,g){function l(){++j===m.length&&i()}function i(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+d3+" WHERE seq IN "+bi(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+d3+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(u){var v="SELECT digest FROM "+d3+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";u.executeSql(v,s,function(x,y){for(var w=new cQ.Set,z=0;z<y.rows.length;z++){w.add(y.rows.item(z).digest)}s.forEach(function(A){w.has(A)||(x.executeSql("DELETE FROM "+d3+" WHERE digest=?",[A]),x.executeSql("DELETE FROM "+db+" WHERE digest=?",[A]))})})})}})}}if(m.length){var j=0,h=[];m.forEach(function(n){var o="SELECT seq FROM "+fE+" WHERE doc_id=? AND rev=?";g.executeSql(o,[k,n],function(q,p){if(!p.rows.length){return l()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+fE+" WHERE seq=?",[r],l)})})}}function b6(g){return function(h){console.error("WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(ea(bL,j,i))}}function bF(g){if("size" in g){return 1000000*g.size}var h=/Android/.test(window.navigator.userAgent);return h?5000000:1}function eb(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(g){return openDatabase(g.name,g.version,g.description,g.size)}:void 0}function cv(g,i){try{return{db:g(i)}}catch(h){return{error:h}}}function jp(g){var i=dT[g.name];if(!i){var h=eb();i=dT[g.name]=cv(h,g),i.db&&(i.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return i}function cs(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function jP(g){jJ()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):a8()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function bp(){jq.EventEmitter.call(this),this._listeners={},jP(this)}function aQ(g){return decodeURIComponent(window.escape(g))}function cM(g){return 65>g?g-48:g-55}function fH(h,j,i){for(var g="";i>j;){g+=String.fromCharCode(cM(h.charCodeAt(j++))<<4|cM(h.charCodeAt(j++)))}return g}function b7(h,j,i){for(var g="";i>j;){g+=String.fromCharCode(cM(h.charCodeAt(j+2))<<12|cM(h.charCodeAt(j+3))<<8|cM(h.charCodeAt(j))<<4|cM(h.charCodeAt(j+1))),j+=4}return g}function aE(g,h){return"UTF-8"===h?aQ(fH(g,0,g.length)):b7(g,0,g.length)}function bs(g){try{return JSON.parse(g)}catch(h){return ah.parse(g)}}function cy(g){try{return JSON.stringify(g)}catch(h){return ah.stringify(g)}}function bI(h,j,i){function l(p){try{return aI(p)}catch(o){var q=ea(cJ,"Attachment is not a valid base64 string");return{error:q}}}function n(o,q){if(o.stub){return q()}if("string"==typeof o.data){var p=l(o.data);if(p.error){return q(p.error)}o.length=p.length,"blob"===j?o.data=c5(p,o.content_type):"base64"===j?o.data=cR(p):o.data=p,aK(p).then(function(r){o.digest="md5-"+r,q()})}else{dj(o.data,function(r){"binary"===j?o.data=dL(r):"base64"===j&&(o.data=cR(dL(r))),aK(r).then(function(s){o.digest="md5-"+s,o.length=r.byteLength,q()})})}}function k(){m++,h.length===m&&(g?i(g):i())}if(!h.length){return i()}var g,m=0;h.forEach(function(r){function p(u){g=u,q++,q===s.length&&k()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return k()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&n(r.data._attachments[o],p)}})}function dR(g,h){return g.pos-h.pos}function fO(k,i,h){for(var j,l=0,g=k.length;g>l;){j=l+g>>>1,h(k[j],i)<0?l=j+1:g=j}return l}function cd(h,j,i){var g=fO(h,j,i);h.splice(g,0,j)}function eD(n,g){for(var k,h,i=g,j=n.length;j>i;i++){var m=n[i],l=[m.id,m.opts,[]];h?(h[2].push(l),h=l):k=h=l}return k}function cF(g,h){return g[0]<h[0]?-1:1}function dM(h,j){for(var o=[{tree1:h,tree2:j}],l=!1;o.length>0;){var m=o.pop(),g=m.tree1,i=m.tree2;(g[1].status||i[1].status)&&(g[1].status="available"===g[1].status||"available"===i[1].status?"available":"missing");for(var k=0;k<i[2].length;k++){if(g[2][0]){for(var n=!1,p=0;p<g[2].length;p++){g[2][p][0]===i[2][k][0]&&(o.push({tree1:g[2][p],tree2:i[2][k]}),n=!0)}n||(l="new_branch",cd(g[2],i[2][k],cF))}else{l="new_leaf",g[2][0]=i[2][k]}}}return{conflicts:l,tree:h}}function aD(o,r,n){var z,k=[],q=!1,A=!1;if(!o.length){return{tree:[r],conflicts:"new_leaf"}}for(var u=0,j=o.length;j>u;u++){var m=o[u];if(m.pos===r.pos&&m.ids[0]===r.ids[0]){z=dM(m.ids,r.ids),k.push({pos:m.pos,ids:z.tree}),q=q||z.conflicts,A=!0}else{if(n!==!0){var x=m.pos<r.pos?m:r,p=m.pos<r.pos?r:m,y=p.pos-x.pos,s=[],i=[];for(i.push({ids:x.ids,diff:y,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],v=0,w=g.length;w>v;v++){i.push({ids:g[v],diff:h.diff-1,parent:h.ids,parentIdx:v})}}else{h.ids[0]===p.ids[0]&&s.push(h)}}var l=s[0];l?(z=dM(l.ids,p.ids),l.parent[2][l.parentIdx]=z.tree,k.push({pos:x.pos,ids:x.ids}),q=q||z.conflicts,A=!0):k.push(m)}else{k.push(m)}}}return A||k.push(r),k.sort(dR),{tree:k,conflicts:q||"internal_node"}}function ap(h,j){for(var o,l=jS(h),m=0,g=l.length;g>m;m++){var i=l[m],k=i.ids,n=Math.max(0,k.length-j),p={pos:i.pos+n,ids:eD(k,n)};o=o?aD(o,p,!0).tree:[p]}return o}function bD(h,j,i){var g=aD(h,j);return{tree:ap(g.tree,i),conflicts:g.conflicts}}function e7(h,j){for(var o,l=h.slice(),m=j.split("-"),g=parseInt(m[0],10),i=m[1];o=l.pop();){if(o.pos===g&&o.ids[0]===i){return !0}for(var k=o.ids[2],n=0,p=k.length;p>n;n++){l.push({pos:o.pos+1,ids:k[n]})}}return !1}function t(x,s,n,k,m,B,A,i){if(e7(s.rev_tree,n.metadata.rev)){return k[m]=n,B()}var q=s.winningRev||ds(s),w="deleted" in s?s.deleted:b4(s,q),h="deleted" in n.metadata?n.metadata.deleted:b4(n.metadata),p=/^1-/.test(n.metadata.rev);if(w&&!h&&i&&p){var r=n.data;r._rev=q,r._id=n.metadata.id,n=bj(r,i)}var l=bD(s.rev_tree,n.metadata.rev_tree[0],x),j=i&&(w&&h||!w&&"new_leaf"!==l.conflicts||w&&!h&&"new_branch"===l.conflicts);if(j){var g=ea(aZ);return k[m]=g,B()}var z=n.metadata.rev;n.metadata.rev_tree=l.tree,s.rev_map&&(n.metadata.rev_map=s.rev_map);var v,u=ds(n.metadata),y=b4(n.metadata,u),o=w===y?0:y>w?-1:1;v=z===u?y:b4(n.metadata,z),A(n,u,y,v,!0,o,m,B)}function eQ(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function jt(j,q,o,i,k,u,p,g,m){function l(B,x,C){var z=ds(B.metadata),A=b4(B.metadata,z);if("was_delete" in g&&A){return u[x]=ea(bd,"deleted"),C()}var w=n&&eQ(B);if(w){var D=ea(aZ);return u[x]=D,C()}var y=A?0:1;p(B,z,A,A,!1,y,x,C)}function v(){++h===r&&m&&m()}j=j||1000;var n=g.new_edits,s=new cQ.Map,h=0,r=q.length;q.forEach(function(w,y){if(w._id&&c2(w._id)){var z=w._deleted?"_removeLocal":"_putLocal";return void o[z](w,{ctx:k},function(B,A){u[y]=B||A,v()})}var x=w.metadata.id;s.has(x)?(r--,s.get(x).push([w,y])):s.set(x,[[w,y]])}),s.forEach(function(z,x){function w(){++y<z.length?A():v()}function A(){var C=z[y],D=C[0],E=C[1];if(i.has(x)){t(j,i.get(x),D,u,E,w,p,n)}else{var B=bD([],D.metadata.rev_tree[0],j);D.metadata.rev_tree=B.tree,l(D,E,w)}}var y=0;A()})}function d1(g){var h=[];return ef(g.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(h.push(i+"-"+k),j.status="missing")}),h}function cX(y,g,o,v,m,s,q){function i(){return w?q(w):(s.notify(v._name),v._docCount=-1,void q(null,r))}function B(E,D){var F="SELECT count(*) as cnt FROM "+db+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=ea(dv,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function l(F){function D(){++G===H.length&&F(E)}var H=[];if(C.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){B(I,function(J){J&&!E&&(E=J),D()})})}function x(G,S,J,F,Q,L,E,P){function I(){function T(ai,a0){function an(){return ++a1===at.length&&a0(),!1}function ao(a3){var a4="INSERT INTO "+d3+" (digest, seq) VALUES (?,?)",a2=[U._attachments[a3].digest,ai];p.executeSql(a4,a2,an,an)}var a1=0,at=Object.keys(U._attachments||{});if(!at.length){return a0()}for(var ar=0;ar<at.length;ar++){ao(at[ar])}}var U=G.data,Y=F?1:0,X=U._id,Z=U._rev,W=jQ(U),V="INSERT INTO "+fE+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",ae=[X,Z,W,Y];p.executeSql(V,ae,function(ao,an){var ai=an.insertId;T(ai,function(){D(ao,ai)})},function(){var ai=fK("seq",fE,null,"doc_id=? AND rev=?");return p.executeSql(ai,[X,Z],function(ar,ao){var a0=ao.rows.item(0).seq,at="UPDATE "+fE+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",an=[W,Y,X,Z];ar.executeSql(at,an,function(a1){T(a0,function(){D(a1,a0)})})}),!1})}function R(T){O||(T?(O=T,P(O)):K===M.length&&I())}function N(T){K++,R(T)}function H(){if(Q&&v.auto_compaction){var U=G.metadata.id,T=d1(G.metadata);cV(T,U,p)}}function D(Y,W){H(),G.metadata.seq=W,delete G.metadata.rev;var U=Q?"UPDATE "+bx+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+fE+" WHERE doc_id="+bx+".id AND rev=?) WHERE id=?":"INSERT INTO "+bx+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",V=cy(G.metadata),X=G.metadata.id,T=Q?[V,W,S,X]:[X,W,W,V];Y.executeSql(U,T,function(){r[E]={ok:!0,id:G.metadata.id,rev:S},A.set(X,G.metadata),P()})}var O=null,K=0;G.data._id=G.metadata.id,G.data._rev=G.metadata.rev;var M=Object.keys(G.data._attachments||{});F&&(G.data._deleted=!0),M.forEach(function(W){var T=G.data._attachments[W];if(T.stub){K++,R()}else{var U=T.data;delete T.data;var V=T.digest;k(V,U,N)}}),M.length||I()}function h(){jt(y.revs_limit,C,v,A,p,r,x,o)}function u(E){function D(){++F===C.length&&E()}if(!C.length){return E()}var F=0;C.forEach(function(G){if(G._id&&c2(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+bx+" WHERE id = ?",[H],function(I,K){if(K.rows.length){var J=bs(K.rows.item(0).json);A.set(H,J)}D()})})}function k(F,D,G){var E="SELECT digest FROM "+db+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+db+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,cm(D)],function(){G()},function(){return G(),!1}))})}var z=o.new_edits,n=g.docs,C=n.map(function(E){if(E._id&&c2(E._id)){return E}var D=bj(E,z);return D}),j=C.filter(function(D){return D.error});if(j.length){return q(j[0])}var p,w,r=new Array(C.length),A=new cQ.Map;bI(C,"binary",function(D){return D?q(D):void m.transaction(function(E){p=E,l(function(F){F?w=F:u(h)})},b6(q),i)})}function af(o,g,l,j,k){function n(){++m===i.length&&k&&k()}function h(q,s){var r=q._attachments[s],p={binary:g.binary,ctx:j};l._getAttachment(r,p,function(v,u){q._attachments[s]=bS.extend(jE(r,["digest","content_type"]),{data:u}),n()})}var i=Object.keys(o._attachments||{});if(!i.length){return k&&k()}var m=0;i.forEach(function(p){g.attachments&&g.include_docs?h(o,p):(o._attachments[p].stub=!0,n())})}function cw(B,z){function o(){a8()&&(window.localStorage["_pouch__websqldb_"+j._name]=!0),z(null,j)}function v(E,D){E.executeSql(jn),E.executeSql("ALTER TABLE "+fE+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){E.executeSql(aN),E.executeSql("ALTER TABLE "+bx+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){E.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+bx+" (local, id)");var F="SELECT "+bx+".winningseq AS seq, "+bx+".json AS metadata FROM "+fE+" JOIN "+bx+" ON "+fE+".seq = "+bx+".winningseq";E.executeSql(F,[],function(I,N){for(var G=[],L=[],K=0;K<N.rows.length;K++){var H=N.rows.item(K),M=H.seq,J=JSON.parse(H.metadata);b4(J)&&G.push(M),c2(J.id)&&L.push(J.id)}I.executeSql("UPDATE "+bx+"SET local = 1 WHERE id IN "+bi(L.length),L,function(){I.executeSql("UPDATE "+fE+" SET deleted = 1 WHERE seq IN "+bi(G.length),G,D)})})})})}function m(E,D){var F="CREATE TABLE IF NOT EXISTS "+cf+" (id UNIQUE, rev, json)";E.executeSql(F,[],function(){var G="SELECT "+bx+".id AS id, "+fE+".json AS data FROM "+fE+" JOIN "+bx+" ON "+fE+".seq = "+bx+".winningseq WHERE local = 1";E.executeSql(G,[],function(J,L){function I(){if(!K.length){return D(J)}var N=K.shift(),M=JSON.parse(N.data)._rev;J.executeSql("INSERT INTO "+cf+" (id, rev, json) VALUES (?,?,?)",[N.id,M,N.data],function(O){O.executeSql("DELETE FROM "+bx+" WHERE id=?",[N.id],function(P){P.executeSql("DELETE FROM "+fE+" WHERE seq=?",[N.seq],function(){I()})})})}for(var K=[],H=0;H<L.rows.length;H++){K.push(L.rows.item(H))}I()})})}function x(F,D){function G(I){function H(){if(!I.length){return D(F)}var O=I.shift(),M=aE(O.hex,g),J=M.lastIndexOf("::"),N=M.substring(0,J),L=M.substring(J+2),K="UPDATE "+fE+" SET doc_id=?, rev=? WHERE doc_id_rev=?";F.executeSql(K,[N,L,M],function(){H()})}H()}var E="ALTER TABLE "+fE+" ADD COLUMN doc_id";F.executeSql(E,[],function(I){var H="ALTER TABLE "+fE+" ADD COLUMN rev";I.executeSql(H,[],function(J){J.executeSql(j2,[],function(L){var K="SELECT hex(doc_id_rev) as hex FROM "+fE;L.executeSql(K,[],function(O,M){for(var N=[],P=0;P<M.rows.length;P++){N.push(M.rows.item(P))}G(N)})})})})}function C(F,D){function G(H){var I="SELECT COUNT(*) AS cnt FROM "+db;H.executeSql(I,[],function(N,J){function M(){var P=fK(e4+", "+bx+".id AS id",[bx,fE],eH,null,bx+".id ");P+=" LIMIT "+K+" OFFSET "+L,L+=K,N.executeSql(P,[],function(X,S){function ai(ao,an){var ar=U[ao]=U[ao]||[];-1===ar.indexOf(an)&&ar.push(an)}if(!S.rows.length){return D(X)}for(var U={},Z=0;Z<S.rows.length;Z++){for(var R=S.rows.item(Z),Q=eP(R.data,R.id,R.rev),V=Object.keys(Q._attachments||{}),W=0;W<V.length;W++){var T=Q._attachments[V[W]];ai(T.digest,R.seq)}}var Y=[];if(Object.keys(U).forEach(function(ao){var an=U[ao];an.forEach(function(ar){Y.push([ao,ar])})}),!Y.length){return M()}var ae=0;Y.forEach(function(an){var ao="INSERT INTO "+d3+" (digest, seq) VALUES (?,?)";X.executeSql(ao,an,function(){++ae===Y.length&&M()})})})}var O=J.rows.item(0).cnt;if(!O){return D(N)}var L=0,K=10;M()})}var E="CREATE TABLE IF NOT EXISTS "+d3+" (digest, seq INTEGER)";F.executeSql(E,[],function(H){H.executeSql(dV,[],function(I){I.executeSql(ju,[],G)})})}function i(E,D){var F="ALTER TABLE "+db+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";E.executeSql(F,[],D)}function l(E,D){var F="ALTER TABLE "+bx+" ADD COLUMN max_seq INTEGER";E.executeSql(F,[],function(G){var H="UPDATE "+bx+" SET max_seq=(SELECT MAX(seq) FROM "+fE+" WHERE doc_id=id)";G.executeSql(H,[],function(I){var J="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+bx+" (max_seq)";I.executeSql(J,[],D)})})}function s(E,D){E.executeSql('SELECT HEX("a") AS hex',[],function(G,H){var F=H.rows.item(0).hex;g=2===F.length?"UTF-8":"UTF-16",D()})}function n(){for(;h.length>0;){var D=h.pop();D(null,p)}}function u(J,G){if(0===G){var N="CREATE TABLE IF NOT EXISTS "+fP+" (dbid, db_version INTEGER)",L="CREATE TABLE IF NOT EXISTS "+db+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",H="CREATE TABLE IF NOT EXISTS "+d3+" (digest, seq INTEGER)",K="CREATE TABLE IF NOT EXISTS "+bx+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",I="CREATE TABLE IF NOT EXISTS "+fE+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",M="CREATE TABLE IF NOT EXISTS "+cf+" (id UNIQUE, rev, json)";J.executeSql(L),J.executeSql(M),J.executeSql(H,[],function(){J.executeSql(ju),J.executeSql(dV)}),J.executeSql(K,[],function(){J.executeSql(jn),J.executeSql(I,[],function(){J.executeSql(aN),J.executeSql(j2),J.executeSql(N,[],function(){var P="INSERT INTO "+fP+" (db_version, dbid) VALUES (?,?)";p=jy();var Q=[dJ,p];J.executeSql(P,Q,function(){n()})})})})}else{var F=function(){var Q=dJ>G;Q&&J.executeSql("UPDATE "+fP+" SET db_version = "+dJ);var P="SELECT dbid FROM "+fP;J.executeSql(P,[],function(R,S){p=S.rows.item(0).dbid,n()})},O=[v,m,x,C,i,l,F],D=G,E=function(P){O[D-1](P,E),D++};E(J)}}function q(){A.transaction(function(D){s(D,function(){k(D)})},b6(z),o)}function k(E){var D="SELECT sql FROM sqlite_master WHERE tbl_name = "+fP;E.executeSql(D,[],function(G,F){F.rows.length?/db_version/.test(F.rows.item(0).sql)?G.executeSql("SELECT db_version FROM "+fP,[],function(H,J){var I=J.rows.item(0).db_version;u(H,I)}):G.executeSql("ALTER TABLE "+fP+" ADD COLUMN db_version INTEGER",[],function(){u(G,1)}):u(G,0)})}function y(E,D){if(-1!==j._docCount){return D(j._docCount)}var F=fK("COUNT("+bx+".id) AS 'num'",[bx,fE],eH,fE+".deleted=0");E.executeSql(F,[],function(G,H){j._docCount=H.rows.item(0).num,D(j._docCount)})}var g,j=this,p=null,r=bF(B),h=[];j._docCount=-1,j._name=B.name;var w=jp({name:j._name,version:au,description:j._name,size:r,location:B.location,createFromLocation:B.createFromLocation,androidDatabaseImplementation:B.androidDatabaseImplementation});if(w.error){return b6(z)(w.error)}var A=w.db;"function"!=typeof A.readTransaction&&(A.readTransaction=A.transaction),q(),j.type=function(){return"websql"},j._id=jB(function(D){D(null,p)}),j._info=function(D){A.readTransaction(function(E){y(E,function(G){var F="SELECT MAX(seq) AS seq FROM "+fE;E.executeSql(F,[],function(J,H){var I=H.rows.item(0).seq||0;D(null,{doc_count:G,update_seq:I,sqlite_plugin:A._sqlitePlugin,websql_encoding:g})})})},b6(D))},j._bulkDocs=function(D,F,E){cX(B,D,F,j,A,cw.Changes,E)},j._get=function(J,D,H){function E(){H(L,{doc:F,metadata:I,ctx:G})}var F,I,L,G=D.ctx;if(!G){return A.readTransaction(function(N){j._get(J,bS.extend({ctx:N},D),H)})}var M,K;D.rev?(M=fK(e4,[bx,fE],bx+".id="+fE+".doc_id",[fE+".doc_id=?",fE+".rev=?"]),K=[J,D.rev]):(M=fK(e4,[bx,fE],eH,bx+".id=?"),K=[J]),G.executeSql(M,K,function(N,O){if(!O.rows.length){return L=ea(bd,"missing"),E()}var P=O.rows.item(0);return I=bs(P.metadata),P.deleted&&!D.rev?(L=ea(bd,"deleted"),E()):(F=eP(P.data,I.id,P.rev),void E())})},j._allDocs=function(P,I){var F,O=[],Q="startkey" in P?P.startkey:!1,L="endkey" in P?P.endkey:!1,G="key" in P?P.key:!1,J="descending" in P?P.descending:!1,H="limit" in P?P.limit:-1,E="skip" in P?P.skip:0,N=P.inclusive_end!==!1,K=[],D=[];if(G!==!1){D.push(bx+".id = ?"),K.push(G)}else{if(Q!==!1||L!==!1){if(Q!==!1&&(D.push(bx+".id "+(J?"<=":">=")+" ?"),K.push(Q)),L!==!1){var M=J?">":"<";N&&(M+="="),D.push(bx+".id "+M+" ?"),K.push(L)}G!==!1&&(D.push(bx+".id = ?"),K.push(G))}}"ok"!==P.deleted&&D.push(fE+".deleted = 0"),A.readTransaction(function(R){y(R,function(S){if(F=S,0!==H){var T=fK(e4,[bx,fE],eH,D,bx+".id "+(J?"DESC":"ASC"));T+=" LIMIT "+H+" OFFSET "+E,R.executeSql(T,K,function(U,ai){for(var an=0,ao=ai.rows.length;ao>an;an++){var X=ai.rows.item(an),Z=bs(X.metadata),Y=Z.id,W=eP(X.data,Y,X.rev),V=W._rev,ae={id:Y,key:Y,value:{rev:V}};if(P.include_docs&&(ae.doc=W,ae.doc._rev=V,P.conflicts&&(ae.doc._conflicts=jI(Z)),af(ae.doc,P,j,U)),X.deleted){if("ok"!==P.deleted){continue}ae.value.deleted=!0,ae.doc=null}O.push(ae)}})}})},b6(I),function(){I(null,{total_rows:F,offset:P.skip,rows:O})})},j._changes=function(F){function J(){var R=bx+".json AS metadata, "+bx+".max_seq AS maxSeq, "+fE+".json AS winningDoc, "+fE+".rev AS winningRev ",S=bx+" JOIN "+fE,Q=bx+".id="+fE+".doc_id AND "+bx+".winningseq="+fE+".seq",P=["maxSeq > ?"],M=[F.since];F.doc_ids&&(P.push(bx+".id IN "+bi(F.doc_ids.length)),M=M.concat(F.doc_ids));var T="maxSeq "+(E?"DESC":"ASC"),N=fK(R,S,Q,P,T),L=jl(F);F.view||F.filter||(N+=" LIMIT "+I);var O=F.since||0;A.readTransaction(function(U){U.executeSql(N,M,function(V,X){function W(at){return function(){F.onChange(at)}}for(var ar=0,an=X.rows.length;an>ar;ar++){var Z=X.rows.item(ar),Y=bs(Z.metadata);O=Z.maxSeq;var ai=eP(Z.winningDoc,Y.id,Z.winningRev),ao=F.processChange(ai,Y,F);ao.seq=Z.maxSeq;var ae=L(ao);if("object"==typeof ae){return F.complete(ae)}if(ae&&(D++,H&&G.push(ao),F.attachments&&F.include_docs?af(ai,F,j,V,W(ao)):W(ao)()),D===I){break}}})},b6(F.complete),function(){F.continuous||F.complete(null,{results:G,last_seq:O})})}if(F=dY(F),F.continuous){var K=j._name+":"+jy();return cw.Changes.addListener(j._name,K,j,F),cw.Changes.notify(j._name),{cancel:function(){cw.Changes.removeListener(j._name,K)}}}var E=F.descending;F.since=F.since&&!E?F.since:0;var I="limit" in F?F.limit:-1;0===I&&(I=1);var H;H="return_docs" in F?F.return_docs:"returnDocs" in F?F.returnDocs:!0;var G=[],D=0;J()},j._close=function(D){D()},j._getAttachment=function(F,J,K){var E,I=J.ctx,H=F.digest,G=F.content_type,D="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+db+" WHERE digest=?";I.executeSql(D,[H],function(M,N){var O=N.rows.item(0),L=O.escaped?bA(O.body):aE(O.body,g);E=J.binary?c5(L,G):cR(L),K(null,E)})},j._getRevisionTree=function(E,D){A.readTransaction(function(G){var F="SELECT json AS metadata FROM "+bx+" WHERE id = ?";G.executeSql(F,[E],function(H,I){if(I.rows.length){var J=bs(I.rows.item(0).metadata);D(null,J.rev_tree)}else{D(ea(bd))}})})},j._doCompaction=function(E,D,F){return D.length?void A.transaction(function(H){var G="SELECT json AS metadata FROM "+bx+" WHERE id = ?";H.executeSql(G,[E],function(J,L){var I=bs(L.rows.item(0).metadata);ef(I.rev_tree,function(N,P,M,O,R){var Q=P+"-"+M;-1!==D.indexOf(Q)&&(R.status="missing")});var K="UPDATE "+bx+" SET json = ? WHERE id = ?";J.executeSql(K,[cy(I),E])}),cV(D,E,H)},b6(F),function(){F()}):F()},j._getLocal=function(E,D){A.readTransaction(function(G){var F="SELECT json, rev FROM "+cf+" WHERE id=?";G.executeSql(F,[E],function(K,I){if(I.rows.length){var J=I.rows.item(0),H=eP(J.json,E,J.rev);D(null,H)}else{D(ea(bd))}})})},j._putLocal=function(H,K,F){function D(M){var O,N;G?(O="UPDATE "+cf+" SET rev=?, json=? WHERE id=? AND rev=?",N=[E,J,I,G]):(O="INSERT INTO "+cf+" (id, rev, json) VALUES (?,?,?)",N=[I,E,J]),M.executeSql(O,N,function(Q,P){P.rowsAffected?(L={ok:!0,id:I,rev:E},K.ctx&&F(null,L)):F(ea(aZ))},function(){return F(ea(aZ)),!1})}"function"==typeof K&&(F=K,K={}),delete H._revisions;var E,G=H._rev,I=H._id;E=G?H._rev="0-"+(parseInt(G.split("-")[1],10)+1):H._rev="0-1";var L,J=jQ(H);K.ctx?D(K.ctx):A.transaction(D,b6(F),function(){L&&F(null,L)})},j._removeLocal=function(F,D,H){function E(I){var K="DELETE FROM "+cf+" WHERE id=? AND rev=?",J=[F._id,F._rev];I.executeSql(K,J,function(M,L){return L.rowsAffected?(G={ok:!0,id:F._id,rev:"0-0"},void (D.ctx&&H(null,G))):H(ea(bd))})}"function"==typeof D&&(H=D,D={});var G;D.ctx?E(D.ctx):A.transaction(E,b6(H),function(){G&&H(null,G)})},j._destroy=function(E,D){cw.Changes.removeAllListeners(j._name),A.transaction(function(G){var F=[bx,fE,db,fP,cf,d3];F.forEach(function(H){G.executeSql("DROP TABLE IF EXISTS "+H,[])})},b6(D),function(){a8()&&(delete window.localStorage["_pouch__websqldb_"+j._name],delete window.localStorage[j._name]),D(null,{ok:!0})})}}function ca(h,j,i){try{h.apply(j,i)}catch(g){"undefined"!=typeof PouchDB&&PouchDB.emit("error",g)}}function bW(){if(!cO.running&&cO.queue.length){cO.running=!0;var g=cO.queue.shift();g.action(function(h,i){ca(g.callback,this,[h,i]),cO.running=!1,bV.nextTick(bW)})}}function el(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(ea(bZ,i,h.type))}}function j1(g,i,h){return{data:cy(g),winningRev:i,deletedOrLocal:h?"1":"0",seq:g.seq,id:g.id}}function bb(g){if(!g){return null}var h=bs(g.data);return h.winningRev=g.winningRev,h.deleted="1"===g.deletedOrLocal,h.seq=g.seq,h}function bG(g){if(!g){return g}var h=g._doc_id_rev.lastIndexOf(":");return g._id=g._doc_id_rev.substring(0,h-1),g._rev=g._doc_id_rev.substring(h+1),delete g._doc_id_rev,g}function jO(h,j,i,g){i?g(h?"string"!=typeof h?h:e3(h,j):cI([""],{type:j})):h?"string"!=typeof h?jm(h,function(k){g(cR(k))}):g(h):g("")}function jT(n,g,k,h){function i(){++l===m.length&&h&&h()}function j(s,q){var r=s._attachments[q],p=r.digest,o=k.objectStore(eG).get(p);o.onsuccess=function(u){r.body=u.target.result.body,i()}}var m=Object.keys(n._attachments||{});if(!m.length){return h&&h()}var l=0;m.forEach(function(o){g.attachments&&g.include_docs?j(n,o):(n._attachments[o].stub=!0,i())})}function dS(g,h){return e2.all(g.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return e2.all(j.map(function(m){var k=i.doc._attachments[m];if("body" in k){var l=k.body,n=k.content_type;return new e2(function(o){jO(l,n,h,function(p){i.doc._attachments[m]=bS.extend(jE(k,["digest","content_type"]),{data:p}),o()})})}}))}}))}function eX(h,j,o){function l(){p--,p||m()}function m(){g.length&&g.forEach(function(q){var r=n.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||k["delete"](q)}})}var g=[],i=o.objectStore(du),k=o.objectStore(eG),n=o.objectStore(eF),p=h.length;h.forEach(function(s){var r=i.index("_doc_id_rev"),q=j+"::"+s;r.getKey(q).onsuccess=function(u){var w=u.target.result;if("number"!=typeof w){return l()}i["delete"](w);var v=n.index("seq").openCursor(IDBKeyRange.only(w));v.onsuccess=function(x){var z=x.target.result;if(z){var y=z.value.digestSeq.split("::")[0];g.push(y),n["delete"](z.primaryKey),z["continue"]()}else{l()}}}})}function ak(h,j,i){try{return{txn:h.transaction(j,i)}}catch(g){return{error:g}}}function jN(p,L,w,s,A,E,N){function K(){var Q=[ep,du,eG,eI,dx,eF],P=ak(A,Q,"readwrite");return P.error?N(P.error):(m=P.txn,m.onabort=el(N),m.ontimeout=el(N),m.oncomplete=i,I=m.objectStore(ep),y=m.objectStore(du),D=m.objectStore(eG),H=m.objectStore(eF),void g(function(R){return R?(j=!0,N(R)):void x()}))}function q(){jt(p.revs_limit,o,s,r,m,n,B,w)}function x(){function T(){++V===o.length&&q()}function R(X){var W=bb(X.target.result);W&&r.set(W.id,W),T()}if(o.length){for(var V=0,S=0,U=o.length;U>S;S++){var Q=o[S];if(Q._id&&c2(Q._id)){T()}else{var P=I.get(Q.metadata.id);P.onsuccess=R}}}}function i(){j||(E.notify(s._meta.name),s._meta.docCount+=C,N(null,n))}function M(Q,P){var R=D.get(Q);R.onsuccess=function(T){if(T.target.result){P()}else{var S=ea(dv,"unknown stub attachment with digest "+Q);S.status=412,P(S)}}}function g(R){function P(){++S===T.length&&R(Q)}var T=[];if(o.forEach(function(U){U.data&&U.data._attachments&&Object.keys(U.data._attachments).forEach(function(W){var V=U.data._attachments[W];V.stub&&T.push(V.digest)})}),!T.length){return R()}var Q,S=0;T.forEach(function(U){M(U,function(V){V&&!Q&&(Q=V),P()})})}function B(V,P,T,R,S,U,X,Q){C+=U,V.metadata.winningRev=P,V.metadata.deleted=T;var Y=V.data;Y._id=V.metadata.id,Y._rev=V.metadata.rev,R&&(Y._deleted=!0);var W=Y._attachments&&Object.keys(Y._attachments).length;return W?O(V,P,T,S,X,Q):void F(V,P,T,S,X,Q)}function z(Q){var P=d1(Q.metadata);eX(P,Q.metadata.id,m)}function F(W,P,S,R,U,Z){function Q(ao){R&&s.auto_compaction&&z(W),T.seq=ao.target.result,delete T.rev;var an=j1(T,P,S),ai=I.put(an);ai.onsuccess=Y}function ae(an){an.preventDefault(),an.stopPropagation();var ai=y.index("_doc_id_rev"),ao=ai.getKey(V._doc_id_rev);ao.onsuccess=function(at){var ar=y.put(V,at.target.result);ar.onsuccess=Q}}function Y(){n[U]={ok:!0,id:T.id,rev:P},r.set(W.metadata.id,W.metadata),G(W,T.seq,Z)}var V=W.data,T=W.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var X=y.put(V);X.onsuccess=Q,X.onerror=ae}function O(X,Q,U,S,T,V){function Z(){Y===W.length&&F(X,Q,U,S,T,V)}function R(){Y++,Z()}var P=X.data,Y=0,W=Object.keys(P._attachments);W.forEach(function(ai){var ao=X.data._attachments[ai];if(ao.stub){Y++,Z()}else{var ae=ao.data;delete ao.data;var an=ao.digest;h(an,ae,R)}})}function G(V,S,P){function U(){++R===Q.length&&P()}function W(Z){var Y=V.data._attachments[Z].digest,X=H.put({seq:S,digestSeq:Y+"::"+S});X.onsuccess=U,X.onerror=function(ae){ae.preventDefault(),ae.stopPropagation(),U()}}var R=0,Q=Object.keys(V.data._attachments||{});if(!Q.length){return P()}for(var T=0;T<Q.length;T++){W(Q[T])}}function h(R,P,S){var Q=D.count(R);Q.onsuccess=function(V){var W=V.target.result;if(W){return S()}var U={digest:R,body:P},T=D.put(U);T.onsuccess=S}}for(var m,I,y,D,H,v,o=L.docs,C=0,l=0,J=o.length;J>l;l++){var k=o[l];k._id&&c2(k._id)||(k=o[l]=bj(k,w.new_edits),k.error&&!v&&(v=k))}if(v){return N(v)}var n=new Array(o.length),r=new cQ.Map,j=!1,u=s._meta.blobSupport?"blob":"base64";bI(o,u,function(P){return P?N(P):void K()})}function dW(k,i,h,j,l){try{if(k&&i){return l?IDBKeyRange.bound(i,k,!h,!1):IDBKeyRange.bound(k,i,!1,!h)}if(k){return l?IDBKeyRange.upperBound(k):IDBKeyRange.lowerBound(k)}if(i){return l?IDBKeyRange.lowerBound(i,!h):IDBKeyRange.upperBound(i,!h)}if(j){return IDBKeyRange.only(j)}}catch(g){return{error:g}}return null}function dd(h,j,i,g){return"DataError"===i.name&&0===i.code?g(null,{total_rows:h._meta.docCount,offset:j.skip,rows:[]}):void g(ea(bZ,i.name,i.message))}function fF(k,i,h,j){function l(s,o){function B(M,L,N){var O=M.id+"::"+N;n.get(O).onsuccess=function(P){L.doc=bG(P.target.result),s.conflicts&&(L.doc._conflicts=jI(M)),jT(L.doc,s,w)}}function v(N,P,O){var M={id:O.id,key:O.id,value:{rev:P}},L=O.deleted;if("ok"===s.deleted){p.push(M),L?(M.value.deleted=!0,M.doc=null):s.include_docs&&B(O,M,P)}else{if(!L&&y--<=0&&(p.push(M),s.include_docs&&B(O,M,P),0===--H)){return}}N["continue"]()}function u(N){K=i._meta.docCount;var L=N.target.result;if(L){var M=bb(L.value),O=M.winningRev;v(L,O,M)}}function x(){o(null,{total_rows:K,offset:s.skip,rows:p})}function r(){s.attachments?dS(p,s.binary).then(x):x()}var z="startkey" in s?s.startkey:!1,J="endkey" in s?s.endkey:!1,C="key" in s?s.key:!1,y=s.skip||0,H="number"==typeof s.limit?s.limit:-1,F=s.inclusive_end!==!1,E="descending" in s&&s.descending?"prev":null,I=dW(z,J,F,C,E);if(I&&I.error){return dd(i,s,I.error,o)}var q=[ep,du];s.attachments&&q.push(eG);var A=ak(h,q,"readonly");if(A.error){return o(A.error)}var w=A.txn,G=w.objectStore(ep),m=w.objectStore(du),D=E?G.openCursor(I,E):G.openCursor(I),n=m.index("_doc_id_rev"),p=[],K=0;w.oncomplete=r,D.onsuccess=u}function g(n,m){return 0===n.limit?m(null,{total_rows:i._meta.docCount,offset:n.skip,rows:[]}):void l(n,m)}g(k,j)}function eT(g){return new e2(function(h){var i=cI([""]);g.objectStore(d7).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function aJ(g,i){var h=this;cO.queue.push({action:function(j){aA(h,g,j)},callback:i}),bW()}function aA(m,j,p){function s(w){var v=w.createObjectStore(ep,{keyPath:"id"});w.createObjectStore(du,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),w.createObjectStore(eG,{keyPath:"digest"}),w.createObjectStore(eI,{keyPath:"id",autoIncrement:!1}),w.createObjectStore(d7),v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),w.createObjectStore(dx,{keyPath:"_id"});var x=w.createObjectStore(eF,{autoIncrement:!0});x.createIndex("seq","seq"),x.createIndex("digestSeq","digestSeq",{unique:!0})}function g(w,v){var x=w.objectStore(ep);x.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=b4(y);y.deletedOrLocal=A?"1":"0",x.put(y),B["continue"]()}else{v()}}}function o(v){v.createObjectStore(dx,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function i(w,x){var z=w.objectStore(dx),v=w.objectStore(ep),y=w.objectStore(du),A=v.openCursor();A.onsuccess=function(M){var J=M.target.result;if(J){var D=J.value,G=D.id,F=c2(G),C=ds(D);if(F){var L=G+"::"+C,I=G+"::",B=G+"::~",K=y.index("_doc_id_rev"),H=IDBKeyRange.bound(I,B,!1,!1),E=K.openCursor(H);E.onsuccess=function(N){if(E=N.target.result){var O=E.value;O._doc_id_rev===L&&z.put(O),y["delete"](E.primaryKey),E["continue"]()}else{v["delete"](J.primaryKey),J["continue"]()}}}else{J["continue"]()}}else{x&&x()}}}function u(w){var v=w.createObjectStore(eF,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function n(w,x){var z=w.objectStore(du),v=w.objectStore(eG),y=w.objectStore(eF),A=v.count();A.onsuccess=function(B){var C=B.target.result;return C?void (z.openCursor().onsuccess=function(G){var M=G.target.result;if(!M){return x()}for(var L=M.value,E=M.primaryKey,I=Object.keys(L._attachments||{}),K={},J=0;J<I.length;J++){var H=L._attachments[I[J]];K[H.digest]=!0}var F=Object.keys(K);for(J=0;J<F.length;J++){var D=F[J];y.put({seq:E,digestSeq:D+"::"+E})}M["continue"]()}):x()}}function l(z){function w(A){return A.data?bb(A):(A.deleted="1"===A.deletedOrLocal,A)}var x=z.objectStore(du),y=z.objectStore(ep),v=y.openCursor();v.onsuccess=function(C){function A(){var H=B.id+"::",F=B.id+"::",G=x.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return B.seq=I,E()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function E(){var G=j1(B,B.winningRev,B.deleted),F=y.put(G);F.onsuccess=function(){D["continue"]()}}var D=C.target.result;if(D){var B=w(D.value);return B.winningRev=B.winningRev||ds(B),B.seq?E():void A()}}}var q=j.name,k=null;m._meta=null,m.type=function(){return"idb"},m._id=jB(function(v){v(null,m._meta.instanceId)}),m._bulkDocs=function(x,v,w){jN(j,x,v,m,k,aJ.Changes,w)},m._get=function(D,y,C){function A(){C(v,{doc:B,metadata:x,ctx:z})}var B,x,v,z=y.ctx;if(!z){var w=ak(k,[ep,du,eG],"readonly");if(w.error){return C(w.error)}z=w.txn}z.objectStore(ep).get(D).onsuccess=function(E){if(x=bb(E.target.result),!x){return v=ea(bd,"missing"),A()}if(b4(x)&&!y.rev){return v=ea(bd,"deleted"),A()}var G=z.objectStore(du),H=y.rev||x.winningRev,F=x.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return B=I.target.result,B&&(B=bG(B)),B?void A():(v=ea(bd,"missing"),A())}}},m._getAttachment=function(z,y,A){var w;if(y.ctx){w=y.ctx}else{var x=ak(k,[ep,du,eG],"readonly");if(x.error){return A(x.error)}w=x.txn}var v=z.digest,B=z.content_type;w.objectStore(eG).get(v).onsuccess=function(C){var D=C.target.result.body;jO(D,B,y.binary,function(E){A(null,E)})}},m._info=function(y){if(null===k||!eR[q]){var w=new Error("db isn't open");return w.id="idbNull",y(w)}var A,x,v=ak(k,[du],"readonly");if(v.error){return y(v.error)}var B=v.txn,z=B.objectStore(du).openCursor(null,"prev");z.onsuccess=function(D){var C=D.target.result;A=C?C.key:0,x=m._meta.docCount},B.oncomplete=function(){y(null,{doc_count:x,update_seq:A,idb_attachment_format:m._meta.blobSupport?"binary":"base64"})}},m._allDocs=function(v,w){fF(v,m,k,w)},m._changes=function(z){function A(Q){function T(){return N.seq!==O?Q["continue"]():(G=O,N.winningRev===P._rev?S(P):void R())}function R(){var U=P._id+"::"+N.winningRev,V=I.get(U);V.onsuccess=function(W){S(bG(W.target.result))}}function S(V){var W=z.processChange(V,N,z);W.seq=N.seq;var U=D(W);return"object"==typeof U?z.complete(U):(U&&(L++,x&&F.push(W),z.attachments&&z.include_docs?jT(V,z,E,function(){dS([W],z.binary).then(function(){z.onChange(W)})}):z.onChange(W)),void (L!==v&&Q["continue"]()))}var P=bG(Q.value),O=Q.key;if(C&&!C.has(P._id)){return Q["continue"]()}var N;return(N=y.get(P._id))?T():void (B.get(P._id).onsuccess=function(U){N=bb(U.target.result),y.set(P._id,N),T()})}function M(N){var O=N.target.result;O&&A(O)}function J(){var P=[ep,du];z.attachments&&P.push(eG);var O=ak(k,P,"readonly");if(O.error){return z.complete(O.error)}E=O.txn,E.onabort=el(z.complete),E.oncomplete=K,H=E.objectStore(du),B=E.objectStore(ep),I=H.index("_doc_id_rev");var N;N=z.descending?H.openCursor(null,"prev"):H.openCursor(IDBKeyRange.lowerBound(z.since,!0)),N.onsuccess=M}function K(){function N(){z.complete(null,{results:F,last_seq:G})}!z.continuous&&z.attachments?dS(F).then(N):N()}if(z=dY(z),z.continuous){var w=q+":"+jy();return aJ.Changes.addListener(q,w,m,z),aJ.Changes.notify(q),{cancel:function(){aJ.Changes.removeListener(q,w)}}}var C=z.doc_ids&&new cQ.Set(z.doc_ids);z.since=z.since||0;var G=z.since,v="limit" in z?z.limit:-1;0===v&&(v=1);var x;x="return_docs" in z?z.return_docs:"returnDocs" in z?z.returnDocs:!0;var E,H,B,I,F=[],L=0,D=jl(z),y=new cQ.Map;J()},m._close=function(v){return null===k?v(ea(df)):(k.close(),delete eR[q],k=null,void v())},m._getRevisionTree=function(z,w){var x=ak(k,[ep],"readonly");if(x.error){return w(x.error)}var y=x.txn,v=y.objectStore(ep).get(z);v.onsuccess=function(B){var A=bb(B.target.result);A?w(null,A.rev_tree):w(ea(bd))}},m._doCompaction=function(z,y,A){var w=[ep,du,eG,eF],x=ak(k,w,"readwrite");if(x.error){return A(x.error)}var v=x.txn,B=v.objectStore(ep);B.get(z).onsuccess=function(E){var C=bb(E.target.result);ef(C.rev_tree,function(I,K,H,J,G){var L=K+"-"+H;-1!==y.indexOf(L)&&(G.status="missing")}),eX(y,z,v);var D=C.winningRev,F=C.deleted;v.objectStore(ep).put(j1(C,D,F))},v.onabort=el(A),v.oncomplete=function(){A()}},m._getLocal=function(z,w){var x=ak(k,[dx],"readonly");if(x.error){return w(x.error)}var y=x.txn,v=y.objectStore(dx).get(z);v.onerror=el(w),v.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,w(null,A)):w(ea(bd))}},m._putLocal=function(z,E,y){"function"==typeof E&&(y=E,E={}),delete z._revisions;var w=z._rev,x=z._id;w?z._rev="0-"+(parseInt(w.split("-")[1],10)+1):z._rev="0-1";var C,B=E.ctx;if(!B){var v=ak(k,[dx],"readwrite");if(v.error){return y(v.error)}B=v.txn,B.onerror=el(y),B.oncomplete=function(){C&&y(null,C)}}var D,A=B.objectStore(dx);w?(D=A.get(x),D.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===w){var F=A.put(z);F.onsuccess=function(){C={ok:!0,id:z._id,rev:z._rev},E.ctx&&y(null,C)}}else{y(ea(aZ))}}):(D=A.add(z),D.onerror=function(F){y(ea(aZ)),F.preventDefault(),F.stopPropagation()},D.onsuccess=function(){C={ok:!0,id:z._id,rev:z._rev},E.ctx&&y(null,C)})},m._removeLocal=function(D,y,C){"function"==typeof y&&(C=y,y={});var A=y.ctx;if(!A){var B=ak(k,[dx],"readwrite");if(B.error){return C(B.error)}A=B.txn,A.oncomplete=function(){x&&C(null,x)}}var x,v=D._id,z=A.objectStore(dx),w=z.get(v);w.onerror=el(C),w.onsuccess=function(F){var E=F.target.result;E&&E._rev===D._rev?(z["delete"](v),x={ok:!0,id:v,rev:"0-0"},y.ctx&&C(null,x)):C(ea(bd))}},m._destroy=function(w,v){aJ.Changes.removeAllListeners(q),aJ.openReqList[q]&&aJ.openReqList[q].result&&(aJ.openReqList[q].result.close(),delete eR[q]);var x=indexedDB.deleteDatabase(q);x.onsuccess=function(){aJ.openReqList[q]&&(aJ.openReqList[q]=null),a8()&&q in localStorage&&delete localStorage[q],v(null,{ok:!0})},x.onerror=el(v)};var h=eR[q];if(h){return k=h.idb,m._meta=h.global,void bV.nextTick(function(){p(null,m)})}var r;r=j.storage?c9(q,j.storage):indexedDB.open(q,da),"openReqList" in aJ||(aJ.openReqList={}),aJ.openReqList[q]=r,r.onupgradeneeded=function(w){function z(){var B=y[A-1];A++,B&&B(v,z)}var x=w.target.result;if(w.oldVersion<1){return s(x)}var v=w.currentTarget.transaction;w.oldVersion<3&&o(x),w.oldVersion<4&&u(x);var y=[g,i,n,l],A=w.oldVersion;z()},r.onsuccess=function(v){k=v.target.result,k.onversionchange=function(){k.close(),delete eR[q]},k.onabort=function(B){console.error("Database has a global failure",B.target.error),k.close(),delete eR[q]};var z=k.transaction([eI,d7,ep],"readwrite"),y=z.objectStore(eI).get(eI),x=null,w=null,A=null;y.onsuccess=function(D){var B=function(){null!==x&&null!==w&&null!==A&&(m._meta={name:q,instanceId:A,blobSupport:x,docCount:w},eR[q]={idb:k,global:m._meta},p(null,m))},E=D.target.result||{id:eI};q+"_id" in E?(A=E[q+"_id"],B()):(A=jy(),E[q+"_id"]=A,z.objectStore(eI).put(E).onsuccess=function(){B()}),dh||(dh=eT(z)),dh.then(function(F){x=F,B()});var C=z.objectStore(ep).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){w=F.target.result,B()}}},r.onerror=function(w){var v="Failed to open indexedDB, are you in private browsing mode?";console.error(v),p(ea(bZ,v))}}function c9(g,i){try{return indexedDB.open(g,{version:da,storage:i})}catch(h){return indexedDB.open(g,da)}}var bS=f(7),bT="default" in bS?bS["default"]:bS,c1=f(6);c1="default" in c1?c1["default"]:c1;var cQ=f(12);cQ="default" in cQ?cQ["default"]:cQ;var jq=f(4),jA=f(1);jA="default" in jA?jA["default"]:jA;var bg=f(2);bg="default" in bg?bg["default"]:bg;var cT=f(10),ec="default" in cT?cT["default"]:cT,cu=f(8);cu="default" in cu?cu["default"]:cu;var ck=f(14);ck="default" in ck?ck["default"]:ck;var aS=f(15);aS="default" in aS?aS["default"]:aS;var ah=f(16);ah="default" in ah?ah["default"]:ah;var e2="function"==typeof Promise?Promise:cu,c7=jz();c1(aL,Error),aL.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var dQ=new aL({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),bQ=new aL({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),bd=new aL({status:404,error:"not_found",reason:"missing"}),aZ=new aL({status:409,error:"conflict",reason:"Document update conflict"}),eZ=new aL({status:400,error:"invalid_id",reason:"_id field must contain a string"}),a9=new aL({status:412,error:"missing_id",reason:"_id is required for puts"}),dz=new aL({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),df=new aL({status:412,error:"precondition_failed",reason:"Database not open"}),bY=new aL({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),cJ=new aL({status:500,error:"badarg",reason:"Some query argument is invalid"}),e9=new aL({status:400,error:"invalid_request",reason:"Request was invalid"}),fJ=new aL({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),ay=new aL({status:500,error:"doc_validation",reason:"Bad special document member"}),jx=new aL({status:400,error:"bad_request",reason:"Something wrong with the request"}),fQ=new aL({status:400,error:"bad_request",reason:"Document must be a JSON object"}),eE=new aL({status:404,error:"not_found",reason:"Database not found"}),bZ=new aL({status:500,error:"indexed_db_went_bad",reason:"unknown"}),bL=new aL({status:500,error:"web_sql_went_bad",reason:"unknown"}),eN=new aL({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),cC=new aL({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),jX=new aL({status:400,error:"bad_request",reason:"Invalid rev format"}),eV=new aL({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),dv=new aL({status:412,error:"missing_stub"}),em=new aL({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),ax={UNAUTHORIZED:dQ,MISSING_BULK_DOCS:bQ,MISSING_DOC:bd,REV_CONFLICT:aZ,INVALID_ID:eZ,MISSING_ID:a9,RESERVED_ID:dz,NOT_OPEN:df,UNKNOWN_ERROR:bY,BAD_ARG:cJ,INVALID_REQUEST:e9,QUERY_PARSE_ERROR:fJ,DOC_VALIDATION:ay,BAD_REQUEST:jx,NOT_AN_OBJECT:fQ,DB_MISSING:eE,WSQ_ERROR:bL,LDB_ERROR:eN,FORBIDDEN:cC,INVALID_REV:jX,FILE_EXISTS:eV,MISSING_STUB:dv,IDB_ERROR:bZ,INVALID_URL:em},cH=function(j,h,g){var i=Object.keys(ax).filter(function(m){var l=ax[m];return"function"!=typeof l&&l[j]===h}),k=g&&i.filter(function(m){var l=ax[m];return l.message===g})[0]||i[0];return k?ax[k]:null},ej=function(){},fG=bg("pouchdb:api");c1(jW,jq.EventEmitter),jW.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},jW.prototype.doChanges=function(j){var h=this,g=j.complete;if(j=dY(j),"live" in j&&!("continuous" in j)&&(j.continuous=j.live),j.processChange=aU,"latest"===j.since&&(j.since="now"),j.since||(j.since=0),"now"===j.since){return void this.db.info().then(function(l){return h.isCancelled?void g(null,{status:"cancelled"}):(j.since=l.update_seq,void h.doChanges(j))},g)}if(j.continuous&&"now"!==j.since&&this.db.info().then(function(l){h.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),j.filter&&"string"==typeof j.filter&&("_view"===j.filter?j.view=jR(j.view):j.filter=jR(j.filter),"http"!==this.db.type()&&!j.doc_ids)){return this.filterChanges(j)}"descending" in j||(j.descending=!1),j.limit=0===j.limit?1:j.limit,j.complete=g;var i=this.db._changes(j);if(i&&"function"==typeof i.cancel){var k=h.cancel;h.cancel=jA(function(l){i.cancel(),k.apply(this,l)})}},jW.prototype.filterChanges=function(k){var i=this,h=k.complete;if("_view"===k.filter){if(!k.view||"string"!=typeof k.view){var j=ea(jx,"`view` filter parameter not found or invalid.");return h(j)}var l=jG(k.view);this.db.get("_design/"+l[0],function(o,n){if(i.isCancelled){return h(null,{status:"cancelled"})}if(o){return h(d0(o))}var m=n&&n.views&&n.views[l[1]]&&n.views[l[1]].map;return m?(k.filter=aa(m),void i.doChanges(k)):h(ea(bd,n.views?"missing json key: "+l[1]:"missing json key: views"))})}else{var g=jG(k.filter);if(!g){return i.doChanges(k)}this.db.get("_design/"+g[0],function(m,n){if(i.isCancelled){return h(null,{status:"cancelled"})}if(m){return h(d0(m))}var o=n&&n.filters&&n.filters[g[1]];return o?(k.filter=bP(o),void i.doChanges(k)):h(ea(bd,n&&n.filters?"missing json key: "+g[1]:"missing json key: filters"))})}};var az="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),cD=jo(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cp=jo(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);c1(ba,jq.EventEmitter),ba.prototype.post=cj("post",function(g,i,h){return"function"==typeof i&&(h=i,i={}),"object"!=typeof g||Array.isArray(g)?h(ea(fQ)):void this.bulkDocs({docs:[g]},i,cS(h))}),ba.prototype.put=cj("put",jA(function(m){var k,g,l,i,j=m.shift(),h="_id" in j;if("object"!=typeof j||Array.isArray(j)){return(i=m.pop())(ea(fQ))}for(;;){if(k=m.shift(),g=typeof k,"string"!==g||h?"string"!==g||!h||"_rev" in j?"object"===g?l=k:"function"===g&&(i=k):j._rev=k:(j._id=k,h=!0),!m.length){break}}return l=l||{},jU(j._id),c2(j._id)&&"function"==typeof this._putLocal?j._deleted?this._removeLocal(j,i):this._putLocal(j,i):void this.bulkDocs({docs:[j]},l,cS(i))})),ba.prototype.putAttachment=cj("putAttachment",function(n,g,k,h,i,j){function m(o){return o._attachments=o._attachments||{},o._attachments[g]={content_type:i,data:h},l.put(o)}var l=this;return"function"==typeof i&&(j=i,i=h,h=k,k=null),"undefined"==typeof i&&(i=h,h=k,k=null),l.get(n).then(function(o){if(o._rev!==k){throw ea(aZ)}return m(o)},function(o){if(o.reason===bd.message){return m({_id:n})}throw o})}),ba.prototype.removeAttachment=cj("removeAttachment",function(j,h,g,i){var k=this;k.get(j,function(m,l){return m?void i(m):l._rev!==g?void i(ea(aZ)):l._attachments?(delete l._attachments[h],0===Object.keys(l._attachments).length&&delete l._attachments,void k.put(l,i)):i()})}),ba.prototype.remove=cj("remove",function(k,i,h,j){var l;"string"==typeof i?(l={_id:k,_rev:i},"function"==typeof h&&(j=h,h={})):(l=k,"function"==typeof i?(j=i,h={}):(j=h,h=i)),h=h||{},h.was_delete=!0;var g={_id:l._id,_rev:l._rev||h.rev};return g._deleted=!0,c2(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(l,j):void this.bulkDocs({docs:[g]},h,cS(j))}),ba.prototype.revsDiff=cj("revsDiff",function(n,g,k){function h(o,p){l.has(o)||l.set(o,{missing:[]}),l.get(o).missing.push(p)}function i(q,p){var o=n[q].slice(0);ef(p,function(v,s,r,w,x){var u=s+"-"+r,y=o.indexOf(u);-1!==y&&(o.splice(y,1),"available"!==x.status&&h(q,u))}),o.forEach(function(r){h(q,r)})}"function"==typeof g&&(k=g,g={});var j=Object.keys(n);if(!j.length){return k(null,{})}var m=0,l=new cQ.Map;j.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){l.set(o,{missing:n[o]})}else{if(q){return k(q)}i(o,p)}if(++m===j.length){var r={};return l.forEach(function(u,s){r[s]=u}),k(null,r)}})},this)}),ba.prototype.bulkGet=cj("bulkGet",function(g,h){dl(this,g,h)}),ba.prototype.compactDocument=cj("compactDocument",function(h,j,i){var g=this;this._getRevisionTree(h,function(k,n){if(k){return i(k)}var l=bw(n),o=[],m=[];Object.keys(l).forEach(function(p){l[p]>j&&o.push(p)}),ef(n,function(u,r,p,s,v){var q=r+"-"+p;"available"===v.status&&-1!==o.indexOf(q)&&m.push(q)}),g._doCompaction(h,m,i)})}),ba.prototype.compact=cj("compact",function(g,i){"function"==typeof g&&(i=g,g={});var h=this;g=g||{},h._compactionQueue=h._compactionQueue||[],h._compactionQueue.push({opts:g,callback:i}),1===h._compactionQueue.length&&dK(h)}),ba.prototype._compact=function(m,k){function g(n){h.push(i.compactDocument(n.id,0))}function l(n){var o=n.last_seq;e2.all(h).then(function(){return dy(i,"_local/compaction",function(p){return !p.last_seq||p.last_seq<o?(p.last_seq=o,p):!1})}).then(function(){k(null,{ok:!0})})["catch"](k)}var i=this,j={return_docs:!1,last_seq:m.last_seq||0},h=[];i.changes(j).on("change",g).on("complete",l).on("error",k)},ba.prototype.get=cj("get",function(n,g,k){function h(){var o=[],p=i.length;return p?void i.forEach(function(q){j.get(n,{rev:q,revs:g.revs,attachments:g.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||k(null,o)})}):k(null,o)}if("function"==typeof g&&(k=g,g={}),"string"!=typeof n){return k(ea(eZ))}if(c2(n)&&"function"==typeof this._getLocal){return this._getLocal(n,k)}var i=[],j=this;if(!g.open_revs){return this._get(n,g,function(y,v){if(y){return k(y)}var B=v.doc,w=v.metadata,p=v.ctx;if(g.conflicts){var u=jI(w);u.length&&(B._conflicts=u)}if(b4(w,B._rev)&&(B._deleted=!0),g.revs||g.revs_info){var A=jS(w.rev_tree),r=bk(A,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(B._rev.split("-")[1])}),C=r.ids.map(function(D){return D.id}).indexOf(B._rev.split("-")[1])+1,s=r.ids.length-C;if(r.ids.splice(C,s),r.ids.reverse(),g.revs&&(B._revisions={start:r.pos+r.ids.length-1,ids:r.ids.map(function(D){return D.id})}),g.revs_info){var x=r.pos+r.ids.length;B._revs_info=r.ids.map(function(D){return x--,{rev:x+"-"+D.id,status:D.opts.status}})}}if(g.attachments&&B._attachments){var z=B._attachments,o=Object.keys(z).length;if(0===o){return k(null,B)}Object.keys(z).forEach(function(D){this._getAttachment(z[D],{binary:g.binary,ctx:p},function(F,G){var E=B._attachments[D];E.data=G,delete E.stub,delete E.length,--o||k(null,B)})},j)}else{if(B._attachments){for(var q in B._attachments){B._attachments.hasOwnProperty(q)&&(B._attachments[q].stub=!0)}}k(null,B)}})}if("all"===g.open_revs){this._getRevisionTree(n,function(o,p){return o?k(o):(i=aw(p).map(function(q){return q.rev}),void h())})}else{if(!Array.isArray(g.open_revs)){return k(ea(bY,"function_clause"))}i=g.open_revs;for(var m=0;m<i.length;m++){var l=i[m];if("string"!=typeof l||!/^\d+-/.test(l)){return k(ea(jX))}}h()}}),ba.prototype.getAttachment=cj("getAttachment",function(j,h,g,i){var k=this;g instanceof Function&&(i=g,g={}),this._get(j,g,function(m,l){return m?i(m):l.doc._attachments&&l.doc._attachments[h]?(g.ctx=l.ctx,g.binary=!0,k._getAttachment(l.doc._attachments[h],g,i),void 0):i(ea(bd))})}),ba.prototype.allDocs=cj("allDocs",function(g,i){if("function"==typeof g&&(i=g,g={}),g.skip="undefined"!=typeof g.skip?g.skip:0,g.start_key&&(g.startkey=g.start_key),g.end_key&&(g.endkey=g.end_key),"keys" in g){if(!Array.isArray(g.keys)){return i(new TypeError("options.keys must be an array"))}var h=["startkey","endkey","key"].filter(function(j){return j in g})[0];if(h){return void i(ea(fJ,"Query parameter `"+h+"` is not compatible with multi-get"))}if("http"!==this.type()){return aT(this,g,i)}}return this._allDocs(g,i)}),ba.prototype.changes=function(g,h){return"function"==typeof g&&(h=g,g={}),new jW(this,g,h)},ba.prototype.close=cj("close",function(g){return this._closed=!0,this._close(g)}),ba.prototype.info=cj("info",function(g){var h=this;this._info(function(j,i){return j?g(j):(i.db_name=i.db_name||h._db_name,i.auto_compaction=!(!h.auto_compaction||"http"===h.type()),i.adapter=h.type(),void g(null,i))})}),ba.prototype.id=cj("id",function(g){return this._id(g)}),ba.prototype.bulkDocs=cj("bulkDocs",function(j,h,g){if("function"==typeof h&&(g=h,h={}),h=h||{},Array.isArray(j)&&(j={docs:j}),!j||!j.docs||!Array.isArray(j.docs)){return g(ea(bQ))}for(var i=0;i<j.docs.length;++i){if("object"!=typeof j.docs[i]||Array.isArray(j.docs[i])){return g(ea(fQ))}}var k;return j.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){k=k||eY(m)})}),k?g(ea(jx,k)):("new_edits" in h||("new_edits" in j?h.new_edits=j.new_edits:h.new_edits=!0),h.new_edits||"http"===this.type()||j.docs.sort(c0),bH(j.docs),this._bulkDocs(j,h,function(m,l){return m?g(m):(h.new_edits||(l=l.filter(function(n){return n.error})),void g(null,l))}))}),ba.prototype.registerDependentDatabase=cj("registerDependentDatabase",function(h,j){function i(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[h]?!1:(k.dependentDbs[h]=!0,k)}var g=new this.constructor(h,this.__opts);dy(this,"_local/_pouch_dependentDbs",i).then(function(){j(null,{db:g})})["catch"](j)}),ba.prototype.destroy=cj("destroy",function(j,h){function g(){i._destroy(j,function(l,m){return l?h(l):(i.emit("destroyed"),void h(null,m||{ok:!0}))})}"function"==typeof j&&(h=j,j={});var i=this,k="use_prefix" in i?i.use_prefix:!0;return"http"===i.type()?g():void i.get("_local/_pouch_dependentDbs",function(l,o){if(l){return 404!==l.status?h(l):g()}var m=o.dependentDbs,p=i.constructor,n=Object.keys(m).map(function(r){var q=k?r.replace(new RegExp("^"+p.prefix),""):r;return new p(q,i.__opts).destroy()});e2.all(n).then(g,h)})}),fC.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},fC.prototype.fail=function(g){this.failed=g,this.execute()},fC.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},fC.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},c1(cE,ba),cE.debug=bg;var eA;if(jJ()){eA=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),eA=!!localStorage.getItem("_pouch_check_localstorage")}catch(dB){eA=!1}}cE.adapters={},cE.preferredAdapters=[],cE.prefix="_pouch_";var fL=new jq.EventEmitter;e8(cE),cE.parseAdapter=function(n,g){var k,h,i=n.match(/([a-z\-]*):\/\/(.*)/);if(i){if(n=/http(s?)/.test(i[1])?i[1]+"://"+i[2]:i[2],k=i[1],!cE.adapters[k].valid()){throw"Invalid adapter"}return{name:n,adapter:i[1]}}var j="idb" in cE.adapters&&"websql" in cE.adapters&&a8()&&localStorage["_pouch__websqldb_"+cE.prefix+n];if(g.adapter){h=g.adapter}else{if("undefined"!=typeof g&&g.db){h="leveldb"}else{for(var m=0;m<cE.preferredAdapters.length;++m){if(h=cE.preferredAdapters[m],h in cE.adapters){if(j&&"idb"===h){console.log('PouchDB is downgrading "'+n+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}k=cE.adapters[h];var l=k&&"use_prefix" in k?k.use_prefix:!0;return{name:l?cE.prefix+n:n,adapter:h}},cE.adapter=function(g,i,h){i.valid()&&(cE.adapters[g]=i,h&&cE.preferredAdapters.push(g))},cE.plugin=function(g){return Object.keys(g).forEach(function(h){cE.prototype[h]=g[h]}),cE},cE.defaults=function(g){function h(k,i,j){return this instanceof h?(("function"==typeof i||"undefined"==typeof i)&&(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=bS.extend({},g,i),void cE.call(this,k,i,j)):new h(k,i,j)}return c1(h,cE),e8(h),h.preferredAdapters=cE.preferredAdapters.slice(),Object.keys(cE).forEach(function(i){i in h||(h[i]=cE[i])}),h};var aI=function(g){return atob(g)},cR=function(g){return btoa(g)},aV=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],bE="queryKey",b1=/(?:^|&)([^&=]*)=?([^&]*)/g,ac=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,bm=bT.extend,bu={ajax:dO,parseUri:bh,uuid:jy,Promise:e2,atob:aI,btoa:cR,binaryStringToBlobOrBuffer:c5,clone:dY,extend:bm,createError:ea},cz=ec.collate,cA=1,bq="pouchdb",dI=5,cZ=0;jV.prototype.writeCheckpoint=function(g,i){var h=this;return this.updateTarget(g,i).then(function(){return h.updateSource(g,i)})},jV.prototype.updateTarget=function(g,h){return by(this.target,this.id,g,h,this.returnValue)},jV.prototype.updateSource=function(g,i){var h=this;return this.readOnlySource?e2.resolve(!0):by(this.src,this.id,g,i,this.returnValue)["catch"](function(k){var j="number"==typeof k.status&&4===Math.floor(k.status/100);if(j){return h.readOnlySource=!0,!0}throw k})};var av={undefined:function(g,h){return 0===cz(g.last_seq,h.last_seq)?h.last_seq:0},1:function(g,h){return cG(h,g).last_seq}};jV.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.src.get(g.id).then(function(i){if(h.version!==i.version){return cZ}var j;return j=h.version?h.version.toString():"undefined",j in av?av[j](h,i):cZ},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:cZ}).then(function(){return cZ},function(j){return 401===j.status?(g.readOnlySource=!0,h.last_seq):cZ})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return cZ})};var dm=0,b2=dH.setImmediate||dH.setTimeout,eK=32768,aK=jB(function(h,j){function o(){var q=k*g,u=q+g;if(k++,i>k){p(n,h,q,u),b2(o)}else{p(n,h,q,u);var r=n.end(!0),s=dk(r);j(null,s),n.destroy()}}var l="string"==typeof h,m=l?h.length:h.byteLength,g=Math.min(eK,m),i=Math.ceil(m/g),k=0,n=l?new aS:new aS.ArrayBuffer,p=l?bO:dc;o()});c1(bX,jq.EventEmitter),bX.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},bX.prototype.ready=function(j,h){function g(){k.cancel()}function i(){j.removeListener("destroyed",g),h.removeListener("destroyed",g)}var k=this;k._readyCalled||(k._readyCalled=!0,j.once("destroyed",g),h.once("destroyed",g),k.once("complete",i))};var eB={replicate:b5,toPouch:dF},dU=eB.replicate;c1(dq,jq.EventEmitter),dq.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var c3=25,dw=50,cN={},jv=1800,bU=bg("pouchdb:http");dE.valid=function(){return !0};var e5=function(g,h){return h&&g.then(function(i){bV.nextTick(function(){h(null,i)})},function(i){bV.nextTick(function(){h(i)})}),g},dg=function(g){return jA(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&e5(i,j),i})},bM=function(g,h){return g.then(function(i){return h().then(function(){return i})},function(i){return h().then(function(){throw i})})},dC=function(g,h){return function(){var j=arguments,i=this;return g.add(function(){return h.apply(i,j)})}},ab=function(k){for(var i={},h=0,j=k.length;j>h;h++){i["$"+k[h]]=!0}var l=Object.keys(i),g=new Array(l.length);for(h=0,j=l.length;j>h;h++){g[h]=l[h].substring(1)}return g},d2={uniq:ab,sequentialize:dC,fin:bM,callbackify:dg,promisedCallback:e5};b9.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},b9.prototype.finish=function(){return this.promise};var aG,bK=ec.collate,cx=ec.toIndexableString,dD=ec.normalizeKey,dP=ec.parseIndexableString;aG="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var cb=d2.callbackify,eW=d2.sequentialize,d8=d2.uniq,aY=d2.fin,aF=d2.promisedCallback,dG={},cg=new b9,dp=50,dX={_sum:function(g,h){return eO(h)},_count:function(g,h){return h.length},_stats:function(g,i){function h(m){for(var k=0,j=0,l=m.length;l>j;j++){var n=m[j];k+=n*n}return k}return{sum:eO(i),min:Math.min.apply(null,i),max:Math.max.apply(null,i),count:i.length,sumsqr:h(i)}}},jw=cb(function(){var g=this;return"http"===g.type()?dN(g):"function"==typeof g._viewCleanup?aM(g):fA(g)}),jC=function(j,h,g){"function"==typeof h&&(g=h,h={}),h=h?eg(h):{},"function"==typeof j&&(j={map:j});var i=this,k=e2.resolve().then(function(){return ed(i,j,h)});return aF(k,g),k};c1(ag,Error),c1(j0,Error),c1(fB,Error);var bN={query:jC,viewCleanup:jw},dJ=7,bx=eM("document-store"),fE=eM("by-sequence"),db=eM("attach-store"),cf=eM("local-store"),fP=eM("metadata-store"),d3=eM("attach-seq-store"),dT={};c1(bp,jq.EventEmitter),bp.prototype.addListener=function(m,k,g,l){function i(){function o(){h=!1}if(j._listeners[k]){if(h){return void (h="waiting")}h=!0;var n=jE(l,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(n).on("change",function(p){p.seq>l.since&&!l.cancelled&&(l.since=p.seq,l.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){i()},0),h=!1}).on("error",o)}}if(!this._listeners[k]){var j=this,h=!1;this._listeners[k]=i,this.on(m,i)}},bp.prototype.removeListener=function(g,h){h in this._listeners&&jq.EventEmitter.prototype.removeListener.call(this,g,this._listeners[h])},bp.prototype.notifyLocalWindows=function(g){jJ()?chrome.storage.local.set({dbName:g}):a8()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},bp.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)};var au=1,aN="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+fE+" (seq, deleted)",j2="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+fE+" (doc_id, rev)",jn="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+bx+" (winningseq)",ju="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+d3+" (seq)",dV="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+d3+" (digest, seq)",eH=fE+".seq = "+bx+".winningseq",e4=fE+".seq AS seq, "+fE+".deleted AS deleted, "+fE+".json AS data, "+fE+".rev AS rev, "+bx+".json AS metadata";cw.valid=cs,cw.Changes=new bp;var dh,da=5,ep="document-store",du="by-sequence",eG="attach-store",eF="attach-seq-store",eI="meta-store",dx="local-store",d7="detect-blob-support",cO={running:!1,queue:[]},eR={};aJ.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},aJ.Changes=new bp;var eC={idb:aJ,websql:cw};cE.ajax=dO,cE.utils=bu,cE.Errors=ax,cE.replicate=eB.replicate,cE.sync=e,cE.version="5.2.0",cE.adapter("http",dE),cE.adapter("https",dE),cE.plugin(bN),Object.keys(eC).forEach(function(g){cE.adapter(g,eC[g],!0)}),d.exports=cE}).call(this,f(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});