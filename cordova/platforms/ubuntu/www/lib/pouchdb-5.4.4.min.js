!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(c,f,h){function j(e,k){if(!f[e]){if(!c[e]){var i="function"==typeof require&&require;if(!k&&i){return i(e,!0)}if(g){return g(e,!0)}var m=new Error("Cannot find module '"+e+"'");throw m.code="MODULE_NOT_FOUND",m}var l=f[e]={exports:{}};c[e][0].call(l.exports,function(o){var n=c[e][1][o];return j(n?n:o)},l,l.exports,a,c,f,h)}return f[e].exports}for(var g="function"==typeof require&&require,d=0;d<h.length;d++){j(h[d])}return j}({1:[function(j,l,f){function k(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(e){return"function"==typeof e}function g(e){return"number"==typeof e}function h(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}l.exports=k,k.EventEmitter=k,k.prototype._events=void 0,k.prototype._maxListeners=void 0,k.defaultMaxListeners=10,k.prototype.setMaxListeners=function(e){if(!g(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},k.prototype.emit=function(i){var p,o,e,n,m,q;if(this._events||(this._events={}),"error"===i&&(!this._events.error||h(this._events.error)&&!this._events.error.length)){if(p=arguments[1],p instanceof Error){throw p}throw TypeError('Uncaught, unspecified "error" event.')}if(o=this._events[i],c(o)){return !1}if(d(o)){switch(arguments.length){case 1:o.call(this);break;case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),o.apply(this,n)}}else{if(h(o)){for(n=Array.prototype.slice.call(arguments,1),q=o.slice(),e=q.length,m=0;e>m;m++){q[m].apply(this,n)}}}return !0},k.prototype.addListener=function(m,i){var e;if(!d(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,d(i.listener)?i.listener:i),this._events[m]?h(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,h(this._events[m])&&!this._events[m].warned&&(e=c(this._maxListeners)?k.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},k.prototype.on=k.prototype.addListener,k.prototype.once=function(m,e){function n(){this.removeListener(m,n),i||(i=!0,e.apply(this,arguments))}if(!d(e)){throw TypeError("listener must be a function")}var i=!1;return n.listener=e,this.on(m,n),this},k.prototype.removeListener=function(m,p){var o,n,e,i;if(!d(p)){throw TypeError("listener must be a function")}if(!this._events||!this._events[m]){return this}if(o=this._events[m],e=o.length,n=-1,o===p||d(o.listener)&&o.listener===p){delete this._events[m],this._events.removeListener&&this.emit("removeListener",m,p)}else{if(h(o)){for(i=e;i-->0;){if(o[i]===p||o[i].listener&&o[i].listener===p){n=i;break}}if(0>n){return this}1===o.length?(o.length=0,delete this._events[m]):o.splice(n,1),this._events.removeListener&&this.emit("removeListener",m,p)}}return this},k.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],d(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},k.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?d(this._events[i])?[this._events[i]]:this._events[i].slice():[]},k.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(d(e)){return 1}if(e){return e.length}}return 0},k.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(c,p,m){function j(){k&&z&&(k=!1,z.length?x=z.concat(x):g=-1,x.length&&A())}function A(){if(!k){var f=q(j);k=!0;for(var e=x.length;e;){for(z=x,x=[];++g<e;){z&&z[g].run()}g=-1,e=x.length}z=null,k=!1,y(f)}}function v(f,e){this.fun=f,this.array=e}function w(){}var q,y,d=p.exports={};!function(){try{q=setTimeout}catch(e){q=function(){throw new Error("setTimeout is not defined")}}try{y=clearTimeout}catch(e){y=function(){throw new Error("clearTimeout is not defined")}}}();var z,x=[],k=!1,g=-1;d.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}x.push(new v(f,e)),1!==x.length||k||q(A,0)},v.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=w,d.addListener=w,d.once=w,d.off=w,d.removeListener=w,d.removeAllListeners=w,d.emit=w,d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],3:[function(c,f,d){(function(eO,dY){function f3(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function ed(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function e4(h){if("function"==typeof h.slice){return h.slice(0)}var j=new ArrayBuffer(h.byteLength),i=new Uint8Array(j),g=new Uint8Array(h);return i.set(g),j}function dX(i){if(i instanceof ArrayBuffer){return e4(i)}var h=i.size,g=i.type;return"function"==typeof i.slice?i.slice(0,h,g):i.webkitSlice(0,h,g)}function aU(i){var h=Object.getPrototypeOf(i);if(null===h){return !0}var g=h.constructor;return"function"==typeof g&&g instanceof g&&fO.call(g)==ca}function c1(i){var g,k,h;if(!i||"object"!=typeof i){return i}if(Array.isArray(i)){for(g=[],k=0,h=i.length;h>k;k++){g[k]=c1(i[k])}return g}if(i instanceof Date){return i.toISOString()}if(ed(i)){return dX(i)}if(!aU(i)){return i}g={};for(k in i){if(Object.prototype.hasOwnProperty.call(i,k)){var j=c1(i[k]);"undefined"!=typeof j&&(g[k]=j)}}return g}function fD(g){var h=!1;return au(function(i){if(h){throw new Error("once called more than once")}h=!0,g.apply(this,i)})}function eK(g){return au(function(j){j=c1(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(m,n){eO.nextTick(function(){i(m,n)})});var h=new dO(function(m,q){var o;try{var n=fD(function(r,s){r?q(r):m(s)});j.push(n),o=g.apply(l,j),o&&"function"==typeof o.then&&m(o)}catch(p){q(p)}});return k&&h.then(function(m){k(null,m)},k),h})}function f5(i,h){function g(n,l,j){if(cJ.enabled){for(var m=[n._db_name,l],o=0;o<j.length-1;o++){m.push(j[o])}cJ.apply(null,m);var k=j[j.length-1];j[j.length-1]=function(r,p){var q=[n._db_name,l];q=q.concat(r?["error",r]:["success",p]),cJ.apply(null,q),k(r,p)}}}return eK(au(function(j){if(this._closed){return dO.reject(new Error("database is closed"))}if(this._destroyed){return dO.reject(new Error("database is destroyed"))}var k=this;return g(k,i,j),this.taskqueue.isReady?h.apply(this,j):new dO(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[i].apply(k,j))})})}))}function eX(j,h){for(var l={},i=0,k=h.length;k>i;i++){var g=h[i];g in j&&(l[g]=j[g])}return l}function eE(g){return g}function dC(g){return[{ok:g}]}function eB(u,i,q){function g(){var w=[];r.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),q(null,{results:w})}function k(){++j===n&&g()}function o(y,x,w){r[y]={id:x,docs:w},k()}function m(){if(!(l>=p.length)){var x=Math.min(l+bm,p.length),w=p.slice(l,x);v(w,l),l+=w.length}}function v(x,w){x.forEach(function(D,B){var z=w+B,A=s[D],C=eX(A[0],["atts_since","attachments"]);C.open_revs=A.map(function(E){return E.rev}),C.open_revs=C.open_revs.filter(eE);var y=eE;0===C.open_revs.length&&(delete C.open_revs,y=dC),["revs","attachments","binary","ajax"].forEach(function(E){E in i&&(C[E]=i[E])}),u.get(D,C,function(G,E){var F;F=G?[{error:G}]:y(E),o(z,D,F),m()})})}var h=i.docs,s={};h.forEach(function(w){w.id in s?s[w.id].push(w):s[w.id]=[w]});var n=Object.keys(s).length,j=0,r=new Array(n),p=Object.keys(s),l=0;m()}function bi(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function dd(){return eJ}function dg(g){bi()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):dd()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function dy(){cY.EventEmitter.call(this),this._listeners={},dg(this)}function aL(g){if("undefined"!==console&&g in console){var h=Array.prototype.slice.call(arguments,1);console[g].apply(console,h)}}function eC(i,g){var k=600000;i=parseInt(i,10)||0,g=parseInt(g,10),g!==g||i>=g?g=(i||1)<<1:g+=1,g>k&&(i=k>>1,g=k);var h=Math.random(),j=g-i;return ~~(j*h+i)}function ch(g){var h=0;return g||(h=2000),eC(g,h)}function av(g,h){aL("info","The above "+g+" is totally normal. "+h)}function e0(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function cU(h,j,i){function g(k){for(var l in h){"function"!=typeof h[l]&&(this[l]=h[l])}void 0!==i&&(this.name=i),void 0!==k&&(this.reason=k)}return g.prototype=e0.prototype,new g(j)}function bJ(j){var h,l,i,k,g;return l=j.error===!0&&"string"==typeof j.name?j.name:j.error,g=j.reason,i=cD("name",l,g),j.missing||"missing"===g||"deleted"===g||"not_found"===l?i=bz:"doc_validation"===l?(i=ka,k=g):"bad_request"===l&&i.message!==g&&(i=bW),i||(i=cD("status",j.status,g)||bw),h=cU(i,g,l),k&&(h.message=k),j.id&&(h.id=j.id),j.status&&(h.status=j.status),j.missing&&(h.missing=j.missing),h}function aQ(i,g,k){try{return !i(g,k)}catch(h){var j="Filter function threw: "+h.toString();return cU(bW,j)}}function eU(i){var h={},g=i.filter&&"function"==typeof i.filter;return h.query=i.query_params,function(k){k.doc||(k.doc={});var l=g&&aQ(i.filter,k.doc,h);if("object"==typeof l){return l}if(l){return !1}if(i.include_docs){if(!i.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function eA(h){for(var j=[],i=0,g=h.length;g>i;i++){j=j.concat(h[i])}return j}function bS(g){var h;if(g?"string"!=typeof g?h=cU(aC):/^_/.test(g)&&!/^_(design|local)/.test(g)&&(h=cU(fI)):h=cU(d4),h){throw h}}function aD(g,h){return"listenerCount" in g?g.listenerCount(h):cY.EventEmitter.listenerCount(g,h)}function bc(g){if(!g){return null}var h=g.split("/");return 2===h.length?h:1===h.length?[g,g]:null}function bd(g){var h=bc(g);return h?h.join("/"):null}function bH(l){for(var j=kh.exec(l),g={},k=14;k--;){var m=df[k],i=j[k]||"",h=-1!==["user","password"].indexOf(m);g[m]=h?decodeURIComponent(i):i}return g[d6]={},g[df[12]].replace(eZ,function(p,n,o){n&&(g[d6][n]=o)}),g}function aa(i,h,g){return new dO(function(j,k){i.get(h,function(m,o){if(m){if(404!==m.status){return k(m)}o={}}var n=o._rev,l=g(o);return l?(l._id=h,l._rev=n,void j(cm(i,l,g))):j({updated:!1,rev:n})})})}function cm(i,h,g){return i.put(h).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return aa(i,h._id,g)})}function ds(g){return 0|Math.random()*g}function fH(h,j){j=j||bF.length;var i="",g=-1;if(h){for(;++g<h;){i+=bF[ds(j)]}return i}for(;++g<36;){switch(g){case 8:case 13:case 18:case 23:i+="-";break;case 19:i+=bF[3&ds(16)|8];break;default:i+=bF[ds(16)]}}return i}function jY(r){for(var l,o,m,n,q=r.rev_tree.slice();n=q.pop();){var j=n.ids,s=j[2],k=n.pos;if(s.length){for(var i=0,g=s.length;g>i;i++){q.push({pos:k+1,ids:s[i]})}}else{var p=!!j[1].deleted,h=j[0];l&&!(m!==p?m:o!==k?k>o:h>l)||(l=h,o=k,m=p)}}return o+"-"+l}function bP(l,o){for(var j,h=l.slice();j=h.pop();){for(var i=j.pos,k=j.ids,m=k[2],g=o(0===m.length,i,k[0],j.ctx,k[1]),n=0,p=m.length;p>n;n++){h.push({pos:i+1,ids:m[n],ctx:g})}}}function e8(g,h){return g.pos-h.pos}function bI(h){var j=[];bP(h,function(m,o,l,n,k){m&&j.push({rev:o+"-"+l,pos:o,opts:k})}),j.sort(e8).reverse();for(var i=0,g=j.length;g>i;i++){delete j[i].pos}return j}function aI(l){for(var j=jY(l),g=bI(l.rev_tree),k=[],m=0,i=g.length;i>m;m++){var h=g[m];h.rev===j||h.opts.deleted||k.push(h.rev)}return k}function cI(g){var h=[];return bP(g.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(h.push(i+"-"+k),j.status="missing")}),h}function dH(r){for(var l,o=[],m=r.slice();l=m.pop();){var n=l.pos,q=l.ids,j=q[0],s=q[1],k=q[2],i=0===k.length,g=l.history?l.history.slice():[];g.push({id:j,opts:s}),i&&o.push({pos:n+1-g.length,ids:g});for(var p=0,h=k.length;h>p;p++){m.push({pos:n+1,ids:k[p],history:g})}}return o.reverse()}function d3(g,h){return g.pos-h.pos}function cd(j,h,l){for(var i,k=0,g=j.length;g>k;){i=k+g>>>1,l(j[i],h)<0?k=i+1:g=i}return k}function fM(h,j,i){var g=cd(h,j,i);h.splice(g,0,j)}function e5(k,m){for(var n,j,l=m,h=k.length;h>l;l++){var g=k[l],i=[g.id,g.opts,[]];j?(j[2].push(i),j=i):n=j=i}return n}function cV(g,h){return g[0]<h[0]?-1:1}function cE(l,o){for(var j=[{tree1:l,tree2:o}],h=!1;j.length>0;){var i=j.pop(),k=i.tree1,m=i.tree2;(k[1].status||m[1].status)&&(k[1].status="available"===k[1].status||"available"===m[1].status?"available":"missing");for(var g=0;g<m[2].length;g++){if(k[2][0]){for(var n=!1,p=0;p<k[2].length;p++){k[2][p][0]===m[2][g][0]&&(j.push({tree1:k[2][p],tree2:m[2][g]}),n=!0)}n||(h="new_branch",fM(k[2],m[2][g],cV))}else{h="new_leaf",k[2][0]=m[2][g]}}}return{conflicts:h,tree:l}}function jJ(n,A,m){var x,k=[],p=!1,y=!1;if(!n.length){return{tree:[A],conflicts:"new_leaf"}}for(var r=0,j=n.length;j>r;r++){var z=n[r];if(z.pos===A.pos&&z.ids[0]===A.ids[0]){x=cE(z.ids,A.ids),k.push({pos:z.pos,ids:x.tree}),p=p||x.conflicts,y=!0}else{if(m!==!0){var v=z.pos<A.pos?z:A,o=z.pos<A.pos?A:z,s=o.pos-v.pos,q=[],i=[];for(i.push({ids:v.ids,diff:s,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],w=0,u=g.length;u>w;w++){i.push({ids:g[w],diff:h.diff-1,parent:h.ids,parentIdx:w})}}else{h.ids[0]===o.ids[0]&&q.push(h)}}var l=q[0];l?(x=cE(l.ids,o.ids),l.parent[2][l.parentIdx]=x.tree,k.push({pos:v.pos,ids:v.ids}),p=p||x.conflicts,y=!0):k.push(z)}else{k.push(z)}}}return y||k.push(A),k.sort(d3),{tree:k,conflicts:p||"internal_node"}}function dh(r,l){for(var o,m=dH(r),n={},q=0,j=m.length;j>q;q++){for(var s=m[q],k=s.ids,i=Math.max(0,k.length-l),g={pos:s.pos+i,ids:e5(k,i)},p=0;i>p;p++){var h=s.pos+p+"-"+k[p].id;n[h]=!0}o=o?jJ(o,g,!0).tree:[g]}return bP(o,function(u,w,v){delete n[w+"-"+v]}),{tree:o,revs:Object.keys(n)}}function jQ(i,g,k){var h=jJ(i,g),j=dh(h.tree,k);return{tree:j.tree,stemmedRevs:j.revs,conflicts:h.conflicts}}function aP(l,o){for(var j,h=l.slice(),i=o.split("-"),k=parseInt(i[0],10),m=i[1];j=h.pop();){if(j.pos===k&&j.ids[0]===m){return !0}for(var g=j.ids[2],n=0,p=g.length;p>n;n++){h.push({pos:j.pos+1,ids:g[n]})}}return !1}function du(g){return g.ids}function cP(i,g){g||(g=jY(i));for(var k,h=g.substring(g.indexOf("-")+1),j=i.rev_tree.map(du);k=j.pop();){if(k[0]===h){return !!k[1].deleted}j=j.concat(k[2])}}function fB(g){return/^_local/.test(g)}function ap(g){return aX("return "+g+";",{})}function eY(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function aA(i,h){try{i.emit("change",h)}catch(g){aL("error",'Error in .on("change", function):',g)}}function af(l,j,g){function k(){m.cancel()}cY.EventEmitter.call(this);var m=this;this.db=l,j=j?c1(j):{};var i=j.complete=fD(function(n,o){n?aD(m,"error")>0&&m.emit("error",n):m.emit("complete",o),m.removeAllListeners(),l.removeListener("destroyed",k)});g&&(m.on("complete",function(n){g(null,n)}),m.on("error",g)),l.once("destroyed",k),j.onChange=function(n){j.isCancelled||(aA(m,n),m.startSeq&&m.startSeq<=n.seq&&(m.startSeq=!1))};var h=new dO(function(n,o){j.complete=function(p,q){p?o(p):n(q)}});m.once("cancel",function(){l.removeListener("destroyed",k),j.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){i(null,n)},i),l.taskqueue.isReady?m.doChanges(j):l.taskqueue.addTask(function(){m.isCancelled?m.emit("cancel"):m.doChanges(j)})}function bV(i,g,k){var h=[{rev:i._rev}];"all_docs"===k.style&&(h=bI(g.rev_tree).map(function(l){return{rev:l.rev}}));var j={id:g.id,changes:h,doc:i};return cP(g,i._rev)&&(j.deleted=!0),k.conflicts&&(j.doc._conflicts=aI(g),j.doc._conflicts.length||delete j.doc._conflicts),j}function eM(g,h){return h>g?-1:g>h?1:0}function ki(i,h){for(var g=0;g<i.length;g++){if(h(i[g],g)===!0){return i[g]}}}function dZ(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function eb(j){for(var h=0;h<j.length;h++){var l=j[h];if(l._deleted){delete l._attachments}else{if(l._attachments){for(var i=Object.keys(l._attachments),k=0;k<i.length;k++){var g=i[k];l._attachments[g]=eX(l._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function f8(i,g){var k=eM(i._id,g._id);if(0!==k){return k}var h=i._revisions?i._revisions.start:0,j=g._revisions?g._revisions.start:0;return eM(h,j)}function c4(i){var h={},g=[];return bP(i,function(m,l,n,k){var j=l+"-"+n;return m&&(h[j]=0),void 0!==k&&g.push({from:k,to:j}),j}),g.reverse(),g.forEach(function(j){void 0===h[j.from]?h[j.from]=1+h[j.to]:h[j.from]=Math.min(h[j.from],1+h[j.to])}),h}function f0(i,g,k){var h="limit" in g?g.keys.slice(g.skip,g.limit+g.skip):g.skip>0?g.keys.slice(g.skip):g.keys;if(g.descending&&h.reverse(),!h.length){return i._allDocs({limit:0},k)}var j={offset:g.skip};return dO.all(h.map(function(m){var l=dm.extend({key:m,deleted:"ok"},g);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new dO(function(n,o){i._allDocs(l,function(q,p){return q?o(q):(j.total_rows=p.total_rows,void n(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return j.rows=l,j})}function ad(h){var j=h._compactionQueue[0],g=j.opts,i=j.callback;h.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(g.last_seq=k.last_seq),h._compact(g,function(l,m){l?i(l):i(null,m),eO.nextTick(function(){h._compactionQueue.shift(),h._compactionQueue.length&&ad(h)})})})}function dE(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function dv(){cY.EventEmitter.call(this)}function d8(){this.isReady=!1,this.failed=!1,this.queue=[]}function eR(g){g&&dY.debug&&aL("error",g)}function c9(l,j){function g(){i.emit("destroyed",m)}function k(){l.removeListener("destroyed",g),l.emit("destroyed",l)}var m=j.originalName,i=l.constructor,h=i._destructionListeners;l.once("destroyed",g),h.has(m)||h.set(m,[]),h.get(m).push(k)}function jG(l,j,g){if(!(this instanceof jG)){return new jG(l,j,g)}var k=this;if("function"!=typeof j&&"undefined"!=typeof j||(g=j,j={}),l&&"object"==typeof l&&(j=l,l=void 0),"undefined"==typeof g){g=eR}else{var m=g;g=function(){return aL("warn","Using a callback for new PouchDB()is deprecated."),m.apply(null,arguments)}}l=l||j.name,j=c1(j),delete j.name,this.__opts=j;var i=g;k.auto_compaction=j.auto_compaction,k.prefix=jG.prefix,dv.call(k),k.taskqueue=new d8;var h=new dO(function(p,n){g=function(r,s){return r?n(r):(delete s.then,void p(s))},j=c1(j);var q,o;return function(){try{if("string"!=typeof l){throw o=new Error("Missing/invalid DB name"),o.code=400,o}var r=(j.prefix||"")+l;if(q=jG.parseAdapter(r,j),j.originalName=l,j.name=q.name,j.adapter=j.adapter||q.adapter,k._adapter=j.adapter,c6("pouchdb:adapter")("Picked adapter: "+j.adapter),k._db_name=l,!jG.adapters[j.adapter]){throw o=new Error("Adapter is missing"),o.code=404,o}if(!jG.adapters[j.adapter].valid()){throw o=new Error("Invalid Adapter"),o.code=404,o}}catch(s){k.taskqueue.fail(s)}}(),o?n(o):(k.adapter=j.adapter,k.replicate={},k.replicate.from=function(r,u,s){return k.constructor.replicate(r,k,u,s)},k.replicate.to=function(r,u,s){return k.constructor.replicate(k,r,u,s)},k.sync=function(r,u,s){return k.constructor.sync(k,r,u,s)},k.replicate.sync=k.sync,void jG.adapters[j.adapter].call(k,j,function(r){return r?(k.taskqueue.fail(r),void g(r)):(c9(k,j),k.emit("created",k),jG.emit("created",j.originalName),k.taskqueue.ready(k),void g(null,k))}))});h.then(function(n){i(null,n)},i),k.then=h.then.bind(h),k["catch"]=h["catch"].bind(h)}function eG(g){Object.keys(cY.EventEmitter.prototype).forEach(function(i){"function"==typeof cY.EventEmitter.prototype[i]&&(g[i]=dP[i].bind(dP))});var h=g._destructionListeners=new cz.Map;g.on("destroyed",function(i){h.get(i).forEach(function(j){j()}),h["delete"](i)})}function e(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function d2(h){if(!/^\d+\-./.test(h)){return cU(ea)}var j=h.indexOf("-"),i=h.substring(0,j),g=h.substring(j+1);return{prefix:parseInt(i,10),id:g}}function dk(l,j){for(var g=l.start-l.ids.length+1,k=l.ids,m=[k[0],j,[]],i=1,h=k.length;h>i;i++){m=[k[i],{status:"missing"},[m]]}return[{pos:g,ids:m}]}function bq(l,o){var j,h,i,k={status:"available"};if(l._deleted&&(k.deleted=!0),o){if(l._id||(l._id=fH()),h=fH(32,16).toLowerCase(),l._rev){if(i=d2(l._rev),i.error){return i}l._rev_tree=[{pos:i.prefix,ids:[i.id,{status:"missing"},[[h,k,[]]]]}],j=i.prefix+1}else{l._rev_tree=[{pos:1,ids:[h,k,[]]}],j=1}}else{if(l._revisions&&(l._rev_tree=dk(l._revisions,k),j=l._revisions.start,h=l._revisions.ids[0]),!l._rev_tree){if(i=d2(l._rev),i.error){return i}j=i.prefix,h=i.id,l._rev_tree=[{pos:j,ids:[h,k,[]]}]}}bS(l._id),l._rev=j+"-"+h;var m={metadata:{},data:{}};for(var g in l){if(Object.prototype.hasOwnProperty.call(l,g)){var n="_"===g[0];if(n&&!kd[g]){var p=cU(ka,g);throw p.message=ka.message+": "+g,p}n&&!cu[g]?m.metadata[g.slice(1)]=l[g]:m.data[g]=l[g]}}return m}function dz(i){for(var g="",k=new Uint8Array(i),h=k.byteLength,j=0;h>j;j++){g+=String.fromCharCode(k[j])}return g}function jN(g){return dV(dz(g))}function e3(j,h){j=j||[],h=h||{};try{return new Blob(j,h)}catch(l){if("TypeError"!==l.name){throw l}for(var i="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,k=new i,g=0;g<j.length;g+=1){k.append(j[g])}return k.getBlob(h.type)}}function bR(i){for(var g=i.length,k=new ArrayBuffer(g),h=new Uint8Array(k),j=0;g>j;j++){h[j]=i.charCodeAt(j)}return k}function jM(g,h){return e3([bR(g)],{type:h})}function j1(g,h){return jM(eQ(g),h)}function eh(h,j){if("undefined"==typeof FileReader){return j(dz((new FileReaderSync).readAsArrayBuffer(h)))}var i=new FileReader,g="function"==typeof i.readAsBinaryString;i.onloadend=function(k){var l=k.target.result||"";return g?j(l):void j(dz(l))},g?i.readAsBinaryString(h):i.readAsArrayBuffer(h)}function dj(g,h){eh(g,function(i){h(dV(i))})}function db(i,h){if("undefined"==typeof FileReader){return h((new FileReaderSync).readAsArrayBuffer(i))}var g=new FileReader;g.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);h(k)},g.readAsArrayBuffer(i)}function b8(g){return dV(g)}function eg(h,j,i,g){(i>0||g<j.byteLength)&&(j=new Uint8Array(j,i,Math.min(g,j.byteLength)-i)),h.append(j)}function fE(h,j,i,g){(i>0||g<j.length)&&(j=j.substring(i,g)),h.appendBinary(j)}function cO(l,o){function j(){var q=g*k,u=q+k;if(g++,m>g){p(n,l,q,u),fG(j)}else{p(n,l,q,u);var r=n.end(!0),s=b8(r);o(s),n.destroy()}}var h="string"==typeof l,i=h?l.length:l.byteLength,k=Math.min(bG,i),m=Math.ceil(i/k),g=0,n=h?new aK:new aK.ArrayBuffer,p=h?fE:eg;j()}function j8(g){return aK.hash(g)}function cp(k,m,n){function j(o){try{return eQ(o)}catch(q){var p=cU(dF,"Attachment is not a valid base64 string");return{error:p}}}function l(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=j(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===m?q.data=jM(o,q.content_type):"base64"===m?q.data=dV(o):q.data=o,cO(o,function(r){q.digest="md5-"+r,p()})}else{db(q.data,function(r){"binary"===m?q.data=dz(r):"base64"===m&&(q.data=jN(r)),cO(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function h(){i++,k.length===i&&(g?n(g):n())}if(!k.length){return n()}var g,i=0;k.forEach(function(r){function p(u){g=u,q++,q===s.length&&h()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return h()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&l(r.data._attachments[o],p)}})}function aB(s,x,z,B,l,g,v,q){if(aP(x.rev_tree,z.metadata.rev)){return B[l]=z,g()}var k=x.winningRev||jY(x),m="deleted" in x?x.deleted:cP(x,k),A="deleted" in z.metadata?z.metadata.deleted:cP(z.metadata),n=/^1-/.test(z.metadata.rev);if(m&&!A&&q&&n){var w=z.data;w._rev=k,w._id=z.metadata.id,z=bq(w,q)}var p=jQ(x.rev_tree,z.metadata.rev_tree[0],s),j=q&&(m&&A||!m&&"new_leaf"!==p.conflicts||m&&!A&&"new_branch"===p.conflicts);if(j){var i=cU(eH);return B[l]=i,g()}var h=z.metadata.rev;z.metadata.rev_tree=p.tree,z.stemmedRevs=p.stemmedRevs||[],x.rev_map&&(z.metadata.rev_map=x.rev_map);var r,y=jY(z.metadata),o=cP(z.metadata,y),u=m===o?0:o>m?-1:1;r=h===y?o:cP(z.metadata,h),v(z,y,o,r,!0,u,l,g)}function fJ(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function aE(o,q,u,i,s,k,m,g,l){function r(B,x,C){var w=jY(B.metadata),A=cP(B.metadata,w);if("was_delete" in g&&A){return k[x]=cU(bz,"deleted"),C()}var z=v&&fJ(B);if(z){var D=cU(eH);return k[x]=D,C()}var y=A?0:1;m(B,w,A,A,!1,y,x,C)}function n(){++p===j&&l&&l()}o=o||1000;var v=g.new_edits,h=new cz.Map,p=0,j=q.length;q.forEach(function(w,y){if(w._id&&fB(w._id)){var z=w._deleted?"_removeLocal":"_putLocal";return void u[z](w,{ctx:s},function(B,A){k[y]=B||A,n()})}var x=w.metadata.id;h.has(x)?(j--,h.get(x).push([w,y])):h.set(x,[[w,y]])}),h.forEach(function(z,x){function w(){++y<z.length?A():n()}function A(){var C=z[y],E=C[0],D=C[1];if(i.has(x)){aB(o,i.get(x),E,k,D,w,m,v)}else{var B=jQ([],E.metadata.rev_tree[0],o);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],r(E,D,w)}}var y=0;A()})}function cw(g){try{return JSON.parse(g)}catch(h){return bb.parse(g)}}function j0(g){return g.length<50000?JSON.parse(g):cw(g)}function jW(g){try{return JSON.stringify(g)}catch(h){return bb.stringify(g)}}function t(i,g,k,h){try{i.apply(g,k)}catch(j){h.emit("error",j)}}function aR(g){if(!bg.running&&bg.queue.length){bg.running=!0;var h=bg.queue.shift();h.action(function(i,j){t(h.callback,this,[i,j],g),bg.running=!1,eO.nextTick(function(){aR(g)})})}}function bM(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(cU(eW,i,h.type))}}function ay(i,h,g){return{data:jW(i),winningRev:h,deletedOrLocal:g?"1":"0",seq:i.seq,id:i.id}}function fK(g){if(!g){return null}var h=j0(g.data);return h.winningRev=g.winningRev,h.deleted="1"===g.deletedOrLocal,h.seq=g.seq,h}function jV(g){if(!g){return g}var h=g._doc_id_rev.lastIndexOf(":");return g._id=g._doc_id_rev.substring(0,h-1),g._rev=g._doc_id_rev.substring(h+1),delete g._doc_id_rev,g}function bl(h,j,i,g){i?g(h?"string"!=typeof h?h:j1(h,j):e3([""],{type:j})):h?"string"!=typeof h?eh(h,function(k){g(dV(k))}):g(h):g("")}function aO(k,m,n,j){function l(){++i===g.length&&j&&j()}function h(s,q){var r=s._attachments[q],p=r.digest,o=n.objectStore(cK).get(p);o.onsuccess=function(u){r.body=u.target.result.body,l()}}var g=Object.keys(k._attachments||{});if(!g.length){return j&&j()}var i=0;g.forEach(function(o){m.attachments&&m.include_docs?h(k,o):(k._attachments[o].stub=!0,l())})}function bk(g,h){return dO.all(g.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return dO.all(j.map(function(m){var k=i.doc._attachments[m];if("body" in k){var l=k.body,n=k.content_type;return new dO(function(o){bl(l,n,h,function(p){i.doc._attachments[m]=dm.extend(eX(k,["digest","content_type"]),{data:p}),o()})})}}))}}))}function bs(l,o,j){function h(){p--,p||i()}function i(){k.length&&k.forEach(function(q){var r=n.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||g["delete"](q)}})}var k=[],m=j.objectStore(e7),g=j.objectStore(cK),n=j.objectStore(dQ),p=l.length;l.forEach(function(s){var r=m.index("_doc_id_rev"),q=o+"::"+s;r.getKey(q).onsuccess=function(w){var v=w.target.result;if("number"!=typeof v){return h()}m["delete"](v);var u=n.index("seq").openCursor(IDBKeyRange.only(v));u.onsuccess=function(y){var x=y.target.result;if(x){var z=x.value.digestSeq.split("::")[0];k.push(z),n["delete"](x.primaryKey),x["continue"]()}else{h()}}}})}function cR(h,j,i){try{return{txn:h.transaction(j,i)}}catch(g){return{error:g}}}function bB(x,D,l,j,m,v,r){function u(){var P=[cA,e7,cK,jL,dQ],O=cR(m,P,"readwrite");return O.error?r(O.error):(A=O.txn,A.onabort=bM(r),A.ontimeout=bM(r),A.oncomplete=n,E=A.objectStore(cA),q=A.objectStore(e7),I=A.objectStore(cK),z=A.objectStore(dQ),void g(function(Q){return Q?(w=!0,r(Q)):void h()}))}function G(){aE(x.revs_limit,M,j,o,A,N,C,l)}function h(){function U(){++P===M.length&&G()}function S(W){var V=fK(W.target.result);V&&o.set(V.id,V),U()}if(M.length){for(var P=0,T=0,O=M.length;O>T;T++){var R=M[T];if(R._id&&fB(R._id)){U()}else{var Q=E.get(R.metadata.id);Q.onsuccess=S}}}}function n(){w||(v.notify(j._meta.name),j._meta.docCount+=B,r(null,N))}function k(P,O){var Q=I.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=cU(ck,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(M.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){k(T,function(U){U&&!P&&(P=U),O()})})}function C(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?y(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(ae){var an=X.stemmedRevs||[];R&&j.auto_compaction&&(an=an.concat(cI(X.metadata))),an&&an.length&&bs(an,X.metadata.id,A),T.seq=ae.target.result,delete T.rev;var ai=ay(T,Q,S),ao=E.put(ai);ao.onsuccess=Z}function P(ae){ae.preventDefault(),ae.stopPropagation();var an=q.index("_doc_id_rev"),ai=an.getKey(V._doc_id_rev);ai.onsuccess=function(ar){var ao=q.put(V,ar.target.result);ao.onsuccess=W}}function Z(){N[U]={ok:!0,id:T.id,rev:Q},o.set(X.metadata.id,X.metadata),p(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=q.put(V);Y.onsuccess=W,Y.onerror=P}function y(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(ai){var Z=W.data._attachments[ai];if(Z.stub){X++,Y()}else{var ae=Z.data;delete Z.data,Z.revpos=parseInt(P,10);var an=Z.digest;H(an,ae,Q)}})}function p(P,U,R){function O(){++T===S.length&&R()}function Q(Y){var X=P.data._attachments[Y].digest,W=z.put({seq:U,digestSeq:X+"::"+U});W.onsuccess=O,W.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),O()}}var T=0,S=Object.keys(P.data._attachments||{});if(!S.length){return R()}for(var V=0;V<S.length;V++){Q(S[V])}}function H(Q,O,R){var P=I.count(Q);P.onsuccess=function(T){var U=T.target.result;if(U){return R()}var S={digest:Q,body:O},V=I.put(S);V.onsuccess=R}}for(var A,E,q,I,z,F,M=D.docs,B=0,L=0,J=M.length;J>L;L++){var s=M[L];s._id&&fB(s._id)||(s=M[L]=bq(s,l.new_edits),s.error&&!F&&(F=s))}if(F){return r(F)}var N=new Array(M.length),o=new cz.Map,w=!1,i=j._meta.blobSupport?"blob":"base64";cp(M,i,function(O){return O?r(O):void u()})}function aV(j,h,l,i,k){try{if(j&&h){return k?IDBKeyRange.bound(h,j,!l,!1):IDBKeyRange.bound(j,h,!1,!l)}if(j){return k?IDBKeyRange.upperBound(j):IDBKeyRange.lowerBound(j)}if(h){return k?IDBKeyRange.lowerBound(h,!l):IDBKeyRange.upperBound(h,!l)}if(i){return IDBKeyRange.only(i)}}catch(g){return{error:g}}return null}function cZ(h,j,i,g){return"DataError"===i.name&&0===i.code?g(null,{total_rows:h._meta.docCount,offset:j.skip,rows:[]}):void g(cU(eW,i.name,i.message))}function bu(j,h,l,i){function k(J,F){function y(M,L,N){var O=M.id+"::"+N;m.get(O).onsuccess=function(P){L.doc=jV(P.target.result),J.conflicts&&(L.doc._conflicts=aI(M)),aO(L.doc,J,G)}}function v(O,L,P){var N={id:P.id,key:P.id,value:{rev:L}},M=P.deleted;if("ok"===J.deleted){n.push(N),M?(N.value.deleted=!0,N.doc=null):J.include_docs&&y(P,N,L)}else{if(!M&&o--<=0&&(n.push(N),J.include_docs&&y(P,N,L),0===--u)){return}}O["continue"]()}function s(N){K=h._meta.docCount;var L=N.target.result;if(L){var M=fK(L.value),O=M.winningRev;v(L,O,M)}}function B(){F(null,{total_rows:K,offset:J.skip,rows:n})}function x(){J.attachments?bk(n,J.binary).then(B):B()}var q="startkey" in J?J.startkey:!1,C="endkey" in J?J.endkey:!1,A="key" in J?J.key:!1,o=J.skip||0,u="number"==typeof J.limit?J.limit:-1,z=J.inclusive_end!==!1,I="descending" in J&&J.descending?"prev":null,H=aV(q,C,z,A,I);if(H&&H.error){return cZ(h,J,H.error,F)}var r=[cA,e7];J.attachments&&r.push(cK);var E=cR(l,r,"readonly");if(E.error){return F(E.error)}var G=E.txn,p=G.objectStore(cA),D=G.objectStore(e7),w=I?p.openCursor(H,I):p.openCursor(H),m=D.index("_doc_id_rev"),n=[],K=0;G.oncomplete=x,w.onsuccess=s}function g(n,m){return 0===n.limit?m(null,{total_rows:h._meta.docCount,offset:n.skip,rows:[]}):void k(n,m)}g(j,i)}function b1(g){return new dO(function(h){var i=e3([""]);g.objectStore(aq).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function j7(i,h){var g=this;bg.queue.push({action:function(j){c3(g,i,j)},callback:h}),aR(g.constructor)}function c3(l,m,q){function u(x){var w=x.createObjectStore(cA,{keyPath:"id"});x.createObjectStore(e7,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(cK,{keyPath:"digest"}),x.createObjectStore(bT,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(aq),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(jL,{keyPath:"_id"});var v=x.createObjectStore(dQ,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function g(x,w){var v=x.objectStore(cA);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=cP(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function p(v){v.createObjectStore(jL,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function k(x,z){var y=x.objectStore(jL),v=x.objectStore(cA),w=x.objectStore(e7),A=v.openCursor();A.onsuccess=function(I){var F=I.target.result;if(F){var L=F.value,C=L.id,B=fB(C),K=jY(L);if(B){var H=C+"::"+K,E=C+"::",J=C+"::~",G=w.index("_doc_id_rev"),D=IDBKeyRange.bound(E,J,!1,!1),M=G.openCursor(D);M.onsuccess=function(N){if(M=N.target.result){var O=M.value;O._doc_id_rev===H&&y.put(O),w["delete"](M.primaryKey),M["continue"]()}else{v["delete"](F.primaryKey),F["continue"]()}}}else{F["continue"]()}}else{z&&z()}}}function h(w){var v=w.createObjectStore(dQ,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function i(x,z){var y=x.objectStore(e7),v=x.objectStore(cK),w=x.objectStore(dQ),A=v.count();A.onsuccess=function(B){var C=B.target.result;return C?void (y.openCursor().onsuccess=function(E){var K=E.target.result;if(!K){return z()}for(var J=K.value,M=K.primaryKey,G=Object.keys(J._attachments||{}),I={},H=0;H<G.length;H++){var F=J._attachments[G[H]];I[F.digest]=!0}var D=Object.keys(I);for(H=0;H<D.length;H++){var L=D[H];w.put({seq:M,digestSeq:L+"::"+M})}K["continue"]()}):z()}}function n(y){function z(A){return A.data?fK(A):(A.deleted="1"===A.deletedOrLocal,A)}var x=y.objectStore(e7),w=y.objectStore(cA),v=w.openCursor();v.onsuccess=function(C){function D(){var H=A.id+"::",F=A.id+"::￿",G=x.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return A.seq=I,B()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function B(){var G=ay(A,A.winningRev,A.deleted),F=w.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var A=z(E.value);return A.winningRev=A.winningRev||jY(A),A.seq?B():void D()}}}var s=m.name,o=null;l._meta=null,l.type=function(){return"idb"},l._id=eK(function(v){v(null,l._meta.instanceId)}),l._bulkDocs=function(v,w,x){bB(m,v,w,l,o,el,x)},l._get=function(z,D,C){function x(){C(A,{doc:y,metadata:w,ctx:v})}var y,w,A,v=D.ctx;if(!v){var B=cR(o,[cA,e7,cK],"readonly");if(B.error){return C(B.error)}v=B.txn}v.objectStore(cA).get(z).onsuccess=function(E){if(w=fK(E.target.result),!w){return A=cU(bz,"missing"),x()}if(cP(w)&&!D.rev){return A=cU(bz,"deleted"),x()}var G=v.objectStore(e7),H=D.rev||w.winningRev,F=w.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return y=I.target.result,y&&(y=jV(y)),y?void x():(A=cU(bz,"missing"),x())}}},l._getAttachment=function(z,D,C,x,y){var w;if(x.ctx){w=x.ctx}else{var A=cR(o,[cA,e7,cK],"readonly");if(A.error){return y(A.error)}w=A.txn}var v=C.digest,B=C.content_type;w.objectStore(cK).get(v).onsuccess=function(E){var F=E.target.result.body;bl(F,B,x.binary,function(G){y(null,G)})}},l._info=function(A){if(null===o||!bX.has(s)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var x,w,v=cR(o,[e7],"readonly");if(v.error){return A(v.error)}var z=v.txn,B=z.objectStore(e7).openCursor(null,"prev");B.onsuccess=function(D){var C=D.target.result;x=C?C.key:0,w=l._meta.docCount},z.oncomplete=function(){A(null,{doc_count:w,update_seq:x,idb_attachment_format:l._meta.blobSupport?"binary":"base64"})}},l._allDocs=function(v,w){bu(v,l,o,w)},l._changes=function(C){function w(N){function T(){return S.seq!==O?N["continue"]():(K=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=B.get(U);V.onsuccess=function(W){R(jV(W.target.result))}}function R(V){var W=C.processChange(V,S,C);W.seq=S.seq;var U=H(W);return"object"==typeof U?C.complete(U):(U&&(x++,L&&M.push(W),C.attachments&&C.include_docs?aO(V,C,F,function(){bk([W],C.binary).then(function(){C.onChange(W)})}):C.onChange(W)),void (x!==J&&N["continue"]()))}var P=jV(N.value),O=N.key;if(E&&!E.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (D.get(P._id).onsuccess=function(U){S=fK(U.target.result),y.set(P._id,S),T()})}function A(N){var O=N.target.result;O&&w(O)}function v(){var P=[cA,e7];C.attachments&&P.push(cK);var O=cR(o,P,"readonly");if(O.error){return C.complete(O.error)}F=O.txn,F.onabort=bM(C.complete),F.oncomplete=G,z=F.objectStore(e7),D=F.objectStore(cA),B=z.index("_doc_id_rev");var N;N=C.descending?z.openCursor(null,"prev"):z.openCursor(IDBKeyRange.lowerBound(C.since,!0)),N.onsuccess=A}function G(){function N(){C.complete(null,{results:M,last_seq:K})}!C.continuous&&C.attachments?bk(M).then(N):N()}if(C=c1(C),C.continuous){var I=s+":"+fH();return el.addListener(s,I,l,C),el.notify(s),{cancel:function(){el.removeListener(s,I)}}}var E=C.doc_ids&&new cz.Set(C.doc_ids);C.since=C.since||0;var K=C.since,J="limit" in C?C.limit:-1;0===J&&(J=1);var L;L="return_docs" in C?C.return_docs:"returnDocs" in C?C.returnDocs:!0;var F,z,D,B,M=[],x=0,H=eU(C),y=new cz.Map;v()},l._close=function(v){return null===o?v(cU(e6)):(o.close(),bX["delete"](s),o=null,void v())},l._getRevisionTree=function(y,z){var x=cR(o,[cA],"readonly");if(x.error){return z(x.error)}var w=x.txn,v=w.objectStore(cA).get(y);v.onsuccess=function(B){var A=fK(B.target.result);A?z(null,A.rev_tree):z(cU(bz))}},l._doCompaction=function(y,A,w){var B=[cA,e7,cK,dQ],x=cR(o,B,"readwrite");if(x.error){return w(x.error)}var v=x.txn,z=v.objectStore(cA);z.get(y).onsuccess=function(E){var C=fK(E.target.result);bP(C.rev_tree,function(I,K,H,J,G){var L=K+"-"+H;-1!==A.indexOf(L)&&(G.status="missing")}),bs(A,y,v);var D=C.winningRev,F=C.deleted;v.objectStore(cA).put(ay(C,D,F))},v.onabort=bM(w),v.oncomplete=function(){w()}},l._getLocal=function(y,z){var x=cR(o,[jL],"readonly");if(x.error){return z(x.error)}var w=x.txn,v=w.objectStore(jL).get(y);v.onerror=bM(z),v.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,z(null,A)):z(cU(bz))}},l._putLocal=function(z,E,C){"function"==typeof E&&(C=E,E={}),delete z._revisions;var x=z._rev,y=z._id;x?z._rev="0-"+(parseInt(x.split("-")[1],10)+1):z._rev="0-1";var w,B=E.ctx;if(!B){var v=cR(o,[jL],"readwrite");if(v.error){return C(v.error)}B=v.txn,B.onerror=bM(C),B.oncomplete=function(){w&&C(null,w)}}var D,A=B.objectStore(jL);x?(D=A.get(y),D.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===x){var F=A.put(z);F.onsuccess=function(){w={ok:!0,id:z._id,rev:z._rev},E.ctx&&C(null,w)}}else{C(cU(eH))}}):(D=A.add(z),D.onerror=function(F){C(cU(eH)),F.preventDefault(),F.stopPropagation()},D.onsuccess=function(){w={ok:!0,id:z._id,rev:z._rev},E.ctx&&C(null,w)})},l._removeLocal=function(z,D,C){"function"==typeof D&&(C=D,D={});var x=D.ctx;if(!x){var y=cR(o,[jL],"readwrite");if(y.error){return C(y.error)}x=y.txn,x.oncomplete=function(){w&&C(null,w)}}var w,A=z._id,v=x.objectStore(jL),B=v.get(A);B.onerror=bM(C),B.onsuccess=function(F){var E=F.target.result;E&&E._rev===z._rev?(v["delete"](A),w={ok:!0,id:A,rev:"0-0"},D.ctx&&C(null,w)):C(cU(bz))}},l._destroy=function(x,v){el.removeAllListeners(s);var y=kf.get(s);y&&y.result&&(y.result.close(),bX["delete"](s));var w=indexedDB.deleteDatabase(s);w.onsuccess=function(){kf["delete"](s),dd()&&s in localStorage&&delete localStorage[s],v(null,{ok:!0})},w.onerror=bM(v)};var j=bX.get(s);if(j){return o=j.idb,l._meta=j.global,void eO.nextTick(function(){q(null,l)})}var r;r=m.storage?aG(s,m.storage):indexedDB.open(s,dG),kf.set(s,r),r.onupgradeneeded=function(z){function x(){var B=w[A-1];A++,B&&B(y,x)}var v=z.target.result;if(z.oldVersion<1){return u(v)}var y=z.currentTarget.transaction;z.oldVersion<3&&p(v),z.oldVersion<4&&h(v);var w=[g,k,i,n],A=z.oldVersion;x()},r.onsuccess=function(v){o=v.target.result,o.onversionchange=function(){o.close(),bX["delete"](s)},o.onabort=function(B){aL("error","Database has a global failure",B.target.error),o.close(),bX["delete"](s)};var y=o.transaction([bT,aq,cA],"readwrite"),w=y.objectStore(bT).get(bT),z=null,x=null,A=null;w.onsuccess=function(D){var B=function(){null!==z&&null!==x&&null!==A&&(l._meta={name:s,instanceId:A,blobSupport:z,docCount:x},bX.set(s,{idb:o,global:l._meta}),q(null,l))},E=D.target.result||{id:bT};s+"_id" in E?(A=E[s+"_id"],B()):(A=fH(),E[s+"_id"]=A,y.objectStore(bT).put(E).onsuccess=function(){B()}),c2||(c2=b1(y)),c2.then(function(F){z=F,B()});var C=y.objectStore(cA).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){x=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";aL("error",v),q(cU(eW,v))}}function aG(i,h){try{return indexedDB.open(i,{version:dG,storage:h})}catch(g){return indexedDB.open(i,dG)}}function b4(g){g.adapter("idb",j7,!0)}function b5(g){return decodeURIComponent(escape(g))}function aM(g){return 65>g?g-48:g-55}function al(h,j,i){for(var g="";i>j;){g+=String.fromCharCode(aM(h.charCodeAt(j++))<<4|aM(h.charCodeAt(j++)))}return g}function aw(h,j,i){for(var g="";i>j;){g+=String.fromCharCode(aM(h.charCodeAt(j+2))<<12|aM(h.charCodeAt(j+3))<<8|aM(h.charCodeAt(j))<<4|aM(h.charCodeAt(j+1))),j+=4}return g}function bY(g,h){return"UTF-8"===h?b5(al(g,0,g.length)):aw(g,0,g.length)}function bf(g){return"'"+g+"'"}function aS(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function bh(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function aJ(g){return delete g._id,delete g._rev,JSON.stringify(g)}function c5(i,h,g){return i=JSON.parse(i),i._id=h,i._rev=g,i}function dM(g){for(var h="(";g--;){h+="?",g&&(h+=",")}return h+")"}function cH(i,g,k,h,j){return"SELECT "+i+" FROM "+("string"==typeof g?g:g.join(" JOIN "))+(k?" ON "+k:"")+(h?" WHERE "+("string"==typeof h?h:h.join(" AND ")):"")+(j?" ORDER BY "+j:"")}function aH(l,j,g){function k(){++i===l.length&&m()}function m(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+aW+" WHERE seq IN "+dM(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+aW+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(u){var v="SELECT digest FROM "+aW+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";u.executeSql(v,s,function(x,y){for(var w=new cz.Set,z=0;z<y.rows.length;z++){w.add(y.rows.item(z).digest)}s.forEach(function(A){w.has(A)||(x.executeSql("DELETE FROM "+aW+" WHERE digest=?",[A]),x.executeSql("DELETE FROM "+am+" WHERE digest=?",[A]))})})})}})}}if(l.length){var i=0,h=[];l.forEach(function(n){var o="SELECT seq FROM "+j6+" WHERE doc_id=? AND rev=?";g.executeSql(o,[j,n],function(q,p){if(!p.rows.length){return k()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+j6+" WHERE seq=?",[r],k)})})}}function dl(g){return function(h){aL("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(cU(jR,j,i))}}function cy(g){if("size" in g){return 1000000*g.size}var h="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return h?5000000:1}function cX(y,j,n,k,m,q,l){function i(){return w?l(w):(q.notify(k._name),k._docCount=-1,void l(null,r))}function v(E,D){var F="SELECT count(*) as cnt FROM "+am+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=cU(ck,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function h(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){v(I,function(J){J&&!E&&(E=J),D()})})}function x(E,M,H,R,P,J,O,L){function G(){function X(ar,a0){function at(){return ++ao===an.length&&a0(),!1}function ai(a2){var a3="INSERT INTO "+aW+" (digest, seq) VALUES (?,?)",a1=[W._attachments[a2].digest,ar];p.executeSql(a3,a1,at,at)}var ao=0,an=Object.keys(W._attachments||{});if(!an.length){return a0()}for(var ae=0;ae<an.length;ae++){ai(an[ae])}}var W=E.data,Z=R?1:0,U=W._id,Y=W._rev,S=aJ(W),T="INSERT INTO "+j6+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",V=[U,Y,S,Z];p.executeSql(T,V,function(ai,ae){var an=ae.insertId;X(an,function(){F(ai,an)})},function(){var ae=cH("seq",j6,null,"doc_id=? AND rev=?");return p.executeSql(ae,[U,Y],function(an,ao){var ar=ao.rows.item(0).seq,ai="UPDATE "+j6+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[S,Z,U,Y];an.executeSql(ai,at,function(a0){X(ar,function(){F(a0,ar)})})}),!1})}function D(S){Q||(S?(Q=S,L(Q)):K===I.length&&G())}function N(S){K++,D(S)}function F(S,Y){var U=E.metadata.id,T=E.stemmedRevs||[];P&&k.auto_compaction&&(T=cI(E.metadata).concat(T)),T.length&&aH(T,U,S),E.metadata.seq=Y,delete E.metadata.rev;var V=P?"UPDATE "+cv+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+j6+" WHERE doc_id="+cv+".id AND rev=?) WHERE id=?":"INSERT INTO "+cv+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",W=jW(E.metadata),X=P?[W,Y,M,U]:[U,Y,Y,W];S.executeSql(V,X,function(){r[O]={ok:!0,id:E.metadata.id,rev:M},A.set(U,E.metadata),L()})}var Q=null,K=0;E.data._id=E.metadata.id,E.data._rev=E.metadata.rev;var I=Object.keys(E.data._attachments||{});R&&(E.data._deleted=!0),I.forEach(function(S){var U=E.data._attachments[S];if(U.stub){K++,D()}else{var V=U.data;delete U.data,U.revpos=parseInt(M,10);var T=U.digest;s(T,V,N)}}),I.length||G()}function C(){aE(y.revs_limit,o,k,A,p,r,x,n)}function g(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&fB(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+cv+" WHERE id = ?",[H],function(K,J){if(J.rows.length){var I=j0(J.rows.item(0).json);A.set(H,I)}D()})})}function s(F,D,G){var E="SELECT digest FROM "+am+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+am+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,aS(D)],function(){G()},function(){return G(),!1}))})}var B=n.new_edits,u=j.docs,o=u.map(function(E){if(E._id&&fB(E._id)){return E}var D=bq(E,B);return D}),z=o.filter(function(D){return D.error});if(z.length){return l(z[0])}var p,w,r=new Array(o.length),A=new cz.Map;cp(o,"binary",function(D){return D?l(D):void m.transaction(function(E){p=E,h(function(F){F?w=F:g(C)})},dl(l),i)})}function dW(g){return g.websql(g.name,g.version,g.description,g.size)}function cQ(g){try{return{db:dW(g)}}catch(h){return{error:h}}}function c7(g){var h=b7.get(g.name);return h||(h=cQ(g),b7.set(g.name,h),h.db&&(h.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),h}function cB(j,l,h,n,g){function i(){++m===o.length&&g&&g()}function k(q,s){var r=q._attachments[s],p={binary:l.binary,ctx:n};h._getAttachment(q._id,s,r,p,function(v,u){q._attachments[s]=dm.extend(eX(r,["digest","content_type"]),{data:u}),i()})}var o=Object.keys(j._attachments||{});if(!o.length){return g&&g()}var m=0;o.forEach(function(p){l.attachments&&l.include_docs?k(j,p):(j._attachments[p].stub=!0,i())})}function a8(A,n){function s(){dd()&&(window.localStorage["_pouch__websqldb_"+B._name]=!0),n(null,B)}function o(F,E){F.executeSql(jT),F.executeSql("ALTER TABLE "+j6+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(dL),F.executeSql("ALTER TABLE "+cv+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+cv+" (local, id)");var G="SELECT "+cv+".winningseq AS seq, "+cv+".json AS metadata FROM "+j6+" JOIN "+cv+" ON "+j6+".seq = "+cv+".winningseq";F.executeSql(G,[],function(H,L){for(var O=[],J=[],K=0;K<L.rows.length;K++){var M=L.rows.item(K),N=M.seq,I=JSON.parse(M.metadata);cP(I)&&O.push(N),fB(I.id)&&J.push(I.id)}H.executeSql("UPDATE "+cv+"SET local = 1 WHERE id IN "+dM(J.length),J,function(){H.executeSql("UPDATE "+j6+" SET deleted = 1 WHERE seq IN "+dM(O.length),O,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+a9+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+cv+".id AS id, "+j6+".json AS data FROM "+j6+" JOIN "+cv+" ON "+j6+".seq = "+cv+".winningseq WHERE local = 1";F.executeSql(H,[],function(J,L){function I(){if(!K.length){return E(J)}var O=K.shift(),N=JSON.parse(O.data)._rev;J.executeSql("INSERT INTO "+a9+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+cv+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+j6+" WHERE seq=?",[O.seq],function(){I()})})})}for(var K=[],M=0;M<L.rows.length;M++){K.push(L.rows.item(M))}I()})})}function j(G,E){function H(I){function J(){if(!I.length){return E(G)}var P=I.shift(),N=bY(P.hex,m),K=N.lastIndexOf("::"),O=N.substring(0,K),M=N.substring(K+2),L="UPDATE "+j6+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(L,[O,M,N],function(){J()})}J()}var F="ALTER TABLE "+j6+" ADD COLUMN doc_id";G.executeSql(F,[],function(I){var J="ALTER TABLE "+j6+" ADD COLUMN rev";I.executeSql(J,[],function(K){K.executeSql(ag,[],function(M){var L="SELECT hex(doc_id_rev) as hex FROM "+j6;M.executeSql(L,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function D(G,E){function H(J){var I="SELECT COUNT(*) AS cnt FROM "+am;J.executeSql(I,[],function(O,K){function N(){var Q=cH(bj+", "+cv+".id AS id",[cv,j6],bN,null,cv+".id ");Q+=" LIMIT "+L+" OFFSET "+M,M+=L,O.executeSql(Q,[],function(ai,U){function Z(at,ar){var ao=W[at]=W[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!U.rows.length){return E(ai)}for(var W={},R=0;R<U.rows.length;R++){for(var T=U.rows.item(R),S=c5(T.data,T.id,T.rev),X=Object.keys(S._attachments||{}),an=0;an<X.length;an++){var V=S._attachments[X[an]];Z(V.digest,T.seq)}}var Y=[];if(Object.keys(W).forEach(function(ar){var ao=W[ar];ao.forEach(function(at){Y.push([ar,at])})}),!Y.length){return N()}var ae=0;Y.forEach(function(ao){var ar="INSERT INTO "+aW+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++ae===Y.length&&N()})})})}var P=K.rows.item(0).cnt;if(!P){return E(O)}var M=0,L=10;N()})}var F="CREATE TABLE IF NOT EXISTS "+aW+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(ej,[],function(J){J.executeSql(cW,[],H)})})}function w(F,E){var G="ALTER TABLE "+am+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function v(F,E){var G="ALTER TABLE "+cv+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+cv+" SET max_seq=(SELECT MAX(seq) FROM "+j6+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+cv+" (max_seq)";J.executeSql(K,[],E)})})}function y(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;m=2===H.length?"UTF-8":"UTF-16",E()})}function C(){for(;z.length>0;){var E=z.pop();E(null,g)}}function x(F,N){if(0===N){var K="CREATE TABLE IF NOT EXISTS "+f4+" (dbid, db_version INTEGER)",H="CREATE TABLE IF NOT EXISTS "+am+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",E="CREATE TABLE IF NOT EXISTS "+aW+" (digest, seq INTEGER)",O="CREATE TABLE IF NOT EXISTS "+cv+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",P="CREATE TABLE IF NOT EXISTS "+j6+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",J="CREATE TABLE IF NOT EXISTS "+a9+" (id UNIQUE, rev, json)";F.executeSql(H),F.executeSql(J),F.executeSql(E,[],function(){F.executeSql(cW),F.executeSql(ej)}),F.executeSql(O,[],function(){F.executeSql(jT),F.executeSql(P,[],function(){F.executeSql(dL),F.executeSql(ag),F.executeSql(K,[],function(){var R="INSERT INTO "+f4+" (db_version, dbid) VALUES (?,?)";g=fH();var Q=[bL,g];F.executeSql(R,Q,function(){C()})})})})}else{var L=function(){var Q=bL>N;Q&&F.executeSql("UPDATE "+f4+" SET db_version = "+bL);var R="SELECT dbid FROM "+f4;F.executeSql(R,[],function(T,S){g=S.rows.item(0).dbid,C()})},I=[o,p,j,D,w,v,L],G=N,M=function(Q){I[G-1](Q,M),G++};M(F)}}function h(){i.transaction(function(E){y(E,function(){r(E)})},dl(n),s)}function r(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+f4;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+f4,[],function(K,J){var I=J.rows.item(0).db_version;x(K,I)}):H.executeSql("ALTER TABLE "+f4+" ADD COLUMN db_version INTEGER",[],function(){x(H,1)}):x(H,0)})}function k(F,E){if(-1!==B._docCount){return E(B._docCount)}var G=cH("COUNT("+cv+".id) AS 'num'",[cv,j6],bN,j6+".deleted=0");F.executeSql(G,[],function(I,H){B._docCount=H.rows.item(0).num,E(B._docCount)})}var m,B=this,g=null,u=cy(A),z=[];B._docCount=-1,B._name=A.name;var l=dm.extend({},A,{version:j5,description:A.name,size:u}),q=c7(l);if(q.error){return dl(n)(q.error)}var i=q.db;"function"!=typeof i.readTransaction&&(i.readTransaction=i.transaction),h(),B.type=function(){return"websql"},B._id=eK(function(E){E(null,g)}),B._info=function(E){i.readTransaction(function(F){k(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+j6;F.executeSql(G,[],function(J,K){var I=K.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:I,sqlite_plugin:i._sqlitePlugin,websql_encoding:m})})})},dl(E))},B._bulkDocs=function(E,G,F){cX(A,E,G,B,i,ab,F)},B._get=function(I,J,G){function N(){G(L,{doc:E,metadata:H,ctx:F})}var E,H,L,F=J.ctx;if(!F){return i.readTransaction(function(O){B._get(I,dm.extend({ctx:O},J),G)})}var M,K;J.rev?(M=cH(bj,[cv,j6],cv+".id="+j6+".doc_id",[j6+".doc_id=?",j6+".rev=?"]),K=[I,J.rev]):(M=cH(bj,[cv,j6],bN,cv+".id=?"),K=[I]),F.executeSql(M,K,function(O,P){if(!P.rows.length){return L=cU(bz,"missing"),N()}var Q=P.rows.item(0);return H=j0(Q.metadata),Q.deleted&&!J.rev?(L=cU(bz,"deleted"),N()):(E=c5(Q.data,H.id,Q.rev),void N())})},B._allDocs=function(L,H){var I,P=[],R="startkey" in L?L.startkey:!1,M="endkey" in L?L.endkey:!1,F="key" in L?L.key:!1,J="descending" in L?L.descending:!1,G="limit" in L?L.limit:-1,E="skip" in L?L.skip:0,O=L.inclusive_end!==!1,K=[],Q=[];if(F!==!1){Q.push(cv+".id = ?"),K.push(F)}else{if(R!==!1||M!==!1){if(R!==!1&&(Q.push(cv+".id "+(J?"<=":">=")+" ?"),K.push(R)),M!==!1){var N=J?">":"<";O&&(N+="="),Q.push(cv+".id "+N+" ?"),K.push(M)}F!==!1&&(Q.push(cv+".id = ?"),K.push(F))}}"ok"!==L.deleted&&Q.push(j6+".deleted = 0"),i.readTransaction(function(S){k(S,function(T){if(I=T,0!==G){var U=cH(bj,[cv,j6],bN,Q,cv+".id "+(J?"DESC":"ASC"));U+=" LIMIT "+G+" OFFSET "+E,S.executeSql(U,K,function(X,ai){for(var Z=0,ar=ai.rows.length;ar>Z;Z++){var W=ai.rows.item(Z),Y=j0(W.metadata),ao=Y.id,V=c5(W.data,ao,W.rev),an=V._rev,ae={id:ao,key:ao,value:{rev:an}};if(L.include_docs&&(ae.doc=V,ae.doc._rev=an,L.conflicts&&(ae.doc._conflicts=aI(Y)),cB(ae.doc,L,B,X)),W.deleted){if("ok"!==L.deleted){continue}ae.value.deleted=!0,ae.doc=null}P.push(ae)}})}})},dl(H),function(){H(null,{total_rows:I,offset:L.skip,rows:P})})},B._changes=function(L){function E(){var S=cv+".json AS metadata, "+cv+".max_seq AS maxSeq, "+j6+".json AS winningDoc, "+j6+".rev AS winningRev ",T=cv+" JOIN "+j6,R=cv+".id="+j6+".doc_id AND "+cv+".winningseq="+j6+".seq",Q=["maxSeq > ?"],O=[L.since];L.doc_ids&&(Q.push(cv+".id IN "+dM(L.doc_ids.length)),O=O.concat(L.doc_ids));var U="maxSeq "+(I?"DESC":"ASC"),N=cH(S,T,R,Q,U),M=eU(L);L.view||L.filter||(N+=" LIMIT "+F);var P=L.since||0;i.readTransaction(function(V){V.executeSql(N,O,function(ar,at){function ao(a0){return function(){L.onChange(a0)}}for(var Z=0,Y=at.rows.length;Y>Z;Z++){var X=at.rows.item(Z),W=j0(X.metadata);P=X.maxSeq;var ae=c5(X.winningDoc,W.id,X.winningRev),an=L.processChange(ae,W,L);an.seq=X.maxSeq;var ai=M(an);if("object"==typeof ai){return L.complete(ai)}if(ai&&(H++,K&&J.push(an),L.attachments&&L.include_docs?cB(ae,L,B,ar,ao(an)):ao(an)()),H===F){break}}})},dl(L.complete),function(){L.continuous||L.complete(null,{results:J,last_seq:P})})}if(L=c1(L),L.continuous){var G=B._name+":"+fH();return ab.addListener(B._name,G,B,L),ab.notify(B._name),{cancel:function(){ab.removeListener(B._name,G)}}}var I=L.descending;L.since=L.since&&!I?L.since:0;var F="limit" in L?L.limit:-1;0===F&&(F=1);var K;K="return_docs" in L?L.return_docs:"returnDocs" in L?L.returnDocs:!0;var J=[],H=0;E()},B._close=function(E){E()},B._getAttachment=function(I,J,G,N,E){var H,L=N.ctx,F=G.digest,M=G.content_type,K="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+am+" WHERE digest=?";L.executeSql(K,[F],function(P,O){var Q=O.rows.item(0),R=Q.escaped?bh(Q.body):bY(Q.body,m);H=N.binary?jM(R,M):dV(R),E(null,H)})},B._getRevisionTree=function(F,E){i.readTransaction(function(H){var G="SELECT json AS metadata FROM "+cv+" WHERE id = ?";H.executeSql(G,[F],function(K,I){if(I.rows.length){var J=j0(I.rows.item(0).metadata);E(null,J.rev_tree)}else{E(cU(bz))}})})},B._doCompaction=function(F,E,G){return E.length?void i.transaction(function(H){var I="SELECT json AS metadata FROM "+cv+" WHERE id = ?";H.executeSql(I,[F],function(K,M){var J=j0(M.rows.item(0).metadata);bP(J.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var L="UPDATE "+cv+" SET json = ? WHERE id = ?";K.executeSql(L,[jW(J),F])}),aH(E,F,H)},dl(G),function(){G()}):G()},B._getLocal=function(F,E){i.readTransaction(function(H){var G="SELECT json, rev FROM "+a9+" WHERE id=?";H.executeSql(G,[F],function(K,I){if(I.rows.length){var J=I.rows.item(0),L=c5(J.json,F,J.rev);E(null,L)}else{E(cU(bz))}})})},B._putLocal=function(K,F,I){function G(N){var P,O;J?(P="UPDATE "+a9+" SET rev=?, json=? WHERE id=? AND rev=?",O=[H,E,M,J]):(P="INSERT INTO "+a9+" (id, rev, json) VALUES (?,?,?)",O=[M,H,E]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(L={ok:!0,id:M,rev:H},F.ctx&&I(null,L)):I(cU(eH))},function(){return I(cU(eH)),!1})}"function"==typeof F&&(I=F,F={}),delete K._revisions;var H,J=K._rev,M=K._id;H=J?K._rev="0-"+(parseInt(J.split("-")[1],10)+1):K._rev="0-1";var L,E=aJ(K);F.ctx?G(F.ctx):i.transaction(G,dl(I),function(){L&&I(null,L)})},B._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+a9+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(cU(bz))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):i.transaction(G,dl(E),function(){I&&E(null,I)})},B._destroy=function(F,E){ab.removeAllListeners(B._name),i.transaction(function(H){var G=[cv,j6,am,f4,a9,aW];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},dl(E),function(){dd()&&(delete window.localStorage["_pouch__websqldb_"+B._name],delete window.localStorage[B._name]),E(null,{ok:!0})})}}function bU(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function dI(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var i=dd(),h="_pouch__websqldb_valid_"+navigator.userAgent;if(i&&localStorage[h]){return"1"===localStorage[h]}var g=bU();return i&&(localStorage[h]=g?"1":"0"),g}function aT(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:dI()}function kc(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=dm.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function eI(h,j){var i=kc(h),g=dm.extend({websql:i},h);a8.call(this,g,j)}function jF(g){g.adapter("websql",eI,!0)}function cF(){for(var h={},j=new dO(function(k,l){h.resolve=k,h.reject=l}),i=new Array(arguments.length),g=0;g<i.length;g++){i[g]=arguments[g]}return h.promise=j,dO.resolve().then(function(){return fetch.apply(null,i)}).then(function(k){h.resolve(k)})["catch"](function(k){h.reject(k)}),h}function fN(l,j){var g,k,m,i=new Headers,h={method:l.method,credentials:"include",headers:i};return l.json&&(i.set("Accept","application/json"),i.set("Content-Type",l.headers["Content-Type"]||"application/json")),l.body&&l.body instanceof Blob?db(l.body,function(n){h.body=n}):l.body&&l.processData&&"string"!=typeof l.body?h.body=JSON.stringify(l.body):"body" in l?h.body=l.body:h.body=null,Object.keys(l.headers).forEach(function(n){l.headers.hasOwnProperty(n)&&i.set(n,l.headers[n])}),g=cF(l.url,h),l.timeout>0&&(k=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+l.url))},l.timeout)),g.promise.then(function(n){return m={statusCode:n.status},l.timeout>0&&clearTimeout(k),m.statusCode>=200&&m.statusCode<300?l.binary?n.blob():n.text():n.json()}).then(function(n){m.statusCode>=200&&m.statusCode<300?j(null,m,n):j(n,m)})["catch"](function(n){j(n,m)}),{abort:g.reject}}function e1(j,l){var h,n,g=!1,i=function(){h.abort()},k=function(){g=!0,h.abort()};h=j.xhr?new j.xhr:new XMLHttpRequest;try{h.open(j.method,j.url)}catch(o){l(o,{statusCode:413})}h.withCredentials="withCredentials" in j?j.withCredentials:!0,"GET"===j.method?delete j.headers["Content-Type"]:j.json&&(j.headers.Accept="application/json",j.headers["Content-Type"]=j.headers["Content-Type"]||"application/json",j.body&&j.processData&&"string"!=typeof j.body&&(j.body=JSON.stringify(j.body))),j.binary&&(h.responseType="arraybuffer"),"body" in j||(j.body=null);for(var m in j.headers){j.headers.hasOwnProperty(m)&&h.setRequestHeader(m,j.headers[m])}return j.timeout>0&&(n=setTimeout(k,j.timeout),h.onprogress=function(){clearTimeout(n),4!==h.readyState&&(n=setTimeout(k,j.timeout))},"undefined"!=typeof h.upload&&(h.upload.onprogress=h.onprogress)),h.onreadystatechange=function(){if(4===h.readyState){var s={statusCode:h.status};if(h.status>=200&&h.status<300){var q;q=j.binary?e3([h.response||""],{type:h.getResponseHeader("Content-Type")}):h.responseText,l(null,s,q)}else{var p={};if(g){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(h.response)}catch(r){}}l(p,s)}}},j.body&&j.body instanceof Blob?db(j.body,function(p){h.send(p)}):h.send(j.body),{abort:i}}function bC(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function dT(g,h){return bD||g.xhr?e1(g,h):fN(g,h)}function jZ(){return""}function bK(i,g){function k(o,n,l){if(!i.binary&&i.json&&"string"==typeof o){try{o=JSON.parse(o)}catch(m){return l(m)}}Array.isArray(o)&&(o=o.map(function(p){return p.error||p.missing?bJ(p):p})),i.binary&&az(o,n),l(null,o,n)}function h(p,n){var l,o;if(p.code&&p.status){var q=new Error(p.message||p.code);return q.status=p.status,n(q)}if(p.message&&"ETIMEDOUT"===p.message){return n(p)}try{l=JSON.parse(p.responseText),o=bJ(l)}catch(m){o=bJ(p)}n(o)}i=c1(i);var j={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return i=dm.extend(j,i),i.json&&(i.binary||(i.headers.Accept="application/json"),i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json"),i.binary&&(i.encoding=null,i.json=!1),i.processData||(i.json=!1),dT(i,function(p,m,r){if(p){return p.status=m?m.statusCode:400,h(p,g)}var n,l=m.headers&&m.headers["content-type"],q=r||jZ();if(!i.binary&&(i.json||!i.processData)&&"object"!=typeof q&&(/json/.test(l)||/^[\s]*\{/.test(q)&&/\}[\s]*$/.test(q))){try{q=JSON.parse(q.toString())}catch(o){}}m.statusCode>=200&&m.statusCode<300?k(q,m,g):(n=bJ(q),n.status=m.statusCode,g(n))})}function dD(l,o){var j=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",h=-1!==j.indexOf("safari")&&-1===j.indexOf("chrome"),i=-1!==j.indexOf("msie"),k=-1!==j.indexOf("edge"),m=h||(i||k)&&"GET"===l.method,g="cache" in l?l.cache:!0,n=/^blob:/.test(l.url);if(!n&&(m||!g)){var p=-1!==l.url.indexOf("?");l.url+=(p?"&":"?")+"_nonce="+Date.now()}return bK(l,o)}function eL(g){var h=g.doc&&g.doc._attachments;h&&Object.keys(h).forEach(function(i){var j=h[i];j.data=j1(j.data,j.content_type)})}function ek(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function j4(g){return g._attachments&&Object.keys(g._attachments)?dO.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new dO(function(j){dj(i.data,j)}).then(function(j){i.data=j}):void 0})):dO.resolve()}function cb(i){var h=bH(i);(h.user||h.password)&&(h.auth={username:h.user,password:h.password});var g=h.path.replace(/(^\/|\/$)/g,"").split("/");return h.db=g.pop(),-1===h.db.indexOf("%")&&(h.db=encodeURIComponent(h.db)),h.path=g.join("/"),h}function dA(g,h){return eS(g,g.db+"/"+h)}function eS(i,h){var g=i.path?"/":"";return i.protocol+"://"+i.host+(i.port?":"+i.port:"")+"/"+i.path+g+h}function ep(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function fP(j,o){function w(A,z,x){var y=A.ajax||{},B=dm.extend(c1(q),y,z);return b0(B.method+" "+B.url),k._ajax(B,x)}function p(y,x){return new dO(function(z,A){w(y,x,function(C,B){return C?A(C):void z(B)})})}function v(y,x){return f5(y,au(function(z){u().then(function(){return x.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function u(){if(j.skipSetup||j.skip_setup){return dO.resolve()}if(h){return h}var x={method:"GET",url:s};return h=p({},x)["catch"](function(y){return y&&y.status&&404===y.status?(av(404,"PouchDB is just detecting if the remote exists."),p({},{method:"PUT",url:s})):dO.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:dO.reject(y)}),h["catch"](function(){h=null}),h}function g(x){return x.split("/").map(encodeURIComponent).join("/")}var k=this,r=cb;j.getHost&&(r=j.getHost);var i=r(j.name,j),s=dA(i,"");j=c1(j);var q=j.ajax||{};if(k.getUrl=function(){return s},k.getHeaders=function(){return q.headers||{}},j.auth||i.auth){var n=j.auth||i.auth,m=n.username+":"+n.password,l=dV(unescape(encodeURIComponent(m)));q.headers=q.headers||{},q.headers.Authorization="Basic "+l}k._ajax=dD;var h;setTimeout(function(){o(null,k)}),k.type=function(){return"http"},k.id=v("id",function(x){w({},{method:"GET",url:eS(i,"")},function(y,A){var z=A&&A.uuid?A.uuid+i.db:dA(i,"");x(null,z)})}),k.request=v("request",function(y,x){y.url=dA(i,y.url),w({},y,x)}),k.compact=v("compact",function(y,x){"function"==typeof y&&(x=y,y={}),y=c1(y),w(y,{url:dA(i,"_compact"),method:"POST"},function(){function z(){k.info(function(A,B){B&&!B.compact_running?x(null,{ok:!0}):setTimeout(z,y.interval||200)})}z()})}),k.bulkGet=f5("bulkGet",function(y,C){function B(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),w({},{url:dA(i,"_bulk_get"+ep(E)),method:"POST",body:{docs:y.docs}},F)}function A(){function H(L){return function(M,N){K[L]=N.results,++I===F&&C(null,{results:eA(K)})}}for(var E=dx,F=Math.ceil(y.docs.length/E),I=0,K=new Array(F),J=0;F>J;J++){var G=eX(y,["revs","attachments"]);G.ajax=q,G.docs=y.docs.slice(J*E,Math.min(y.docs.length,(J+1)*E)),eB(z,G,H(J))}}var z=this,D=eS(i,""),x=d7[D];"boolean"!=typeof x?B(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(d7[D]=!1,av(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),A()):C(E)}else{d7[D]=!0,C(null,F)}}):x?B(C):A()}),k._info=function(x){u().then(function(){w({},{method:"GET",url:dA(i,"")},function(y,z){return y?x(y):(z.host=dA(i,""),void x(null,z))})})["catch"](x)},k.get=v("get",function(C,y,B){function A(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?dO.all(E.map(function(I){var J=G[I],H=ek(F._id)+"/"+g(I)+"?rev="+F._rev;return p(y,{method:"GET",url:dA(i,H),binary:!0}).then(function(K){return y.binary?K:new dO(function(L){dj(K,L)})}).then(function(K){delete J.stub,delete J.length,J.data=K})})):void 0}function z(E){return Array.isArray(E)?dO.all(E.map(function(F){return F.ok?A(F.ok):void 0})):A(E)}"function"==typeof y&&(B=y,y={}),y=c1(y);var x={};y.revs&&(x.revs=!0),y.revs_info&&(x.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),x.open_revs=y.open_revs),y.rev&&(x.rev=y.rev),y.conflicts&&(x.conflicts=y.conflicts),C=ek(C);var D={method:"GET",url:dA(i,C+ep(x))};p(y,D).then(function(E){return dO.resolve().then(function(){return y.attachments?z(E):void 0}).then(function(){B(null,E)})})["catch"](B)}),k.remove=v("remove",function(B,z,x,C){var y;"string"==typeof z?(y={_id:B,_rev:z},"function"==typeof x&&(C=x,x={})):(y=B,"function"==typeof z?(C=z,x={}):(C=x,x=z));var A=y._rev||x.rev;w(x,{method:"DELETE",url:dA(i,ek(y._id))+"?rev="+A},C)}),k.getAttachment=v("getAttachment",function(B,x,z,y){"function"==typeof z&&(y=z,z={});var A=z.rev?"?rev="+z.rev:"",C=dA(i,ek(B))+"/"+g(x)+A;w(z,{method:"GET",url:C,binary:!0},y)}),k.removeAttachment=v("removeAttachment",function(A,z,y,x){var B=dA(i,ek(A)+"/"+g(z))+"?rev="+y;w({},{method:"DELETE",url:B},x)}),k.putAttachment=v("putAttachment",function(F,y,A,B,D,z){"function"==typeof D&&(z=D,D=B,B=A,A=null);var x=ek(F)+"/"+g(y),H=dA(i,x);if(A&&(H+="?rev="+A),"string"==typeof B){var C;try{C=eQ(B)}catch(G){return z(cU(dF,"Attachment is not a valid base64 string"))}B=C?jM(C,D):""}var E={headers:{"Content-Type":D},method:"PUT",url:H,processData:!1,body:B,timeout:q.timeout||60000};w({},E,z)}),k._bulkDocs=function(z,x,y){z.new_edits=x.new_edits,u().then(function(){return dO.all(z.docs.map(j4))}).then(function(){w(x,{method:"POST",url:dA(i,"_bulk_docs"),body:z},function(B,A){return B?y(B):(A.forEach(function(C){C.ok=!0}),void y(null,A))})})["catch"](y)},k.allDocs=v("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=c1(C);var B,A={},z="GET";C.conflicts&&(A.conflicts=!0),C.descending&&(A.descending=!0),C.include_docs&&(A.include_docs=!0),C.attachments&&(A.attachments=!0),C.key&&(A.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(A.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(A.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(A.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(A.limit=C.limit),"undefined"!=typeof C.skip&&(A.skip=C.skip);var D=ep(A);if("undefined"!=typeof C.keys){var x="keys="+encodeURIComponent(JSON.stringify(C.keys));x.length+D.length+1<=f2?D+="&"+x:(z="POST",B={keys:C.keys})}p(C,{method:z,url:dA(i,"_all_docs"+D),body:B}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(eL),y(null,E)})["catch"](y)}),k._changes=function(B){var J="batch_size" in B?B.batch_size:cN;B=c1(B),B.timeout="timeout" in B?B.timeout:"timeout" in q?q.timeout:30000;var H,A=B.timeout?{timeout:B.timeout-5000}:{},D="undefined"!=typeof B.limit?B.limit:!1;H="return_docs" in B?B.return_docs:"returnDocs" in B?B.returnDocs:!0;var L=D;if(B.style&&(A.style=B.style),(B.include_docs||B.filter&&"function"==typeof B.filter)&&(A.include_docs=!0),B.attachments&&(A.attachments=!0),B.continuous&&(A.feed="longpoll"),B.conflicts&&(A.conflicts=!0),B.descending&&(A.descending=!0),"heartbeat" in B?B.heartbeat&&(A.heartbeat=B.heartbeat):A.heartbeat=10000,B.filter&&"string"==typeof B.filter&&(A.filter=B.filter),B.view&&"string"==typeof B.view&&(A.filter="_view",A.view=B.view),B.query_params&&"object"==typeof B.query_params){for(var y in B.query_params){B.query_params.hasOwnProperty(y)&&(A[y]=B.query_params[y])}}var F,x="GET";if(B.doc_ids){A.filter="_doc_ids";var I=JSON.stringify(B.doc_ids);I.length<f2?A.doc_ids=I:(x="POST",F={doc_ids:B.doc_ids})}var G,E,C=function(N,M){if(!B.aborted){A.since=N,"object"==typeof A.since&&(A.since=JSON.stringify(A.since)),B.descending?D&&(A.limit=L):A.limit=!D||L>J?J:L;var O={method:x,url:dA(i,"_changes"+ep(A)),timeout:B.timeout,body:F};E=N,B.aborted||u().then(function(){G=w(B,O,M)})["catch"](M)}},z={results:[]},K=function(O,Q){if(!B.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,z.last_seq=Q.last_seq;var M={};M.query=B.query_params,Q.results=Q.results.filter(function(R){L--;var S=eU(B)(R);return S&&(B.include_docs&&B.attachments&&B.binary&&eL(R),H&&z.results.push(R),B.onChange(R)),S})}else{if(O){return B.aborted=!0,void B.complete(O)}}Q&&Q.last_seq&&(E=Q.last_seq);var N=D&&0>=L||Q&&J>P||B.descending;(!B.continuous||D&&0>=L)&&N?B.complete(null,z):setTimeout(function(){C(E,K)},0)}};return C(B.since||0,K),{cancel:function(){B.aborted=!0,G&&G.abort()}}},k.revsDiff=v("revsDiff",function(z,x,y){"function"==typeof x&&(y=x,x={}),w(x,{method:"POST",url:dA(i,"_revs_diff"),body:z},y)}),k._close=function(x){x()},k._destroy=function(y,x){w(y,{url:dA(i,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?x(z):void x(null,A)})}}function aj(g){g.adapter("http",fP,!1),g.adapter("https",fP,!1)}function cq(){this.promise=new dO(function(g){g()})}function kk(k){var m=k.db,n=k.viewName,j=k.map,l=k.reduce,h=k.temporary,g=j.toString()+(l&&l.toString())+"undefined";if(!h&&m._cachedViews){var i=m._cachedViews[g];if(i){return dO.resolve(i)}}return m.info().then(function(p){function o(u){u.views=u.views||{};var r=n;-1===r.indexOf("/")&&(r=n+"/"+n);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(h?"temp":j8(g));return aa(m,"_local/mrviews",o).then(function(){return m.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:m,adapter:m.adapter,mapFun:j,reduceFun:l};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,h||(m._cachedViews=m._cachedViews||{},m._cachedViews[g]=r,r.db.once("destroyed",function(){delete m._cachedViews[g]})),r})})})})}function eV(j,h,l,i,k,g){return aX("return ("+j.replace(/;\s*$/,"")+");",{emit:h,sum:l,log:i,isArray:k,toJSON:g})}function aY(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function jI(g){return 1===g.length&&/^1-/.test(g[0].rev)}function cj(i,h){try{i.emit("error",h)}catch(g){aL("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),aL("error",h)}}function j3(h,j,i){try{return{output:j.apply(null,i)}}catch(g){return cj(h,g),{error:g}}}function jP(i,h){var g=e9.collate(i.key,h.key);return 0!==g?g:e9.collate(i.value,h.value)}function eq(i,h,g){return g=g||0,"number"==typeof h?i.slice(g,h+g):g>0?i.slice(g):i}function eN(i){var h=i.value,g=h&&"object"==typeof h&&h._id||i.id;return g}function kg(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=j1(k.data,k.content_type)})})}function fQ(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&kg(h),h}}function kb(g){var h="builtin "+g+" function requires map values to be numbers or number arrays";return new ac(h)}function e2(k){for(var m=0,n=0,j=k.length;j>n;n++){var l=k[n];if("number"!=typeof l){if(!Array.isArray(l)){throw kb("_sum")}m="number"==typeof m?[m]:m;for(var h=0,g=l.length;g>h;h++){var i=l[h];if("number"!=typeof i){throw kb("_sum")}"undefined"==typeof m[h]?m.push(i):m[h]+=i}}else{"number"==typeof m?m+=l:m[0]+=l}}return m}function kj(i,g,k,h){var j=g[i];"undefined"!=typeof j&&(h&&(j=encodeURIComponent(JSON.stringify(j))),k.push(i+"="+j))}function ef(g){if("undefined"!=typeof g){var h=Number(g);return isNaN(h)||h!==parseInt(g,10)?g:h}}function jU(g){return g.group_level=ef(g.group_level),g.limit=ef(g.limit),g.skip=ef(g.skip),g}function km(g){if(g){if("number"!=typeof g){return new cc('Invalid value for integer: "'+g+'"')}if(0>g){return new cc('Invalid value for positive integer: "'+g+'"')}}}function f6(h,j){var i=h.descending?"endkey":"startkey",g=h.descending?"startkey":"endkey";if("undefined"!=typeof h[i]&&"undefined"!=typeof h[g]&&e9.collate(h[i],h[g])>0){throw new cc("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(j.reduce&&h.reduce!==!1){if(h.include_docs){throw new cc("{include_docs:true} is invalid for reduce")}if(h.keys&&h.keys.length>1&&!h.group&&!h.group_level){throw new cc("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=km(h[k]);if(l){throw l}})}function f9(j,l,h){var n,g=[],i="GET";if(kj("reduce",h,g),kj("include_docs",h,g),kj("attachments",h,g),kj("limit",h,g),kj("descending",h,g),kj("group",h,g),kj("group_level",h,g),kj("skip",h,g),kj("stale",h,g),kj("conflicts",h,g),kj("startkey",h,g,!0),kj("start_key",h,g,!0),kj("endkey",h,g,!0),kj("end_key",h,g,!0),kj("inclusive_end",h,g),kj("key",h,g,!0),g=g.join("&"),g=""===g?"":"?"+g,"undefined"!=typeof h.keys){var k=2000,o="keys="+encodeURIComponent(JSON.stringify(h.keys));o.length+g.length+1<=k?g+=("?"===g[0]?"&":"?")+o:(i="POST","string"==typeof l?n={keys:h.keys}:l.keys=h.keys)}if("string"==typeof l){var m=aY(l);return j.request({method:i,url:"_design/"+m[0]+"/_view/"+m[1]+g,body:n}).then(fQ(h))}return n=n||{},Object.keys(l).forEach(function(p){Array.isArray(l[p])?n[p]=l[p]:n[p]=l[p].toString()}),j.request({method:"POST",url:"_temp_view"+g,body:n}).then(fQ(h))}function jO(i,h,g){return new dO(function(j,k){i._query(h,g,function(m,l){return m?k(m):void j(l)})})}function cl(g){return new dO(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function ah(g){return function(h){if(404===h.status){return g}throw h}}function dR(n,i,m){function k(){return jI(o)?dO.resolve(h):i.db.get(p)["catch"](ah(h))}function j(r){return r.keys.length?i.db.allDocs({keys:r.keys,include_docs:!0}):dO.resolve({rows:[]})}function l(s,u){for(var y=[],w={},z=0,B=u.rows.length;B>z;z++){var r=u.rows[z],x=r.doc;if(x&&(y.push(x),w[x._id]=!0,x._deleted=!q[x._id],!x._deleted)){var v=q[x._id];"value" in v&&(x.value=v.value)}}var A=Object.keys(q);return A.forEach(function(C){if(!w[C]){var E={_id:C},D=q[C];"value" in D&&(E.value=D.value),y.push(E)}}),s.keys=cT(A.concat(s.keys)),y.push(s),y}var p="_local/doc_"+n,h={_id:p,keys:[]},g=m[n],q=g.indexableKeysToKeyValues,o=g.changes;return k().then(function(r){return j(r).then(function(s){return l(r,s)})})}function em(h,j,i){var g="_local/lastSeq";return h.db.get(g)["catch"](ah({_id:g,seq:0})).then(function(k){var l=Object.keys(j);return dO.all(l.map(function(m){return dR(m,h,j)})).then(function(n){var m=eA(n);return k.seq=i,m.push(k),h.db.bulkDocs({docs:m})})})}function eF(i){var h="string"==typeof i?i:i.name,g=ak[h];return g||(g=ak[h]=new cq),g}function bv(g){return b3(eF(g),function(){return bO(g)})()}function bO(j){function l(p,r){var q={id:g._id,key:e9.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=e9.normalizeKey(r)),n.push(q)}function h(q,p){return function(){return em(j,q,p)}}var n,g,i;if("function"==typeof j.mapFun&&2===j.mapFun.length){var k=j.mapFun;i=function(p){return k(p,l)}}else{i=eV(j.mapFun.toString(),l,e2,bx,Array.isArray,JSON.parse)}var o=j.seq||0,m=new cq;return new dO(function(p,s){function r(){m.finish().then(function(){j.seq=o,p()})}function q(){function u(v){s(v)}j.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:o,limit:dB}).on("complete",function(x){var F=x.results;if(!F.length){return r()}for(var D={},C=0,A=F.length;A>C;C++){var v=F[C];if("_"!==v.doc._id[0]){n=[],g=v.doc,g._deleted||j3(j.sourceDB,i,[g]),n.sort(jP);for(var z,H={},G=0,y=n.length;y>G;G++){var B=n[G],E=[B.key,B.id];0===e9.collate(B.key,z)&&E.push(G);var w=e9.toIndexableString(E);H[w]=B,z=B.key}D[v.doc._id]={indexableKeysToKeyValues:H,changes:v.changes}}o=v.seq}return m.add(h(D,o)),F.length<dB?r():q()}).on("error",u)}q()})}function eT(n,i,m){0===m.group_level&&delete m.group_level;var k,j=m.group||m.group_level;k=fF[n.reduceFun]?fF[n.reduceFun]:eV(n.reduceFun.toString(),null,e2,bx,Array.isArray,JSON.parse);var l=[],p=isNaN(m.group_level)?Number.POSITIVE_INFINITY:m.group_level;i.forEach(function(r){var u=l[l.length-1],s=j?r.key:null;return j&&Array.isArray(s)&&(s=s.slice(0,p)),u&&0===e9.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void l.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),i=[];for(var h=0,g=l.length;g>h;h++){var q=l[h],o=j3(n.sourceDB,k,[q.keys,q.values,!1]);if(o.error&&o.error instanceof ac){throw o.error}i.push({value:o.error?null:o.output,key:q.groupKey})}return{rows:eq(i,m.limit,m.skip)}}function fC(g,h){return b3(eF(g),function(){return dU(g,h)})()}function dU(r,l){function o(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return n=v.total_rows,v.rows.map(function(z){if("value" in z.doc&&"object"==typeof z.doc.value&&null!==z.doc.value){var x=Object.keys(z.doc.value).sort(),w=["id","key","value"];if(!(w>x||x>w)){return z.doc.value}}var y=e9.parseIndexableString(z.doc._id);return{key:y[0],id:y[1],value:"value" in z.doc?z.doc.value:null}})})}function m(v){var u;if(u=q?eT(r,v,l):{total_rows:n,offset:j,rows:v},l.include_docs){var w=cT(v.map(eN));return r.sourceDB.allDocs({keys:w,include_docs:!0,conflicts:l.conflicts,attachments:l.attachments,binary:l.binary}).then(function(y){var x={};return y.rows.forEach(function(z){z.doc&&(x["$"+z.id]=z.doc)}),v.forEach(function(A){var B=eN(A),z=x["$"+B];z&&(A.doc=z)}),u})}return u}var n,q=r.reduceFun&&l.reduce!==!1,j=l.skip||0;if("undefined"==typeof l.keys||l.keys.length||(l.limit=0,delete l.keys),"undefined"!=typeof l.keys){var s=l.keys,k=s.map(function(u){var v={startkey:e9.toIndexableString([u]),endkey:e9.toIndexableString([u,{}])};return o(v)});return dO.all(k).then(eA).then(m)}var i={descending:l.descending};if(l.start_key&&(l.startkey=l.start_key),l.end_key&&(l.endkey=l.end_key),"undefined"!=typeof l.startkey&&(i.startkey=l.descending?e9.toIndexableString([l.startkey,{}]):e9.toIndexableString([l.startkey])),"undefined"!=typeof l.endkey){var g=l.inclusive_end!==!1;l.descending&&(g=!g),i.endkey=e9.toIndexableString(g?[l.endkey,{}]:[l.endkey])}if("undefined"!=typeof l.key){var p=e9.toIndexableString([l.key]),h=e9.toIndexableString([l.key,{}]);i.descending?(i.endkey=p,i.startkey=h):(i.startkey=p,i.endkey=h)}return q||("number"==typeof l.limit&&(i.limit=l.limit),i.skip=j),o(i).then(m)}function fL(g){return g.request({method:"POST",url:"_view_cleanup"})}function cx(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(l){var n=aY(l),k="_design/"+n[0],m=n[1];j[k]=j[k]||{},j[k][m]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(l){var m={};l.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){m[v]=m[v]||s})})});var k=Object.keys(m).filter(function(o){return !m[o]}),n=k.map(function(o){return b3(eF(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return dO.all(n).then(function(){return{ok:!0}})})},ah({ok:!0}))}function dw(l,i,k){if("http"===l.type()){return f9(l,i,k)}if("function"==typeof l._query){return jO(l,i,k)}if("string"!=typeof i){f6(k,i);var n={db:l,viewName:"temp_view/temp_view",map:i.map,reduce:i.reduce,temporary:!0};return ke.add(function(){return kk(n).then(function(o){function p(){return o.db.destroy()}return ax(bv(o).then(function(){return fC(o,k)}),p)})}),ke.finish()}var m=i,g=aY(m),j=g[0],h=g[1];return l.get("_design/"+j).then(function(o){var p=o.views&&o.views[h];if(!p||"string"!=typeof p.map){throw new c0("ddoc "+j+" has no view named "+h)}f6(k,p);var q={db:l,viewName:m,map:p.map,reduce:p.reduce};return kk(q).then(function(r){return"ok"===k.stale||"update_after"===k.stale?("update_after"===k.stale&&eO.nextTick(function(){bv(r)}),fC(r,k)):bv(r).then(function(){return fC(r,k)})})})}function cc(g){this.status=400,this.name="query_parse_error",this.message=g,this.error=!0;try{Error.captureStackTrace(this,cc)}catch(h){}}function c0(g){this.status=404,this.name="not_found",this.message=g,this.error=!0;try{Error.captureStackTrace(this,c0)}catch(h){}}function ac(g){this.status=500,this.name="invalid_value",this.message=g,this.error=!0;try{Error.captureStackTrace(this,ac)}catch(h){}}function cC(g){return/^1-/.test(g)}function jX(i,h,g){return !i._attachments||!i._attachments[g]||i._attachments[g].digest!==h._attachments[g].digest}function kl(i,h){var g=Object.keys(h._attachments);return dO.all(g.map(function(j){return i.getAttachment(h._id,j,{rev:h._rev})}))}function j2(i,g,k){var h="http"===g.type()&&"http"!==i.type(),j=Object.keys(k._attachments);return h?i.get(k._id).then(function(l){return dO.all(j.map(function(m){return jX(l,k,m)?g.getAttachment(k._id,m):i.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return kl(g,k)}):kl(g,k)}function dq(g){var h=[];return Object.keys(g).forEach(function(j){var i=g[j].missing;i.forEach(function(k){h.push({id:j,rev:k})})}),{docs:h,revs:!0}}function b9(m,h,l,j){function k(){var r=dq(l);if(r.docs.length){return m.bulkGet(r).then(function(s){if(j.cancelled){throw new Error("cancelled")}return dO.all(s.results.map(function(u){return dO.all(u.docs.map(function(w){var v=w.ok;return w.error&&(o=!1),v&&v._attachments?j2(h,m,v).then(function(y){var x=Object.keys(v._attachments);return y.forEach(function(z,B){var A=v._attachments[x[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){q=q.concat(eA(u).filter(Boolean))})})}}function n(r){return r._attachments&&Object.keys(r._attachments).length>0}function p(r){return m.allDocs({keys:r,include_docs:!0}).then(function(s){if(j.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&cC(u.value.rev)&&!n(u.doc)&&(q.push(u.doc),delete l[u.id])})})}function i(){var r=Object.keys(l).filter(function(s){var u=l[s].missing;return 1===u.length&&cC(u[0])});return r.length>0?p(r):void 0}function g(){return{ok:o,docs:q}}l=c1(l);var q=[],o=!0;return dO.resolve().then(i).then(k).then(g)}function j9(i,g,k,h,j){return i.get(g)["catch"](function(l){if(404===l.status){return"http"===i.type()&&av(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:h,_id:g,history:[],replicator:dK,version:jK}}throw l}).then(function(l){return j.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==h}),l.history.unshift({last_seq:k,session_id:h}),l.history=l.history.slice(0,bZ),l.version=jK,l.replicator=dK,l.session_id=h,l.last_seq=k,i.put(l)["catch"](function(m){if(409===m.status){return j9(i,g,k,h,j)}throw m}))})}function fR(h,j,i,g){this.src=h,this.target=j,this.id=i,this.returnValue=g}function da(g,h){return g.session_id===h.session_id?{last_seq:g.last_seq,history:g.history}:bQ(g.history,h.history)}function bQ(k,m){var n=k[0],j=k.slice(1),l=m[0],h=m.slice(1);if(!n||0===m.length){return{last_seq:cg,history:[]}}var g=n.session_id;if(dS(g,m)){return{last_seq:n.last_seq,history:k}}var i=l.session_id;return dS(i,j)?{last_seq:l.last_seq,history:h}:bQ(j,h)}function dS(h,j){var i=j[0],g=j.slice(1);return h&&0!==j.length?h===i.session_id?!0:dS(h,g):!1}function ec(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function jH(h,j,i,g){return h.retry===!1?(j.emit("error",i),void j.removeAllListeners()):("function"!=typeof h.back_off_function&&(h.back_off_function=ch),j.emit("requestError",i),"active"!==j.state&&"pending"!==j.state||(j.emit("paused",i),j.state="stopped",j.once("active",function(){h.current_back_off=dp})),h.current_back_off=h.current_back_off||dp,h.current_back_off=h.back_off_function(h.current_back_off),void setTimeout(g,h.current_back_off))}function dc(g){return Object.keys(g).sort(e9.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function dN(l,j,g){var k=g.doc_ids?g.doc_ids.sort(e9.collate):"",m=g.filter?g.filter.toString():"",i="",h="";return g.filter&&g.query_params&&(i=JSON.stringify(dc(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),dO.all([l.id(),j.id()]).then(function(o){var n=o[0]+o[1]+m+h+i+k;return new dO(function(p){cO(n,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function d0(M,j,w,q,v){function C(){return I?dO.resolve():dN(M,j,w).then(function(T){h=T,I=new fR(M,j,h,q)})}function p(){if(n=[],0!==K.docs.length){var T=K.docs;return j.bulkDocs({docs:T,new_edits:!1}).then(function(U){if(q.cancelled){throw u(),new Error("cancelled")}var W=[],Y={};U.forEach(function(Z){Z.error&&(v.doc_write_failures++,W.push(Z),Y[Z.id]=Z)}),L=L.concat(W),v.docs_written+=K.docs.length-W.length;var X=W.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=Y[Z._id];ae?q.emit("denied",c1(ae)):n.push(Z)}),X.length>0){var V=new Error("bulkDocs error");throw V.other_errors=W,D("target.bulkDocs failed to write docs",V),new Error("bulkWrite partial failure")}},function(U){throw v.doc_write_failures+=T.length,U})}}function k(){if(K.error){throw new Error("There was a problem getting docs.")}v.last_seq=B=K.seq;var T=c1(v);return n.length&&(T.docs=n,q.emit("change",T)),F=!0,I.writeCheckpoint(K.seq,N).then(function(){if(F=!1,q.cancelled){throw u(),new Error("cancelled")}K=void 0,y()})["catch"](i)}function P(){var T={};return K.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),j.revsDiff(T).then(function(U){if(q.cancelled){throw u(),new Error("cancelled")}K.diffs=U})}function H(){return b9(M,j,K.diffs,q).then(function(T){K.error=!T.ok,T.docs.forEach(function(U){delete K.diffs[U._id],v.docs_read++,K.docs.push(U)})})}function z(){if(!q.cancelled&&!K){if(0===A.length){return void R(!0)}K=A.shift(),P().then(H).then(p).then(k).then(z)["catch"](function(T){D("batch processing terminated with error",T)})}}function R(T){return 0===s.changes.length?void (0!==A.length||K||((m&&x.live||o)&&(q.state="pending",q.emit("paused")),o&&u())):void ((T||o||s.changes.length>=Q)&&(A.push(s),s={seq:0,changes:[],docs:[]},"pending"!==q.state&&"stopped"!==q.state||(q.state="active",q.emit("active")),z()))}function D(T,U){G||(U.message||(U.message=T),v.ok=!1,v.status="aborting",v.errors.push(U),L=L.concat(U),A=[],s={seq:0,changes:[],docs:[]},u())}function u(){if(!(G||q.cancelled&&(v.status="cancelled",F))){v.status=v.status||"complete",v.end_time=new Date,v.last_seq=B,G=!0;var T=L.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(T.length>0){var U=L.pop();L.length>0&&(U.other_errors=L),U.result=v,jH(w,q,U,function(){d0(M,j,w,q)})}else{v.errors=L,q.emit("complete",v),q.removeAllListeners()}}}function O(T){if(q.cancelled){return u()}var U=eU(w)(T);U&&(s.seq=T.seq,s.changes.push(T),R(0===A.length&&x.live))}function S(T){if(l=!1,q.cancelled){return u()}if(T.results.length>0){x.since=T.last_seq,y(),R(!0)}else{var U=function(){m?(x.live=!0,y()):o=!0,R(!0)};K||0!==T.results.length?U():(F=!0,I.writeCheckpoint(T.last_seq,N).then(function(){F=!1,v.last_seq=B=T.last_seq,U()})["catch"](i))}}function r(T){return l=!1,q.cancelled?u():void D("changes rejected",T)}function y(){function V(){U.cancel()}function T(){q.removeListener("cancel",V)}if(!l&&!o&&A.length<g){l=!0,q._changes&&(q.removeListener("cancel",q._abortChanges),q._changes.cancel()),q.once("cancel",V);var U=M.changes(x).on("change",O);U.then(T,T),U.then(S)["catch"](r),w.retry&&(q._changes=U,q._abortChanges=V)}}function E(){C().then(function(){return q.cancelled?void u():I.getCheckpoint().then(function(T){B=T,x={since:B,limit:Q,batch_size:Q,style:"all_docs",doc_ids:J,return_docs:!0},w.filter&&("string"!=typeof w.filter?x.include_docs=!0:x.filter=w.filter),"heartbeat" in w&&(x.heartbeat=w.heartbeat),"timeout" in w&&(x.timeout=w.timeout),w.query_params&&(x.query_params=w.query_params),w.view&&(x.view=w.view),y()})})["catch"](function(T){D("getCheckpoint rejected with ",T)})}function i(T){throw F=!1,D("writeCheckpoint completed with error",T),T}var K,h,I,A=[],s={seq:0,changes:[],docs:[]},F=!1,o=!1,G=!1,B=0,m=w.continuous||w.live||!1,Q=w.batch_size||100,g=w.batches_limit||10,l=!1,J=w.doc_ids,L=[],n=[],N=fH();v=v||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var x={};return q.ready(M,j),q.cancelled?void u():(q._addedListeners||(q.once("cancel",u),"function"==typeof w.complete&&(q.once("error",w.complete),q.once("complete",function(T){w.complete(null,T)})),q._addedListeners=!0),void ("undefined"==typeof w.since?E():C().then(function(){return F=!0,I.writeCheckpoint(w.since,N)}).then(function(){return F=!1,q.cancelled?void u():(B=w.since,void E())})["catch"](i)))}function b6(){cY.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var g=this,h=new dO(function(i,j){g.once("complete",i),g.once("error",j)});g.then=function(i,j){return h.then(i,j)},g["catch"]=function(i){return h["catch"](i)},g["catch"](function(){})}function eD(i,h){var g=h.PouchConstructor;return"string"==typeof i?new g(i,h):i}function d5(l,j,g,k){if("function"==typeof g&&(k=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw cU(bW,"`doc_ids` filter parameter is not a list.")}g.complete=k,g=c1(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var m=new b6(g),i=eD(l,g),h=eD(j,g);return d0(i,h,g,m),m}function aZ(h,j,i,g){return"function"==typeof i&&(g=i,i={}),"undefined"==typeof i&&(i={}),i=c1(i),i.PouchConstructor=i.PouchConstructor||this,h=eD(h,i),j=eD(j,i),new by(h,j,i,g)}function by(p,x,y,r){function w(z){n.emit("change",{direction:"pull",change:z})}function m(z){n.emit("change",{direction:"push",change:z})}function v(z){n.emit("denied",{direction:"push",doc:z})}function k(z){n.emit("denied",{direction:"pull",doc:z})}function i(){n.pushPaused=!0,n.pullPaused&&n.emit("paused")}function s(){n.pullPaused=!0,n.pushPaused&&n.emit("paused")}function o(){n.pushPaused=!1,n.pullPaused&&n.emit("active",{direction:"push"})}function l(){n.pullPaused=!1,n.pushPaused&&n.emit("active",{direction:"pull"})}function q(z){return function(D,A){var B="change"===D&&(A===w||A===m),F="denied"===D&&(A===k||A===v),C="paused"===D&&(A===s||A===i),E="active"===D&&(A===l||A===o);(B||F||C||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&n.removeAllListeners(D))}}var n=this;this.canceled=!1;var u=y.push?dm.extend({},y,y.push):y,h=y.pull?dm.extend({},y,y.pull):y;this.push=d5(p,x,u),this.pull=d5(x,p,h),this.pushPaused=!0,this.pullPaused=!0;var g={};y.live&&(this.push.on("complete",n.pull.cancel.bind(n.pull)),this.pull.on("complete",n.push.cancel.bind(n.push))),this.on("newListener",function(z){"change"===z?(n.pull.on("change",w),n.push.on("change",m)):"denied"===z?(n.pull.on("denied",k),n.push.on("denied",v)):"active"===z?(n.pull.on("active",l),n.push.on("active",o)):"paused"===z&&(n.pull.on("paused",s),n.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(n.pull.removeListener("change",w),n.push.removeListener("change",m)):"denied"===z?(n.pull.removeListener("denied",k),n.push.removeListener("denied",v)):"active"===z?(n.pull.removeListener("active",l),n.push.removeListener("active",o)):"paused"===z&&(n.pull.removeListener("paused",s),n.push.removeListener("paused",i))}),this.pull.on("removeListener",q("pull")),this.push.on("removeListener",q("push"));var j=dO.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return n.emit("complete",z),r&&r(null,z),n.removeAllListeners(),z},function(z){if(n.cancel(),r?r(z):n.emit("error",z),n.removeAllListeners(),r){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function cL(g){g.replicate=d5,g.sync=aZ}var eJ,dm=c(9),c6=f3(c(5)),cS=f3(c(8)),cf=f3(c(10)),cz=c(14),au=f3(c(4)),cY=c(1),aX=f3(c(15)),aK=f3(c(16)),bb=f3(c(17)),e9=c(12),dO="function"==typeof Promise?Promise:cf,fO=Function.prototype.toString,ca=fO.call(Object),cJ=c6("pouchdb:api"),bm=6;if(bi()){eJ=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),eJ=!!localStorage.getItem("_pouch_check_localstorage")}catch(c8){eJ=!1}}cS(dy,cY.EventEmitter),dy.prototype.addListener=function(l,j,g,k){function m(){function o(){h=!1}if(i._listeners[j]){if(h){return void (h="waiting")}h=!0;var n=eX(k,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(n).on("change",function(p){p.seq>k.since&&!k.cancelled&&(k.since=p.seq,k.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){m()},0),h=!1}).on("error",o)}}if(!this._listeners[j]){var i=this,h=!1;this._listeners[j]=m,this.on(l,m)}},dy.prototype.removeListener=function(g,h){h in this._listeners&&cY.EventEmitter.prototype.removeListener.call(this,g,this._listeners[h])},dy.prototype.notifyLocalWindows=function(g){bi()?chrome.storage.local.set({dbName:g}):dd()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},dy.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},cS(e0,Error),e0.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var ba=new e0({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),b2=new e0({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),bz=new e0({status:404,error:"not_found",reason:"missing"}),eH=new e0({status:409,error:"conflict",reason:"Document update conflict"}),aC=new e0({status:400,error:"invalid_id",reason:"_id field must contain a string"}),d4=new e0({status:412,error:"missing_id",reason:"_id is required for puts"}),fI=new e0({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),e6=new e0({status:412,error:"precondition_failed",reason:"Database not open"}),bw=new e0({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),dF=new e0({status:500,error:"badarg",reason:"Some query argument is invalid"}),dJ=new e0({status:400,error:"invalid_request",reason:"Request was invalid"}),eP=new e0({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),ka=new e0({status:500,error:"doc_validation",reason:"Bad special document member"}),bW=new e0({status:400,error:"bad_request",reason:"Something wrong with the request"}),cs=new e0({status:400,error:"bad_request",reason:"Document must be a JSON object"}),bA=new e0({status:404,error:"not_found",reason:"Database not found"}),eW=new e0({status:500,error:"indexed_db_went_bad",reason:"unknown"}),jR=new e0({status:500,error:"web_sql_went_bad",reason:"unknown"}),d1=new e0({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),cM=new e0({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),ea=new e0({status:400,error:"bad_request",reason:"Invalid rev format"}),f1=new e0({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),ck=new e0({status:412,error:"missing_stub"}),bE=new e0({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),cG=[ba,b2,bz,eH,aC,d4,fI,e6,bw,dF,dJ,eP,ka,bW,cs,bA,jR,d1,cM,ea,f1,ck,eW,bE],cD=function(h,j,i){var g=cG.filter(function(k){return k[h]===j});return i&&g.filter(function(k){return k.message===i})[0]||g[0]},df=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],d6="queryKey",eZ=/(?:^|&)([^&=]*)=?([^&]*)/g,kh=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,bF="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");cS(af,cY.EventEmitter),af.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},af.prototype.doChanges=function(i){var g=this,k=i.complete;if(i=c1(i),"live" in i&&!("continuous" in i)&&(i.continuous=i.live),i.processChange=bV,"latest"===i.since&&(i.since="now"),i.since||(i.since=0),"now"===i.since){return void this.db.info().then(function(l){return g.isCancelled?void k(null,{status:"cancelled"}):(i.since=l.update_seq,void g.doChanges(i))},k)}if(i.continuous&&"now"!==i.since&&this.db.info().then(function(l){g.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),i.view&&!i.filter&&(i.filter="_view"),i.filter&&"string"==typeof i.filter&&("_view"===i.filter?i.view=bd(i.view):i.filter=bd(i.filter),"http"!==this.db.type()&&!i.doc_ids)){return this.filterChanges(i)}"descending" in i||(i.descending=!1),i.limit=0===i.limit?1:i.limit,i.complete=k;var h=this.db._changes(i);if(h&&"function"==typeof h.cancel){var j=g.cancel;g.cancel=au(function(l){h.cancel(),j.apply(this,l)})}},af.prototype.filterChanges=function(j){var h=this,l=j.complete;if("_view"===j.filter){if(!j.view||"string"!=typeof j.view){var i=cU(bW,"`view` filter parameter not found or invalid.");return l(i)}var k=bc(j.view);this.db.get("_design/"+k[0],function(n,m){if(h.isCancelled){return l(null,{status:"cancelled"})}if(n){return l(bJ(n))}var o=m&&m.views&&m.views[k[1]]&&m.views[k[1]].map;return o?(j.filter=eY(o),void h.doChanges(j)):l(cU(bz,m.views?"missing json key: "+k[1]:"missing json key: views"))})}else{var g=bc(j.filter);if(!g){return h.doChanges(j)}this.db.get("_design/"+g[0],function(o,m){if(h.isCancelled){return l(null,{status:"cancelled"})}if(o){return l(bJ(o))}var n=m&&m.filters&&m.filters[g[1]];return n?(j.filter=ap(n),void h.doChanges(j)):l(cU(bz,m&&m.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},cS(dv,cY.EventEmitter),dv.prototype.post=f5("post",function(i,h,g){return"function"==typeof h&&(g=h,h={}),"object"!=typeof i||Array.isArray(i)?g(cU(cs)):void this.bulkDocs({docs:[i]},h,dZ(g))}),dv.prototype.put=f5("put",au(function(j){function l(){k||(aL("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),k=!0)}var h,n,g,i,k=!1,o=j.shift(),m="_id" in o;if("object"!=typeof o||Array.isArray(o)){return(i=j.pop())(cU(cs))}for(;;){if(h=j.shift(),n=typeof h,"string"!==n||m?"string"!==n||!m||"_rev" in o?"object"===n?g=h:"function"===n&&(i=h):(l(),o._rev=h):(l(),o._id=h,m=!0),!j.length){break}}return g=g||{},bS(o._id),fB(o._id)&&"function"==typeof this._putLocal?o._deleted?this._removeLocal(o,i):this._putLocal(o,i):void this.bulkDocs({docs:[o]},g,dZ(i))})),dv.prototype.putAttachment=f5("putAttachment",function(l,j,g,k,m){function i(n){var o="_rev" in n?parseInt(n._rev,10):0;return n._attachments=n._attachments||{},n._attachments[j]={content_type:m,data:k,revpos:++o},h.put(n)}var h=this;return"function"==typeof m&&(m=k,k=g,g=null),"undefined"==typeof m&&(m=k,k=g,g=null),h.get(l).then(function(n){if(n._rev!==g){throw cU(eH)}return i(n)},function(n){if(n.reason===bz.message){return i({_id:l})}throw n})}),dv.prototype.removeAttachment=f5("removeAttachment",function(i,g,k,h){var j=this;j.get(i,function(m,l){return m?void h(m):l._rev!==k?void h(cU(eH)):l._attachments?(delete l._attachments[g],0===Object.keys(l._attachments).length&&delete l._attachments,void j.put(l,h)):h()})}),dv.prototype.remove=f5("remove",function(j,h,l,i){var k;"string"==typeof h?(k={_id:j,_rev:h},"function"==typeof l&&(i=l,l={})):(k=j,"function"==typeof h?(i=h,l={}):(i=l,l=h)),l=l||{},l.was_delete=!0;var g={_id:k._id,_rev:k._rev||l.rev};return g._deleted=!0,fB(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(k,i):void this.bulkDocs({docs:[g]},l,dZ(i))}),dv.prototype.revsDiff=f5("revsDiff",function(k,m,n){function j(o,p){i.has(o)||i.set(o,{missing:[]}),i.get(o).missing.push(p)}function l(q,p){var o=k[q].slice(0);bP(p,function(x,w,v,r,s){var u=w+"-"+v,y=o.indexOf(u);-1!==y&&(o.splice(y,1),"available"!==s.status&&j(q,u))}),o.forEach(function(r){j(q,r)})}"function"==typeof m&&(n=m,m={});var h=Object.keys(k);if(!h.length){return n(null,{})}var g=0,i=new cz.Map;h.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){i.set(o,{missing:k[o]})}else{if(q){return n(q)}l(o,p)}if(++g===h.length){var r={};return i.forEach(function(u,s){r[s]=u}),n(null,r)}})},this)}),dv.prototype.bulkGet=f5("bulkGet",function(g,h){eB(this,g,h)}),dv.prototype.compactDocument=f5("compactDocument",function(h,j,i){var g=this;this._getRevisionTree(h,function(o,m){if(o){return i(o)}var k=c4(m),n=[],l=[];Object.keys(k).forEach(function(p){k[p]>j&&n.push(p)}),bP(m,function(r,p,u,q,s){var v=p+"-"+u;"available"===s.status&&-1!==n.indexOf(v)&&l.push(v)}),g._doCompaction(h,l,i)})}),dv.prototype.compact=f5("compact",function(i,h){"function"==typeof i&&(h=i,i={});var g=this;i=i||{},g._compactionQueue=g._compactionQueue||[],g._compactionQueue.push({opts:i,callback:h}),1===g._compactionQueue.length&&ad(g)}),dv.prototype._compact=function(l,j){function g(n){h.push(m.compactDocument(n.id,0))}function k(n){var o=n.last_seq;dO.all(h).then(function(){return aa(m,"_local/compaction",function(p){return !p.last_seq||p.last_seq<o?(p.last_seq=o,p):!1})}).then(function(){j(null,{ok:!0})})["catch"](j)}var m=this,i={return_docs:!1,last_seq:l.last_seq||0},h=[];m.changes(i).on("change",g).on("complete",k).on("error",j)},dv.prototype.get=f5("get",function(k,m,n){function j(){var o=[],p=l.length;return p?void l.forEach(function(q){h.get(k,{rev:q,revs:m.revs,attachments:m.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||n(null,o)})}):n(null,o)}if("function"==typeof m&&(n=m,m={}),"string"!=typeof k){return n(cU(aC))}if(fB(k)&&"function"==typeof this._getLocal){return this._getLocal(k,n)}var l=[],h=this;if(!m.open_revs){return this._get(k,m,function(s,v){if(s){return n(s)}var p=v.doc,x=v.metadata,u=v.ctx;if(m.conflicts){var B=aI(x);B.length&&(p._conflicts=B)}if(cP(x,p._rev)&&(p._deleted=!0),m.revs||m.revs_info){var A=dH(x.rev_tree),r=ki(A,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(p._rev.split("-")[1])}),o=r.ids.map(function(D){return D.id}).indexOf(p._rev.split("-")[1])+1,y=r.ids.length-o;if(r.ids.splice(o,y),r.ids.reverse(),m.revs&&(p._revisions={start:r.pos+r.ids.length-1,ids:r.ids.map(function(D){return D.id})}),m.revs_info){var w=r.pos+r.ids.length;p._revs_info=r.ids.map(function(D){return w--,{rev:w+"-"+D.id,status:D.opts.status}})}}if(m.attachments&&p._attachments){var z=p._attachments,C=Object.keys(z).length;if(0===C){return n(null,p)}Object.keys(z).forEach(function(D){this._getAttachment(p._id,D,z[D],{rev:p._rev,binary:m.binary,ctx:u},function(F,G){var E=p._attachments[D];E.data=G,delete E.stub,delete E.length,--C||n(null,p)})},h)}else{if(p._attachments){for(var q in p._attachments){p._attachments.hasOwnProperty(q)&&(p._attachments[q].stub=!0)}}n(null,p)}})}if("all"===m.open_revs){this._getRevisionTree(k,function(o,p){return o?n(o):(l=bI(p).map(function(q){return q.rev}),void j())})}else{if(!Array.isArray(m.open_revs)){return n(cU(bw,"function_clause"))}l=m.open_revs;for(var g=0;g<l.length;g++){var i=l[g];if("string"!=typeof i||!/^\d+-/.test(i)){return n(cU(ea))}}j()}}),dv.prototype.getAttachment=f5("getAttachment",function(i,g,k,h){var j=this;k instanceof Function&&(h=k,k={}),this._get(i,k,function(m,l){return m?h(m):l.doc._attachments&&l.doc._attachments[g]?(k.ctx=l.ctx,k.binary=!0,j._getAttachment(i,g,l.doc._attachments[g],k,h),void 0):h(cU(bz))})}),dv.prototype.allDocs=f5("allDocs",function(i,h){if("function"==typeof i&&(h=i,i={}),i.skip="undefined"!=typeof i.skip?i.skip:0,i.start_key&&(i.startkey=i.start_key),i.end_key&&(i.endkey=i.end_key),"keys" in i){if(!Array.isArray(i.keys)){return h(new TypeError("options.keys must be an array"))}var g=["startkey","endkey","key"].filter(function(j){return j in i})[0];if(g){return void h(cU(eP,"Query parameter `"+g+"` is not compatible with multi-get"))}if("http"!==this.type()){return f0(this,i,h)}}return this._allDocs(i,h)}),dv.prototype.changes=function(g,h){return"function"==typeof g&&(h=g,g={}),new af(this,g,h)},dv.prototype.close=f5("close",function(g){return this._closed=!0,this._close(g)}),dv.prototype.info=f5("info",function(g){var h=this;this._info(function(j,i){return j?g(j):(i.db_name=i.db_name||h._db_name,i.auto_compaction=!(!h.auto_compaction||"http"===h.type()),i.adapter=h.type(),void g(null,i))})}),dv.prototype.id=f5("id",function(g){return this._id(g)}),dv.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},dv.prototype.bulkDocs=f5("bulkDocs",function(i,g,k){if("function"==typeof g&&(k=g,g={}),g=g||{},Array.isArray(i)&&(i={docs:i}),!i||!i.docs||!Array.isArray(i.docs)){return k(cU(b2))}for(var h=0;h<i.docs.length;++h){if("object"!=typeof i.docs[h]||Array.isArray(i.docs[h])){return k(cU(cs))}}var j;return i.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){j=j||dE(m)})}),j?k(cU(bW,j)):("new_edits" in g||("new_edits" in i?g.new_edits=i.new_edits:g.new_edits=!0),g.new_edits||"http"===this.type()||i.docs.sort(f8),eb(i.docs),this._bulkDocs(i,g,function(m,l){return m?k(m):(g.new_edits||(l=l.filter(function(n){return n.error})),void k(null,l))}))}),dv.prototype.registerDependentDatabase=f5("registerDependentDatabase",function(h,j){function i(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[h]?!1:(k.dependentDbs[h]=!0,k)}var g=new this.constructor(h,this.__opts);aa(this,"_local/_pouch_dependentDbs",i).then(function(){j(null,{db:g})})["catch"](j)}),dv.prototype.destroy=f5("destroy",function(i,g){function k(){h._destroy(i,function(l,m){return l?g(l):(h._destroyed=!0,h.emit("destroyed"),void g(null,m||{ok:!0}))})}"function"==typeof i&&(g=i,i={});var h=this,j="use_prefix" in h?h.use_prefix:!0;return"http"===h.type()?k():void h.get("_local/_pouch_dependentDbs",function(p,n){if(p){return 404!==p.status?g(p):k()}var l=n.dependentDbs,o=h.constructor,m=Object.keys(l).map(function(r){var q=j?r.replace(new RegExp("^"+o.prefix),""):r;return new o(q,h.__opts).destroy()});dO.all(m).then(k,g)})}),d8.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},d8.prototype.fail=function(g){this.failed=g,this.execute()},d8.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},d8.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},cS(jG,dv),jG.debug=c6,jG.adapters={},jG.preferredAdapters=[],jG.prefix="_pouch_";var dP=new cY.EventEmitter;eG(jG),jG.parseAdapter=function(k,m){var n,j,l=k.match(/([a-z\-]*):\/\/(.*)/);if(l){if(k=/http(s?)/.test(l[1])?l[1]+"://"+l[2]:l[2],n=l[1],!jG.adapters[n].valid()){throw"Invalid adapter"}return{name:k,adapter:l[1]}}var h="idb" in jG.adapters&&"websql" in jG.adapters&&dd()&&localStorage["_pouch__websqldb_"+jG.prefix+k];if(m.adapter){j=m.adapter}else{if("undefined"!=typeof m&&m.db){j="leveldb"}else{for(var g=0;g<jG.preferredAdapters.length;++g){if(j=jG.preferredAdapters[g],j in jG.adapters){if(h&&"idb"===j){aL("log",'PouchDB is downgrading "'+k+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}n=jG.adapters[j];var i=n&&"use_prefix" in n?n.use_prefix:!0;return{name:i?jG.prefix+k:k,adapter:j}},jG.adapter=function(i,h,g){h.valid()&&(jG.adapters[i]=h,g&&jG.preferredAdapters.push(i))},jG.plugin=function(g){return"function"==typeof g?g(jG):Object.keys(g).forEach(function(h){jG.prototype[h]=g[h]}),jG},jG.defaults=function(g){function h(k,i,j){return this instanceof h?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=dm.extend({},g,i),void jG.call(this,k,i,j)):new h(k,i,j)}return cS(h,jG),h.preferredAdapters=jG.preferredAdapters.slice(),Object.keys(jG).forEach(function(i){i in h||(h[i]=jG[i])}),h};var f7="5.4.4";jG.version=f7;var c2,kd=e(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cu=e(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),eQ=function(g){return atob(g)},dV=function(g){return btoa(g)},fG=dY.setImmediate||dY.setTimeout,bG=32768,dG=5,cA="document-store",e7="by-sequence",cK="attach-store",dQ="attach-seq-store",bT="meta-store",jL="local-store",aq="detect-blob-support",bg={running:!1,queue:[]},bX=new cz.Map,el=new dy,kf=new cz.Map;j7.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var bL=7,cv=bf("document-store"),j6=bf("by-sequence"),am=bf("attach-store"),a9=bf("local-store"),f4=bf("metadata-store"),aW=bf("attach-seq-store"),b7=new cz.Map,ab=new dy,j5=1,dL="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+j6+" (seq, deleted)",ag="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+j6+" (doc_id, rev)",jT="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+cv+" (winningseq)",cW="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+aW+" (seq)",ej="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+aW+" (digest, seq)",bN=j6+".seq = "+cv+".winningseq",bj=j6+".seq AS seq, "+j6+".deleted AS deleted, "+j6+".json AS data, "+j6+".rev AS rev, "+cv+".json AS metadata";eI.valid=aT,eI.use_prefix=!0;var bD=bC(),az=function(){},cN=25,dx=50,d7={},f2=1800,b0=c6("pouchdb:http");fP.valid=function(){return !0},cq.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},cq.prototype.finish=function(){return this.promise};var aN=function(g,h){return h&&g.then(function(i){eO.nextTick(function(){h(null,i)})},function(i){eO.nextTick(function(){h(i)})}),g},aF=function(g){return au(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&aN(i,j),i})},ax=function(g,h){return g.then(function(i){return h().then(function(){return i})},function(i){return h().then(function(){throw i})})},b3=function(g,h){return function(){var j=arguments,i=this;return g.add(function(){return h.apply(i,j)})}},cT=function(j){for(var h={},l=0,i=j.length;i>l;l++){h["$"+j[l]]=!0}var k=Object.keys(h),g=new Array(k.length);for(l=0,i=k.length;i>l;l++){g[l]=k[l].substring(1)}return g},ak={},ke=new cq,dB=50,bx=aL.bind(null,"log"),fF={_sum:function(g,h){return e2(h)},_count:function(g,h){return h.length},_stats:function(i,h){function g(l){for(var j=0,n=0,k=l.length;k>n;n++){var m=l[n];j+=m*m}return j}return{sum:e2(h),min:Math.min.apply(null,h),max:Math.max.apply(null,h),count:h.length,sumsqr:g(h)}}},jS=aF(function(){var g=this;return"http"===g.type()?fL(g):"function"==typeof g._viewCleanup?cl(g):cx(g)}),fA=function(i,g,k){"function"==typeof g&&(k=g,g={}),g=g?jU(g):{},"function"==typeof i&&(i={map:i});var h=this,j=dO.resolve().then(function(){return dw(h,i,g)});return aN(j,k),j};cS(cc,Error),cS(c0,Error),cS(ac,Error);var bp={query:fA,viewCleanup:jS},jK=1,dK="pouchdb",bZ=5,cg=0;fR.prototype.writeCheckpoint=function(i,h){var g=this;return this.updateTarget(i,h).then(function(){return g.updateSource(i,h)})},fR.prototype.updateTarget=function(g,h){return j9(this.target,this.id,g,h,this.returnValue)},fR.prototype.updateSource=function(i,h){var g=this;return this.readOnlySource?dO.resolve(!0):j9(this.src,this.id,i,h,this.returnValue)["catch"](function(j){if(ec(j)){return g.readOnlySource=!0,!0}throw j})};var d9={undefined:function(g,h){return 0===e9.collate(g.last_seq,h.last_seq)?h.last_seq:0},1:function(g,h){return da(h,g).last_seq}};fR.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?dO.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return cg}var j;return j=h.version?h.version.toString():"undefined",j in d9?d9[j](h,i):cg},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:cg}).then(function(){return cg},function(j){return ec(j)?(g.readOnlySource=!0,h.last_seq):cg})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return cg})};var dp=0;cS(b6,cY.EventEmitter),b6.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},b6.prototype.ready=function(i,g){function k(){j.cancel()}function h(){i.removeListener("destroyed",k),g.removeListener("destroyed",k)}var j=this;j._readyCalled||(j._readyCalled=!0,i.once("destroyed",k),g.once("destroyed",k),j.once("complete",h))},cS(by,cY.EventEmitter),by.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},jG.plugin(b4).plugin(jF).plugin(aj).plugin(bp).plugin(cL),f.exports=jG}).call(this,c(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(c,f,d){function g(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}f.exports=g},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+f.humanize(this.diff),!n){return e}var i="color: "+this.color;e=[e[0],i,"color: inherit"].concat(Array.prototype.slice.call(e,1));var o=0,p=0;return e[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(o++,"%c"===q&&(p=o))}),e.splice(p,0,i),e}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(l,v,h){function d(){return h.colors[k++%h.colors.length]}function g(i){function e(){}function f(){var s=f,u=+new Date,t=u-(m||u);s.diff=t,s.prev=m,s.curr=u,m=u,null==s.useColors&&(s.useColors=h.useColors()),null==s.color&&s.useColors&&(s.color=d());var o=Array.prototype.slice.call(arguments);o[0]=h.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var x=0;o[0]=o[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}x++;var w=h.formatters[B];if("function"==typeof w){var C=o[x];D=w.call(s,C),o.splice(x,1),x--}return D}),"function"==typeof h.formatArgs&&(o=h.formatArgs.apply(s,o));var r=f.log||h.log||console.log.bind(console);r.apply(s,o)}e.enabled=!1,f.enabled=!0;var n=h.enabled(i)?f:e;return n.namespace=i,n}function j(f){h.save(f);for(var i=(f||"").split(/[\s,]+/),e=i.length,n=0;e>n;n++){i[n]&&(f=i[n].replace(/\*/g,".*?"),"-"===f[0]?h.skips.push(new RegExp("^"+f.substr(1)+"$")):h.names.push(new RegExp("^"+f+"$")))}}function p(){h.enable("")}function c(i){var e,f;for(e=0,f=h.skips.length;f>e;e++){if(h.skips[e].test(i)){return !1}}for(e=0,f=h.names.length;f>e;e++){if(h.names[e].test(i)){return !0}}return !1}function q(e){return e instanceof Error?e.stack||e.message:e}h=v.exports=g,h.coerce=q,h.disable=p,h.enable=j,h.enabled=c,h.humanize=l(11),h.names=[],h.skips=[],h.formatters={};var m,k=0},{11:11}],7:[function(c,f,d){(function(t){function k(){q=!0;for(var n,l,i=m.length;i;){for(l=m,m=[],n=-1;++n<i;){l[n]()}i=m.length}q=!1}function g(i){1!==m.push(i)||q||h()}var h,p=t.MutationObserver||t.WebKitMutationObserver;if(p){var v=0,e=new p(k),w=t.document.createTextNode("");e.observe(w,{characterData:!0}),h=function(){w.data=v=++v%2}}else{if(t.setImmediate||"undefined"==typeof t.MessageChannel){h="document" in t&&"onreadystatechange" in t.document.createElement("script")?function(){var i=t.document.createElement("script");i.onreadystatechange=function(){k(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},t.document.documentElement.appendChild(i)}:function(){setTimeout(k,0)}}else{var j=new t.MessageChannel;j.port1.onmessage=k,h=function(){j.port2.postMessage(0)}}}var q,m=[];f.exports=g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(c,f,d){"function"==typeof Object.create?f.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:f.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(c,f,d){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(l){if(l){for(var k in l){"object"==typeof l[k]&&i[k]?h.call(i,i[k],l[k]):i[k]=l[k]}}}),i};this.extend=h}).call(this)},{}],10:[function(x,k,D){function q(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=H,this.queue=[],this.outcome=void 0,e!==q&&g(this,e)}function z(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function I(f,e,h){A(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function C(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(m,i){function f(o){e||(e=!0,d.reject(m,o))}function l(o){e||(e=!0,d.resolve(m,o))}function h(){i(l,f)}var e=!1,n=B(h);"error"===n.status&&f(n.value)}function B(i,f){var e={};try{e.value=i(f),e.status="success"}catch(h){e.status="error",e.value=h}return e}function w(e){return e instanceof this?e:d.resolve(new this(q),e)}function E(f){var e=new this(q);return d.reject(e,f)}function F(e){function f(r,s){function t(u){l[s]=u,++h!==n||p||(p=!0,d.resolve(i,l))}o.resolve(r).then(t,function(u){p||(p=!0,d.reject(i,u))})}var o=this;if("[object Array]"!==Object.prototype.toString.call(e)){return this.reject(new TypeError("must be an array"))}var n=e.length,p=!1;if(!n){return this.resolve([])}for(var l=new Array(n),h=0,m=-1,i=new this(q);++m<n;){f(e[m],m)}return i}function G(m){function i(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(l,p))},function(p){e||(e=!0,d.reject(l,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(m)){return this.reject(new TypeError("must be an array"))}var h=m.length,e=!1;if(!h){return this.resolve([])}for(var n=-1,l=new this(q);++n<h;){i(m[n])}return l}var A=x(7),d={},c=["REJECTED"],J=["FULFILLED"],H=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(h,f){if("function"!=typeof h&&this.state===J||"function"!=typeof f&&this.state===c){return this}var e=new this.constructor(q);if(this.state!==H){var i=this.state===J?h:f;I(e,i,this.outcome)}else{this.queue.push(new z(e,h,f))}return e},z.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},z.prototype.otherCallFulfilled=function(e){I(this.promise,this.onFulfilled,e)},z.prototype.callRejected=function(e){d.reject(this.promise,e)},z.prototype.otherCallRejected=function(e){I(this.promise,this.onRejected,e)},d.resolve=function(l,f){var h=B(C,f);if("error"===h.status){return d.reject(l,h.value)}var i=h.value;if(i){g(l,i)}else{l.state=J,l.outcome=f;for(var m=-1,e=l.queue.length;++m<e;){l.queue[m].callFulfilled(f)}}return l},d.reject=function(i,f){i.state=c,i.outcome=f;for(var e=-1,h=i.queue.length;++e<h;){i.queue[e].callRejected(f)}return i},j.resolve=w,j.reject=E,j.all=F,j.race=G},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(m,j,v){function C(f){if(null!==f){switch(typeof f){case"boolean":return f?1:0;case"number":return g(f);case"string":return f.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var i=Array.isArray(f),n=i?f:Object.keys(f),e=-1,o=n.length,l="";if(i){for(;++e<o;){l+=v.toIndexableString(n[e])}}else{for(;++e<o;){var h=n[e];l+=v.toIndexableString(h)+v.toIndexableString(f[h])}}return l}}return""}function d(r,h){var o,l=h,n="1"===r[h];if(n){o=0,h++}else{var p="0"===r[h];h++;var e="",i=r.substring(h,h+k),f=parseInt(i,10)+x;for(p&&(f=-f),h+=k;;){var s=r[h];if("\x00"===s){break}e+=s,h++}e=e.split("."),o=1===e.length?parseInt(e,10):parseFloat(e[0]+"."+e[1]),p&&(o-=10),0!==f&&(o=parseFloat(o+"e"+f))}return{num:o,length:h-l}}function c(n,e){var i=n.pop();if(e.length){var l=e[e.length-1];i===l.element&&(e.pop(),l=e[e.length-1]);var o=l.element,f=l.index;if(Array.isArray(o)){o.push(i)}else{if(f===n.length-2){var h=n.pop();o[h]=i}else{n.push(i)}}}}function y(i,f){for(var h=Math.min(i.length,f.length),l=0;h>l;l++){var e=v.collate(i[l],f[l]);if(0!==e){return e}}return i.length===f.length?0:i.length>f.length?1:-1}function B(f,e){return f===e?0:f>e?1:-1}function w(f,i){for(var n=Object.keys(f),e=Object.keys(i),o=Math.min(n.length,e.length),l=0;o>l;l++){var h=v.collate(n[l],e[l]);if(0!==h){return h}if(h=v.collate(f[n[l]],i[e[l]]),0!==h){return h}}return n.length===e.length?0:n.length>e.length?1:-1}function z(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function g(i){if(0===i){return"1"}var o=i.toExponential().split(/e\+?/),f=parseInt(o[1],10),r=0>i,e=r?"0":"2",h=(r?-f:f)-x,l=q.padLeft(h.toString(),"0",k);e+=A+l;var p=Math.abs(parseFloat(o[0]));r&&(p=10-p);var n=p.toFixed(20);return n=n.replace(/\.?0+$/,""),e+=A+n}var x=-324,k=3,A="",q=m(13);v.collate=function(h,e){if(h===e){return 0}h=v.normalizeKey(h),e=v.normalizeKey(e);var f=z(h),i=z(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return B(h,e)}return Array.isArray(h)?y(h,e):w(h,e)},v.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var f=0;i>f;f++){l[f]=v.normalizeKey(h[f])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var e in h){if(h.hasOwnProperty(e)){var n=h[e];"undefined"!=typeof n&&(l[e]=v.normalizeKey(n))}}}}}return l},v.toIndexableString=function(f){var e="\x00";return f=v.normalizeKey(f),z(f)+A+C(f)+e},v.parseIndexableString=function(r){for(var h=[],n=[],l=0;;){var e=r[l++];if("\x00"!==e){switch(e){case"1":h.push(null);break;case"2":h.push("1"===r[l]),l++;break;case"3":var i=d(r,l);h.push(i.num),l+=i.length;break;case"4":for(var f="";;){var s=r[l];if("\x00"===s){break}f+=s,l++}f=f.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),h.push(f);break;case"5":var p={element:[],index:h.length};h.push(p.element),n.push(p);break;case"6":var o={element:{},index:h.length};h.push(o.element),n.push(o);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+e)}}else{if(1===h.length){return h.pop()}c(h,n)}}}},{13:13}],13:[function(c,f,d){function g(h,k,j){for(var e="",i=j-h.length;e.length<i;){e+=k}return e}d.padLeft=function(h,e,j){var i=g(h,e,j);return i+h},d.padRight=function(h,e,j){var i=g(h,e,j);return h+i},d.stringLexCompare=function(p,j){var l,h=p.length,m=j.length;for(l=0;h>l;l++){if(l===m){return 1}var k=p.charAt(l),e=j.charAt(l);if(k!==e){return e>k?-1:1}}return m>h?-1:0},d.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(f,c,h){function d(){this.store={}}function g(i){if(this.store=new d,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}h.Map=d,h.Set=g,d.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},d.prototype.unmangle=function(e){return e.substring(1)},d.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},d.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},d.prototype.has=function(i){var e=this.mangle(i);return e in this.store},d.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},d.prototype.forEach=function(k){for(var e=Object.keys(this.store),l=0,j=e.length;j>l;l++){var i=e[l],m=this.store[i];i=this.unmangle(i),k(m,i)}},g.prototype.add=function(e){return this.store.set(e,!0)},g.prototype.has=function(e){return this.store.has(e)},g.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(c,f,d){(function(){var e={}.hasOwnProperty,g=[].slice;f.exports=function(k,j){var i,m,l,h;m=[],h=[];for(i in j){e.call(j,i)&&(l=j[i],"this"!==i&&(m.push(i),h.push(l)))}return Function.apply(null,g.call(m).concat([k])).apply(j["this"],h)}}).call(this)},{}],16:[function(e,d,c){!function(g){if("object"==typeof c){d.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(H){function x(i,h,n,m,l,g){return h=K(K(h,i),K(m,g)),K(h<<l|h>>>32-l,n)}function E(m,n,l,h,i,o,g){return x(n&l|~n&h,m,n,i,o,g)}function I(m,n,l,h,i,o,g){return x(n&h|l&~h,m,n,i,o,g)}function A(m,n,l,h,i,o,g){return x(n^l^h,m,n,i,o,g)}function w(m,n,l,h,i,o,g){return x(l^(n|~h),m,n,i,o,g)}function M(i,h){var n=i[0],m=i[1],g=i[2],l=i[3];n=E(n,m,g,l,h[0],7,-680876936),l=E(l,n,m,g,h[1],12,-389564586),g=E(g,l,n,m,h[2],17,606105819),m=E(m,g,l,n,h[3],22,-1044525330),n=E(n,m,g,l,h[4],7,-176418897),l=E(l,n,m,g,h[5],12,1200080426),g=E(g,l,n,m,h[6],17,-1473231341),m=E(m,g,l,n,h[7],22,-45705983),n=E(n,m,g,l,h[8],7,1770035416),l=E(l,n,m,g,h[9],12,-1958414417),g=E(g,l,n,m,h[10],17,-42063),m=E(m,g,l,n,h[11],22,-1990404162),n=E(n,m,g,l,h[12],7,1804603682),l=E(l,n,m,g,h[13],12,-40341101),g=E(g,l,n,m,h[14],17,-1502002290),m=E(m,g,l,n,h[15],22,1236535329),n=I(n,m,g,l,h[1],5,-165796510),l=I(l,n,m,g,h[6],9,-1069501632),g=I(g,l,n,m,h[11],14,643717713),m=I(m,g,l,n,h[0],20,-373897302),n=I(n,m,g,l,h[5],5,-701558691),l=I(l,n,m,g,h[10],9,38016083),g=I(g,l,n,m,h[15],14,-660478335),m=I(m,g,l,n,h[4],20,-405537848),n=I(n,m,g,l,h[9],5,568446438),l=I(l,n,m,g,h[14],9,-1019803690),g=I(g,l,n,m,h[3],14,-187363961),m=I(m,g,l,n,h[8],20,1163531501),n=I(n,m,g,l,h[13],5,-1444681467),l=I(l,n,m,g,h[2],9,-51403784),g=I(g,l,n,m,h[7],14,1735328473),m=I(m,g,l,n,h[12],20,-1926607734),n=A(n,m,g,l,h[5],4,-378558),l=A(l,n,m,g,h[8],11,-2022574463),g=A(g,l,n,m,h[11],16,1839030562),m=A(m,g,l,n,h[14],23,-35309556),n=A(n,m,g,l,h[1],4,-1530992060),l=A(l,n,m,g,h[4],11,1272893353),g=A(g,l,n,m,h[7],16,-155497632),m=A(m,g,l,n,h[10],23,-1094730640),n=A(n,m,g,l,h[13],4,681279174),l=A(l,n,m,g,h[0],11,-358537222),g=A(g,l,n,m,h[3],16,-722521979),m=A(m,g,l,n,h[6],23,76029189),n=A(n,m,g,l,h[9],4,-640364487),l=A(l,n,m,g,h[12],11,-421815835),g=A(g,l,n,m,h[15],16,530742520),m=A(m,g,l,n,h[2],23,-995338651),n=w(n,m,g,l,h[0],6,-198630844),l=w(l,n,m,g,h[7],10,1126891415),g=w(g,l,n,m,h[14],15,-1416354905),m=w(m,g,l,n,h[5],21,-57434055),n=w(n,m,g,l,h[12],6,1700485571),l=w(l,n,m,g,h[3],10,-1894986606),g=w(g,l,n,m,h[10],15,-1051523),m=w(m,g,l,n,h[1],21,-2054922799),n=w(n,m,g,l,h[8],6,1873313359),l=w(l,n,m,g,h[15],10,-30611744),g=w(g,l,n,m,h[6],15,-1560198380),m=w(m,g,l,n,h[13],21,1309151649),n=w(n,m,g,l,h[4],6,-145523070),l=w(l,n,m,g,h[11],10,-1120210379),g=w(g,l,n,m,h[2],15,718787259),m=w(m,g,l,n,h[9],21,-343485551),i[0]=K(n,i[0]),i[1]=K(m,i[1]),i[2]=K(g,i[2]),i[3]=K(l,i[3])}function F(g){var i,h=[];for(i=0;64>i;i+=4){h[i>>2]=g.charCodeAt(i)+(g.charCodeAt(i+1)<<8)+(g.charCodeAt(i+2)<<16)+(g.charCodeAt(i+3)<<24)}return h}function D(g){var i,h=[];for(i=0;64>i;i+=4){h[i>>2]=g[i]+(g[i+1]<<8)+(g[i+2]<<16)+(g[i+3]<<24)}return h}function q(g){var p,l,i,r,m,h,o=g.length,n=[1732584193,-271733879,-1732584194,271733878];for(p=64;o>=p;p+=64){M(n,F(g.substring(p-64,p)))}for(g=g.substring(p-64),l=g.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;l>p;p+=1){i[p>>2]|=g.charCodeAt(p)<<(p%4<<3)}if(i[p>>2]|=128<<(p%4<<3),p>55){for(M(n,i),p=0;16>p;p+=1){i[p]=0}}return r=8*o,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),h=parseInt(r[1],16)||0,i[14]=m,i[15]=h,M(n,i),n}function B(g){var h,l,i,r,m,p,o=g.length,n=[1732584193,-271733879,-1732584194,271733878];for(h=64;o>=h;h+=64){M(n,D(g.subarray(h-64,h)))}for(g=o>h-64?g.subarray(h-64):new Uint8Array(0),l=g.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h=0;l>h;h+=1){i[h>>2]|=g[h]<<(h%4<<3)}if(i[h>>2]|=128<<(h%4<<3),h>55){for(M(n,i),h=0;16>h;h+=1){i[h]=0}}return r=8*o,r=r.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(r[2],16),p=parseInt(r[1],16)||0,i[14]=m,i[15]=p,M(n,i),n}function G(g){var i,h="";for(i=0;4>i;i+=1){h+=L[g>>8*i+4&15]+L[g>>8*i&15]}return h}function J(h){var g;for(g=0;g<h.length;g+=1){h[g]=G(h[g])}return h.join("")}function C(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(i,h){var n,m=i.length,l=new ArrayBuffer(m),g=new Uint8Array(l);for(n=0;m>n;n+=1){g[n]=i.charCodeAt(n)}return h?g:l}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(h,g,i){var l=new Uint8Array(h.byteLength+g.byteLength);return l.set(new Uint8Array(h)),l.set(new Uint8Array(g),h.byteLength),i?l:l.buffer}function N(h){var g,i=[],l=h.length;for(g=0;l-1>g;g+=2){i.push(parseInt(h.substr(g,2),16))}return String.fromCharCode.apply(String,i)}function z(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==J(q("hello"))&&(K=function(h,g){var i=(65535&h)+(65535&g),l=(h>>16)+(g>>16)+(i>>16);return l<<16|65535&i}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(h,i){return h=0|h||0,0>h?Math.max(h+i,0):Math.min(h,i)}ArrayBuffer.prototype.slice=function(s,n){var r,l,o,p,m=this.byteLength,h=g(s,m),i=m;return n!==H&&(i=g(n,m)),h>i?new ArrayBuffer(0):(r=i-h,l=new ArrayBuffer(r),o=new Uint8Array(l),p=new Uint8Array(this,h,r),o.set(p),l)}}(),z.prototype.append=function(g){return this.appendBinary(C(g)),this},z.prototype.appendBinary=function(g){this._buff+=g,this._length+=g.length;var i,h=this._buff.length;for(i=64;h>=i;i+=64){M(this._hash,F(this._buff.substring(i-64,i)))}return this._buff=this._buff.substring(i-64),this},z.prototype.end=function(i){var h,n,m=this._buff,l=m.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;l>h;h+=1){g[h>>2]|=m.charCodeAt(h)<<(h%4<<3)}return this._finish(g,l),n=J(this._hash),i&&(n=N(n)),this.reset(),n},z.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},z.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},z.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},z.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},z.prototype._finish=function(i,h){var n,m,l,g=h;if(i[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,i),g=0;16>g;g+=1){i[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(n[2],16),l=parseInt(n[1],16)||0,i[14]=m,i[15]=l,M(this._hash,i)},z.hash=function(h,g){return z.hashBinary(C(h),g)},z.hashBinary=function(h,g){var i=q(h),l=J(i);return g?N(l):l},z.ArrayBuffer=function(){this.reset()},z.ArrayBuffer.prototype.append=function(h){var g,i=f(this._buff.buffer,h,!0),l=i.length;for(this._length+=h.byteLength,g=64;l>=g;g+=64){M(this._hash,D(i.subarray(g-64,g)))}return this._buff=l>g-64?new Uint8Array(i.buffer.slice(g-64)):new Uint8Array(0),this},z.ArrayBuffer.prototype.end=function(i){var h,n,m=this._buff,l=m.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;l>h;h+=1){g[h>>2]|=m[h]<<(h%4<<3)}return this._finish(g,l),n=J(this._hash),i&&(n=N(n)),this.reset(),n},z.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},z.ArrayBuffer.prototype.getState=function(){var g=z.prototype.getState.call(this);return g.buff=j(g.buff),g},z.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),z.prototype.setState.call(this,g)},z.ArrayBuffer.prototype.destroy=z.prototype.destroy,z.ArrayBuffer.prototype._finish=z.prototype._finish,z.ArrayBuffer.hash=function(h,g){var i=B(new Uint8Array(h)),l=J(i);return g?N(l):l},z})},{}],17:[function(c,f,d){function g(p,j,l){var h=l[l.length-1];p===h.element&&(l.pop(),h=l[l.length-1]);var m=h.element,k=h.index;if(Array.isArray(m)){m.push(p)}else{if(k===j.length-2){var e=j.pop();m[e]=p}else{j.push(p)}}}d.stringify=function(q){var B=[];B.push({obj:q});for(var A,v,z,m,p,w,x,j,h,k,y,e="";A=B.pop();){if(v=A.obj,z=A.prefix||"",m=A.val||"",e+=z,m){e+=m}else{if("object"!=typeof v){e+="undefined"==typeof v?null:JSON.stringify(v)}else{if(null===v){e+="null"}else{if(Array.isArray(v)){for(B.push({val:"]"}),p=v.length-1;p>=0;p--){w=0===p?"":",",B.push({obj:v[p],prefix:w})}B.push({val:"["})}else{x=[];for(j in v){v.hasOwnProperty(j)&&x.push(j)}for(B.push({val:"}"}),p=x.length-1;p>=0;p--){h=x[p],k=v[h],y=p>0?",":"",y+=JSON.stringify(h)+":",B.push({obj:k,prefix:y})}B.push({val:"{"})}}}}}return e},d.parse=function(p){for(var x,e,v,y,m,j,q,h,w,k=[],z=[],r=0;;){if(x=p[r++],"}"!==x&&"]"!==x&&"undefined"!=typeof x){switch(x){case" ":case"	":case"\n":case":":case",":break;case"n":r+=3,g(null,k,z);break;case"t":r+=3,g(!0,k,z);break;case"f":r+=4,g(!1,k,z);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(e="",r--;;){if(v=p[r++],!/[\d\.\-e\+]/.test(v)){r--;break}e+=v}g(parseFloat(e),k,z);break;case'"':for(y="",m=void 0,j=0;;){if(q=p[r++],'"'===q&&("\\"!==m||j%2!==1)){break}y+=q,m=q,"\\"===m?j++:j=0}g(JSON.parse('"'+y+'"'),k,z);break;case"[":h={element:[],index:k.length},k.push(h.element),z.push(h);break;case"{":w={element:{},index:k.length},k.push(w.element),z.push(w);break;default:throw new Error("unexpectedly reached end of input: "+x)}}else{if(1===k.length){return k.pop()}g(k.pop(),k,z)}}}},{}]},{},[3])(3)});