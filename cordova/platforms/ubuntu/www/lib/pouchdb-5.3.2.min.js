!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(b,l,i){function e(g,n){if(!l[g]){if(!b[g]){var f="function"==typeof require&&require;if(!n&&f){return f(g,!0)}if(k){return k(g,!0)}var h=new Error("Cannot find module '"+g+"'");throw h.code="MODULE_NOT_FOUND",h}var j=l[g]={exports:{}};b[g][0].call(j.exports,function(p){var m=b[g][1][p];return e(m?m:p)},j,j.exports,d,b,l,i)}return l[g].exports}for(var k="function"==typeof require&&require,a=0;a<i.length;a++){e(i[a])}return e}({1:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],2:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var j="color: "+this.color;k=[k[0],j,"color: inherit"].concat(Array.prototype.slice.call(k,1));var g=0,f=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(g++,"%c"===l&&(f=g))}),k.splice(f,0,j),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(3),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{3:3}],3:[function(n,b,s){function u(){return s.colors[o++%s.colors.length]}function t(k){function h(){}function g(){var w=g,q=+new Date,v=q-(i||q);w.diff=v,w.prev=i,w.curr=q,i=q,null==w.useColors&&(w.useColors=s.useColors()),null==w.color&&w.useColors&&(w.color=u());var m=Array.prototype.slice.call(arguments);m[0]=s.coerce(m[0]),"string"!=typeof m[0]&&(m=["%o"].concat(m));var p=0;m[0]=m[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}p++;var x=s.formatters[A];if("function"==typeof x){var z=m[p];y=x.call(w,z),m.splice(p,1),p--}return y}),"function"==typeof s.formatArgs&&(m=s.formatArgs.apply(w,m));var l=g.log||s.log||console.log.bind(console);l.apply(w,m)}h.enabled=!1,g.enabled=!0;var j=s.enabled(k)?g:h;return j.namespace=k,j}function r(g){s.save(g);for(var k=(g||"").split(/[\s,]+/),h=k.length,j=0;h>j;j++){k[j]&&(g=k[j].replace(/\*/g,".*?"),"-"===g[0]?s.skips.push(new RegExp("^"+g.substr(1)+"$")):s.names.push(new RegExp("^"+g+"$")))}}function f(){s.enable("")}function a(g){var j,h;for(j=0,h=s.skips.length;h>j;j++){if(s.skips[j].test(g)){return !1}}for(j=0,h=s.names.length;h>j;j++){if(s.names[j].test(g)){return !0}}return !1}function e(g){return g instanceof Error?g.stack||g.message:g}s=b.exports=t,s.coerce=e,s.disable=f,s.enable=r,s.enabled=a,s.humanize=n(9),s.names=[],s.skips=[],s.formatters={};var i,o=0},{9:9}],4:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function i(f){return"number"==typeof f}function p(f){return"object"==typeof f&&null!==f}function m(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!i(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,f,h,j,r,l;if(this._events||(this._events={}),"error"===k&&(!this._events.error||p(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(f=this._events[k],m(f)){return !1}if(b(f)){switch(arguments.length){case 1:f.call(this);break;case 2:f.call(this,arguments[1]);break;case 3:f.call(this,arguments[1],arguments[2]);break;default:j=Array.prototype.slice.call(arguments,1),f.apply(this,j)}}else{if(p(f)){for(j=Array.prototype.slice.call(arguments,1),l=f.slice(),h=l.length,r=0;h>r;r++){l[r].apply(this,j)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?p(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,p(this._events[f])&&!this._events[f].warned&&(h=m(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(j,g){function h(){this.removeListener(j,h),f||(f=!0,g.apply(this,arguments))}if(!b(g)){throw TypeError("listener must be a function")}var f=!1;return h.listener=g,this.on(j,h),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(p(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],5:[function(b,e,a){(function(i){function r(){l=!0;for(var g,h,j=o.length;j;){for(h=o,o=[],g=-1;++g<j;){h[g]()}j=o.length}l=!1}function x(g){1!==o.push(g)||l||u()}var u,n=i.MutationObserver||i.WebKitMutationObserver;if(n){var f=0,y=new n(r),z=i.document.createTextNode("");y.observe(z,{characterData:!0}),u=function(){z.data=f=++f%2}}else{if(i.setImmediate||"undefined"==typeof i.MessageChannel){u="document" in i&&"onreadystatechange" in i.document.createElement("script")?function(){var g=i.document.createElement("script");g.onreadystatechange=function(){r(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:function(){setTimeout(r,0)}}else{var s=new i.MessageChannel;s.port1.onmessage=r,u=function(){s.port2.postMessage(0)}}}var l,o=[];e.exports=x}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(b,e,a){"function"==typeof Object.create?e.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],7:[function(b,e,a){(function(f){f("object"==typeof a?a:this)}).call(this,function(j){var l=Array.prototype.slice,f=Array.prototype.forEach,k=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=l.call(arguments,1);return f.call(g,function(i){if(i){for(var n in i){"object"==typeof i[n]&&h[n]?k.call(h,h[n],i[n]):h[n]=i[n]}}}),h};j.extend=k})},{}],8:[function(i,u,r){function l(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=e,this.queue=[],this.outcome=void 0,g!==l&&y(this,g)}function p(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function b(j,k,g){f(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function m(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(j,q){function w(A){x||(x=!0,K.reject(j,A))}function k(A){x||(x=!0,K.resolve(j,A))}function g(){q(k,w)}var x=!1,z=s(g);"error"===z.status&&w(z.value)}function s(j,q){var g={};try{g.value=j(q),g.status="success"}catch(k){g.status="error",g.value=k}return g}function o(g){return g instanceof this?g:K.resolve(new this(l),g)}function t(g){var j=new this(l);return K.reject(j,g)}function h(z){function k(E,D){function C(F){q[D]=F,++x!==j||B||(B=!0,K.resolve(w,q))}g.resolve(E).then(C,function(F){B||(B=!0,K.reject(w,F))})}var g=this;if("[object Array]"!==Object.prototype.toString.call(z)){return this.reject(new TypeError("must be an array"))}var j=z.length,B=!1;if(!j){return this.resolve([])}for(var q=new Array(j),x=0,A=-1,w=new this(l);++A<j;){k(z[A],A)}return w}function n(j){function q(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(k,B))},function(B){x||(x=!0,K.reject(k,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(j)){return this.reject(new TypeError("must be an array"))}var g=j.length,x=!1;if(!g){return this.resolve([])}for(var z=-1,k=new this(l);++z<g;){q(j[z])}return k}var f=i(5),K={},L=["REJECTED"],a=["FULFILLED"],e=["PENDING"];u.exports=r=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(k,q){if("function"!=typeof k&&this.state===a||"function"!=typeof q&&this.state===L){return this}var g=new this.constructor(l);if(this.state!==e){var j=this.state===a?k:q;b(g,j,this.outcome)}else{this.queue.push(new p(g,k,q))}return g},p.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},p.prototype.otherCallFulfilled=function(g){b(this.promise,this.onFulfilled,g)},p.prototype.callRejected=function(g){K.reject(this.promise,g)},p.prototype.otherCallRejected=function(g){b(this.promise,this.onRejected,g)},K.resolve=function(k,w){var g=s(m,w);if("error"===g.status){return K.reject(k,g.value)}var q=g.value;if(q){y(k,q)}else{k.state=a,k.outcome=w;for(var j=-1,x=k.queue.length;++j<x;){k.queue[j].callFulfilled(w)}}return k},K.reject=function(j,q){j.state=L,j.outcome=q;for(var g=-1,k=j.queue.length;++g<k;){j.queue[g].callRejected(q)}return j},r.resolve=o,r.reject=t,r.all=h,r.race=n},{5:5}],9:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],10:[function(r,D,o){function s(w){if(null!==w){switch(typeof w){case"boolean":return w?1:0;case"number":return i(w);case"string":return w.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var v=Array.isArray(w),g=v?w:Object.keys(w),m=-1,q=g.length,j="";if(v){for(;++m<q;){j+=o.toIndexableString(g[m])}}else{for(;++m<q;){var k=g[m];j+=o.toIndexableString(k)+o.toIndexableString(w[k])}}return j}}return""}function h(y,q){var g,k=q,j="1"===y[q];if(j){g=0,q++}else{var z="0"===y[q];q++;var w="",m=y.substring(q,q+a),v=parseInt(m,10)+e;for(z&&(v=-v),q+=a;;){var x=y[q];if("\x00"===x){break}w+=x,q++}w=w.split("."),g=1===w.length?parseInt(w,10):parseFloat(w[0]+"."+w[1]),z&&(g-=10),0!==v&&(g=parseFloat(g+"e"+v))}return{num:g,length:q-k}}function l(g,m){var v=g.pop();if(m.length){var j=m[m.length-1];v===j.element&&(m.pop(),j=m[m.length-1]);var q=j.element,w=j.index;if(Array.isArray(q)){q.push(v)}else{if(w===g.length-2){var k=g.pop();q[k]=v}else{g.push(v)}}}}function b(m,g){for(var q=Math.min(m.length,g.length),k=0;q>k;k++){var j=o.collate(m[k],g[k]);if(0!==j){return j}}return m.length===g.length?0:m.length>g.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(w,v){for(var g=Object.keys(w),m=Object.keys(v),q=Math.min(g.length,m.length),j=0;q>j;j++){var k=o.collate(g[j],m[j]);if(0!==k){return k}if(k=o.collate(w[g[j]],v[m[j]]),0!==k){return k}}return g.length===m.length?0:g.length>m.length?1:-1}function n(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function i(q){if(0===q){return"1"}var j=q.toExponential().split(/e\+?/),w=parseInt(j[1],10),y=0>q,x=y?"0":"2",v=(y?-w:w)-e,m=p.padLeft(v.toString(),"0",a);x+=u+m;var g=Math.abs(parseFloat(j[0]));y&&(g=10-g);var k=g.toFixed(20);return k=k.replace(/\.?0+$/,""),x+=u+k}var e=-324,a=3,u="",p=r(11);o.collate=function(j,m){if(j===m){return 0}j=o.normalizeKey(j),m=o.normalizeKey(m);var k=n(j),g=n(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?b(j,m):f(j,m)},o.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var v=0;j>v;v++){g[v]=o.normalizeKey(k[v])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var m in k){if(k.hasOwnProperty(m)){var q=k[m];"undefined"!=typeof q&&(g[m]=o.normalizeKey(q))}}}}}return g},o.toIndexableString=function(g){var j="\x00";return g=o.normalizeKey(g),n(g)+u+s(g)+j},o.parseIndexableString=function(y){for(var q=[],j=[],k=0;;){var w=y[k++];if("\x00"!==w){switch(w){case"1":q.push(null);break;case"2":q.push("1"===y[k]),k++;break;case"3":var m=h(y,k);q.push(m.num),k+=m.length;break;case"4":for(var v="";;){var x=y[k];if("\x00"===x){break}v+=x,k++}v=v.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),q.push(v);break;case"5":var z={element:[],index:q.length};q.push(z.element),j.push(z);break;case"6":var g={element:{},index:q.length};q.push(g.element),j.push(g);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+w)}}else{if(1===q.length){return q.pop()}l(q,j)}}}},{11:11}],11:[function(b,h,a){function e(f,l,m){for(var g="",n=m-f.length;g.length<n;){g+=l}return g}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var f,g=n.length,o=r.length;for(f=0;g>f;f++){if(f===o){return 1}var q=n.charAt(f),i=r.charAt(f);if(q!==i){return i>q?-1:1}}return o>g?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],12:[function(i,a,b){function j(){this.store={}}function e(g){if(this.store=new j,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}b.Map=j,b.Set=e,j.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},j.prototype.unmangle=function(f){return f.substring(1)},j.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},j.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},j.prototype.has=function(f){var g=this.mangle(f);return g in this.store},j.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},j.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},e.prototype.add=function(f){return this.store.set(f,!0)},e.prototype.has=function(f){return this.store.has(f)},e.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],13:[function(b,s,l){function o(){e=!1,r.length?a=r.concat(a):i=-1,a.length&&n()}function n(){if(!e){var g=setTimeout(o);e=!0;for(var h=a.length;h;){for(r=a,a=[];++i<h;){r&&r[i].run()}i=-1,h=a.length}r=null,e=!1,clearTimeout(g)}}function f(g,h){this.fun=g,this.array=h}function u(){}var r,t=s.exports={},a=[],e=!1,i=-1;t.nextTick=function(h){var j=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){j[g-1]=arguments[g]}}a.push(new f(h,j)),1!==a.length||e||setTimeout(n,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=u,t.addListener=u,t.once=u,t.off=u,t.removeListener=u,t.removeAllListeners=u,t.emit=u,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],14:[function(b,e,a){(function(){var h={}.hasOwnProperty,f=[].slice;e.exports=function(g,n){var o,p,q,r;p=[],r=[];for(o in n){h.call(n,o)&&(q=n[o],"this"!==o&&(p.push(o),r.push(q)))}return Function.apply(null,f.call(p).concat([g])).apply(n["this"],r)}}).call(this)},{}],15:[function(f,a,b){!function(i){if("object"==typeof b){a.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(n){function r(k,w,z,q,j,x){return w=i(i(w,k),i(q,x)),i(w<<j|w>>>32-j,z)}function Q(j,q,k,A,w,z,x){return r(q&k|~q&A,j,q,w,z,x)}function m(j,q,k,A,w,z,x){return r(q&A|k&~A,j,q,w,z,x)}function o(j,q,k,A,w,z,x){return r(q^k^A,j,q,w,z,x)}function v(j,q,k,A,w,z,x){return r(k^(q|~A),j,q,w,z,x)}function g(k,w){var z=k[0],q=k[1],x=k[2],j=k[3];z=Q(z,q,x,j,w[0],7,-680876936),j=Q(j,z,q,x,w[1],12,-389564586),x=Q(x,j,z,q,w[2],17,606105819),q=Q(q,x,j,z,w[3],22,-1044525330),z=Q(z,q,x,j,w[4],7,-176418897),j=Q(j,z,q,x,w[5],12,1200080426),x=Q(x,j,z,q,w[6],17,-1473231341),q=Q(q,x,j,z,w[7],22,-45705983),z=Q(z,q,x,j,w[8],7,1770035416),j=Q(j,z,q,x,w[9],12,-1958414417),x=Q(x,j,z,q,w[10],17,-42063),q=Q(q,x,j,z,w[11],22,-1990404162),z=Q(z,q,x,j,w[12],7,1804603682),j=Q(j,z,q,x,w[13],12,-40341101),x=Q(x,j,z,q,w[14],17,-1502002290),q=Q(q,x,j,z,w[15],22,1236535329),z=m(z,q,x,j,w[1],5,-165796510),j=m(j,z,q,x,w[6],9,-1069501632),x=m(x,j,z,q,w[11],14,643717713),q=m(q,x,j,z,w[0],20,-373897302),z=m(z,q,x,j,w[5],5,-701558691),j=m(j,z,q,x,w[10],9,38016083),x=m(x,j,z,q,w[15],14,-660478335),q=m(q,x,j,z,w[4],20,-405537848),z=m(z,q,x,j,w[9],5,568446438),j=m(j,z,q,x,w[14],9,-1019803690),x=m(x,j,z,q,w[3],14,-187363961),q=m(q,x,j,z,w[8],20,1163531501),z=m(z,q,x,j,w[13],5,-1444681467),j=m(j,z,q,x,w[2],9,-51403784),x=m(x,j,z,q,w[7],14,1735328473),q=m(q,x,j,z,w[12],20,-1926607734),z=o(z,q,x,j,w[5],4,-378558),j=o(j,z,q,x,w[8],11,-2022574463),x=o(x,j,z,q,w[11],16,1839030562),q=o(q,x,j,z,w[14],23,-35309556),z=o(z,q,x,j,w[1],4,-1530992060),j=o(j,z,q,x,w[4],11,1272893353),x=o(x,j,z,q,w[7],16,-155497632),q=o(q,x,j,z,w[10],23,-1094730640),z=o(z,q,x,j,w[13],4,681279174),j=o(j,z,q,x,w[0],11,-358537222),x=o(x,j,z,q,w[3],16,-722521979),q=o(q,x,j,z,w[6],23,76029189),z=o(z,q,x,j,w[9],4,-640364487),j=o(j,z,q,x,w[12],11,-421815835),x=o(x,j,z,q,w[15],16,530742520),q=o(q,x,j,z,w[2],23,-995338651),z=v(z,q,x,j,w[0],6,-198630844),j=v(j,z,q,x,w[7],10,1126891415),x=v(x,j,z,q,w[14],15,-1416354905),q=v(q,x,j,z,w[5],21,-57434055),z=v(z,q,x,j,w[12],6,1700485571),j=v(j,z,q,x,w[3],10,-1894986606),x=v(x,j,z,q,w[10],15,-1051523),q=v(q,x,j,z,w[1],21,-2054922799),z=v(z,q,x,j,w[8],6,1873313359),j=v(j,z,q,x,w[15],10,-30611744),x=v(x,j,z,q,w[6],15,-1560198380),q=v(q,x,j,z,w[13],21,1309151649),z=v(z,q,x,j,w[4],6,-145523070),j=v(j,z,q,x,w[11],10,-1120210379),x=v(x,j,z,q,w[2],15,718787259),q=v(q,x,j,z,w[9],21,-343485551),k[0]=i(z,k[0]),k[1]=i(q,k[1]),k[2]=i(x,k[2]),k[3]=i(j,k[3])}function p(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k.charCodeAt(q)+(k.charCodeAt(q+1)<<8)+(k.charCodeAt(q+2)<<16)+(k.charCodeAt(q+3)<<24)}return j}function O(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k[q]+(k[q+1]<<8)+(k[q+2]<<16)+(k[q+3]<<24)}return j}function s(C){var x,q,z,w,k,A,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;B>=x;x+=64){g(j,p(C.substring(x-64,x)))}for(C=C.substring(x-64),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;q>x;x+=1){z[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(z[x>>2]|=128<<(x%4<<3),x>55){for(g(j,z),x=0;16>x;x+=1){z[x]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),A=parseInt(w[1],16)||0,z[14]=k,z[15]=A,g(j,z),j}function P(C){var A,q,z,w,k,x,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(A=64;B>=A;A+=64){g(j,O(C.subarray(A-64,A)))}for(C=B>A-64?C.subarray(A-64):new Uint8Array(0),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=0;q>A;A+=1){z[A>>2]|=C[A]<<(A%4<<3)}if(z[A>>2]|=128<<(A%4<<3),A>55){for(g(j,z),A=0;16>A;A+=1){z[A]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,z[14]=k,z[15]=x,g(j,z),j}function u(k){var q,j="";for(q=0;4>q;q+=1){j+=h[k>>8*q+4&15]+h[k>>8*q&15]}return j}function l(j){var k;for(k=0;k<j.length;k+=1){j[k]=u(j[k])}return j.join("")}function t(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(k,w){var z,q=k.length,j=new ArrayBuffer(q),x=new Uint8Array(j);for(z=0;q>z;z+=1){x[z]=k.charCodeAt(z)}return w?x:j}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(k,w,j){var q=new Uint8Array(k.byteLength+w.byteLength);return q.set(new Uint8Array(k)),q.set(new Uint8Array(w),k.byteLength),j?q:q.buffer}function e(k){var w,j=[],q=k.length;for(w=0;q-1>w;w+=2){j.push(parseInt(k.substr(w,2),16))}return String.fromCharCode.apply(String,j)}function y(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==l(s("hello"))&&(i=function(k,w){var j=(65535&k)+(65535&w),q=(k>>16)+(w>>16)+(j>>16);return q<<16|65535&j}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(B,w){var D,C,k,x,A=this.byteLength,z=j(B,A),q=A;return w!==n&&(q=j(w,A)),z>q?new ArrayBuffer(0):(D=q-z,C=new ArrayBuffer(D),k=new Uint8Array(C),x=new Uint8Array(this,z,D),k.set(x),C)}}(),y.prototype.append=function(j){return this.appendBinary(t(j)),this},y.prototype.appendBinary=function(k){this._buff+=k,this._length+=k.length;var q,j=this._buff.length;for(q=64;j>=q;q+=64){g(this._hash,p(this._buff.substring(q-64,q)))}return this._buff=this._buff.substring(q-64),this},y.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q.charCodeAt(w)<<(w%4<<3)}return this._finish(x,j),z=l(this._hash),k&&(z=e(z)),this.reset(),z},y.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},y.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},y.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},y.prototype._finish=function(k,w){var z,q,j,x=w;if(k[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,k),x=0;16>x;x+=1){k[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),q=parseInt(z[2],16),j=parseInt(z[1],16)||0,k[14]=q,k[15]=j,g(this._hash,k)},y.hash=function(j,k){return y.hashBinary(t(j),k)},y.hashBinary=function(k,w){var j=s(k),q=l(j);return w?e(q):q},y.ArrayBuffer=function(){this.reset()},y.ArrayBuffer.prototype.append=function(k){var w,j=T(this._buff.buffer,k,!0),q=j.length;for(this._length+=k.byteLength,w=64;q>=w;w+=64){g(this._hash,O(j.subarray(w-64,w)))}return this._buff=q>w-64?new Uint8Array(j.buffer.slice(w-64)):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q[w]<<(w%4<<3)}return this._finish(x,j),z=l(this._hash),k&&(z=e(z)),this.reset(),z},y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.getState=function(){var j=y.prototype.getState.call(this);return j.buff=S(j.buff),j},y.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),y.prototype.setState.call(this,j)},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.hash=function(k,w){var j=P(new Uint8Array(k)),q=l(j);return w?e(q):q},y})},{}],16:[function(b,h,a){function e(n,r,f){var g=f[f.length-1];n===g.element&&(f.pop(),g=f[f.length-1]);var o=g.element,q=g.index;if(Array.isArray(o)){o.push(n)}else{if(q===r.length-2){var i=r.pop();o[i]=n}else{r.push(n)}}}a.stringify=function(i){var s=[];s.push({obj:i});for(var E,g,F,n,l,f,u,C,D,o,t,r="";E=s.pop();){if(g=E.obj,F=E.prefix||"",n=E.val||"",r+=F,n){r+=n}else{if("object"!=typeof g){r+="undefined"==typeof g?null:JSON.stringify(g)}else{if(null===g){r+="null"}else{if(Array.isArray(g)){for(s.push({val:"]"}),l=g.length-1;l>=0;l--){f=0===l?"":",",s.push({obj:g[l],prefix:f})}s.push({val:"["})}else{u=[];for(C in g){g.hasOwnProperty(C)&&u.push(C)}for(s.push({val:"}"}),l=u.length-1;l>=0;l--){D=u[l],o=g[D],t=l>0?",":"",t+=JSON.stringify(D)+":",s.push({obj:o,prefix:t})}s.push({val:"{"})}}}}}return r},a.parse=function(B){for(var C,l,A,g,D,s,t,i,n,u=[],f=[],o=0;;){if(C=B[o++],"}"!==C&&"]"!==C&&"undefined"!=typeof C){switch(C){case" ":case"	":case"\n":case":":case",":break;case"n":o+=3,e(null,u,f);break;case"t":o+=3,e(!0,u,f);break;case"f":o+=4,e(!1,u,f);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(l="",o--;;){if(A=B[o++],!/[\d\.\-e\+]/.test(A)){o--;break}l+=A}e(parseFloat(l),u,f);break;case'"':for(g="",D=void 0,s=0;;){if(t=B[o++],'"'===t&&("\\"!==D||s%2!==1)){break}g+=t,D=t,"\\"===D?s++:s=0}e(JSON.parse('"'+g+'"'),u,f);break;case"[":i={element:[],index:u.length},u.push(i.element),f.push(i);break;case"{":n={element:{},index:u.length},u.push(n.element),f.push(n);break;default:throw new Error("unexpectedly reached end of input: "+C)}}else{if(1===u.length){return u.pop()}e(u.pop(),u,f)}}}},{}],17:[function(b,e,a){(function(ig,hq){function hU(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function gF(t,ab){for(var ac={},aa=0,ad=ab.length;ad>aa;aa++){var af=ab[aa];af in t&&(ac[af]=t[af])}return ac}function a2(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function gC(aa){if("function"==typeof aa.slice){return aa.slice(0)}var ac=new ArrayBuffer(aa.byteLength),t=new Uint8Array(ac),ab=new Uint8Array(aa);return t.set(ab),ac}function hJ(aa){if(aa instanceof ArrayBuffer){return gC(aa)}var ab=aa.size,t=aa.type;return"function"==typeof aa.slice?aa.slice(0,ab,t):aa.webkitSlice(0,ab,t)}function gy(t){var ab,ac,aa;if(!t||"object"!=typeof t){return t}if(Array.isArray(t)){for(ab=[],ac=0,aa=t.length;aa>ac;ac++){ab[ac]=gy(t[ac])}return ab}if(t instanceof Date){return t.toISOString()}if(a2(t)){return hJ(t)}ab={};for(ac in t){if(Object.prototype.hasOwnProperty.call(t,ac)){var ad=gy(t[ac]);"undefined"!=typeof ad&&(ab[ac]=ad)}}return ab}function i9(t){var aa=!1;return gk(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function js(t){return gk(function(ac){ac=gy(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){ig.nextTick(function(){ad(ah,ag)})});var af=new fq(function(ak,al){var ah;try{var aj=i9(function(ap,am){ap?al(ap):ak(am)});ac.push(aj),ah=t.apply(aa,ac),ah&&"function"==typeof ah.then&&ak(ah)}catch(ag){al(ag)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function gT(aa,ab){function t(ac,af,ah){if(iG.enabled){for(var ad=[ac._db_name,af],aj=0;aj<ah.length-1;aj++){ad.push(ah[aj])}iG.apply(null,ad);var ag=ah[ah.length-1];ah[ah.length-1]=function(ak,am){var al=[ac._db_name,af];al=al.concat(ak?["error",ak]:["success",am]),iG.apply(null,al),ag(ak,am)}}}return js(gk(function(ad){if(this._closed){return fq.reject(new Error("database is closed"))}if(this._destroyed){return fq.reject(new Error("database is destroyed"))}var ac=this;return t(ac,aa,ad),this.taskqueue.isReady?ab.apply(this,ad):new fq(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[aa].apply(ac,ad))})})}))}function hO(aa,ab,t){return new fq(function(ad,ac){aa.get(ab,function(aj,ag){if(aj){if(404!==aj.status){return ac(aj)}ag={}}var ah=ag._rev,af=t(ag);return af?(af._id=ab,af._rev=ah,void ad(B(aa,af,t))):ad({updated:!1,rev:ah})})})}function B(aa,ab,t){return aa.put(ab).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return hO(aa,ab._id,t)})}function hA(t){for(var aj,af,ah,ag,ac=t.rev_tree.slice();ag=ac.pop();){var al=ag.ids,ab=al[2],ak=ag.pos;if(ab.length){for(var am=0,aa=ab.length;aa>am;am++){ac.push({pos:ak+1,ids:ab[am]})}}else{var ad=!!al[1].deleted,ap=al[0];aj&&!(ah!==ad?ah:af!==ak?ak>af:ap>aj)||(aj=ap,af=ak,ah=ad)}}return af+"-"+aj}function iX(t){return t.ids}function ie(t,ab){ab||(ab=hA(t));for(var ac,aa=ab.substring(ab.indexOf("-")+1),ad=t.rev_tree.map(iX);ac=ad.pop();){if(ac[0]===aa){return !!ac[1].deleted}ad=ad.concat(ac[2])}}function fx(t){return n("return "+t+";",{})}function fS(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function D(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function a0(t){var aa=D(t);return aa?aa.join("/"):null}function jr(ah,af){for(var ak,ac=ah.slice();ak=ac.pop();){for(var aa=ak.pos,aj=ak.ids,ag=aj[2],ad=af(0===ag.length,aa,aj[0],ak.ctx,aj[1]),t=0,ab=ag.length;ab>t;t++){ac.push({pos:aa+1,ids:ag[t],ctx:ad})}}}function hf(t,aa){return t.pos-aa.pos}function iR(aa){var ac=[];jr(aa,function(ah,af,aj,ag,ad){ah&&ac.push({rev:af+"-"+aj,pos:af,opts:ad})}),ac.sort(hf).reverse();for(var t=0,ab=ac.length;ab>t;t++){delete ac[t].pos}return ac}function q(ad){for(var aa=hA(ad),ag=iR(ad.rev_tree),t=[],ac=0,ab=ag.length;ab>ac;ac++){var af=ag[ac];af.rev===aa||af.opts.deleted||t.push(af.rev)}return t}function je(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function jd(aa,ac,t){function ab(af){for(var ad in aa){"function"!=typeof aa[ad]&&(this[ad]=aa[ad])}void 0!==t&&(this.name=t),void 0!==af&&(this.reason=af)}return ab.prototype=je.prototype,new ab(ac)}function fY(t){var ab,ac,aa,ad,af;return ac=t.error===!0&&"string"==typeof t.name?t.name:t.error,af=t.reason,aa=gM("name",ac,af),t.missing||"missing"===af||"deleted"===af||"not_found"===ac?aa=l:"doc_validation"===ac?(aa=iV,ad=af):"bad_request"===ac&&aa.message!==af&&(aa=fT),aa||(aa=gM("status",t.status,af)||a4),ab=jd(aa,af,ac),ad&&(ab.message=ad),t.id&&(ab.id=t.id),t.status&&(ab.status=t.status),t.missing&&(ab.missing=t.missing),ab}function at(ad,aa,ag){function t(){ac.cancel()}jc.EventEmitter.call(this);var ac=this;this.db=ad,aa=aa?gy(aa):{};var ab=aa.complete=i9(function(ah,aj){ah?ac.emit("error",ah):ac.emit("complete",aj),ac.removeAllListeners(),ad.removeListener("destroyed",t)});ag&&(ac.on("complete",function(ah){ag(null,ah)}),ac.on("error",ag)),ad.once("destroyed",t),aa.onChange=function(ah){aa.isCancelled||(ac.emit("change",ah),ac.startSeq&&ac.startSeq<=ah.seq&&(ac.startSeq=!1))};var af=new fq(function(ah,aj){aa.complete=function(al,ak){al?aj(al):ah(ak)}});ac.once("cancel",function(){ad.removeListener("destroyed",t),aa.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ab(null,ah)},ab),ad.taskqueue.isReady?ac.doChanges(aa):ad.taskqueue.addTask(function(){ac.isCancelled?ac.emit("cancel"):ac.doChanges(aa)})}function fZ(t,ab,ac){var aa=[{rev:t._rev}];"all_docs"===ac.style&&(aa=iR(ab.rev_tree).map(function(af){return{rev:af.rev}}));var ad={id:ab.id,changes:aa,doc:t};return ie(ab,t._rev)&&(ad.deleted=!0),ac.conflicts&&(ad.doc._conflicts=q(ab),ad.doc._conflicts.length||delete ad.doc._conflicts),ad}function g5(al,ag,aa){function ad(){var am=[];ab.forEach(function(ap){ap.docs.forEach(function(aq){am.push({id:ap.id,docs:[aq]})})}),aa(null,{results:am})}function ac(){++t===aj&&ad()}function ak(aq,am,ap){ab[aq]={id:am,docs:ap},ac()}var af=Array.isArray(ag)?ag:ag.docs,ah={};af.forEach(function(am){am.id in ah?ah[am.id].push(am):ah[am.id]=[am]});var aj=Object.keys(ah).length,t=0,ab=new Array(aj);Object.keys(ah).forEach(function(av,ap){var au=ah[av],am=gF(au[0],["atts_since","attachments"]);am.open_revs=au.map(function(aw){return aw.rev}),am.open_revs=am.open_revs.filter(function(aw){return aw});var aq=function(aw){return aw};0===am.open_revs.length&&(delete am.open_revs,aq=function(aw){return[{ok:aw}]}),["revs","attachments","binary","ajax"].forEach(function(aw){aw in ag&&(am[aw]=ag[aw])}),al.get(av,am,function(aw,ax){ak(ap,av,aw?[{error:aw}]:aq(ax))})})}function fl(t){return/^_local/.test(t)}function gQ(t){for(var aj,af=[],ah=t.slice();aj=ah.pop();){var ag=aj.pos,ac=aj.ids,al=ac[0],ab=ac[1],ak=ac[2],am=0===ak.length,aa=aj.history?aj.history.slice():[];aa.push({id:al,opts:ab}),am&&af.push({pos:ag+1-aa.length,ids:aa});for(var ad=0,ap=ak.length;ap>ad;ad++){ah.push({pos:ag+1,ids:ak[ad],history:aa})}}return af.reverse()}function jb(t){return 0|Math.random()*t}function gp(aa,ac){ac=ac||W.length;var t="",ab=-1;if(aa){for(;++ab<aa;){t+=W[jb(ac)]}return t}for(;++ab<36;){switch(ab){case 8:case 13:case 18:case 23:t+="-";break;case 19:t+=W[3&jb(16)|8];break;default:t+=W[jb(16)]}}return t}function h7(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function hE(t){var aa;if(t?"string"!=typeof t?aa=jd(hr):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=jd(hb)):aa=jd(gW),aa){throw aa}}function iS(aa){if(!/^\d+\-./.test(aa)){return jd(ar)}var ac=aa.indexOf("-"),t=aa.substring(0,ac),ab=aa.substring(ac+1);return{prefix:parseInt(t,10),id:ab}}function gv(ad,aa){for(var ag=ad.start-ad.ids.length+1,t=ad.ids,ac=[t[0],aa,[]],ab=1,af=t.length;af>ab;ab++){ac=[t[ab],{status:"missing"},[ac]]}return[{pos:ag,ids:ac}]}function bt(ah,af){var ak,ac,aa,aj={status:"available"};if(ah._deleted&&(aj.deleted=!0),af){if(ah._id||(ah._id=gp()),ac=gp(32,16).toLowerCase(),ah._rev){if(aa=iS(ah._rev),aa.error){return aa}ah._rev_tree=[{pos:aa.prefix,ids:[aa.id,{status:"missing"},[[ac,aj,[]]]]}],ak=aa.prefix+1}else{ah._rev_tree=[{pos:1,ids:[ac,aj,[]]}],ak=1}}else{if(ah._revisions&&(ah._rev_tree=gv(ah._revisions,aj),ak=ah._revisions.start,ac=ah._revisions.ids[0]),!ah._rev_tree){if(aa=iS(ah._rev),aa.error){return aa}ak=aa.prefix,ac=aa.id,ah._rev_tree=[{pos:ak,ids:[ac,aj,[]]}]}}hE(ah._id),ah._rev=ak+"-"+ac;var ag={metadata:{},data:{}};for(var ad in ah){if(Object.prototype.hasOwnProperty.call(ah,ad)){var t="_"===ad[0];if(t&&!hu[ad]){var ab=jd(iV,ad);throw ab.message=iV.message+": "+ad,ab}t&&!h5[ad]?ag.metadata[ad.slice(1)]=ah[ad]:ag.data[ad]=ah[ad]}}return ag}function ft(t,aa){return aa>t?-1:t>aa?1:0}function gx(aa,ab){for(var t=0;t<aa.length;t++){if(ab(aa[t],t)===!0){return aa[t]}}}function gO(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function et(t){for(var ab=0;ab<t.length;ab++){var ac=t[ab];if(ac._deleted){delete ac._attachments}else{if(ac._attachments){for(var aa=Object.keys(ac._attachments),ad=0;ad<aa.length;ad++){var af=aa[ad];ac._attachments[af]=gF(ac._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function gq(t,ab){var ac=ft(t._id,ab._id);if(0!==ac){return ac}var aa=t._revisions?t._revisions.start:0,ad=ab._revisions?ab._revisions.start:0;return ft(aa,ad)}function h3(aa){var ab={},t=[];return jr(aa,function(ag,ah,af,ac){var ad=ah+"-"+af;return ag&&(ab[ad]=0),void 0!==ac&&t.push({from:ac,to:ad}),ad}),t.reverse(),t.forEach(function(ac){void 0===ab[ac.from]?ab[ac.from]=1+ab[ac.to]:ab[ac.from]=Math.min(ab[ac.from],1+ab[ac.to])}),ab}function g(t,ab,ac){var aa="limit" in ab?ab.keys.slice(ab.skip,ab.limit+ab.skip):ab.skip>0?ab.keys.slice(ab.skip):ab.keys;if(ab.descending&&aa.reverse(),!aa.length){return t._allDocs({limit:0},ac)}var ad={offset:ab.skip};return fq.all(aa.map(function(af){var ag=jC.extend({key:af,deleted:"ok"},ab);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new fq(function(ah,aj){t._allDocs(ag,function(ak,al){return ak?aj(ak):(ad.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ad.rows=af,ad})}function h0(aa){var ac=aa._compactionQueue[0],ab=ac.opts,t=ac.callback;aa.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ab.last_seq=ad.last_seq),aa._compact(ab,function(ag,af){ag?t(ag):t(null,af),ig.nextTick(function(){aa._compactionQueue.shift(),aa._compactionQueue.length&&h0(aa)})})})}function gG(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function v(t,ab,ac,aa){ab.seq=ab.seq||0;var ad={doc_ids:["_design/"+ac],limit:1,since:ab.seq};t.changes(ad).then(function(ag){var af=ag.results&&ag.results.length&&ag.results[0].seq;af&&af>ab.seq&&(ab.seq=af,delete ab.promise),aa()})["catch"](aa)}function im(aa,ac,t){aa._ddocCache=aa._ddocCache||{},aa._ddocCache[ac]=aa._ddocCache[ac]||{};var ab=aa._ddocCache[ac];v(aa,ab,ac,function(ad){return ad?t(ad):(ab.promise||(ab.promise=new fq(function(af,ag){aa._get("_design/"+ac,{},function(aj,ak){if(aj){return ag(aj)}var ah={};["views","filters"].forEach(function(al){ah[al]=ak.doc[al]}),af(ah)})})),void ab.promise.then(function(af){t(null,af)})["catch"](t))})}function gn(t,ab,ac,aa,ad){im(t,ab,function(ah,af){if(ah){return ad(ah)}var ag=af[ac]&&af[ac][aa];return ag?void ad(null,ag):ad(jd(l))})}function ih(){jc.EventEmitter.call(this)}function iF(){this.isReady=!1,this.failed=!1,this.queue=[]}function iK(t){t&&hq.debug&&console.error(t)}function gD(ad,aa){function ag(){ab.emit("destroyed",ac)}function t(){ad.removeListener("destroyed",ag),ad.emit("destroyed",ad)}var ac=aa.originalName,ab=ad.constructor,af=ab._destructionListeners;ad.once("destroyed",ag),af.has(ac)||af.set(ac,[]),af.get(ac).push(t)}function hB(t,ab,ac){if(!(this instanceof hB)){return new hB(t,ab,ac)}var aa=this;"function"!=typeof ab&&"undefined"!=typeof ab||(ac=ab,ab={}),t&&"object"==typeof t&&(ab=t,t=void 0),"undefined"==typeof ac&&(ac=iK),t=t||ab.name,ab=gy(ab),delete ab.name,this.__opts=ab;var ad=ac;aa.auto_compaction=ab.auto_compaction,aa.prefix=hB.prefix,ih.call(aa),aa.taskqueue=new iF;var af=new fq(function(ak,ag){ac=function(ap,am){return ap?ag(ap):(delete am.then,void ak(am))},ab=gy(ab);var aj,al,ah=ab.name||t;return function(){try{if("string"!=typeof ah){throw al=new Error("Missing/invalid DB name"),al.code=400,al}if(aj=hB.parseAdapter(ah,ab),ab.originalName=ah,ab.name=aj.name,ab.prefix&&"http"!==aj.adapter&&"https"!==aj.adapter&&(ab.name=ab.prefix+ab.name),ab.adapter=ab.adapter||aj.adapter,aa._adapter=ab.adapter,jq("pouchdb:adapter")("Picked adapter: "+ab.adapter),aa._db_name=ah,!hB.adapters[ab.adapter]){throw al=new Error("Adapter is missing"),al.code=404,al}if(!hB.adapters[ab.adapter].valid()){throw al=new Error("Invalid Adapter"),al.code=404,al}}catch(am){aa.taskqueue.fail(am)}}(),al?ag(al):(aa.adapter=ab.adapter,aa.replicate={},aa.replicate.from=function(aq,am,ap){return aa.constructor.replicate(aq,aa,am,ap)},aa.replicate.to=function(aq,am,ap){return aa.constructor.replicate(aa,aq,am,ap)},aa.sync=function(aq,am,ap){return aa.constructor.sync(aa,aq,am,ap)},aa.replicate.sync=aa.sync,void hB.adapters[ab.adapter].call(aa,ab,function(am){return am?(aa.taskqueue.fail(am),void ac(am)):(gD(aa,ab),aa.emit("created",aa),hB.emit("created",ab.originalName),aa.taskqueue.ready(aa),void ac(null,aa))}))});af.then(function(ag){ad(null,ag)},ad),aa.then=af.then.bind(af),aa["catch"]=af["catch"].bind(af)}function g3(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function ho(){return jg}function jh(t){Object.keys(jc.EventEmitter.prototype).forEach(function(ab){"function"==typeof jc.EventEmitter.prototype[ab]&&(t[ab]=il[ab].bind(il))});var aa=t._destructionListeners=new gJ.Map;t.on("destroyed",function(ab){aa.has(ab)&&(aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab))})}function hl(t,ab){t=t||[],ab=ab||{};try{return new Blob(t,ab)}catch(ac){if("TypeError"!==ac.name){throw ac}for(var aa="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ad=new aa,af=0;af<t.length;af+=1){ad.append(t[af])}return ad.getBlob(ab.type)}}function hK(aa,ab){if("undefined"==typeof FileReader){return ab((new FileReaderSync).readAsArrayBuffer(aa))}var t=new FileReader;t.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);ab(ac)},t.readAsArrayBuffer(aa)}function hW(){for(var aa={},ac=new fq(function(af,ad){aa.resolve=af,aa.reject=ad}),t=new Array(arguments.length),ab=0;ab<t.length;ab++){t[ab]=arguments[ab]}return aa.promise=ac,fq.resolve().then(function(){return fetch.apply(null,t)}).then(function(ad){aa.resolve(ad)})["catch"](function(ad){aa.reject(ad)}),aa}function fb(ad,aa){var ag,t,ac,ab=new Headers,af={method:ad.method,credentials:"include",headers:ab};return ad.json&&(ab.set("Accept","application/json"),ab.set("Content-Type",ad.headers["Content-Type"]||"application/json")),ad.body&&ad.body instanceof Blob?hK(ad.body,function(ah){af.body=ah}):ad.body&&ad.processData&&"string"!=typeof ad.body?af.body=JSON.stringify(ad.body):"body" in ad?af.body=ad.body:af.body=null,Object.keys(ad.headers).forEach(function(ah){ad.headers.hasOwnProperty(ah)&&ab.set(ah,ad.headers[ah])}),ag=hW(ad.url,af),ad.timeout>0&&(t=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ad.url))},ad.timeout)),ag.promise.then(function(ah){return ac={statusCode:ah.status},ad.timeout>0&&clearTimeout(t),ac.statusCode>=200&&ac.statusCode<300?ad.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ac.statusCode>=200&&ac.statusCode<300?aa(null,ac,ah):aa(ah,ac)})["catch"](function(ah){aa(ah,ac)}),{abort:ag.reject}}function iJ(aa,ah){var ab,ad,ac=!1,aj=function(){ab.abort()},ag=function(){ac=!0,ab.abort()};ab=aa.xhr?new aa.xhr:new XMLHttpRequest;try{ab.open(aa.method,aa.url)}catch(af){ah(af,{statusCode:413})}ab.withCredentials="withCredentials" in aa?aa.withCredentials:!0,"GET"===aa.method?delete aa.headers["Content-Type"]:aa.json&&(aa.headers.Accept="application/json",aa.headers["Content-Type"]=aa.headers["Content-Type"]||"application/json",aa.body&&aa.processData&&"string"!=typeof aa.body&&(aa.body=JSON.stringify(aa.body))),aa.binary&&(ab.responseType="arraybuffer"),"body" in aa||(aa.body=null);for(var t in aa.headers){aa.headers.hasOwnProperty(t)&&ab.setRequestHeader(t,aa.headers[t])}return aa.timeout>0&&(ad=setTimeout(ag,aa.timeout),ab.onprogress=function(){clearTimeout(ad),4!==ab.readyState&&(ad=setTimeout(ag,aa.timeout))},"undefined"!=typeof ab.upload&&(ab.upload.onprogress=ab.onprogress)),ab.onreadystatechange=function(){if(4===ab.readyState){var ak={statusCode:ab.status};if(ab.status>=200&&ab.status<300){var am;am=aa.binary?hl([ab.response||""],{type:ab.getResponseHeader("Content-Type")}):ab.responseText,ah(null,ak,am)}else{var ap={};if(ac){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ab.response)}catch(al){}}ah(ap,ak)}}},aa.body&&aa.body instanceof Blob?hK(aa.body,function(ak){ab.send(ak)}):ab.send(aa.body),{abort:aj}}function G(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function fy(t,aa){return jk||t.xhr?iJ(t,aa):fb(t,aa)}function iv(){return""}function jt(t,ab){function ac(ag,ah,af){if(!t.binary&&t.json&&"string"==typeof ag){try{ag=JSON.parse(ag)}catch(aj){return af(aj)}}Array.isArray(ag)&&(ag=ag.map(function(ak){return ak.error||ak.missing?fY(ak):ak})),t.binary&&hy(ag,ah),af(null,ag,ah)}function aa(ak,af){var ah,al;if(ak.code&&ak.status){var aj=new Error(ak.message||ak.code);return aj.status=ak.status,af(aj)}if(ak.message&&"ETIMEDOUT"===ak.message){return af(ak)}try{ah=JSON.parse(ak.responseText),al=fY(ah)}catch(ag){al=fY(ak)}af(al)}t=gy(t);var ad={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return t=jC.extend(ad,t),t.json&&(t.binary||(t.headers.Accept="application/json"),t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json"),t.binary&&(t.encoding=null,t.json=!1),t.processData||(t.json=!1),fy(t,function(al,ag,aj){if(al){return al.status=ag?ag.statusCode:400,aa(al,ab)}var af,ah=ag.headers&&ag.headers["content-type"],ak=aj||iv();if(!t.binary&&(t.json||!t.processData)&&"object"!=typeof ak&&(/json/.test(ah)||/^[\s]*\{/.test(ak)&&/\}[\s]*$/.test(ak))){try{ak=JSON.parse(ak.toString())}catch(am){}}ag.statusCode>=200&&ag.statusCode<300?ac(ak,ag,ab):(af=fY(ak),af.status=ag.statusCode,ab(af))})}function gH(ah,af){var ak=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ac=-1!==ak.indexOf("safari")&&-1===ak.indexOf("chrome"),aa=-1!==ak.indexOf("msie"),aj=-1!==ak.indexOf("edge"),ag=ac||(aa||aj)&&"GET"===ah.method,ad="cache" in ah?ah.cache:!0,t=/^blob:/.test(ah.url);if(!t&&(ag||!ad)){var ab=-1!==ah.url.indexOf("?");ah.url+=(ab?"&":"?")+"_nonce="+Date.now()}return jt(ah,af)}function z(ad){for(var aa=jm.exec(ad),ag={},t=14;t--;){var ac=eu[t],ab=aa[t]||"",af=-1!==["user","password"].indexOf(ac);ag[ac]=af?decodeURIComponent(ab):ab}return ag[ex]={},ag[eu[12]].replace(it,function(aj,ah,ak){ah&&(ag[ex][ah]=ak)}),ag}function a3(t){for(var ab=t.length,ac=new ArrayBuffer(ab),aa=new Uint8Array(ac),ad=0;ab>ad;ad++){aa[ad]=t.charCodeAt(ad)}return ac}function hT(t,aa){return hl([a3(t)],{type:aa})}function h8(t,ab,ac){try{return !t(ab,ac)}catch(aa){var ad="Filter function threw: "+aa.toString();return jd(fT,ad)}}function fe(aa){var ab={},t=aa.filter&&"function"==typeof aa.filter;return ab.query=aa.query_params,function(ad){ad.doc||(ad.doc={});var ac=t&&h8(aa.filter,ad.doc,ab);if("object"==typeof ac){return ac}if(ac){return !1}if(aa.include_docs){if(!aa.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function ia(t,aa){"console" in hq&&"info" in console&&console.info("The above "+t+" is totally normal. "+aa)}function iB(t,ab,ac,aa,ad){return t.get(ab)["catch"](function(af){if(404===af.status){return"http"===t.type()&&ia(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:aa,_id:ab,history:[],replicator:he,version:gh}}throw af}).then(function(af){return ad.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==aa}),af.history.unshift({last_seq:ac,session_id:aa}),af.history=af.history.slice(0,ii),af.version=gh,af.replicator=he,af.session_id=aa,af.last_seq=ac,t.put(af)["catch"](function(ag){if(409===ag.status){return iB(t,ab,ac,aa,ad)}throw ag}))})}function gL(aa,ac,t,ab){this.src=aa,this.target=ac,this.id=t,this.returnValue=ab}function fo(aa,ac){if(aa.session_id===ac.session_id){return{last_seq:aa.last_seq,history:aa.history||[]}}var t=aa.history||[],ab=ac.history||[];return ct(t,ab)}function ct(ag,af){var t=ag[0],ad=ag.slice(1),ab=af[0],aa=af.slice(1);if(!t||0===af.length){return{last_seq:hp,history:[]}}var ac=t.session_id;if(id(ac,af)){return{last_seq:t.last_seq,history:ag}}var ah=ab.session_id;return id(ah,ad)?{last_seq:ab.last_seq,history:aa}:ct(ad,aa)}function id(aa,ac){var t=ac[0],ab=ac.slice(1);return aa&&0!==ac.length?aa===t.session_id?!0:id(aa,ab):!1}function dr(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function M(aa,ac){aa=parseInt(aa,10)||0,ac=parseInt(ac,10),ac!==ac||aa>=ac?ac=(aa||1)<<1:ac+=1;var t=Math.random(),ab=ac-aa;return ~~(ab*t+aa)}function hN(t){var aa=0;return t||(aa=2000),M(t,aa)}function iq(aa,ac,t,ab){return aa.retry===!1?(ac.emit("error",t),void ac.removeAllListeners()):("function"!=typeof aa.back_off_function&&(aa.back_off_function=hN),ac.emit("requestError",t),"active"!==ac.state&&"pending"!==ac.state||(ac.emit("paused",t),ac.state="stopped",ac.once("active",function(){aa.current_back_off=F})),aa.current_back_off=aa.current_back_off||F,aa.current_back_off=aa.back_off_function(aa.current_back_off),void setTimeout(ab,aa.current_back_off))}function hn(t){return hz(t)}function ip(aa,ac,t,ab){(t>0||ab<ac.byteLength)&&(ac=new Uint8Array(ac,t,Math.min(ab,ac.byteLength)-t)),aa.append(ac)}function ei(aa,ac,t,ab){(t>0||ab<ac.length)&&(ac=ac.substring(t,ab)),aa.appendBinary(ac)}function gm(t){return Object.keys(t).sort(fg.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function H(ad,aa,ag){var t=ag.doc_ids?ag.doc_ids.sort(fg.collate):"",ac=ag.filter?ag.filter.toString():"",ab="",af="";return ag.filter&&ag.query_params&&(ab=JSON.stringify(gm(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),fq.all([ad.id(),aa.id()]).then(function(aj){var ah=aj[0]+aj[1]+ac+af+ab+t;return i8(ah)}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function O(t){return/^1-/.test(t)}function h(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0,attachments:!0,binary:!0}}function gX(aa,af,ak){function ac(){var al=h(af);if(al.docs.length){return aa.bulkGet(al).then(function(am){if(ak.cancelled){throw new Error("cancelled")}am.results.forEach(function(ap){ap.docs.forEach(function(aq){aq.ok?ah.push(aq.ok):void 0!==aq.error&&(t=!1)})})})}}function ad(al){return al._attachments&&Object.keys(al._attachments).length>0}function ab(al){return aa.allDocs({keys:al,include_docs:!0}).then(function(am){if(ak.cancelled){throw new Error("cancelled")}am.rows.forEach(function(ap){!ap.deleted&&ap.doc&&O(ap.value.rev)&&!ad(ap.doc)&&(ah.push(ap.doc),delete af[ap.id])})})}function aj(){var al=Object.keys(af).filter(function(ap){var am=af[ap].missing;return 1===am.length&&O(am[0])});return al.length>0?ab(al):void 0}function ag(){return{ok:t,docs:ah}}af=gy(af);var ah=[],t=!0;return fq.resolve().then(aj).then(ac).then(ag)}function hD(ak,aa,aF,aK,aG){function az(){return aw?fq.resolve():H(ak,aa,aF).then(function(aS){aP=aS,aw=new gL(ak,aa,aP,aK)})}function aL(){if(aN=[],0!==am.docs.length){var aS=am.docs;return aa.bulkDocs({docs:aS,new_edits:!1}).then(function(aW){if(aK.cancelled){throw aH(),new Error("cancelled")}var aU=[],aX={};aW.forEach(function(aY){aY.error&&(aG.doc_write_failures++,aU.push(aY),aX[aY.id]=aY)}),al=al.concat(aU),aG.docs_written+=am.docs.length-aU.length;var aT=aU.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aX[aZ._id];aY?aK.emit("denied",gy(aY)):aN.push(aZ)}),aT.length>0){var aV=new Error("bulkDocs error");throw aV.other_errors=aU,ay("target.bulkDocs failed to write docs",aV),new Error("bulkWrite partial failure")}},function(aT){throw aG.doc_write_failures+=aS.length,aT})}}function aR(){if(am.error){throw new Error("There was a problem getting docs.")}aG.last_seq=ap=am.seq;var aS=gy(aG);return aN.length&&(aS.docs=aN,aK.emit("change",aS)),av=!0,aw.writeCheckpoint(am.seq,aj).then(function(){if(av=!1,aK.cancelled){throw aH(),new Error("cancelled")}am=void 0,aD()})["catch"](function(aT){throw av=!1,ay("writeCheckpoint completed with error",aT),aT})}function ag(){var aS={};return am.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aa.revsDiff(aS).then(function(aT){if(aK.cancelled){throw aH(),new Error("cancelled")}am.diffs=aT})}function au(){return gX(ak,am.diffs,aK).then(function(aS){am.error=!aS.ok,aS.docs.forEach(function(aT){delete am.diffs[aT._id],aG.docs_read++,am.docs.push(aT)})})}function aC(){if(!aK.cancelled&&!am){if(0===aB.length){return void af(!0)}am=aB.shift(),ag().then(au).then(aL).then(aR).then(aC)["catch"](function(aS){ay("batch processing terminated with error",aS)})}}function af(aS){return 0===aI.changes.length?void (0!==aB.length||am||((aA&&aQ.live||aM)&&(aK.state="pending",aK.emit("paused")),aM&&aH())):void ((aS||aM||aI.changes.length>=aO)&&(aB.push(aI),aI={seq:0,changes:[],docs:[]},"pending"!==aK.state&&"stopped"!==aK.state||(aK.state="active",aK.emit("active")),aC()))}function ay(aS,aT){aE||(aT.message||(aT.message=aS),aG.ok=!1,aG.status="aborting",aG.errors.push(aT),al=al.concat(aT),aB=[],aI={seq:0,changes:[],docs:[]},aH())}function aH(){if(!(aE||aK.cancelled&&(aG.status="cancelled",av))){aG.status=aG.status||"complete",aG.end_time=new Date,aG.last_seq=ap,aE=!0;var aS=al.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=al.pop();al.length>0&&(aT.other_errors=al),aT.result=aG,iq(aF,aK,aT,function(){hD(ak,aa,aF,aK)})}else{aG.errors=al,aK.emit("complete",aG),aK.removeAllListeners()}}}function ah(aS){if(aK.cancelled){return aH()}var aT=fe(aF)(aS);aT&&(aI.seq=aS.seq,aI.changes.push(aS),af(aQ.live))}function t(aS){return ad=!1,aK.cancelled?aH():(aS.results.length>0?(aQ.since=aS.last_seq,aD()):aA?(aQ.live=!0,aD()):aM=!0,void af(!0))}function aJ(aS){return ad=!1,aK.cancelled?aH():void ay("changes rejected",aS)}function aD(){function aT(){aU.cancel()}function aS(){aK.removeListener("cancel",aT)}if(!ad&&!aM&&aB.length<ac){ad=!0,aK._changes&&(aK.removeListener("cancel",aK._abortChanges),aK._changes.cancel()),aK.once("cancel",aT);var aU=ak.changes(aQ).on("change",ah);aU.then(aS,aS),aU.then(t)["catch"](aJ),aF.retry&&(aK._changes=aU,aK._abortChanges=aT)}}function ax(){az().then(function(){return aK.cancelled?void aH():aw.getCheckpoint().then(function(aS){ap=aS,aQ={since:ap,limit:aO,batch_size:aO,style:"all_docs",doc_ids:aq,return_docs:!0},aF.filter&&("string"!=typeof aF.filter?aQ.include_docs=!0:aQ.filter=aF.filter),"heartbeat" in aF&&(aQ.heartbeat=aF.heartbeat),"timeout" in aF&&(aQ.timeout=aF.timeout),aF.query_params&&(aQ.query_params=aF.query_params),aF.view&&(aQ.view=aF.view),aD()})})["catch"](function(aS){ay("getCheckpoint rejected with ",aS)})}function ab(aS){throw av=!1,ay("writeCheckpoint completed with error",aS),aS}var am,aP,aw,aB=[],aI={seq:0,changes:[],docs:[]},av=!1,aM=!1,aE=!1,ap=0,aA=aF.continuous||aF.live||!1,aO=aF.batch_size||100,ac=aF.batches_limit||10,ad=!1,aq=aF.doc_ids,al=[],aN=[],aj=gp();aG=aG||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aQ={};return aK.ready(ak,aa),aK.cancelled?void aH():(aK._addedListeners||(aK.once("cancel",aH),"function"==typeof aF.complete&&(aK.once("error",aF.complete),aK.once("complete",function(aS){aF.complete(null,aS)})),aK._addedListeners=!0),void ("undefined"==typeof aF.since?ax():az().then(function(){return av=!0,aw.writeCheckpoint(aF.since,aj)}).then(function(){return av=!1,aK.cancelled?void aH():(ap=aF.since,void ax())})["catch"](ab)))}function hi(){jc.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new fq(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function gZ(aa,ab){var t=ab.PouchConstructor;return"string"==typeof aa?new t(aa,ab):aa}function a1(ad,aa,ag,t){if("function"==typeof ag&&(t=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw jd(fT,"`doc_ids` filter parameter is not a list.")}ag.complete=t,ag=gy(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ac=new hi(ag),ab=gZ(ad,ag),af=gZ(aa,ag);return hD(ab,af,ag,ac),ac}function hd(aa,ac,t,ab){return"function"==typeof t&&(ab=t,t={}),"undefined"==typeof t&&(t={}),t=gy(t),t.PouchConstructor=t.PouchConstructor||this,aa=gi.toPouch(aa,t),ac=gi.toPouch(ac,t),new gU(aa,ac,t,ab)}function gU(ak,ab,aa,ah){function ac(ay){am.emit("change",{direction:"pull",change:ay})}function ap(ay){am.emit("change",{direction:"push",change:ay})}function ad(ay){am.emit("denied",{direction:"push",doc:ay})}function t(ay){am.emit("denied",{direction:"pull",doc:ay})}function av(){am.pushPaused=!0,am.pullPaused&&am.emit("paused")}function ag(){am.pullPaused=!0,am.pushPaused&&am.emit("paused")}function al(){am.pushPaused=!1,am.pullPaused&&am.emit("active",{direction:"push"})}function aq(){am.pullPaused=!1,am.pushPaused&&am.emit("active",{direction:"pull"})}function aj(ay){return function(aC,aE){var aD="change"===aC&&(aE===ac||aE===ap),aA="denied"===aC&&(aE===t||aE===ad),az="paused"===aC&&(aE===ag||aE===av),aB="active"===aC&&(aE===aq||aE===al);(aD||aA||az||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&am.removeAllListeners(aC))}}var am=this;this.canceled=!1;var af=aa.push?jC.extend({},aa,aa.push):aa,aw=aa.pull?jC.extend({},aa,aa.pull):aa;this.push=gN(ak,ab,af),this.pull=gN(ab,ak,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};aa.live&&(this.push.on("complete",am.pull.cancel.bind(am.pull)),this.pull.on("complete",am.push.cancel.bind(am.push))),this.on("newListener",function(ay){"change"===ay?(am.pull.on("change",ac),am.push.on("change",ap)):"denied"===ay?(am.pull.on("denied",t),am.push.on("denied",ad)):"active"===ay?(am.pull.on("active",aq),am.push.on("active",al)):"paused"===ay&&(am.pull.on("paused",ag),am.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(am.pull.removeListener("change",ac),am.push.removeListener("change",ap)):"denied"===ay?(am.pull.removeListener("denied",t),am.push.removeListener("denied",ad)):"active"===ay?(am.pull.removeListener("active",aq),am.push.removeListener("active",al)):"paused"===ay&&(am.pull.removeListener("paused",ag),am.push.removeListener("paused",av))}),this.pull.on("removeListener",aj("pull")),this.push.on("removeListener",aj("push"));var au=fq.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return am.emit("complete",az),ah&&ah(null,az),am.removeAllListeners(),az},function(ay){if(am.cancel(),ah?ah(ay):am.emit("error",ay),am.removeAllListeners(),ah){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function iP(t,aa){return hT(K(t),aa)}function o(t){for(var ab="",ac=new Uint8Array(t),aa=ac.byteLength,ad=0;aa>ad;ad++){ab+=String.fromCharCode(ac[ad])}return ab}function fv(aa,ac){if("undefined"==typeof FileReader){return ac(o((new FileReaderSync).readAsArrayBuffer(aa)))}var t=new FileReader,ab="function"==typeof t.readAsBinaryString;t.onloadend=function(af){var ad=af.target.result||"";return ab?ac(ad):void ac(o(ad))},ab?t.readAsBinaryString(aa):t.readAsArrayBuffer(aa)}function ao(t){return new fq(function(aa){fv(t,function(ab){aa(hz(ab))})})}function Y(aa){for(var ac=[],t=0,ab=aa.length;ab>t;t++){ac=ac.concat(aa[t])}return ac}function s(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=iP(ab.data,ab.content_type)})}function ae(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function jp(t){return t._attachments&&Object.keys(t._attachments)?fq.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?ao(aa.data).then(function(ac){aa.data=ac}):void 0})):fq.resolve()}function gb(aa){var ab=z(aa);(ab.user||ab.password)&&(ab.auth={username:ab.user,password:ab.password});var t=ab.path.replace(/(^\/|\/$)/g,"").split("/");return ab.db=t.pop(),-1===ab.db.indexOf("%")&&(ab.db=encodeURIComponent(ab.db)),ab.path=t.join("/"),ab}function iu(t,aa){return ci(t,t.db+"/"+aa)}function ci(aa,ab){var t=aa.path?"/":"";return aa.protocol+"://"+aa.host+(aa.port?":"+aa.port:"")+"/"+aa.path+t+ab}function fr(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function i6(aj,av){function aq(ax,ay,aw){var aA=ax.ajax||{},az=jC.extend(gy(ah),aA,ay);return x(az.method+" "+az.url),bn.ajax(az,aw)}function au(aw,ax){return new fq(function(ay,az){aq(aw,ax,function(aA,aB){return aA?az(aA):void ay(aB)})})}function ag(aw,ax){return gT(aw,gk(function(ay){ab().then(function(){return ax.apply(this,ay)})["catch"](function(aA){var az=ay.pop();az(aA)})}))}function ab(){if(aj.skipSetup||aj.skip_setup){return fq.resolve()}if(aa){return aa}var aw={method:"GET",url:ad};return aa=au({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(ia(404,"PouchDB is just detecting if the remote exists."),au({},{method:"PUT",url:ad})):fq.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:fq.reject(ax)}),aa["catch"](function(){aa=null}),aa}function ap(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ac=this,t=gb;aj.getHost&&(t=aj.getHost);var am=t(aj.name,aj),ad=iu(am,"");aj=gy(aj);var ah=aj.ajax||{};if(ac.getUrl=function(){return ad},ac.getHeaders=function(){return ah.headers||{}},aj.auth||am.auth){var af=aj.auth||am.auth,ak=af.username+":"+af.password,al=hz(unescape(encodeURIComponent(ak)));ah.headers=ah.headers||{},ah.headers.Authorization="Basic "+al}var aa;setTimeout(function(){av(null,ac)}),ac.type=function(){return"http"},ac.id=ag("id",function(aw){aq({},{method:"GET",url:ci(am,"")},function(ay,az){var ax=az&&az.uuid?az.uuid+am.db:iu(am,"");aw(null,ax)})}),ac.request=ag("request",function(aw,ax){aw.url=iu(am,aw.url),aq({},aw,ax)}),ac.compact=ag("compact",function(aw,ax){"function"==typeof aw&&(ax=aw,aw={}),aw=gy(aw),aq(aw,{url:iu(am,"_compact"),method:"POST"},function(){function ay(){ac.info(function(aA,az){az&&!az.compact_running?ax(null,{ok:!0}):setTimeout(ay,aw.interval||200)})}ay()})}),ac.bulkGet=gT("bulkGet",function(aA,aC){function ax(aE){var aD={};aA.revs&&(aD.revs=!0),aA.attachments&&(aD.attachments=!0),aq({},{url:iu(am,"_bulk_get"+fr(aD)),method:"POST",body:{docs:aA.docs}},aE)}function aB(){function aD(aK){return function(aL,aM){aJ[aK]=aM.results,++aI===aF&&aC(null,{results:Y(aJ)})}}for(var aH=i3,aF=Math.ceil(aA.docs.length/aH),aI=0,aJ=new Array(aF),aE=0;aF>aE;aE++){var aG=gF(aA,["revs","attachments"]);aG.ajax=ah,aG.docs=aA.docs.slice(aE*aH,Math.min(aA.docs.length,(aE+1)*aH)),g5(az,aG,aD(aE))}}var az=this,ay=ci(am,""),aw=gz[ay];"boolean"!=typeof aw?ax(function(aE,aD){if(aE){var aF=Math.floor(aE.status/100);4===aF||5===aF?(gz[ay]=!1,ia(aE.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aB()):aC(aE)}else{gz[ay]=!0,aC(null,aD)}}):aw?ax(aC):aB()}),ac._info=function(aw){ab().then(function(){aq({},{method:"GET",url:iu(am,"")},function(ay,ax){return ay?aw(ay):(ax.host=iu(am,""),void aw(null,ax))})})["catch"](aw)},ac.get=ag("get",function(aA,aC,aB){function ax(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?fq.all(aF.map(function(aG){var aH=aD[aG],aI=ae(aE._id)+"/"+ap(aG)+"?rev="+aE._rev;return au(aC,{method:"GET",url:iu(am,aI),binary:!0}).then(function(aJ){return aC.binary?aJ:ao(aJ)}).then(function(aJ){delete aH.stub,delete aH.length,aH.data=aJ})})):void 0}function ay(aD){return Array.isArray(aD)?fq.all(aD.map(function(aE){return aE.ok?ax(aE.ok):void 0})):ax(aD)}"function"==typeof aC&&(aB=aC,aC={}),aC=gy(aC);var az={};aC.revs&&(az.revs=!0),aC.revs_info&&(az.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),az.open_revs=aC.open_revs),aC.rev&&(az.rev=aC.rev),aC.conflicts&&(az.conflicts=aC.conflicts),aA=ae(aA);var aw={method:"GET",url:iu(am,aA+fr(az))};au(aC,aw).then(function(aD){return fq.resolve().then(function(){return aC.attachments?ay(aD):void 0}).then(function(){aB(null,aD)})})["catch"](aB)}),ac.remove=ag("remove",function(ax,aB,az,aw){var aA;"string"==typeof aB?(aA={_id:ax,_rev:aB},"function"==typeof az&&(aw=az,az={})):(aA=ax,"function"==typeof aB?(aw=aB,az={}):(aw=az,az=aB));var ay=aA._rev||az.rev;aq(az,{method:"DELETE",url:iu(am,ae(aA._id))+"?rev="+ay},aw)}),ac.getAttachment=ag("getAttachment",function(ax,aB,az,aw){"function"==typeof az&&(aw=az,az={});var aA=az.rev?"?rev="+az.rev:"",ay=iu(am,ae(ax))+"/"+ap(aB)+aA;aq(az,{method:"GET",url:ay,binary:!0},aw)}),ac.removeAttachment=ag("removeAttachment",function(ax,aA,ay,az){var aw=iu(am,ae(ax)+"/"+ap(aA))+"?rev="+ay;aq({},{method:"DELETE",url:aw},az)}),ac.putAttachment=ag("putAttachment",function(az,aF,aE,aD,aC,ax){"function"==typeof aC&&(ax=aC,aC=aD,aD=aE,aE=null);var aw=ae(az)+"/"+ap(aF),ay=iu(am,aw);if(aE&&(ay+="?rev="+aE),"string"==typeof aD){var aA;try{aA=K(aD)}catch(aG){return ax(jd(ez,"Attachment is not a valid base64 string"))}aD=aA?hT(aA,aC):""}var aB={headers:{"Content-Type":aC},method:"PUT",url:ay,processData:!1,body:aD,timeout:ah.timeout||60000};aq({},aB,ax)}),ac._bulkDocs=function(aw,ay,ax){aw.new_edits=ay.new_edits,ab().then(function(){return fq.all(aw.docs.map(jp))}).then(function(){aq(ay,{method:"POST",url:iu(am,"_bulk_docs"),body:aw},function(az,aA){return az?ax(az):(aA.forEach(function(aB){aB.ok=!0}),void ax(null,aA))})})["catch"](ax)},ac.allDocs=ag("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=gy(aA);var ax,aB={},ay="GET";aA.conflicts&&(aB.conflicts=!0),aA.descending&&(aB.descending=!0),aA.include_docs&&(aB.include_docs=!0),aA.attachments&&(aB.attachments=!0),aA.key&&(aB.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(aB.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(aB.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(aB.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(aB.limit=aA.limit),"undefined"!=typeof aA.skip&&(aB.skip=aA.skip);var aw=fr(aB);if("undefined"!=typeof aA.keys){var az="keys="+encodeURIComponent(JSON.stringify(aA.keys));az.length+aw.length+1<=h1?aw+="&"+az:(ay="POST",ax={keys:aA.keys})}au(aA,{method:ay,url:iu(am,"_all_docs"+aw),body:ax}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(s),aC(null,aD)})["catch"](aC)}),ac._changes=function(aF){var aJ="batch_size" in aF?aF.batch_size:hI;aF=gy(aF),aF.timeout="timeout" in aF?aF.timeout:"timeout" in ah?ah.timeout:30000;var ay,aw=aF.timeout?{timeout:aF.timeout-5000}:{},aD="undefined"!=typeof aF.limit?aF.limit:!1;ay="return_docs" in aF?aF.return_docs:"returnDocs" in aF?aF.returnDocs:!0;var az=aD;if(aF.style&&(aw.style=aF.style),(aF.include_docs||aF.filter&&"function"==typeof aF.filter)&&(aw.include_docs=!0),aF.attachments&&(aw.attachments=!0),aF.continuous&&(aw.feed="longpoll"),aF.conflicts&&(aw.conflicts=!0),aF.descending&&(aw.descending=!0),"heartbeat" in aF?aF.heartbeat&&(aw.heartbeat=aF.heartbeat):aw.heartbeat=10000,aF.filter&&"string"==typeof aF.filter&&(aw.filter=aF.filter,"_view"===aF.filter&&aF.view&&"string"==typeof aF.view&&(aw.view=aF.view)),aF.query_params&&"object"==typeof aF.query_params){for(var aB in aF.query_params){aF.query_params.hasOwnProperty(aB)&&(aw[aB]=aF.query_params[aB])}}var aH,ax="GET";if(aF.doc_ids){aw.filter="_doc_ids";var aA=JSON.stringify(aF.doc_ids);aA.length<h1?aw.doc_ids=aA:(ax="POST",aH={doc_ids:aF.doc_ids})}var aC,aE,aG=function(aL,aM){if(!aF.aborted){aw.since=aL,"object"==typeof aw.since&&(aw.since=JSON.stringify(aw.since)),aF.descending?aD&&(aw.limit=az):aw.limit=!aD||az>aJ?aJ:az;var aN={method:ax,url:iu(am,"_changes"+fr(aw)),timeout:aF.timeout,body:aH};aE=aL,aF.aborted||ab().then(function(){aC=aq(aF,aN,aM)})["catch"](aM)}},aI={results:[]},aK=function(aM,aP){if(!aF.aborted){var aO=0;if(aP&&aP.results){aO=aP.results.length,aI.last_seq=aP.last_seq;var aL={};aL.query=aF.query_params,aP.results=aP.results.filter(function(aR){az--;var aQ=fe(aF)(aR);return aQ&&(aF.include_docs&&aF.attachments&&aF.binary&&s(aR),ay&&aI.results.push(aR),aF.onChange(aR)),aQ})}else{if(aM){return aF.aborted=!0,void aF.complete(aM)}}aP&&aP.last_seq&&(aE=aP.last_seq);var aN=aD&&0>=az||aP&&aJ>aO||aF.descending;(!aF.continuous||aD&&0>=az)&&aN?aF.complete(null,aI):setTimeout(function(){aG(aE,aK)},0)}};return aG(aF.since||0,aK),{cancel:function(){aF.aborted=!0,aC&&aC.abort()}}},ac.revsDiff=ag("revsDiff",function(aw,ay,ax){"function"==typeof ay&&(ax=ay,ay={}),aq(ay,{method:"POST",url:iu(am,"_revs_diff"),body:aw},ax)}),ac._close=function(aw){aw()},ac._destroy=function(ax,aw){aq(ax,{url:iu(am,""),method:"DELETE"},function(ay,az){return ay&&ay.status&&404!==ay.status?aw(ay):(ac.emit("destroyed"),ac.constructor.emit("destroyed",aj.name),void aw(null,az))})}}function gI(){this.promise=new fq(function(t){t()})}function k(t){return co.hash(t)}function i2(ag){var af=ag.db,t=ag.viewName,ad=ag.map,ab=ag.reduce,aa=ag.temporary,ac=ad.toString()+(ab&&ab.toString())+"undefined";if(!aa&&af._cachedViews){var ah=af._cachedViews[ac];if(ah){return fq.resolve(ah)}}return af.info().then(function(ak){function al(am){am.views=am.views||{};var aq=t;-1===aq.indexOf("/")&&(aq=t+"/"+t);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(aa?"temp":k(ac));return hO(af,"_local/mrviews",al).then(function(){return af.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:af,adapter:af.adapter,mapFun:ad,reduceFun:ab};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,aa||(af._cachedViews=af._cachedViews||{},af._cachedViews[ac]=aq,aq.db.once("destroyed",function(){delete af._cachedViews[ac]})),aq})})})})}function es(t,ab,ac,aa,ad,af){return n("return ("+t.replace(/;\s*$/,"")+");",{emit:ab,sum:ac,log:aa,isArray:ad,toJSON:af})}function m(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function fd(t){return 1===t.length&&/^1-/.test(t[0].rev)}function fX(aa,ab){try{aa.emit("error",ab)}catch(t){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(ab)}}function P(aa,ac,t){try{return{output:ac.apply(null,t)}}catch(ab){return fX(aa,ab),{error:ab}}}function an(aa,ab){var t=hV(aa.key,ab.key);return 0!==t?t:hV(aa.value,ab.value)}function hs(aa,ab,t){return t=t||0,"number"==typeof ab?aa.slice(t,ab+t):t>0?aa.slice(t):aa}function ff(aa){var ab=aa.value,t=ab&&"object"==typeof ab&&ab._id||aa.id;return t}function iN(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=iP(ac.data,ac.content_type)})})}function r(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&iN(aa),aa}}function dt(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new fU(aa)}function E(ag){for(var af=0,t=0,ad=ag.length;ad>t;t++){var ab=ag[t];if("number"!=typeof ab){if(!Array.isArray(ab)){throw dt("_sum")}af="number"==typeof af?[af]:af;for(var aa=0,ac=ab.length;ac>aa;aa++){var ah=ab[aa];if("number"!=typeof ah){throw dt("_sum")}"undefined"==typeof af[aa]?af.push(ah):af[aa]+=ah}}else{"number"==typeof af?af+=ab:af[0]+=ab}}return af}function hG(t,ab,ac,aa){var ad=ab[t];"undefined"!=typeof ad&&(aa&&(ad=encodeURIComponent(JSON.stringify(ad))),ac.push(t+"="+ad))}function g9(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function hv(t){return t.group_level=g9(t.group_level),t.limit=g9(t.limit),t.skip=g9(t.skip),t}function hS(t){if(t){if("number"!=typeof t){return new y('Invalid value for integer: "'+t+'"')}if(0>t){return new y('Invalid value for positive integer: "'+t+'"')}}}function eo(aa,ac){var t=aa.descending?"endkey":"startkey",ab=aa.descending?"startkey":"endkey";if("undefined"!=typeof aa[t]&&"undefined"!=typeof aa[ab]&&hV(aa[t],aa[ab])>0){throw new y("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ac.reduce&&aa.reduce!==!1){if(aa.include_docs){throw new y("{include_docs:true} is invalid for reduce")}if(aa.keys&&aa.keys.length>1&&!aa.group&&!aa.group_level){throw new y("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=hS(aa[af]);if(ad){throw ad}})}function g8(aa,ah,ab){var ad,ac=[],aj="GET";if(hG("reduce",ab,ac),hG("include_docs",ab,ac),hG("attachments",ab,ac),hG("limit",ab,ac),hG("descending",ab,ac),hG("group",ab,ac),hG("group_level",ab,ac),hG("skip",ab,ac),hG("stale",ab,ac),hG("conflicts",ab,ac),hG("startkey",ab,ac,!0),hG("start_key",ab,ac,!0),hG("endkey",ab,ac,!0),hG("end_key",ab,ac,!0),hG("inclusive_end",ab,ac),hG("key",ab,ac,!0),ac=ac.join("&"),ac=""===ac?"":"?"+ac,"undefined"!=typeof ab.keys){var ag=2000,af="keys="+encodeURIComponent(JSON.stringify(ab.keys));af.length+ac.length+1<=ag?ac+=("?"===ac[0]?"&":"?")+af:(aj="POST","string"==typeof ah?ad={keys:ab.keys}:ah.keys=ab.keys)}if("string"==typeof ah){var t=m(ah);return aa.request({method:aj,url:"_design/"+t[0]+"/_view/"+t[1]+ac,body:ad}).then(r(ab))}return ad=ad||{},Object.keys(ah).forEach(function(ak){Array.isArray(ah[ak])?ad[ak]=ah[ak]:ad[ak]=ah[ak].toString()}),aa.request({method:"POST",url:"_temp_view"+ac,body:ad}).then(r(ab))}function gs(aa,ab,t){return new fq(function(ad,ac){aa._query(ab,t,function(af,ag){return af?ac(af):void ad(ag)})})}function fa(t){return new fq(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function gV(t){return function(aa){if(404===aa.status){return t}throw aa}}function J(al,ag,aa){function ad(){return fd(t)?fq.resolve(ah):ag.db.get(ak)["catch"](gV(ah))}function af(am){return am.keys.length?ag.db.allDocs({keys:am.keys,include_docs:!0}):fq.resolve({rows:[]})}function ac(ay,aw){for(var ap=[],av={},aq=0,am=aw.rows.length;am>aq;aq++){var az=aw.rows[aq],au=az.doc;if(au&&(ap.push(au),av[au._id]=!0,au._deleted=!aj[au._id],!au._deleted)){var ax=aj[au._id];"value" in ax&&(au.value=ax.value)}}var aA=Object.keys(aj);return aA.forEach(function(aD){if(!av[aD]){var aB={_id:aD},aC=aj[aD];"value" in aC&&(aB.value=aC.value),ap.push(aB)}}),ay.keys=Z(aA.concat(ay.keys)),ap.push(ay),ap}var ak="_local/doc_"+al,ah={_id:ak,keys:[]},ab=aa[al],aj=ab.indexableKeysToKeyValues,t=ab.changes;return ad().then(function(am){return af(am).then(function(ap){return ac(am,ap)})})}function j(aa,ac,t){var ab="_local/lastSeq";return aa.db.get(ab)["catch"](gV({_id:ab,seq:0})).then(function(af){var ad=Object.keys(ac);return fq.all(ad.map(function(ag){return J(ag,aa,ac)})).then(function(ag){var ah=Y(ag);return af.seq=t,ah.push(af),aa.db.bulkDocs({docs:ah})})})}function gl(aa){var ab="string"==typeof aa?aa:aa.name,t=g1[ab];return t||(t=g1[ab]=new gI),t}function de(t){return i4(gl(t),function(){return ce(t)})()}function ce(aa){function ah(am,ak){var al={id:ac._id,key:fW(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=fW(ak)),ad.push(al)}function ab(ak,al){return function(){return j(aa,ak,al)}}var ad,ac,aj;if("function"==typeof aa.mapFun&&2===aa.mapFun.length){var ag=aa.mapFun;aj=function(ak){return ag(ak,ah)}}else{aj=es(aa.mapFun.toString(),ah,E,io,Array.isArray,JSON.parse)}var af=aa.seq||0,t=new gI;return new fq(function(ap,ak){function al(){t.finish().then(function(){aa.seq=af,ap()})}function am(){function aq(au){ak(au)}aa.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:af,limit:hX}).on("complete",function(ax){var aD=ax.results;if(!aD.length){return al()}for(var aB={},aF=0,av=aD.length;av>aF;aF++){var aA=aD[aF];if("_"!==aA.doc._id[0]){ad=[],ac=aA.doc,ac._deleted||P(aa.sourceDB,aj,[ac]),ad.sort(an);for(var aC,ay={},au=0,aw=ad.length;aw>au;au++){var aG=ad[au],aE=[aG.key,aG.id];0===hV(aG.key,aC)&&aE.push(au);var az=fj(aE);ay[az]=aG,aC=aG.key}aB[aA.doc._id]={indexableKeysToKeyValues:ay,changes:aA.changes}}af=aA.seq}return t.add(ab(aB,af)),aD.length<hX?al():am()}).on("error",aq)}am()})}function fn(al,ag,aa){0===aa.group_level&&delete aa.group_level;var ad,af=aa.group||aa.group_level;ad=hQ[al.reduceFun]?hQ[al.reduceFun]:es(al.reduceFun.toString(),null,E,io,Array.isArray,JSON.parse);var ac=[],ak=isNaN(aa.group_level)?Number.POSITIVE_INFINITY:aa.group_level;ag.forEach(function(aq){var am=ac[ac.length-1],ap=af?aq.key:null;return af&&Array.isArray(ap)&&(ap=ap.slice(0,ak)),am&&0===hV(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ac.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ag=[];for(var ah=0,ab=ac.length;ab>ah;ah++){var aj=ac[ah],t=P(al.sourceDB,ad,[aj.keys,aj.values,!1]);if(t.error&&t.error instanceof fU){throw t.error}ag.push({value:t.error?null:t.output,key:aj.groupKey})}return{rows:hs(ag,aa.limit,aa.skip)}}function g7(t,aa){return i4(gl(t),function(){return V(t,aa)})()}function V(t,aj){function af(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ag=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=i(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function ah(av){var aq;if(aq=ac?fn(t,av,aj):{total_rows:ag,offset:al,rows:av},aj.include_docs){var au=Z(av.map(ff));return t.sourceDB.allDocs({keys:au,include_docs:!0,conflicts:aj.conflicts,attachments:aj.attachments,binary:aj.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),av.forEach(function(ay){var aA=ff(ay),az=ax["$"+aA];az&&(ay.doc=az)}),aq})}return aq}var ag,ac=t.reduceFun&&aj.reduce!==!1,al=aj.skip||0;if("undefined"==typeof aj.keys||aj.keys.length||(aj.limit=0,delete aj.keys),"undefined"!=typeof aj.keys){var ab=aj.keys,ak=ab.map(function(aq){var au={startkey:fj([aq]),endkey:fj([aq,{}])};return af(au)});return fq.all(ak).then(Y).then(ah)}var am={descending:aj.descending};if(aj.start_key&&(aj.startkey=aj.start_key),aj.end_key&&(aj.endkey=aj.end_key),"undefined"!=typeof aj.startkey&&(am.startkey=fj(aj.descending?[aj.startkey,{}]:[aj.startkey])),"undefined"!=typeof aj.endkey){var aa=aj.inclusive_end!==!1;aj.descending&&(aa=!aa),am.endkey=fj(aa?[aj.endkey,{}]:[aj.endkey])}if("undefined"!=typeof aj.key){var ad=fj([aj.key]),ap=fj([aj.key,{}]);am.descending?(am.endkey=ad,am.startkey=ap):(am.startkey=ad,am.endkey=ap)}return ac||("number"==typeof aj.limit&&(am.limit=aj.limit),am.skip=al),af(am).then(ah)}function X(t){return t.request({method:"POST",url:"_view_cleanup"})}function a7(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ad){var ag=m(ad),af="_design/"+ag[0],ah=ag[1];aa[af]=aa[af]||{},aa[af][ah]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ad){var ah={};ad.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ah[au]=ah[au]||am})})});var af=Object.keys(ah).filter(function(aj){return !ah[aj]}),ag=af.map(function(aj){return i4(gl(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return fq.all(ag).then(function(){return{ok:!0}})})},gV({ok:!0}))}function L(ab,ah,ag){if("http"===ab.type()){return g8(ab,ah,ag)}if("function"==typeof ab._query){return gs(ab,ah,ag)}if("string"!=typeof ah){eo(ag,ah);var t={db:ab,viewName:"temp_view/temp_view",map:ah.map,reduce:ah.reduce,temporary:!0};return iM.add(function(){return i2(t).then(function(ak){function aj(){return ak.db.destroy()}return ev(de(ak).then(function(){return g7(ak,ag)}),aj)})}),iM.finish()}var af=ah,ac=m(af),ad=ac[0],aa=ac[1];return ab.getView(ad,aa).then(function(aj){eo(ag,aj);var ak={db:ab,viewName:af,map:aj.map,reduce:aj.reduce};return i2(ak).then(function(al){return"ok"===ag.stale||"update_after"===ag.stale?("update_after"===ag.stale&&ig.nextTick(function(){de(al)}),g7(al,ag)):de(al).then(function(){return g7(al,ag)})})})}function y(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,y)}catch(aa){}}function fU(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,fU)}catch(aa){}}function be(t){return hz(o(t))}function fc(ag,af,t){function ad(al){try{return K(al)}catch(aj){var ak=jd(ez,"Attachment is not a valid base64 string");return{error:ak}}}function ab(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ad(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===af?aj.data=hT(al,aj.content_type):"base64"===af?aj.data=hz(al):aj.data=al,i8(al).then(function(am){aj.digest="md5-"+am,ak()})}else{hK(aj.data,function(am){"binary"===af?aj.data=o(am):"base64"===af&&(aj.data=be(am)),i8(am).then(function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function aa(){ah++,ag.length===ah&&(ac?t(ac):t())}if(!ag.length){return t()}var ac,ah=0;ag.forEach(function(ak){function am(aq){ac=aq,al++,al===aj.length&&aa()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return aa()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ab(ak.data._attachments[ap],am)}})}function iL(t,aa){return t.pos-aa.pos}function hg(t,ab,ac){for(var aa,ad=0,af=t.length;af>ad;){aa=ad+af>>>1,ac(t[aa],ab)<0?ad=aa+1:af=aa}return ad}function fu(aa,ac,t){var ab=hg(aa,ac,t);aa.splice(ab,0,ac)}function h4(ag,af){for(var t,ad,ab=af,aa=ag.length;aa>ab;ab++){var ac=ag[ab],ah=[ac.id,ac.opts,[]];ad?(ad[2].push(ah),ad=ah):t=ad=ah}return t}function gd(t,aa){return t[0]<aa[0]?-1:1}function gj(ah,af){for(var ak=[{tree1:ah,tree2:af}],ac=!1;ak.length>0;){var aa=ak.pop(),aj=aa.tree1,ag=aa.tree2;(aj[1].status||ag[1].status)&&(aj[1].status="available"===aj[1].status||"available"===ag[1].status?"available":"missing");for(var ad=0;ad<ag[2].length;ad++){if(aj[2][0]){for(var t=!1,ab=0;ab<aj[2].length;ab++){aj[2][ab][0]===ag[2][ad][0]&&(ak.push({tree1:aj[2][ab],tree2:ag[2][ad]}),t=!0)}t||(ac="new_branch",fu(aj[2],ag[2][ad],gd))}else{ac="new_leaf",aj[2][0]=ag[2][ad]}}}return{conflicts:ac,tree:ah}}function hj(al,af,am){var aq,av=[],ag=!1,ah=!1;if(!al.length){return{tree:[af],conflicts:"new_leaf"}}for(var ac=0,aw=al.length;aw>ac;ac++){var ap=al[ac];if(ap.pos===af.pos&&ap.ids[0]===af.ids[0]){aq=gj(ap.ids,af.ids),av.push({pos:ap.pos,ids:aq.tree}),ag=ag||aq.conflicts,ah=!0}else{if(am!==!0){var t=ap.pos<af.pos?ap:af,aj=ap.pos<af.pos?af:ap,ak=aj.pos-t.pos,ad=[],ax=[];for(ax.push({ids:t.ids,diff:ak,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],ab=0,aa=az.length;aa>ab;ab++){ax.push({ids:az[ab],diff:ay.diff-1,parent:ay.ids,parentIdx:ab})}}else{ay.ids[0]===aj.ids[0]&&ad.push(ay)}}var au=ad[0];au?(aq=gj(au.ids,aj.ids),au.parent[2][au.parentIdx]=aq.tree,av.push({pos:t.pos,ids:t.ids}),ag=ag||aq.conflicts,ah=!0):av.push(ap)}else{av.push(ap)}}}return ah||av.push(af),av.sort(iL),{tree:av,conflicts:ag||"internal_node"}}function cn(t,aj){for(var af,ah=gQ(t),ag={},ac=0,al=ah.length;al>ac;ac++){for(var ab=ah[ac],ak=ab.ids,am=Math.max(0,ak.length-aj),aa={pos:ab.pos+am,ids:h4(ak,am)},ad=0;am>ad;ad++){var ap=ab.pos+ad+"-"+ak[ad].id;ag[ap]=!0}af=af?hj(af,aa,!0).tree:[aa]}return jr(af,function(aq,au,av){delete ag[au+"-"+av]}),{tree:af,revs:Object.keys(ag)}}function i7(t,ab,ac){var aa=hj(t,ab),ad=cn(aa.tree,ac);return{tree:ad.tree,stemmedRevs:ad.revs,conflicts:aa.conflicts}}function ee(ah,af){for(var ak,ac=ah.slice(),aa=af.split("-"),aj=parseInt(aa[0],10),ag=aa[1];ak=ac.pop();){if(ak.pos===aj&&ak.ids[0]===ag){return !0}for(var ad=ak.ids[2],t=0,ab=ad.length;ab>t;t++){ac.push({pos:ak.pos+1,ids:ad[t]})}}return !1}function hH(al,ag,au,az,aw,af,av,ac){if(ee(ag.rev_tree,au.metadata.rev)){return az[aw]=au,af()}var ay=ag.winningRev||hA(ag),ak="deleted" in ag?ag.deleted:ie(ag,ay),aa="deleted" in au.metadata?au.metadata.deleted:ie(au.metadata),am=/^1-/.test(au.metadata.rev);if(ak&&!aa&&ac&&am){var t=au.data;t._rev=ay,t._id=au.metadata.id,au=bt(t,ac)}var ad=i7(ag.rev_tree,au.metadata.rev_tree[0],al),ax=ac&&(ak&&aa||!ak&&"new_leaf"!==ad.conflicts||ak&&!aa&&"new_branch"===ad.conflicts);if(ax){var aA=jd(iD);return az[aw]=aA,af()}var aq=au.metadata.rev;au.metadata.rev_tree=ad.tree,au.stemmedRevs=ad.stemmedRevs||[],ag.rev_map&&(au.metadata.rev_map=ag.rev_map);var ab,aj=hA(au.metadata),ap=ie(au.metadata,aj),ah=ak===ap?0:ap>ak?-1:1;ab=aq===aj?ap:ie(au.metadata,aq),av(au,aj,ap,ab,!0,ah,aw,af)}function iw(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function jf(ah,ap,aq,af,ac,aj,aa,am,t){function ab(aA,aC,aw){var av=hA(aA.metadata),ay=ie(aA.metadata,av);if("was_delete" in am&&ay){return aj[aC]=jd(l,"deleted"),aw()}var ax=al&&iw(aA);if(ax){var az=jd(iD);return aj[aC]=az,aw()}var aB=ay?0:1;aa(aA,av,ay,ay,!1,aB,aC,aw)}function ak(){++au===ag&&t&&t()}ah=ah||1000;var al=am.new_edits,ad=new gJ.Map,au=0,ag=ap.length;ap.forEach(function(ay,aw){if(ay._id&&fl(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void aq[av](ay,{ctx:ac},function(aA,az){aj[aw]=aA||az,ak()})}var ax=ay.metadata.id;ad.has(ax)?(ag--,ad.get(ax).push([ay,aw])):ad.set(ax,[[ay,aw]])}),ad.forEach(function(aw,ay){function az(){++ax<aw.length?av():ak()}function av(){var aC=aw[ax],aA=aC[0],aB=aC[1];if(af.has(ay)){hH(ah,af.get(ay),aA,aj,aB,az,aa,al)}else{var aD=i7([],aA.metadata.rev_tree[0],ah);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],ab(aA,aB,az)}}var ax=0;av()})}function R(t){var aa=[];return jr(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function a9(t){try{return JSON.parse(t)}catch(aa){return ik.parse(t)}}function jB(t){return t.length<50000?JSON.parse(t):a9(t)}function ir(t){try{return JSON.stringify(t)}catch(aa){return ik.stringify(t)}}function fk(t,ab,ac,aa){try{t.apply(ab,ac)}catch(ad){aa.emit("error",ad)}}function jn(t){if(!gK.running&&gK.queue.length){gK.running=!0;var aa=gK.queue.shift();aa.action(function(ac,ab){fk(aa.callback,this,[ac,ab],t),gK.running=!1,ig.nextTick(function(){jn(t)})})}}function S(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(jd(iy,aa,ab.type))}}function ix(aa,ab,t){return{data:ir(aa),winningRev:ab,deletedOrLocal:t?"1":"0",seq:aa.seq,id:aa.id}}function T(t){if(!t){return null}var aa=jB(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function eq(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function w(aa,ac,t,ab){t?ab(aa?"string"!=typeof aa?aa:iP(aa,ac):hl([""],{type:ac})):aa?"string"!=typeof aa?fv(aa,function(ad){ab(hz(ad))}):ab(aa):ab("")}function g2(ag,af,t,ad){function ab(){++ah===ac.length&&ad&&ad()}function aa(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=t.objectStore(hL).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ab()}}var ac=Object.keys(ag._attachments||{});if(!ac.length){return ad&&ad()}var ah=0;ac.forEach(function(aj){af.attachments&&af.include_docs?aa(ag,aj):(ag._attachments[aj].stub=!0,ab())})}function ja(t,aa){return fq.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return fq.all(ab.map(function(ah){var af=ac.doc._attachments[ah];if("body" in af){var ad=af.body,ag=af.content_type;return new fq(function(aj){w(ad,ag,aa,function(ak){ac.doc._attachments[ah]=jC.extend(gF(af,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function ga(ah,af,ak){function ac(){ab--,ab||aa()}function aa(){aj.length&&aj.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ad["delete"](am)}})}var aj=[],ag=ak.objectStore(I),ad=ak.objectStore(hL),t=ak.objectStore(iT),ab=ah.length;ah.forEach(function(al){var am=ag.index("_doc_id_rev"),ap=af+"::"+al;am.getKey(ap).onsuccess=function(au){var av=au.target.result;if("number"!=typeof av){return ac()}ag["delete"](av);var aq=t.index("seq").openCursor(IDBKeyRange.only(av));aq.onsuccess=function(ax){var ay=ax.target.result;if(ay){var aw=ay.value.digestSeq.split("::")[0];aj.push(aw),t["delete"](ay.primaryKey),ay["continue"]()}else{ac()}}}})}function gc(aa,ac,t){try{return{txn:aa.transaction(ac,t)}}catch(ab){return{error:ab}}}function dn(aM,af,aB,aa,ak,ac,t){function ah(){var aO=[fp,I,hL,fi,iT],aP=gc(ak,aO,"readwrite");return aP.error?t(aP.error):(av=aP.txn,av.onabort=S(t),av.ontimeout=S(t),av.oncomplete=aN,ay=av.objectStore(fp),al=av.objectStore(I),ax=av.objectStore(hL),aj=av.objectStore(iT),void aL(function(aQ){return aQ?(aK=!0,t(aQ)):void aq()}))}function ad(){jf(aM.revs_limit,aF,aa,az,av,aJ,ab,aB)}function aq(){function aS(){++aQ===aF.length&&ad()}function aU(aV){var aW=T(aV.target.result);aW&&az.set(aW.id,aW),aS()}if(aF.length){for(var aQ=0,aT=0,aR=aF.length;aR>aT;aT++){var aO=aF[aT];if(aO._id&&fl(aO._id)){aS()}else{var aP=ay.get(aO.metadata.id);aP.onsuccess=aU}}}}function aN(){aK||(ac.notify(aa._meta.name),aa._meta.docCount+=aA,t(null,aJ))}function aw(aP,aQ){var aO=ax.get(aP);aO.onsuccess=function(aR){if(aR.target.result){aQ()}else{var aS=jd(jA,"unknown stub attachment with digest "+aP);aS.status=412,aQ(aS)}}}function aL(aQ){function aS(){++aP===aO.length&&aQ(aR)}var aO=[];if(aF.forEach(function(aT){aT.data&&aT.data._attachments&&Object.keys(aT.data._attachments).forEach(function(aU){var aV=aT.data._attachments[aU];aV.stub&&aO.push(aV.digest)})}),!aO.length){return aQ()}var aR,aP=0;aO.forEach(function(aT){aw(aT,function(aU){aU&&!aR&&(aR=aU),aS()})})}function ab(aR,aX,aT,aV,aU,aS,aP,aW){aA+=aS,aR.metadata.winningRev=aX,aR.metadata.deleted=aT;var aO=aR.data;aO._id=aR.metadata.id,aO._rev=aR.metadata.rev,aV&&(aO._deleted=!0);var aQ=aO._attachments&&Object.keys(aO._attachments).length;return aQ?aC(aR,aX,aT,aU,aP,aW):void am(aR,aX,aT,aU,aP,aW)}function aE(aO){var aP=R(aO.metadata);ga(aP,aO.metadata.id,av)}function am(aQ,aX,aU,aV,aS,aZ){function aW(bc){aV&&aa.auto_compaction?aE(aQ):aQ.stemmedRevs.length&&ga(aQ.stemmedRevs,aQ.metadata.id,av),aT.seq=bc.target.result,delete aT.rev;var ba=ix(aT,aX,aU),bb=ay.put(ba);bb.onsuccess=aO}function aY(ba){ba.preventDefault(),ba.stopPropagation();var bb=al.index("_doc_id_rev"),bc=bb.getKey(aR._doc_id_rev);bc.onsuccess=function(bd){var bf=al.put(aR,bd.target.result);bf.onsuccess=aW}}function aO(){aJ[aS]={ok:!0,id:aT.id,rev:aX},az.set(aQ.metadata.id,aQ.metadata),aH(aQ,aT.seq,aZ)}var aR=aQ.data,aT=aQ.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aP=al.put(aR);aP.onsuccess=aW,aP.onerror=aY}function aC(aQ,aX,aT,aV,aU,aS){function aO(){aP===aR.length&&am(aQ,aX,aT,aV,aU,aS)}function aW(){aP++,aO()}var aY=aQ.data,aP=0,aR=Object.keys(aY._attachments);aR.forEach(function(bb){var aZ=aQ.data._attachments[bb];if(aZ.stub){aP++,aO()}else{var bc=aZ.data;delete aZ.data,aZ.revpos=parseInt(aX,10);var ba=aZ.digest;aD(ba,bc,aW)}})}function aH(aS,aV,aQ){function aT(){++aO===aP.length&&aQ()}function aR(aW){var aX=aS.data._attachments[aW].digest,aY=aj.put({seq:aV,digestSeq:aX+"::"+aV});aY.onsuccess=aT,aY.onerror=function(aZ){aZ.preventDefault(),aZ.stopPropagation(),aT()}}var aO=0,aP=Object.keys(aS.data._attachments||{});if(!aP.length){return aQ()}for(var aU=0;aU<aP.length;aU++){aR(aP[aU])}}function aD(aP,aR,aO){var aQ=ax.count(aP);aQ.onsuccess=function(aS){var aV=aS.target.result;if(aV){return aO()}var aT={digest:aP,body:aR},aU=ax.put(aT);aU.onsuccess=aO}}for(var av,ay,al,ax,aj,ap,aF=af.docs,aA=0,aI=0,ag=aF.length;ag>aI;aI++){var aG=aF[aI];aG._id&&fl(aG._id)||(aG=aF[aI]=bt(aG,aB.new_edits),aG.error&&!ap&&(ap=aG))}if(ap){return t(ap)}var aJ=new Array(aF.length),az=new gJ.Map,aK=!1,au=aa._meta.blobSupport?"blob":"base64";fc(aF,au,function(aO){return aO?t(aO):void ah()})}function jv(t,ab,ac,aa,ad){try{if(t&&ab){return ad?IDBKeyRange.bound(ab,t,!ac,!1):IDBKeyRange.bound(t,ab,!1,!ac)}if(t){return ad?IDBKeyRange.upperBound(t):IDBKeyRange.lowerBound(t)}if(ab){return ad?IDBKeyRange.lowerBound(ab,!ac):IDBKeyRange.upperBound(ab,!ac)}if(aa){return IDBKeyRange.only(aa)}}catch(af){return{error:af}}return null}function bo(aa,ac,t,ab){return"DataError"===t.name&&0===t.code?ab(null,{total_rows:aa._meta.docCount,offset:ac.skip,rows:[]}):void ab(jd(iy,t.name,t.message))}function i0(t,ab,ac,aa){function ad(ak,am){function ah(aL,aK,aN){var aM=aL.id+"::"+aN;aF.get(aM).onsuccess=function(aO){aK.doc=eq(aO.target.result),ak.conflicts&&(aK.doc._conflicts=q(aL)),g2(aK.doc,ak,aD)}}function av(aO,aM,aN){var aK={id:aN.id,key:aN.id,value:{rev:aM}},aL=aN.deleted;if("ok"===ak.deleted){ag.push(aK),aL?(aK.value.deleted=!0,aK.doc=null):ak.include_docs&&ah(aN,aK,aM)}else{if(!aL&&aq--<=0&&(ag.push(aK),ak.include_docs&&ah(aN,aK,aM),0===--aB)){return}}aO["continue"]()}function aC(aN){ap=ab._meta.docCount;var aK=aN.target.result;if(aK){var aL=T(aK.value),aM=aL.winningRev;av(aK,aM,aL)}}function aA(){am(null,{total_rows:ap,offset:ak.skip,rows:ag})}function aH(){ak.attachments?ja(ag,ak.binary).then(aA):aA()}var aj="startkey" in ak?ak.startkey:!1,al="endkey" in ak?ak.endkey:!1,aE="key" in ak?ak.key:!1,aq=ak.skip||0,aB="number"==typeof ak.limit?ak.limit:-1,aw=ak.inclusive_end!==!1,aG="descending" in ak&&ak.descending?"prev":null,au=jv(aj,al,aw,aE,aG);if(au&&au.error){return bo(ab,ak,au.error,am)}var ay=[fp,I];ak.attachments&&ay.push(hL);var ax=gc(ac,ay,"readonly");if(ax.error){return am(ax.error)}var aD=ax.txn,aJ=aD.objectStore(fp),az=aD.objectStore(I),aI=aG?aJ.openCursor(au,aG):aJ.openCursor(au),aF=az.index("_doc_id_rev"),ag=[],ap=0;aD.oncomplete=aH,aI.onsuccess=aC}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:ab._meta.docCount,offset:ag.skip,rows:[]}):void ad(ag,ah)}af(t,aa)}function iC(t){return new fq(function(ab){var aa=hl([""]);t.objectStore(iA).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function iY(t){g3()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):ho()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function ib(){jc.EventEmitter.call(this),this._listeners={},iY(this)}function h9(aa,ab){var t=this;gK.queue.push({action:function(ac){jw(t,aa,ac)},callback:ab}),jn(t.constructor)}function jw(ab,af,ap){function al(av){var aw=av.createObjectStore(fp,{keyPath:"id"});av.createObjectStore(I,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),av.createObjectStore(hL,{keyPath:"digest"}),av.createObjectStore(gS,{keyPath:"id",autoIncrement:!1}),av.createObjectStore(iA),aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),av.createObjectStore(fi,{keyPath:"_id"});var au=av.createObjectStore(iT,{autoIncrement:!0});au.createIndex("seq","seq"),au.createIndex("digestSeq","digestSeq",{unique:!0})}function aj(av,aw){var au=av.objectStore(fp);au.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.openCursor().onsuccess=function(aA){var ay=aA.target.result;if(ay){var ax=ay.value,az=ie(ax);ax.deletedOrLocal=az?"1":"0",au.put(ax),ay["continue"]()}else{aw()}}}function ah(au){au.createObjectStore(fi,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ag(ay,av){var ax=ay.objectStore(fi),az=ay.objectStore(fp),aw=ay.objectStore(I),au=az.openCursor();au.onsuccess=function(aI){var aL=aI.target.result;if(aL){var aE=aL.value,aC=aE.id,aD=fl(aC),aG=hA(aE);if(aD){var aJ=aC+"::"+aG,aA=aC+"::",aH=aC+"::~",aK=aw.index("_doc_id_rev"),aB=IDBKeyRange.bound(aA,aH,!1,!1),aF=aK.openCursor(aB);aF.onsuccess=function(aN){if(aF=aN.target.result){var aM=aF.value;aM._doc_id_rev===aJ&&ax.put(aM),aw["delete"](aF.primaryKey),aF["continue"]()}else{az["delete"](aL.primaryKey),aL["continue"]()}}}else{aL["continue"]()}}else{av&&av()}}}function ak(au){var av=au.createObjectStore(iT,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ac(ay,av){var ax=ay.objectStore(I),az=ay.objectStore(hL),aw=ay.objectStore(iT),au=az.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (ax.openCursor().onsuccess=function(aC){var aG=aC.target.result;if(!aG){return av()}for(var aH=aG.value,aE=aG.primaryKey,aK=Object.keys(aH._attachments||{}),aI={},aJ=0;aJ<aK.length;aJ++){var aL=aH._attachments[aK[aJ]];aI[aL.digest]=!0}var aD=Object.keys(aI);for(aJ=0;aJ<aD.length;aJ++){var aF=aD[aJ];aw.put({seq:aE,digestSeq:aF+"::"+aE})}aG["continue"]()}):av()}}function aa(av){function ay(az){return az.data?T(az):(az.deleted="1"===az.deletedOrLocal,az)}var ax=av.objectStore(I),aw=av.objectStore(fp),au=aw.openCursor();au.onsuccess=function(aC){function aB(){var aF=aD.id+"::",aH=aD.id+"::",aG=ax.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,az()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function az(){var aE=ix(aD,aD.winningRev,aD.deleted),aF=aw.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var aD=ay(aA.value);return aD.winningRev=aD.winningRev||hA(aD),aD.seq?az():void aB()}}}var ad=af.name,am=null;ab._meta=null,ab.type=function(){return"idb"},ab._id=js(function(au){au(null,ab._meta.instanceId)}),ab._bulkDocs=function(au,aw,av){dn(af,au,aw,ab,am,p,av)},ab._get=function(az,aw,aA){function aC(){aA(ay,{doc:aB,metadata:au,ctx:av})}var aB,au,ay,av=aw.ctx;if(!av){var ax=gc(am,[fp,I,hL],"readonly");if(ax.error){return aA(ax.error)}av=ax.txn}av.objectStore(fp).get(az).onsuccess=function(aG){if(au=T(aG.target.result),!au){return ay=jd(l,"missing"),aC()}if(ie(au)&&!aw.rev){return ay=jd(l,"deleted"),aC()}var aE=av.objectStore(I),aD=aw.rev||au.winningRev,aF=au.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aB=aH.target.result,aB&&(aB=eq(aB)),aB?void aC():(ay=jd(l,"missing"),aC())}}},ab._getAttachment=function(av,aA,ay){var az;if(aA.ctx){az=aA.ctx}else{var ax=gc(am,[fp,I,hL],"readonly");if(ax.error){return ay(ax.error)}az=ax.txn}var au=av.digest,aw=av.content_type;az.objectStore(hL).get(au).onsuccess=function(aC){var aB=aC.target.result.body;w(aB,aw,aA.binary,function(aD){ay(null,aD)})}},ab._info=function(aA){if(null===am||!hP.has(ad)){var av=new Error("db isn't open");return av.id="idbNull",aA(av)}var az,ay,au=gc(am,[I],"readonly");if(au.error){return aA(au.error)}var aw=au.txn,ax=aw.objectStore(I).openCursor(null,"prev");ax.onsuccess=function(aB){var aC=aB.target.result;az=aC?aC.key:0,ay=ab._meta.docCount},aw.oncomplete=function(){aA(null,{doc_count:ay,update_seq:az,idb_attachment_format:ab._meta.blobSupport?"binary":"base64"})}},ab._allDocs=function(av,au){i0(av,ab,am,au)},ab._changes=function(aK){function aB(aS){function aN(){return aO.seq!==aM?aS["continue"]():(aA=aM,aO.winningRev===aR._rev?aP(aR):void aQ())}function aQ(){var aU=aR._id+"::"+aO.winningRev,aT=az.get(aU);aT.onsuccess=function(aV){aP(eq(aV.target.result))}}function aP(aU){var aT=aK.processChange(aU,aO,aK);aT.seq=aO.seq;var aV=aE(aT);return"object"==typeof aV?aK.complete(aV):(aV&&(aG++,aH&&aF.push(aT),aK.attachments&&aK.include_docs?g2(aU,aK,aJ,function(){ja([aT],aK.binary).then(function(){aK.onChange(aT)})}):aK.onChange(aT)),void (aG!==av&&aS["continue"]()))}var aR=eq(aS.value),aM=aS.key;if(ax&&!ax.has(aR._id)){return aS["continue"]()}var aO;return(aO=ay.get(aR._id))?aN():void (au.get(aR._id).onsuccess=function(aT){aO=T(aT.target.result),ay.set(aR._id,aO),aN()})}function aC(aM){var aN=aM.target.result;aN&&aB(aN)}function aw(){var aN=[fp,I];aK.attachments&&aN.push(hL);var aO=gc(am,aN,"readonly");if(aO.error){return aK.complete(aO.error)}aJ=aO.txn,aJ.onabort=S(aK.complete),aJ.oncomplete=aI,aD=aJ.objectStore(I),au=aJ.objectStore(fp),az=aD.index("_doc_id_rev");var aM;aM=aK.descending?aD.openCursor(null,"prev"):aD.openCursor(IDBKeyRange.lowerBound(aK.since,!0)),aM.onsuccess=aC}function aI(){function aM(){aK.complete(null,{results:aF,last_seq:aA})}!aK.continuous&&aK.attachments?ja(aF).then(aM):aM()}if(aK=gy(aK),aK.continuous){var aL=ad+":"+gp();return p.addListener(ad,aL,ab,aK),p.notify(ad),{cancel:function(){p.removeListener(ad,aL)}}}var ax=aK.doc_ids&&new gJ.Set(aK.doc_ids);aK.since=aK.since||0;var aA=aK.since,av="limit" in aK?aK.limit:-1;0===av&&(av=1);var aH;aH="return_docs" in aK?aK.return_docs:"returnDocs" in aK?aK.returnDocs:!0;var aJ,aD,au,az,aF=[],aG=0,aE=fe(aK),ay=new gJ.Map;aw()},ab._close=function(au){return null===am?au(jd(fh)):(am.close(),hP["delete"](ad),am=null,void au())},ab._getRevisionTree=function(av,ay){var ax=gc(am,[fp],"readonly");if(ax.error){return ay(ax.error)}var aw=ax.txn,au=aw.objectStore(fp).get(av);au.onsuccess=function(aA){var az=T(aA.target.result);az?ay(null,az.rev_tree):ay(jd(l))}},ab._doCompaction=function(av,aA,ay){var az=[fp,I,hL,iT],ax=gc(am,az,"readwrite");if(ax.error){return ay(ax.error)}var au=ax.txn,aw=au.objectStore(fp);aw.get(av).onsuccess=function(aC){var aE=T(aC.target.result);jr(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==aA.indexOf(aI)&&(aH.status="missing")}),ga(aA,av,au);var aD=aE.winningRev,aB=aE.deleted;au.objectStore(fp).put(ix(aE,aD,aB))},au.onabort=S(ay),au.oncomplete=function(){ay()}},ab._getLocal=function(av,ay){var ax=gc(am,[fi],"readonly");if(ax.error){return ay(ax.error)}var aw=ax.txn,au=aw.objectStore(fi).get(av);au.onerror=S(ay),au.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,ay(null,az)):ay(jd(l))}},ab._putLocal=function(aD,az,au){"function"==typeof az&&(au=az,az={}),delete aD._revisions;var aw=aD._rev,av=aD._id;aw?aD._rev="0-"+(parseInt(aw.split("-")[1],10)+1):aD._rev="0-1";var ax,aB=az.ctx;if(!aB){var ay=gc(am,[fi],"readwrite");if(ay.error){return au(ay.error)}aB=ay.txn,aB.onerror=S(au),aB.oncomplete=function(){ax&&au(null,ax)}}var aA,aC=aB.objectStore(fi);aw?(aA=aC.get(av),aA.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aw){var aG=aC.put(aD);aG.onsuccess=function(){ax={ok:!0,id:aD._id,rev:aD._rev},az.ctx&&au(null,ax)}}else{au(jd(iD))}}):(aA=aC.add(aD),aA.onerror=function(aE){au(jd(iD)),aE.preventDefault(),aE.stopPropagation()},aA.onsuccess=function(){ax={ok:!0,id:aD._id,rev:aD._rev},az.ctx&&au(null,ax)})},ab._removeLocal=function(az,aw,aA){"function"==typeof aw&&(aA=aw,aw={});var aC=aw.ctx;if(!aC){var aB=gc(am,[fi],"readwrite");if(aB.error){return aA(aB.error)}aC=aB.txn,aC.oncomplete=function(){au&&aA(null,au)}}var au,ay=az._id,av=aC.objectStore(fi),ax=av.get(ay);ax.onerror=S(aA),ax.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===az._rev?(av["delete"](ay),au={ok:!0,id:ay,rev:"0-0"},aw.ctx&&aA(null,au)):aA(jd(l))}},ab._destroy=function(au,aw){p.removeAllListeners(ad);var ax=jx.get(ad);ax&&ax.result&&(ax.result.close(),hP["delete"](ad));var av=indexedDB.deleteDatabase(ad);av.onsuccess=function(){jx["delete"](ad),ho()&&ad in localStorage&&delete localStorage[ad],aw(null,{ok:!0})},av.onerror=S(aw)};var aq=hP.get(ad);if(aq){return am=aq.idb,ab._meta=aq.global,void ig.nextTick(function(){ap(null,ab)})}var t;t=af.storage?ji(ad,af.storage):indexedDB.open(ad,cr),jx.set(ad,t),t.onupgradeneeded=function(av){function aw(){var aA=az[au-1];au++,aA&&aA(ax,aw)}var ay=av.target.result;if(av.oldVersion<1){return al(ay)}var ax=av.currentTarget.transaction;av.oldVersion<3&&ah(ay),av.oldVersion<4&&ak(ay);var az=[aj,ag,ac,aa],au=av.oldVersion;aw()},t.onsuccess=function(az){am=az.target.result,am.onversionchange=function(){am.close(),hP["delete"](ad)},am.onabort=function(aA){console.error("Database has a global failure",aA.target.error),am.close(),hP["delete"](ad)};var av=am.transaction([gS,iA,fp],"readwrite"),aw=av.objectStore(gS).get(gS),ay=null,ax=null,au=null;aw.onsuccess=function(aB){var aD=function(){null!==ay&&null!==ax&&null!==au&&(ab._meta={name:ad,instanceId:au,blobSupport:ay,docCount:ax},hP.set(ad,{idb:am,global:ab._meta}),ap(null,ab))},aA=aB.target.result||{id:gS};ad+"_id" in aA?(au=aA[ad+"_id"],aD()):(au=gp(),aA[ad+"_id"]=au,av.objectStore(gS).put(aA).onsuccess=function(){aD()}),hc||(hc=iC(av)),hc.then(function(aE){ay=aE,aD()});var aC=av.objectStore(fp).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ax=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";console.error(au),ap(jd(iy,au))}}function ji(aa,ab){try{return indexedDB.open(aa,{version:cr,storage:ab})}catch(t){return indexedDB.open(aa,cr)}}function gt(t){return decodeURIComponent(window.escape(t))}function iU(t){return 65>t?t-48:t-55}function a6(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(iU(aa.charCodeAt(ac++))<<4|iU(aa.charCodeAt(ac++)))}return ab}function jo(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(iU(aa.charCodeAt(ac+2))<<12|iU(aa.charCodeAt(ac+3))<<8|iU(aa.charCodeAt(ac))<<4|iU(aa.charCodeAt(ac+1))),ac+=4}return ab}function hY(t,aa){return"UTF-8"===aa?gt(a6(t,0,t.length)):jo(t,0,t.length)}function A(t){return"'"+t+"'"}function ge(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(t){return openDatabase(t.name,t.version,t.description,t.size)}:void 0}function gf(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function i1(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function er(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function hM(t){return delete t._id,delete t._rev,JSON.stringify(t)}function gY(aa,ab,t){return aa=JSON.parse(aa),aa._id=ab,aa._rev=t,aa}function iZ(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function iQ(t,ab,ac,aa,ad){return"SELECT "+t+" FROM "+("string"==typeof ab?ab:ab.join(" JOIN "))+(ac?" ON "+ac:"")+(aa?" WHERE "+("string"==typeof aa?aa:aa.join(" AND ")):"")+(ad?" ORDER BY "+ad:"")}function hm(ad,aa,ag){function t(){++ab===ad.length&&ac()}function ac(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+C+" WHERE seq IN "+iZ(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+C+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+C+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new gJ.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+C+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+gu+" WHERE digest=?",[az]))})})})}})}}if(ad.length){var ab=0,af=[];ad.forEach(function(ah){var aj="SELECT seq FROM "+jz+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[aa,ah],function(al,am){if(!am.rows.length){return t()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+jz+" WHERE seq=?",[ak],t)})})}}function en(t){return function(ad){console.error("WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(jd(gP,ab,ac))}}function ey(t){if("size" in t){return 1000000*t.size}var aa="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return aa?5000000:1}function fw(aa,ab){try{return{db:aa(ab)}}catch(t){return{error:t}}}function gE(aa){var ab=h2.get(aa.name);if(!ab){var t=ge();ab=fw(t,aa),h2.set(aa.name,ab),ab.db&&(ab.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return ab}function g0(af,ak,ax,aB,az,aa,ab){function au(){return ah?ab(ah):(aa.notify(aB._name),aB._docCount=-1,void ab(null,am))}function al(aD,aE){var aC="SELECT count(*) as cnt FROM "+gu+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=jd(jA,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ad(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){al(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ag(aC,aJ,aO,aE,aG,aM,aH,aK){function aP(){function aX(bc,ba){function bb(){return ++bd===bf.length&&ba(),!1}function aZ(bi){var bh="INSERT INTO "+C+" (digest, seq) VALUES (?,?)",bj=[aY._attachments[bi].digest,bc];ap.executeSql(bh,bj,bb,bb)}var bd=0,bf=Object.keys(aY._attachments||{});if(!bf.length){return ba()}for(var bg=0;bg<bf.length;bg++){aZ(bf[bg])}}var aY=aC.data,aV=aE?1:0,aS=aY._id,aW=aY._rev,aU=hM(aY),aT="INSERT INTO "+jz+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aR=[aS,aW,aU,aV];ap.executeSql(aT,aR,function(bb,aZ){var ba=aZ.insertId;aX(ba,function(){aQ(bb,ba)})},function(){var aZ=iQ("seq",jz,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aS,aW],function(bb,bf){var bd=bf.rows.item(0).seq,bc="UPDATE "+jz+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aU,aV,aS,aW];bb.executeSql(bc,ba,function(bg){aX(bd,function(){aQ(bg,bd)})})}),!1})}function aD(aR){aF||(aR?(aF=aR,aK(aF)):aL===aN.length&&aP())}function aI(aR){aL++,aD(aR)}function aQ(aW,aS){var aV=aC.metadata.id;aG&&aB.auto_compaction?hm(R(aC.metadata),aV,aW):aC.stemmedRevs.length&&hm(aC.stemmedRevs,aV,aW),aC.metadata.seq=aS,delete aC.metadata.rev;var aR=aG?"UPDATE "+hk+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+jz+" WHERE doc_id="+hk+".id AND rev=?) WHERE id=?":"INSERT INTO "+hk+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aU=ir(aC.metadata),aT=aG?[aU,aS,aJ,aV]:[aV,aS,aS,aU];aW.executeSql(aR,aT,function(){am[aH]={ok:!0,id:aC.metadata.id,rev:aJ},ac.set(aV,aC.metadata),aK()})}var aF=null,aL=0;aC.data._id=aC.metadata.id,aC.data._rev=aC.metadata.rev;var aN=Object.keys(aC.data._attachments||{});aE&&(aC.data._deleted=!0),aN.forEach(function(aS){var aU=aC.data._attachments[aS];if(aU.stub){aL++,aD()}else{var aT=aU.data;delete aU.data,aU.revpos=parseInt(aJ,10);var aR=aU.digest;aj(aR,aT,aI)}}),aN.length||aP()}function aA(){jf(af.revs_limit,aq,aB,ac,ap,am,ag,ax)}function av(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&fl(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+hk+" WHERE id = ?",[aF],function(aI,aJ){if(aJ.rows.length){var aH=jB(aJ.rows.item(0).json);ac.set(aF,aH)}aE()})})}function aj(aD,aF,aC){var aE="SELECT digest FROM "+gu+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+gu+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,i1(aF)],function(){aC()},function(){return aC(),!1}))})}var t=ax.new_edits,aw=ak.docs,aq=aw.map(function(aC){if(aC._id&&fl(aC._id)){return aC}var aD=bt(aC,t);return aD}),ay=aq.filter(function(aC){return aC.error});if(ay.length){return ab(ay[0])}var ap,ah,am=new Array(aq.length),ac=new gJ.Map;fc(aq,"binary",function(aC){return aC?ab(aC):void az.transaction(function(aD){ap=aD,ad(function(aE){aE?ah=aE:av(aA)})},en(ab),au)})}function g6(aa,ag,t,ac,ad){function ah(){++ab===aj.length&&ad&&ad()}function af(al,ak){var am=al._attachments[ak],ap={binary:ag.binary,ctx:ac};t._getAttachment(am,ap,function(au,aq){al._attachments[ak]=jC.extend(gF(am,["digest","content_type"]),{data:aq}),ah()})}var aj=Object.keys(aa._attachments||{});if(!aj.length){return ad&&ad()}var ab=0;aj.forEach(function(ak){ag.attachments&&ag.include_docs?af(aa,ak):(aa._attachments[ak].stub=!0,ah())})}function iO(ac,aB){function ab(){ho()&&(window.localStorage["_pouch__websqldb_"+av._name]=!0),aB(null,av)}function ay(aD,aE){aD.executeSql(gw),aD.executeSql("ALTER TABLE "+jz+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(gr),aD.executeSql("ALTER TABLE "+hk+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+hk+" (local, id)");var aF="SELECT "+hk+".winningseq AS seq, "+hk+".json AS metadata FROM "+jz+" JOIN "+hk+" ON "+jz+".seq = "+hk+".winningseq";aD.executeSql(aF,[],function(aL,aH){for(var aM=[],aJ=[],aI=0;aI<aH.rows.length;aI++){var aG=aH.rows.item(aI),aN=aG.seq,aK=JSON.parse(aG.metadata);ie(aK)&&aM.push(aN),fl(aK.id)&&aJ.push(aK.id)}aL.executeSql("UPDATE "+hk+"SET local = 1 WHERE id IN "+iZ(aJ.length),aJ,function(){aL.executeSql("UPDATE "+jz+" SET deleted = 1 WHERE seq IN "+iZ(aM.length),aM,aE)})})})})}function ap(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+hx+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+hk+".id AS id, "+jz+".json AS data FROM "+jz+" JOIN "+hk+" ON "+jz+".seq = "+hk+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aL,aJ){function aH(){if(!aK.length){return aF(aL)}var aM=aK.shift(),aN=JSON.parse(aM.data)._rev;aL.executeSql("INSERT INTO "+hx+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+hk+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+jz+" WHERE seq=?",[aM.seq],function(){aH()})})})}for(var aK=[],aI=0;aI<aJ.rows.length;aI++){aK.push(aJ.rows.item(aI))}aH()})})}function ah(aE,aG){function aD(aI){function aH(){if(!aI.length){return aG(aE)}var aK=aI.shift(),aM=hY(aK.hex,am),aO=aM.lastIndexOf("::"),aL=aM.substring(0,aO),aN=aM.substring(aO+2),aJ="UPDATE "+jz+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aJ,[aL,aN,aM],function(){aH()})}aH()}var aF="ALTER TABLE "+jz+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aI){var aH="ALTER TABLE "+jz+" ADD COLUMN rev";aI.executeSql(aH,[],function(aJ){aJ.executeSql(U,[],function(aK){var aL="SELECT hex(doc_id_rev) as hex FROM "+jz;aK.executeSql(aL,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function ak(aE,aG){function aD(aH){var aI="SELECT COUNT(*) AS cnt FROM "+gu;aH.executeSql(aI,[],function(aL,aJ){function aM(){var aP=iQ(ai+", "+hk+".id AS id",[hk,jz],gg,null,hk+".id ");aP+=" LIMIT "+aO+" OFFSET "+aN,aN+=aO,aL.executeSql(aP,[],function(ba,aT){function aZ(bc,bd){var bf=aQ[bc]=aQ[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aT.rows.length){return aG(ba)}for(var aQ={},aW=0;aW<aT.rows.length;aW++){for(var aU=aT.rows.item(aW),aV=gY(aU.data,aU.id,aU.rev),aY=Object.keys(aV._attachments||{}),aX=0;aX<aY.length;aX++){var aS=aV._attachments[aY[aX]];aZ(aS.digest,aU.seq)}}var bb=[];if(Object.keys(aQ).forEach(function(bc){var bd=aQ[bc];bd.forEach(function(bf){bb.push([bc,bf])})}),!bb.length){return aM()}var aR=0;bb.forEach(function(bd){var bc="INSERT INTO "+C+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aR===bb.length&&aM()})})})}var aK=aJ.rows.item(0).cnt;if(!aK){return aG(aL)}var aN=0,aO=10;aM()})}var aF="CREATE TABLE IF NOT EXISTS "+C+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(ij,[],function(aI){aI.executeSql(jl,[],aD)})})}function az(aE,aF){var aD="ALTER TABLE "+gu+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function aj(aE,aF){var aD="ALTER TABLE "+hk+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aH){var aG="UPDATE "+hk+" SET max_seq=(SELECT MAX(seq) FROM "+jz+" WHERE doc_id=id)";aH.executeSql(aG,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+hk+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ad(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aG,aF){var aH=aF.rows.item(0).hex;am=2===aH.length?"UTF-8":"UTF-16",aE()})}function t(){for(;aw.length>0;){var aD=aw.pop();aD(null,aa)}}function ag(aN,aF){if(0===aF){var aJ="CREATE TABLE IF NOT EXISTS "+ic+" (dbid, db_version INTEGER)",aM="CREATE TABLE IF NOT EXISTS "+gu+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aO="CREATE TABLE IF NOT EXISTS "+C+" (digest, seq INTEGER)",aE="CREATE TABLE IF NOT EXISTS "+hk+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aD="CREATE TABLE IF NOT EXISTS "+jz+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aK="CREATE TABLE IF NOT EXISTS "+hx+" (id UNIQUE, rev, json)";aN.executeSql(aM),aN.executeSql(aK),aN.executeSql(aO,[],function(){aN.executeSql(jl),aN.executeSql(ij)}),aN.executeSql(aE,[],function(){aN.executeSql(gw),aN.executeSql(aD,[],function(){aN.executeSql(gr),aN.executeSql(U),aN.executeSql(aJ,[],function(){var aQ="INSERT INTO "+ic+" (db_version, dbid) VALUES (?,?)";aa=gp();var aP=[iE,aa];aN.executeSql(aQ,aP,function(){t()})})})})}else{var aH=function(){var aP=iE>aF;aP&&aN.executeSql("UPDATE "+ic+" SET db_version = "+iE);var aQ="SELECT dbid FROM "+ic;aN.executeSql(aQ,[],function(aR,aS){aa=aS.rows.item(0).dbid,t()})},aL=[ay,ap,ah,ak,az,aj,aH],aI=aF,aG=function(aP){aL[aI-1](aP,aG),aI++};aG(aN)}}function aq(){al.transaction(function(aD){ad(aD,function(){aC(aD)})},en(aB),ab)}function aC(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+ic;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+ic,[],function(aJ,aH){var aI=aH.rows.item(0).db_version;ag(aJ,aI)}):aF.executeSql("ALTER TABLE "+ic+" ADD COLUMN db_version INTEGER",[],function(){ag(aF,1)}):ag(aF,0)})}function au(aE,aF){if(-1!==av._docCount){return aF(av._docCount)}var aD=iQ("COUNT("+hk+".id) AS 'num'",[hk,jz],gg,jz+".deleted=0");aE.executeSql(aD,[],function(aH,aG){av._docCount=aG.rows.item(0).num,aF(av._docCount)})}var am,av=this,aa=null,af=ey(ac),aw=[];av._docCount=-1,av._name=ac.name;var aA=jC.extend({},ac,{size:af,version:i5}),ax=gE(aA);if(ax.error){return en(aB)(ax.error)}var al=ax.db;"function"!=typeof al.readTransaction&&(al.readTransaction=al.transaction),aq(),av.type=function(){return"websql"},av._id=js(function(aD){aD(null,aa)}),av._info=function(aD){al.readTransaction(function(aE){au(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+jz;aE.executeSql(aG,[],function(aH,aJ){var aI=aJ.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aI,sqlite_plugin:al._sqlitePlugin,websql_encoding:am})})})},en(aD))},av._bulkDocs=function(aF,aD,aE){g0(ac,aF,aD,av,al,jj,aE)},av._get=function(aJ,aF,aL){function aE(){aL(aH,{doc:aD,metadata:aK,ctx:aM})}var aD,aK,aH,aM=aF.ctx;if(!aM){return al.readTransaction(function(aN){av._get(aJ,jC.extend({ctx:aN},aF),aL)})}var aG,aI;aF.rev?(aG=iQ(ai,[hk,jz],hk+".id="+jz+".doc_id",[jz+".doc_id=?",jz+".rev=?"]),aI=[aJ,aF.rev]):(aG=iQ(ai,[hk,jz],gg,hk+".id=?"),aI=[aJ]),aM.executeSql(aG,aI,function(aP,aO){if(!aO.rows.length){return aH=jd(l,"missing"),aE()}var aN=aO.rows.item(0);return aK=jB(aN.metadata),aN.deleted&&!aF.rev?(aH=jd(l,"deleted"),aE()):(aD=gY(aN.data,aK.id,aN.rev),void aE())})},av._allDocs=function(aN,aF){var aI,aM=[],aK="startkey" in aN?aN.startkey:!1,aQ="endkey" in aN?aN.endkey:!1,aH="key" in aN?aN.key:!1,aE="descending" in aN?aN.descending:!1,aG="limit" in aN?aN.limit:-1,aJ="skip" in aN?aN.skip:0,aO=aN.inclusive_end!==!1,aD=[],aL=[];if(aH!==!1){aL.push(hk+".id = ?"),aD.push(aH)}else{if(aK!==!1||aQ!==!1){if(aK!==!1&&(aL.push(hk+".id "+(aE?"<=":">=")+" ?"),aD.push(aK)),aQ!==!1){var aP=aE?">":"<";aO&&(aP+="="),aL.push(hk+".id "+aP+" ?"),aD.push(aQ)}aH!==!1&&(aL.push(hk+".id = ?"),aD.push(aH))}}"ok"!==aN.deleted&&aL.push(jz+".deleted = 0"),al.readTransaction(function(aR){au(aR,function(aS){if(aI=aS,0!==aG){var aT=iQ(ai,[hk,jz],gg,aL,hk+".id "+(aE?"DESC":"ASC"));aT+=" LIMIT "+aG+" OFFSET "+aJ,aR.executeSql(aT,aD,function(aU,ba){for(var bb=0,aX=ba.rows.length;aX>bb;bb++){var aV=ba.rows.item(bb),bc=jB(aV.metadata),aY=bc.id,aW=gY(aV.data,aY,aV.rev),aZ=aW._rev,bd={id:aY,key:aY,value:{rev:aZ}};if(aN.include_docs&&(bd.doc=aW,bd.doc._rev=aZ,aN.conflicts&&(bd.doc._conflicts=q(bc)),g6(bd.doc,aN,av,aU)),aV.deleted){if("ok"!==aN.deleted){continue}bd.value.deleted=!0,bd.doc=null}aM.push(bd)}})}})},en(aF),function(){aF(null,{total_rows:aI,offset:aN.skip,rows:aM})})},av._changes=function(aD){function aK(){var aN=hk+".json AS metadata, "+hk+".max_seq AS maxSeq, "+jz+".json AS winningDoc, "+jz+".rev AS winningRev ",aM=hk+" JOIN "+jz,aO=hk+".id="+jz+".doc_id AND "+hk+".winningseq="+jz+".seq",aP=["maxSeq > ?"],aS=[aD.since];aD.doc_ids&&(aP.push(hk+".id IN "+iZ(aD.doc_ids.length)),aS=aS.concat(aD.doc_ids));var aL="maxSeq "+(aG?"DESC":"ASC"),aR=iQ(aN,aM,aO,aP,aL),aT=fe(aD);aD.view||aD.filter||(aR+=" LIMIT "+aJ);var aQ=aD.since||0;al.readTransaction(function(aU){aU.executeSql(aR,aS,function(bd,bc){function aV(bg){return function(){aD.onChange(bg)}}for(var aY=0,ba=bc.rows.length;ba>aY;aY++){var bb=bc.rows.item(aY),aZ=jB(bb.metadata);aQ=bb.maxSeq;var bf=gY(bb.winningDoc,aZ.id,bb.winningRev),aW=aD.processChange(bf,aZ,aD);aW.seq=bb.maxSeq;var aX=aT(aW);if("object"==typeof aX){return aD.complete(aX)}if(aX&&(aH++,aE&&aF.push(aW),aD.attachments&&aD.include_docs?g6(bf,aD,av,bd,aV(aW)):aV(aW)()),aH===aJ){break}}})},en(aD.complete),function(){aD.continuous||aD.complete(null,{results:aF,last_seq:aQ})})}if(aD=gy(aD),aD.continuous){var aI=av._name+":"+gp();return jj.addListener(av._name,aI,av,aD),jj.notify(av._name),{cancel:function(){jj.removeListener(av._name,aI)}}}var aG=aD.descending;aD.since=aD.since&&!aG?aD.since:0;var aJ="limit" in aD?aD.limit:-1;0===aJ&&(aJ=1);var aE;aE="return_docs" in aD?aD.return_docs:"returnDocs" in aD?aD.returnDocs:!0;var aF=[],aH=0;aK()},av._close=function(aD){aD()},av._getAttachment=function(aD,aK,aI){var aG,aJ=aK.ctx,aE=aD.digest,aF=aD.content_type,aH="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+gu+" WHERE digest=?";aJ.executeSql(aH,[aE],function(aL,aO){var aN=aO.rows.item(0),aM=aN.escaped?er(aN.body):hY(aN.body,am);aG=aK.binary?hT(aM,aF):hz(aM),aI(null,aG)})},av._getRevisionTree=function(aD,aE){al.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+hk+" WHERE id = ?";aF.executeSql(aG,[aD],function(aJ,aI){if(aI.rows.length){var aH=jB(aI.rows.item(0).metadata);aE(null,aH.rev_tree)}else{aE(jd(l))}})})},av._doCompaction=function(aE,aF,aD){return aF.length?void al.transaction(function(aG){var aH="SELECT json AS metadata FROM "+hk+" WHERE id = ?";aG.executeSql(aH,[aE],function(aI,aK){var aJ=jB(aK.rows.item(0).metadata);jr(aJ.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aL="UPDATE "+hk+" SET json = ? WHERE id = ?";aI.executeSql(aL,[ir(aJ),aE])}),hm(aF,aE,aG)},en(aD),function(){aD()}):aD()},av._getLocal=function(aD,aE){al.readTransaction(function(aF){var aG="SELECT json, rev FROM "+hx+" WHERE id=?";aF.executeSql(aG,[aD],function(aI,aK){if(aK.rows.length){var aJ=aK.rows.item(0),aH=gY(aJ.json,aD,aJ.rev);aE(null,aH)}else{aE(jd(l))}})})},av._putLocal=function(aJ,aG,aL){function aE(aO){var aM,aN;aK?(aM="UPDATE "+hx+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aD,aH,aI,aK]):(aM="INSERT INTO "+hx+" (id, rev, json) VALUES (?,?,?)",aN=[aI,aD,aH]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aF={ok:!0,id:aI,rev:aD},aG.ctx&&aL(null,aF)):aL(jd(iD))},function(){return aL(jd(iD)),!1})}"function"==typeof aG&&(aL=aG,aG={}),delete aJ._revisions;var aD,aK=aJ._rev,aI=aJ._id;aD=aK?aJ._rev="0-"+(parseInt(aK.split("-")[1],10)+1):aJ._rev="0-1";var aF,aH=hM(aJ);aG.ctx?aE(aG.ctx):al.transaction(aE,en(aL),function(){aF&&aL(null,aF)})},av._removeLocal=function(aF,aH,aD){function aG(aI){var aJ="DELETE FROM "+hx+" WHERE id=? AND rev=?",aK=[aF._id,aF._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aE={ok:!0,id:aF._id,rev:"0-0"},void (aH.ctx&&aD(null,aE))):aD(jd(l))})}"function"==typeof aH&&(aD=aH,aH={});var aE;aH.ctx?aG(aH.ctx):al.transaction(aG,en(aD),function(){aE&&aD(null,aE)})},av._destroy=function(aD,aE){jj.removeAllListeners(av._name),al.transaction(function(aF){var aG=[hk,jz,gu,ic,hx,C];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},en(aE),function(){ho()&&(delete window.localStorage["_pouch__websqldb_"+av._name],delete window.localStorage[av._name]),aE(null,{ok:!0})})}}var jC=b(7),g4=hU(jC),jq=hU(b(2)),ju=hU(b(6)),gA=hU(b(8)),gJ=b(12),gk=hU(b(1)),jc=b(4),n=hU(b(14)),fg=b(10),fm=hU(fg),co=hU(b(15)),ik=hU(b(16)),fq="function"==typeof Promise?Promise:gA,iG=jq("pouchdb:api");ju(je,Error),je.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var hC=new je({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),jy=new je({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),l=new je({status:404,error:"not_found",reason:"missing"}),iD=new je({status:409,error:"conflict",reason:"Document update conflict"}),hr=new je({status:400,error:"invalid_id",reason:"_id field must contain a string"}),gW=new je({status:412,error:"missing_id",reason:"_id is required for puts"}),hb=new je({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),fh=new je({status:412,error:"precondition_failed",reason:"Database not open"}),a4=new je({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),ez=new je({status:500,error:"badarg",reason:"Some query argument is invalid"}),fz=new je({status:400,error:"invalid_request",reason:"Request was invalid"}),iH=new je({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),iV=new je({status:500,error:"doc_validation",reason:"Bad special document member"}),fT=new je({status:400,error:"bad_request",reason:"Something wrong with the request"}),br=new je({status:400,error:"bad_request",reason:"Document must be a JSON object"}),ht=new je({status:404,error:"not_found",reason:"Database not found"}),iy=new je({status:500,error:"indexed_db_went_bad",reason:"unknown"}),gP=new je({status:500,error:"web_sql_went_bad",reason:"unknown"}),di=new je({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),u=new je({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),ar=new je({status:400,error:"bad_request",reason:"Invalid rev format"}),gB=new je({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),jA=new je({status:412,error:"missing_stub"}),ew=new je({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),ha={UNAUTHORIZED:hC,MISSING_BULK_DOCS:jy,MISSING_DOC:l,REV_CONFLICT:iD,INVALID_ID:hr,MISSING_ID:gW,RESERVED_ID:hb,NOT_OPEN:fh,UNKNOWN_ERROR:a4,BAD_ARG:ez,INVALID_REQUEST:fz,QUERY_PARSE_ERROR:iH,DOC_VALIDATION:iV,BAD_REQUEST:fT,NOT_AN_OBJECT:br,DB_MISSING:ht,WSQ_ERROR:gP,LDB_ERROR:di,FORBIDDEN:u,INVALID_REV:ar,FILE_EXISTS:gB,MISSING_STUB:jA,IDB_ERROR:iy,INVALID_URL:ew},gM=function(t,ab,ac){var aa=Object.keys(ha).filter(function(af){var ag=ha[af];return"function"!=typeof ag&&ag[t]===ab}),ad=ac&&aa.filter(function(af){var ag=ha[af];return ag.message===ac})[0]||aa[0];return ad?ha[ad]:null};ju(at,jc.EventEmitter),at.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},at.prototype.doChanges=function(t){var ab=this,ac=t.complete;if(t=gy(t),"live" in t&&!("continuous" in t)&&(t.continuous=t.live),t.processChange=fZ,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"===t.since){return void this.db.info().then(function(af){return ab.isCancelled?void ac(null,{status:"cancelled"}):(t.since=af.update_seq,void ab.doChanges(t))},ac)}if(t.continuous&&"now"!==t.since&&this.db.info().then(function(af){ab.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),t.filter&&"string"==typeof t.filter&&("_view"===t.filter?t.view=a0(t.view):t.filter=a0(t.filter),"http"!==this.db.type()&&!t.doc_ids)){return this.filterChanges(t)}"descending" in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=ac;var aa=this.db._changes(t);if(aa&&"function"==typeof aa.cancel){var ad=ab.cancel;ab.cancel=gk(function(af){aa.cancel(),ad.apply(this,af)})}},at.prototype.filterChanges=function(t){var ab=this,ac=t.complete;if("_view"===t.filter){if(!t.view||"string"!=typeof t.view){var aa=jd(fT,"`view` filter parameter not found or invalid.");return ac(aa)}var ad=D(t.view);this.db.getView(ad[0],ad[1],function(ag,ah){return ab.isCancelled?ac(null,{status:"cancelled"}):ag?ac(fY(ag)):ah.map?(t.filter=fS(ah.map),void ab.doChanges(t)):ac(jd(l))})}else{var af=D(t.filter);if(!af){return ab.doChanges(t)}this.db.getFilter(af[0],af[1],function(ag,ah){return ab.isCancelled?ac(null,{status:"cancelled"}):ag?ac(fY(ag)):(t.filter=fx(ah),void ab.doChanges(t))})}};var W="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),hu=h7(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),h5=h7(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);ju(ih,jc.EventEmitter),ih.prototype.post=gT("post",function(aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"object"!=typeof aa||Array.isArray(aa)?t(jd(br)):void this.bulkDocs({docs:[aa]},ab,gO(t))}),ih.prototype.put=gT("put",gk(function(ad){var aa,ag,t,ac,ab=ad.shift(),af="_id" in ab;if("object"!=typeof ab||Array.isArray(ab)){return(ac=ad.pop())(jd(br))}for(;;){if(aa=ad.shift(),ag=typeof aa,"string"!==ag||af?"string"!==ag||!af||"_rev" in ab?"object"===ag?t=aa:"function"===ag&&(ac=aa):ab._rev=aa:(ab._id=aa,af=!0),!ad.length){break}}return t=t||{},hE(ab._id),fl(ab._id)&&"function"==typeof this._putLocal?ab._deleted?this._removeLocal(ab,ac):this._putLocal(ab,ac):void this.bulkDocs({docs:[ab]},t,gO(ac))})),ih.prototype.putAttachment=gT("putAttachment",function(ad,aa,ag,t,ac){function ab(ah){var aj="_rev" in ah?parseInt(ah._rev,10):0;return ah._attachments=ah._attachments||{},ah._attachments[aa]={content_type:ac,data:t,revpos:++aj},af.put(ah)}var af=this;return"function"==typeof ac&&(ac=t,t=ag,ag=null),"undefined"==typeof ac&&(ac=t,t=ag,ag=null),af.get(ad).then(function(ah){if(ah._rev!==ag){throw jd(iD)}return ab(ah)},function(ah){if(ah.reason===l.message){return ab({_id:ad})}throw ah})}),ih.prototype.removeAttachment=gT("removeAttachment",function(t,ab,ac,aa){var ad=this;ad.get(t,function(af,ag){return af?void aa(af):ag._rev!==ac?void aa(jd(iD)):ag._attachments?(delete ag._attachments[ab],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ad.put(ag,aa)):aa()})}),ih.prototype.remove=gT("remove",function(t,ab,ac,aa){var ad;"string"==typeof ab?(ad={_id:t,_rev:ab},"function"==typeof ac&&(aa=ac,ac={})):(ad=t,"function"==typeof ab?(aa=ab,ac={}):(aa=ac,ac=ab)),ac=ac||{},ac.was_delete=!0;var af={_id:ad._id,_rev:ad._rev||ac.rev};return af._deleted=!0,fl(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ad,aa):void this.bulkDocs({docs:[af]},ac,gO(aa))}),ih.prototype.revsDiff=gT("revsDiff",function(ag,af,t){function ad(ak,aj){ah.has(ak)||ah.set(ak,{missing:[]}),ah.get(ak).missing.push(aj)}function ab(aj,ak){var al=ag[aj].slice(0);jr(ak,function(aw,am,ap,av,aq){var ax=am+"-"+ap,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==aq.status&&ad(aj,ax))}),al.forEach(function(am){ad(aj,am)})}"function"==typeof af&&(t=af,af={});var aa=Object.keys(ag);if(!aa.length){return t(null,{})}var ac=0,ah=new gJ.Map;aa.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ah.set(aj,{missing:ag[aj]})}else{if(al){return t(al)}ab(aj,am)}if(++ac===aa.length){var ak={};return ah.forEach(function(ap,aq){ak[aq]=ap}),t(null,ak)}})},this)}),ih.prototype.bulkGet=gT("bulkGet",function(t,aa){g5(this,t,aa)}),ih.prototype.compactDocument=gT("compactDocument",function(aa,ac,t){var ab=this;this._getRevisionTree(aa,function(af,ah){if(af){return t(af)}var ad=h3(ah),ag=[],aj=[];Object.keys(ad).forEach(function(ak){ad[ak]>ac&&ag.push(ak)}),jr(ah,function(am,aq,ak,ap,al){var au=aq+"-"+ak;"available"===al.status&&-1!==ag.indexOf(au)&&aj.push(au)}),ab._doCompaction(aa,aj,t)})}),ih.prototype.compact=gT("compact",function(aa,ab){"function"==typeof aa&&(ab=aa,aa={});var t=this;aa=aa||{},t._compactionQueue=t._compactionQueue||[],t._compactionQueue.push({opts:aa,callback:ab}),1===t._compactionQueue.length&&h0(t)}),ih.prototype._compact=function(ad,aa){function ag(ah){af.push(ac.compactDocument(ah.id,0))}function t(ah){var aj=ah.last_seq;fq.all(af).then(function(){return hO(ac,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){aa(null,{ok:!0})})["catch"](aa)}var ac=this,ab={return_docs:!1,last_seq:ad.last_seq||0},af=[];ac.changes(ab).on("change",ag).on("complete",t).on("error",aa)},ih.prototype.get=gT("get",function(ag,af,t){function ad(){var ak=[],aj=ab.length;return aj?void ab.forEach(function(al){aa.get(ag,{rev:al,revs:af.revs,attachments:af.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||t(null,ak)})}):t(null,ak)}if("function"==typeof af&&(t=af,af={}),"string"!=typeof ag){return t(jd(hr))}if(fl(ag)&&"function"==typeof this._getLocal){return this._getLocal(ag,t)}var ab=[],aa=this;if(!af.open_revs){return this._get(ag,af,function(ap,am){if(ap){return t(ap)}var ax=am.doc,al=am.metadata,az=am.ctx;if(af.conflicts){var ay=q(al);ay.length&&(ax._conflicts=ay)}if(ie(al,ax._rev)&&(ax._deleted=!0),af.revs||af.revs_info){var aj=gQ(al.rev_tree),au=gx(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(ax._rev.split("-")[1])}),aw=au.ids.map(function(aC){return aC.id}).indexOf(ax._rev.split("-")[1])+1,aA=au.ids.length-aw;if(au.ids.splice(aw,aA),au.ids.reverse(),af.revs&&(ax._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),af.revs_info){var aq=au.pos+au.ids.length;ax._revs_info=au.ids.map(function(aC){return aq--,{rev:aq+"-"+aC.id,status:aC.opts.status}})}}if(af.attachments&&ax._attachments){var ak=ax._attachments,aB=Object.keys(ak).length;if(0===aB){return t(null,ax)}Object.keys(ak).forEach(function(aC){this._getAttachment(ak[aC],{binary:af.binary,ctx:az},function(aE,aD){var aF=ax._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aB||t(null,ax)})},aa)}else{if(ax._attachments){for(var av in ax._attachments){ax._attachments.hasOwnProperty(av)&&(ax._attachments[av].stub=!0)}}t(null,ax)}})}if("all"===af.open_revs){this._getRevisionTree(ag,function(ak,aj){return ak?t(ak):(ab=iR(aj).map(function(al){return al.rev}),void ad())})}else{if(!Array.isArray(af.open_revs)){return t(jd(a4,"function_clause"))}ab=af.open_revs;for(var ac=0;ac<ab.length;ac++){var ah=ab[ac];if("string"!=typeof ah||!/^\d+-/.test(ah)){return t(jd(ar))}}ad()}}),ih.prototype.getView=gT("getView",function(aa,ab,t){gn(this,aa,"views",ab,t)}),ih.prototype.getFilter=gT("getFilter",function(aa,ab,t){gn(this,aa,"filters",ab,t)}),ih.prototype.getAttachment=gT("getAttachment",function(t,ab,ac,aa){var ad=this;ac instanceof Function&&(aa=ac,ac={}),this._get(t,ac,function(af,ag){return af?aa(af):ag.doc._attachments&&ag.doc._attachments[ab]?(ac.ctx=ag.ctx,ac.binary=!0,ad._getAttachment(ag.doc._attachments[ab],ac,aa),void 0):aa(jd(l))})}),ih.prototype.allDocs=gT("allDocs",function(aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa.skip="undefined"!=typeof aa.skip?aa.skip:0,aa.start_key&&(aa.startkey=aa.start_key),aa.end_key&&(aa.endkey=aa.end_key),"keys" in aa){if(!Array.isArray(aa.keys)){return ab(new TypeError("options.keys must be an array"))}var t=["startkey","endkey","key"].filter(function(ac){return ac in aa})[0];if(t){return void ab(jd(iH,"Query parameter `"+t+"` is not compatible with multi-get"))}if("http"!==this.type()){return g(this,aa,ab)}}return this._allDocs(aa,ab)}),ih.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new at(this,t,aa)},ih.prototype.close=gT("close",function(t){return this._closed=!0,this._close(t)}),ih.prototype.info=gT("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),ih.prototype.id=gT("id",function(t){return this._id(t)}),ih.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},ih.prototype.bulkDocs=gT("bulkDocs",function(t,ab,ac){if("function"==typeof ab&&(ac=ab,ab={}),ab=ab||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs)){return ac(jd(jy))}for(var aa=0;aa<t.docs.length;++aa){if("object"!=typeof t.docs[aa]||Array.isArray(t.docs[aa])){return ac(jd(br))}}var ad;return t.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ad=ad||gG(ag)})}),ad?ac(jd(fT,ad)):("new_edits" in ab||("new_edits" in t?ab.new_edits=t.new_edits:ab.new_edits=!0),ab.new_edits||"http"===this.type()||t.docs.sort(gq),et(t.docs),this._bulkDocs(t,ab,function(af,ag){return af?ac(af):(ab.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ac(null,ag))}))}),ih.prototype.registerDependentDatabase=gT("registerDependentDatabase",function(aa,ac){function t(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[aa]?!1:(ad.dependentDbs[aa]=!0,ad)}var ab=new this.constructor(aa,this.__opts);hO(this,"_local/_pouch_dependentDbs",t).then(function(){ac(null,{db:ab})})["catch"](ac)}),ih.prototype.destroy=gT("destroy",function(t,ab){function ac(){aa._destroy(t,function(ag,af){return ag?ab(ag):(aa._destroyed=!0,aa.emit("destroyed"),void ab(null,af||{ok:!0}))})}"function"==typeof t&&(ab=t,t={});var aa=this,ad="use_prefix" in aa?aa.use_prefix:!0;return"http"===aa.type()?ac():void aa.get("_local/_pouch_dependentDbs",function(af,ah){if(af){return 404!==af.status?ab(af):ac()}var ak=ah.dependentDbs,ag=aa.constructor,aj=Object.keys(ak).map(function(al){var am=ad?al.replace(new RegExp("^"+ag.prefix),""):al;return new ag(am,aa.__opts).destroy()});fq.all(aj).then(ac,ab)})}),iF.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},iF.prototype.fail=function(t){this.failed=t,this.execute()},iF.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},iF.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},ju(hB,ih),hB.debug=jq;var jg;if(g3()){jg=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),jg=!!localStorage.getItem("_pouch_check_localstorage")}catch(hZ){jg=!1}}hB.adapters={},hB.preferredAdapters=[],hB.prefix="_pouch_";var il=new jc.EventEmitter;jh(hB),hB.parseAdapter=function(ag,af){var t,ad,ab=ag.match(/([a-z\-]*):\/\/(.*)/);if(ab){if(ag=/http(s?)/.test(ab[1])?ab[1]+"://"+ab[2]:ab[2],t=ab[1],!hB.adapters[t].valid()){throw"Invalid adapter"}return{name:ag,adapter:ab[1]}}var aa="idb" in hB.adapters&&"websql" in hB.adapters&&ho()&&localStorage["_pouch__websqldb_"+hB.prefix+ag];if(af.adapter){ad=af.adapter}else{if("undefined"!=typeof af&&af.db){ad="leveldb"}else{for(var ac=0;ac<hB.preferredAdapters.length;++ac){if(ad=hB.preferredAdapters[ac],ad in hB.adapters){if(aa&&"idb"===ad){console.log('PouchDB is downgrading "'+ag+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}t=hB.adapters[ad];var ah=t&&"use_prefix" in t?t.use_prefix:!0;return{name:ah?hB.prefix+ag:ag,adapter:ad}},hB.adapter=function(aa,ab,t){ab.valid()&&(hB.adapters[aa]=ab,t&&hB.preferredAdapters.push(aa))},hB.plugin=function(t){return Object.keys(t).forEach(function(aa){hB.prototype[aa]=t[aa]}),hB},hB.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=jC.extend({},t,ad),void hB.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return ju(aa,hB),jh(aa),aa.preferredAdapters=hB.preferredAdapters.slice(),Object.keys(hB).forEach(function(ab){ab in aa||(aa[ab]=hB[ab])}),aa};var jk=G(),hy=function(){},eu=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ex="queryKey",it=/(?:^|&)([^&=]*)=?([^&]*)/g,jm=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,K=function(t){return atob(t)},hz=function(t){return btoa(t)},Q=g4.extend,bn={ajax:gH,parseUri:z,uuid:gp,Promise:fq,atob:K,btoa:hz,binaryStringToBlobOrBuffer:hT,clone:gy,extend:Q,createError:jd},iz=fm.collate,gh=1,he="pouchdb",ii=5,hp=0;gL.prototype.writeCheckpoint=function(aa,ab){var t=this;return this.updateTarget(aa,ab).then(function(){return t.updateSource(aa,ab)})},gL.prototype.updateTarget=function(t,aa){return iB(this.target,this.id,t,aa,this.returnValue)},gL.prototype.updateSource=function(aa,ab){var t=this;return this.readOnlySource?fq.resolve(!0):iB(this.src,this.id,aa,ab,this.returnValue)["catch"](function(ac){if(dr(ac)){return t.readOnlySource=!0,!0}throw ac})};var fV={undefined:function(t,aa){return 0===iz(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return fo(aa,t).last_seq}};gL.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?fq.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return hp}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in fV?fV[ab](aa,ac):hp},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:hp}).then(function(){return hp},function(ac){return dr(ac)?(t.readOnlySource=!0,aa.last_seq):hp})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return hp})};var F=0,fs=hq.setImmediate||hq.setTimeout,gR=32768,i8=js(function(ah,af){function ak(){var aq=ad*aj,al=aq+aj;if(ad++,ag>ad){ab(t,ah,aq,al),fs(ak)}else{ab(t,ah,aq,al);var ap=t.end(!0),am=hn(ap);af(null,am),t.destroy()}}var ac="string"==typeof ah,aa=ac?ah.length:ah.byteLength,aj=Math.min(gR,aa),ag=Math.ceil(aa/aj),ad=0,t=ac?new co:new co.ArrayBuffer,ab=ac?ei:ip;ak()});ju(hi,jc.EventEmitter),hi.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},hi.prototype.ready=function(t,ab){function ac(){ad.cancel()}function aa(){t.removeListener("destroyed",ac),ab.removeListener("destroyed",ac)}var ad=this;ad._readyCalled||(ad._readyCalled=!0,t.once("destroyed",ac),ab.once("destroyed",ac),ad.once("complete",aa))};var gi={replicate:a1,toPouch:gZ},gN=gi.replicate;ju(gU,jc.EventEmitter),gU.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var hI=25,i3=50,gz={},h1=1800,x=jq("pouchdb:http");i6.valid=function(){return !0},gI.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},gI.prototype.finish=function(){return this.promise};var io,hw=function(t,aa){return aa&&t.then(function(ab){ig.nextTick(function(){aa(null,ab)})},function(ab){ig.nextTick(function(){aa(ab)})}),t},f=function(t){return gk(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&hw(ab,aa),ab})},a5=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},go=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},iW=function(t){for(var ab={},ac=0,aa=t.length;aa>ac;ac++){ab["$"+t[ac]]=!0}var ad=Object.keys(ab),af=new Array(ad.length);for(ac=0,aa=ad.length;aa>ac;ac++){af[ac]=ad[ac].substring(1)}return af},a8={uniq:iW,sequentialize:go,fin:a5,callbackify:f,promisedCallback:hw},hV=fm.collate,fj=fm.toIndexableString,fW=fm.normalizeKey,i=fm.parseIndexableString;io="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var N=a8.callbackify,i4=a8.sequentialize,Z=a8.uniq,ev=a8.fin,hF=a8.promisedCallback,g1={},iM=new gI,hX=50,hQ={_sum:function(t,aa){return E(aa)},_count:function(t,aa){return aa.length},_stats:function(aa,ab){function t(ah){for(var ad=0,af=0,ac=ah.length;ac>af;af++){var ag=ah[af];ad+=ag*ag}return ad}return{sum:E(ab),min:Math.min.apply(null,ab),max:Math.max.apply(null,ab),count:ab.length,sumsqr:t(ab)}}},h6=N(function(){var t=this;return t._ddocCache&&delete t._ddocCache,"http"===t.type()?X(t):"function"==typeof t._viewCleanup?fa(t):a7(t)}),hR=function(t,ab,ac){"function"==typeof ab&&(ac=ab,ab={}),ab=ab?hv(ab):{},"function"==typeof t&&(t={map:t});var aa=this,ad=fq.resolve().then(function(){return L(aa,t,ab)});return hF(ad,ac),ad};ju(y,Error),ju(fU,Error);var hh={query:hR,viewCleanup:h6},cr=5,fp="document-store",I="by-sequence",hL="attach-store",iT="attach-seq-store",gS="meta-store",fi="local-store",iA="detect-blob-support",gK={running:!1,queue:[]};ju(ib,jc.EventEmitter),ib.prototype.addListener=function(t,af,ac,aa){function ad(){function ah(){ab=!1}if(ag._listeners[af]){if(ab){return void (ab="waiting")}ab=!0;var aj=gF(aa,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ac.changes(aj).on("change",function(ak){ak.seq>aa.since&&!aa.cancelled&&(aa.since=ak.seq,aa.onChange(ak))}).on("complete",function(){"waiting"===ab&&setTimeout(function(){ad()},0),ab=!1}).on("error",ah)}}if(!this._listeners[af]){var ag=this,ab=!1;this._listeners[af]=ad,this.on(t,ad)}},ib.prototype.removeListener=function(t,aa){aa in this._listeners&&jc.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},ib.prototype.notifyLocalWindows=function(t){g3()?chrome.storage.local.set({dbName:t}):ho()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},ib.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var hc,hP=new gJ.Map,p=new ib,jx=new gJ.Map;h9.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var iE=7,hk=A("document-store"),jz=A("by-sequence"),gu=A("attach-store"),hx=A("local-store"),ic=A("metadata-store"),C=A("attach-seq-store"),h2=new gJ.Map,jj=new ib,i5=1,gr="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+jz+" (seq, deleted)",U="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+jz+" (doc_id, rev)",gw="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+hk+" (winningseq)",jl="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+C+" (seq)",ij="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+C+" (digest, seq)",gg=jz+".seq = "+hk+".winningseq",ai=jz+".seq AS seq, "+jz+".deleted AS deleted, "+jz+".json AS data, "+jz+".rev AS rev, "+hk+".json AS metadata";iO.use_prefix=!("undefined"!=typeof ig&&!ig.browser),iO.valid=gf;var iI={idb:h9,websql:iO};hB.ajax=gH,hB.utils=bn,hB.Errors=ha,hB.replicate=gi.replicate,hB.sync=hd,hB.version="5.3.2",hB.adapter("http",i6),hB.adapter("https",i6),hB.plugin(hh),Object.keys(iI).forEach(function(t){hB.adapter(t,iI[t],!0)}),e.exports=hB}).call(this,b(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});