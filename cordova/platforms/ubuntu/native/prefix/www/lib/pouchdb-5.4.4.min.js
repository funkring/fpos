!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(l,i,b){function a(j,g){if(!i[j]){if(!l[j]){var h="function"==typeof require&&require;if(!g&&h){return h(j,!0)}if(e){return e(j,!0)}var n=new Error("Cannot find module '"+j+"'");throw n.code="MODULE_NOT_FOUND",n}var f=i[j]={exports:{}};l[j][0].call(f.exports,function(m){var p=l[j][1][m];return a(p?p:m)},f,f.exports,d,l,i,b)}return i[j].exports}for(var e="function"==typeof require&&require,k=0;k<b.length;k++){a(b[k])}return a}({1:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function m(f){return"number"==typeof f}function i(f){return"object"==typeof f&&null!==f}function p(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!m(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,r,l,h,j,f;if(this._events||(this._events={}),"error"===g&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[g],p(r)){return !1}if(o(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),r.apply(this,h)}}else{if(i(r)){for(h=Array.prototype.slice.call(arguments,1),f=r.slice(),l=f.length,j=0;l>j;j++){f[j].apply(this,h)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?i(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,i(this._events[f])&&!this._events[f].warned&&(h=p(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(h,f){function g(){this.removeListener(h,g),j||(j=!0,f.apply(this,arguments))}if(!o(f)){throw TypeError("listener must be a function")}var j=!1;return g.listener=f,this.on(h,g),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(i(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(f,a,u){function b(){i&&B&&(i=!1,B.length?e=B.concat(e):n=-1,e.length&&o())}function o(){if(!i){var g=s(b);i=!0;for(var j=e.length;j;){for(B=e,e=[];++n<j;){B&&B[n].run()}n=-1,j=e.length}B=null,i=!1,t(g)}}function l(g,j){this.fun=g,this.array=j}function r(){}var s,t,h=a.exports={};!function(){try{s=setTimeout}catch(g){s=function(){throw new Error("setTimeout is not defined")}}try{t=clearTimeout}catch(g){t=function(){throw new Error("clearTimeout is not defined")}}}();var B,e=[],i=!1,n=-1;h.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}e.push(new l(j,k)),1!==e.length||i||s(o,0)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=r,h.addListener=r,h.once=r,h.off=r,h.removeListener=r,h.removeAllListeners=r,h.emit=r,h.binding=function(g){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(g){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],3:[function(e,a,b){(function(g9,iO){function er(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function gC(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function fi(t){if("function"==typeof t.slice){return t.slice(0)}var ab=new ArrayBuffer(t.byteLength),ac=new Uint8Array(ab),aa=new Uint8Array(t);return ac.set(aa),ab}function fp(t){if(t instanceof ArrayBuffer){return fi(t)}var aa=t.size,ab=t.type;return"function"==typeof t.slice?t.slice(0,aa,ab):t.webkitSlice(0,aa,ab)}function hE(t){var aa=Object.getPrototypeOf(t);if(null===aa){return !0}var ab=aa.constructor;return"function"==typeof ab&&ab instanceof ab&&fz.call(ab)==gi}function gl(ac){var t,aa,ad;if(!ac||"object"!=typeof ac){return ac}if(Array.isArray(ac)){for(t=[],aa=0,ad=ac.length;ad>aa;aa++){t[aa]=gl(ac[aa])}return t}if(ac instanceof Date){return ac.toISOString()}if(gC(ac)){return fp(ac)}if(!hE(ac)){return ac}t={};for(aa in ac){if(Object.prototype.hasOwnProperty.call(ac,aa)){var ab=gl(ac[aa]);"undefined"!=typeof ab&&(t[aa]=ab)}}return t}function fU(aa){var t=!1;return g1(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function fc(t){return g1(function(ac){ac=gl(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){g9.nextTick(function(){ad(ag,ah)})});var af=new hK(function(ah,aj){var al;try{var ag=fU(function(ap,am){ap?aj(ap):ah(am)});ac.push(ag),al=t.apply(aa,ac),al&&"function"==typeof al.then&&ah(al)}catch(ak){aj(ak)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function fZ(t,aa){function ab(aj,ad,ag){if(hx.enabled){for(var ac=[aj._db_name,ad],ah=0;ah<ag.length-1;ah++){ac.push(ag[ah])}hx.apply(null,ac);var af=ag[ag.length-1];ag[ag.length-1]=function(ak,am){var al=[aj._db_name,ad];al=al.concat(ak?["error",ak]:["success",am]),hx.apply(null,al),af(ak,am)}}}return fc(g1(function(ad){if(this._closed){return hK.reject(new Error("database is closed"))}if(this._destroyed){return hK.reject(new Error("database is destroyed"))}var ac=this;return ab(ac,t,ad),this.taskqueue.isReady?aa.apply(this,ad):new hK(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[t].apply(ac,ad))})})}))}function co(ac,t){for(var aa={},ad=0,ab=t.length;ab>ad;ad++){var af=t[ad];af in ac&&(aa[af]=ac[af])}return aa}function cn(t){return t}function gX(t){return[{ok:t}]}function gf(ak,af,am){function ad(){var av=[];al.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),am(null,{results:av})}function ac(){++t===au&&ad()}function aq(ax,av,aw){al[ax]={id:av,docs:aw},ac()}function aa(){if(!(ap>=aj.length)){var av=Math.min(ap+i5,aj.length),aw=aj.slice(ap,av);ah(aw,ap),ap+=aw.length}}function ah(av,aw){av.forEach(function(ay,aC){var aA=aw+aC,ax=ag[ay],az=co(ax[0],["atts_since","attachments"]);az.open_revs=ax.map(function(aD){return aD.rev}),az.open_revs=az.open_revs.filter(cn);var aB=cn;0===az.open_revs.length&&(delete az.open_revs,aB=gX),["revs","attachments","binary","ajax"].forEach(function(aD){aD in af&&(az[aD]=af[aD])}),ak.get(ay,az,function(aD,aF){var aE;aE=aD?[{error:aD}]:aB(aF),aq(aA,ay,aE),aa()})})}var ab=af.docs,ag={};ab.forEach(function(av){av.id in ag?ag[av.id].push(av):ag[av.id]=[av]});var au=Object.keys(ag).length,t=0,al=new Array(au),aj=Object.keys(ag),ap=0;aa()}function iv(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function ga(){return de}function ee(t){iv()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):ga()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function ge(){je.EventEmitter.call(this),this._listeners={},ee(this)}function go(aa){if("undefined"!==console&&aa in console){var t=Array.prototype.slice.call(arguments,1);console[aa].apply(console,t)}}function fy(ac,t){var aa=600000;ac=parseInt(ac,10)||0,t=parseInt(t,10),t!==t||ac>=t?t=(ac||1)<<1:t+=1,t>aa&&(ac=aa>>1,t=aa);var ad=Math.random(),ab=t-ac;return ~~(ab*ad+ac)}function iC(aa){var t=0;return aa||(t=2000),fy(aa,t)}function hs(aa,t){go("info","The above "+aa+" is totally normal. "+t)}function gh(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function iu(t,ab,ac){function aa(af){for(var ad in t){"function"!=typeof t[ad]&&(this[ad]=t[ad])}void 0!==ac&&(this.name=ac),void 0!==af&&(this.reason=af)}return aa.prototype=gh.prototype,new aa(ab)}function jt(ac){var t,aa,ad,ab,af;return aa=ac.error===!0&&"string"==typeof ac.name?ac.name:ac.error,af=ac.reason,ad=h3("name",aa,af),ac.missing||"missing"===af||"deleted"===af||"not_found"===aa?ad=i8:"doc_validation"===aa?(ad=ez,ab=af):"bad_request"===aa&&ad.message!==af&&(ad=gB),ad||(ad=h3("status",ac.status,af)||gx),t=iu(ad,af,aa),ab&&(t.message=ab),ac.id&&(t.id=ac.id),ac.status&&(t.status=ac.status),ac.missing&&(t.missing=ac.missing),t}function h2(ac,t,aa){try{return !ac(t,aa)}catch(ad){var ab="Filter function threw: "+ad.toString();return iu(gB,ab)}}function hn(t){var aa={},ab=t.filter&&"function"==typeof t.filter;return aa.query=t.query_params,function(ad){ad.doc||(ad.doc={});var ac=ab&&h2(t.filter,ad.doc,aa);if("object"==typeof ac){return ac}if(ac){return !1}if(t.include_docs){if(!t.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function fa(t){for(var ab=[],ac=0,aa=t.length;aa>ac;ac++){ab=ab.concat(t[ac])}return ab}function ii(aa){var t;if(aa?"string"!=typeof aa?t=iu(io):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=iu(m)):t=iu(g3),t){throw t}}function fv(aa,t){return"listenerCount" in aa?aa.listenerCount(t):je.EventEmitter.listenerCount(aa,t)}function iS(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function fh(aa){var t=iS(aa);return t?t.join("/"):null}function jd(ab){for(var ad=et.exec(ab),ag={},ac=14;ac--;){var aa=dn[ac],t=ad[ac]||"",af=-1!==["user","password"].indexOf(aa);ag[aa]=af?decodeURIComponent(t):t}return ag[D]={},ag[dn[12]].replace(u,function(ah,ak,aj){ak&&(ag[D][ak]=aj)}),ag}function O(t,aa,ab){return new hK(function(ad,ac){t.get(aa,function(ah,af){if(ah){if(404!==ah.status){return ac(ah)}af={}}var ag=af._rev,aj=ab(af);return aj?(aj._id=aa,aj._rev=ag,void ad(jo(t,aj,ab))):ad({updated:!1,rev:ag})})})}function jo(t,aa,ab){return t.put(aa).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return O(t,aa._id,ab)})}function fd(t){return 0|Math.random()*t}function gO(t,ab){ab=ab||q.length;var ac="",aa=-1;if(t){for(;++aa<t;){ac+=q[fd(ab)]}return ac}for(;++aa<36;){switch(aa){case 8:case 13:case 18:case 23:ac+="-";break;case 19:ac+=q[3&fd(16)|8];break;default:ac+=q[fd(16)]}}return ac}function hB(t){for(var ag,ac,af,ad,aa=t.rev_tree.slice();ad=aa.pop();){var aj=ad.ids,ap=aj[2],ah=ad.pos;if(ap.length){for(var ak=0,am=ap.length;am>ak;ak++){aa.push({pos:ah+1,ids:ap[ak]})}}else{var ab=!!aj[1].deleted,al=aj[0];ag&&!(af!==ab?af:ac!==ah?ah>ac:al>ag)||(ag=al,ac=ah,af=ab)}}return ac+"-"+ag}function di(aa,aj){for(var ad,ag=aa.slice();ad=ag.pop();){for(var af=ad.pos,ac=ad.ids,ak=ac[2],ah=aj(0===ak.length,af,ac[0],ad.ctx,ac[1]),ab=0,t=ak.length;t>ab;ab++){ag.push({pos:af+1,ids:ak[ab],ctx:ah})}}}function a3(aa,t){return aa.pos-t.pos}function g0(t){var ab=[];di(t,function(af,aj,ag,ad,ah){af&&ab.push({rev:aj+"-"+ag,pos:aj,opts:ah})}),ab.sort(a3).reverse();for(var ac=0,aa=ab.length;aa>ac;ac++){delete ab[ac].pos}return ab}function gs(ab){for(var ad=hB(ab),ag=g0(ab.rev_tree),ac=[],aa=0,t=ag.length;t>aa;aa++){var af=ag[aa];af.rev===ad||af.opts.deleted||ac.push(af.rev)}return ac}function iT(aa){var t=[];return di(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function fS(t){for(var ag,ac=[],af=t.slice();ag=af.pop();){var ad=ag.pos,aa=ag.ids,aj=aa[0],ap=aa[1],ah=aa[2],ak=0===ah.length,am=ag.history?ag.history.slice():[];am.push({id:aj,opts:ap}),ak&&ac.push({pos:ad+1-am.length,ids:am});for(var ab=0,al=ah.length;al>ab;ab++){af.push({pos:ad+1,ids:ah[ab],history:am})}}return ac.reverse()}function jE(aa,t){return aa.pos-t.pos}function bo(ac,t,aa){for(var ad,ab=0,af=ac.length;af>ab;){ad=ab+af>>>1,aa(ac[ad],t)<0?ab=ad+1:af=ad}return ab}function ex(t,ab,ac){var aa=bo(t,ab,ac);t.splice(aa,0,ab)}function iz(ac,aa){for(var af,ah,ag=aa,ab=ac.length;ab>ag;ag++){var ad=ac[ag],t=[ad.id,ad.opts,[]];ah?(ah[2].push(t),ah=t):af=ah=t}return af}function l(aa,t){return aa[0]<t[0]?-1:1}function iP(aa,aj){for(var ad=[{tree1:aa,tree2:aj}],ag=!1;ad.length>0;){var af=ad.pop(),ac=af.tree1,ak=af.tree2;(ac[1].status||ak[1].status)&&(ac[1].status="available"===ac[1].status||"available"===ak[1].status?"available":"missing");for(var ah=0;ah<ak[2].length;ah++){if(ac[2][0]){for(var ab=!1,t=0;t<ac[2].length;t++){ac[2][t][0]===ak[2][ah][0]&&(ad.push({tree1:ac[2][t],tree2:ak[2][ah]}),ab=!0)}ab||(ag="new_branch",ex(ac[2],ak[2][ah],l))}else{ag="new_leaf",ac[2][0]=ak[2][ah]}}}return{conflicts:ag,tree:aa}}function iW(aj,aa,al){var ap,av=[],ad=!1,ac=!1;if(!aj.length){return{tree:[aa],conflicts:"new_leaf"}}for(var ak=0,aw=aj.length;aw>ak;ak++){var am=aj[ak];if(am.pos===aa.pos&&am.ids[0]===aa.ids[0]){ap=iP(am.ids,aa.ids),av.push({pos:am.pos,ids:ap.tree}),ad=ad||ap.conflicts,ac=!0}else{if(al!==!0){var aq=am.pos<aa.pos?am:aa,ag=am.pos<aa.pos?aa:am,t=ag.pos-aq.pos,ab=[],ax=[];for(ax.push({ids:aq.ids,diff:t,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],af=0,ah=az.length;ah>af;af++){ax.push({ids:az[af],diff:ay.diff-1,parent:ay.ids,parentIdx:af})}}else{ay.ids[0]===ag.ids[0]&&ab.push(ay)}}var au=ab[0];au?(ap=iP(au.ids,ag.ids),au.parent[2][au.parentIdx]=ap.tree,av.push({pos:aq.pos,ids:aq.ids}),ad=ad||ap.conflicts,ac=!0):av.push(am)}else{av.push(am)}}}return ac||av.push(aa),av.sort(jE),{tree:av,conflicts:ad||"internal_node"}}function jw(t,ag){for(var ac,af=fS(t),ad={},aa=0,aj=af.length;aj>aa;aa++){for(var ap=af[aa],ah=ap.ids,ak=Math.max(0,ah.length-ag),am={pos:ap.pos+ak,ids:iz(ah,ak)},ab=0;ak>ab;ab++){var al=ap.pos+ab+"-"+ah[ab].id;ad[al]=!0}ac=ac?iW(ac,am,!0).tree:[am]}return di(ac,function(av,aq,au){delete ad[aq+"-"+au]}),{tree:ac,revs:Object.keys(ad)}}function hr(ac,t,aa){var ad=iW(ac,t),ab=jw(ad.tree,aa);return{tree:ab.tree,stemmedRevs:ab.revs,conflicts:ad.conflicts}}function h1(aa,aj){for(var ad,ag=aa.slice(),af=aj.split("-"),ac=parseInt(af[0],10),ak=af[1];ad=ag.pop();){if(ad.pos===ac&&ad.ids[0]===ak){return !0}for(var ah=ad.ids[2],ab=0,t=ah.length;t>ab;ab++){ag.push({pos:ad.pos+1,ids:ah[ab]})}}return !1}function hR(t){return t.ids}function jg(ac,t){t||(t=hB(ac));for(var aa,ad=t.substring(t.indexOf("-")+1),ab=ac.rev_tree.map(hR);aa=ab.pop();){if(aa[0]===ad){return !!aa[1].deleted}ab=ab.concat(aa[2])}}function gz(t){return/^_local/.test(t)}function hU(t){return hO("return "+t+";",{})}function w(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function gk(t,aa){try{t.emit("change",aa)}catch(ab){go("error",'Error in .on("change", function):',ab)}}function fu(ab,ad,ag){function ac(){aa.cancel()}je.EventEmitter.call(this);var aa=this;this.db=ab,ad=ad?gl(ad):{};var t=ad.complete=fU(function(aj,ah){aj?fv(aa,"error")>0&&aa.emit("error",aj):aa.emit("complete",ah),aa.removeAllListeners(),ab.removeListener("destroyed",ac)});ag&&(aa.on("complete",function(ah){ag(null,ah)}),aa.on("error",ag)),ab.once("destroyed",ac),ad.onChange=function(ah){ad.isCancelled||(gk(aa,ah),aa.startSeq&&aa.startSeq<=ah.seq&&(aa.startSeq=!1))};var af=new hK(function(aj,ah){ad.complete=function(al,ak){al?ah(al):aj(ak)}});aa.once("cancel",function(){ab.removeListener("destroyed",ac),ad.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){t(null,ah)},t),ab.taskqueue.isReady?aa.doChanges(ad):ab.taskqueue.addTask(function(){aa.isCancelled?aa.emit("cancel"):aa.doChanges(ad)})}function fg(ac,t,aa){var ad=[{rev:ac._rev}];"all_docs"===aa.style&&(ad=g0(t.rev_tree).map(function(af){return{rev:af.rev}}));var ab={id:t.id,changes:ad,doc:ac};return jg(t,ac._rev)&&(ab.deleted=!0),aa.conflicts&&(ab.doc._conflicts=gs(t),ab.doc._conflicts.length||delete ab.doc._conflicts),ab}function hF(aa,t){return t>aa?-1:aa>t?1:0}function fq(t,aa){for(var ab=0;ab<t.length;ab++){if(aa(t[ab],ab)===!0){return t[ab]}}}function iD(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function E(ac){for(var t=0;t<ac.length;t++){var aa=ac[t];if(aa._deleted){delete aa._attachments}else{if(aa._attachments){for(var ad=Object.keys(aa._attachments),ab=0;ab<ad.length;ab++){var af=ad[ab];aa._attachments[af]=co(aa._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function gA(ac,t){var aa=hF(ac._id,t._id);if(0!==aa){return aa}var ad=ac._revisions?ac._revisions.start:0,ab=t._revisions?t._revisions.start:0;return hF(ad,ab)}function g6(t){var aa={},ab=[];return di(t,function(ad,af,ac,ag){var ah=af+"-"+ac;return ad&&(aa[ah]=0),void 0!==ag&&ab.push({from:ag,to:ah}),ah}),ab.reverse(),ab.forEach(function(ac){void 0===aa[ac.from]?aa[ac.from]=1+aa[ac.to]:aa[ac.from]=Math.min(aa[ac.from],1+aa[ac.to])}),aa}function im(ac,t,aa){var ad="limit" in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&ad.reverse(),!ad.length){return ac._allDocs({limit:0},aa)}var ab={offset:t.skip};return hK.all(ad.map(function(af){var ag=gc.extend({key:af,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new hK(function(aj,ah){ac._allDocs(ag,function(ak,al){return ak?ah(ak):(ab.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ab.rows=af,ab})}function ct(t){var ab=t._compactionQueue[0],aa=ab.opts,ac=ab.callback;t.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(aa.last_seq=ad.last_seq),t._compact(aa,function(ag,af){ag?ac(ag):ac(null,af),g9.nextTick(function(){t._compactionQueue.shift(),t._compactionQueue.length&&ct(t)})})})}function gE(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function gM(){je.EventEmitter.call(this)}function ih(){this.isReady=!1,this.failed=!1,this.queue=[]}function jl(t){t&&iO.debug&&go("error",t)}function fW(ab,ad){function ag(){t.emit("destroyed",aa)}function ac(){ab.removeListener("destroyed",ag),ab.emit("destroyed",ab)}var aa=ad.originalName,t=ab.constructor,af=t._destructionListeners;ab.once("destroyed",ag),af.has(aa)||af.set(aa,[]),af.get(aa).push(ac)}function i3(ab,ad,ag){if(!(this instanceof i3)){return new i3(ab,ad,ag)}var ac=this;if("function"!=typeof ad&&"undefined"!=typeof ad||(ag=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),"undefined"==typeof ag){ag=jl}else{var aa=ag;ag=function(){return go("warn","Using a callback for new PouchDB()is deprecated."),aa.apply(null,arguments)}}ab=ab||ad.name,ad=gl(ad),delete ad.name,this.__opts=ad;var t=ag;ac.auto_compaction=ad.auto_compaction,ac.prefix=i3.prefix,gM.call(ac),ac.taskqueue=new ih;var af=new hK(function(al,aj){ag=function(ap,am){return ap?aj(ap):(delete am.then,void al(am))},ad=gl(ad);var ak,ah;return function(){try{if("string"!=typeof ab){throw ah=new Error("Missing/invalid DB name"),ah.code=400,ah}var ap=(ad.prefix||"")+ab;if(ak=i3.parseAdapter(ap,ad),ad.originalName=ab,ad.name=ak.name,ad.adapter=ad.adapter||ak.adapter,ac._adapter=ad.adapter,hS("pouchdb:adapter")("Picked adapter: "+ad.adapter),ac._db_name=ab,!i3.adapters[ad.adapter]){throw ah=new Error("Adapter is missing"),ah.code=404,ah}if(!i3.adapters[ad.adapter].valid()){throw ah=new Error("Invalid Adapter"),ah.code=404,ah}}catch(am){ac.taskqueue.fail(am)}}(),ah?aj(ah):(ac.adapter=ad.adapter,ac.replicate={},ac.replicate.from=function(aq,am,ap){return ac.constructor.replicate(aq,ac,am,ap)},ac.replicate.to=function(aq,am,ap){return ac.constructor.replicate(ac,aq,am,ap)},ac.sync=function(aq,am,ap){return ac.constructor.sync(ac,aq,am,ap)},ac.replicate.sync=ac.sync,void i3.adapters[ad.adapter].call(ac,ad,function(am){return am?(ac.taskqueue.fail(am),void ag(am)):(fW(ac,ad),ac.emit("created",ac),i3.emit("created",ad.originalName),ac.taskqueue.ready(ac),void ag(null,ac))}))});af.then(function(ah){t(null,ah)},t),ac.then=af.then.bind(af),ac["catch"]=af["catch"].bind(af)}function iy(aa){Object.keys(je.EventEmitter.prototype).forEach(function(ab){"function"==typeof je.EventEmitter.prototype[ab]&&(aa[ab]=iV[ab].bind(iV))});var t=aa._destructionListeners=new hi.Map;aa.on("destroyed",function(ab){t.get(ab).forEach(function(ac){ac()}),t["delete"](ab)})}function hA(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function a9(t){if(!/^\d+\-./.test(t)){return iu(iX)}var ab=t.indexOf("-"),ac=t.substring(0,ab),aa=t.substring(ab+1);return{prefix:parseInt(ac,10),id:aa}}function g4(ab,ad){for(var ag=ab.start-ab.ids.length+1,ac=ab.ids,aa=[ac[0],ad,[]],t=1,af=ac.length;af>t;t++){aa=[ac[t],{status:"missing"},[aa]]}return[{pos:ag,ids:aa}]}function g5(aa,aj){var ad,ag,af,ac={status:"available"};if(aa._deleted&&(ac.deleted=!0),aj){if(aa._id||(aa._id=gO()),ag=gO(32,16).toLowerCase(),aa._rev){if(af=a9(aa._rev),af.error){return af}aa._rev_tree=[{pos:af.prefix,ids:[af.id,{status:"missing"},[[ag,ac,[]]]]}],ad=af.prefix+1}else{aa._rev_tree=[{pos:1,ids:[ag,ac,[]]}],ad=1}}else{if(aa._revisions&&(aa._rev_tree=g4(aa._revisions,ac),ad=aa._revisions.start,ag=aa._revisions.ids[0]),!aa._rev_tree){if(af=a9(aa._rev),af.error){return af}ad=af.prefix,ag=af.id,aa._rev_tree=[{pos:ad,ids:[ag,ac,[]]}]}}ii(aa._id),aa._rev=ad+"-"+ag;var ak={metadata:{},data:{}};for(var ah in aa){if(Object.prototype.hasOwnProperty.call(aa,ah)){var ab="_"===ah[0];if(ab&&!iB[ah]){var t=iu(ez,ah);throw t.message=ez.message+": "+ah,t}ab&&!gt[ah]?ak.metadata[ah.slice(1)]=aa[ah]:ak.data[ah]=aa[ah]}}return ak}function y(ac){for(var t="",aa=new Uint8Array(ac),ad=aa.byteLength,ab=0;ad>ab;ab++){t+=String.fromCharCode(aa[ab])}return t}function gd(t){return gu(y(t))}function z(ac,t){ac=ac||[],t=t||{};try{return new Blob(ac,t)}catch(aa){if("TypeError"!==aa.name){throw aa}for(var ad="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ab=new ad,af=0;af<ac.length;af+=1){ab.append(ac[af])}return ab.getBlob(t.type)}}function hH(ac){for(var t=ac.length,aa=new ArrayBuffer(t),ad=new Uint8Array(aa),ab=0;t>ab;ab++){ad[ab]=ac.charCodeAt(ab)}return aa}function eu(aa,t){return z([hH(aa)],{type:t})}function h0(aa,t){return eu(bt(aa),t)}function I(t,ab){if("undefined"==typeof FileReader){return ab(y((new FileReaderSync).readAsArrayBuffer(t)))}var ac=new FileReader,aa="function"==typeof ac.readAsBinaryString;ac.onloadend=function(af){var ad=af.target.result||"";return aa?ab(ad):void ab(y(ad))},aa?ac.readAsBinaryString(t):ac.readAsArrayBuffer(t)}function jk(aa,t){I(aa,function(ab){t(gu(ab))})}function H(t,aa){if("undefined"==typeof FileReader){return aa((new FileReaderSync).readAsArrayBuffer(t))}var ab=new FileReader;ab.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);aa(ac)},ab.readAsArrayBuffer(t)}function hq(t){return gu(t)}function jB(t,ab,ac,aa){(ac>0||aa<ab.byteLength)&&(ab=new Uint8Array(ab,ac,Math.min(aa,ab.byteLength)-ac)),t.append(ab)}function a7(t,ab,ac,aa){(ac>0||aa<ab.length)&&(ab=ab.substring(ac,aa)),t.appendBinary(ab)}function Y(aa,aj){function ad(){var aq=ah*ac,al=aq+ac;if(ah++,ak>ah){t(ab,aa,aq,al),i4(ad)}else{t(ab,aa,aq,al);var ap=ab.end(!0),am=hq(ap);aj(am),ab.destroy()}}var ag="string"==typeof aa,af=ag?aa.length:aa.byteLength,ac=Math.min(iU,af),ak=Math.ceil(af/ac),ah=0,ab=ag?new hc:new hc.ArrayBuffer,t=ag?a7:jB;ad()}function fx(t){return hc.hash(t)}function Z(ac,aa,af){function ah(al){try{return bt(al)}catch(aj){var ak=iu(fn,"Attachment is not a valid base64 string");return{error:ak}}}function ag(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ah(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===aa?aj.data=eu(al,aj.content_type):"base64"===aa?aj.data=gu(al):aj.data=al,Y(al,function(am){aj.digest="md5-"+am,ak()})}else{H(aj.data,function(am){"binary"===aa?aj.data=y(am):"base64"===aa&&(aj.data=gd(am)),Y(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function ab(){t++,ac.length===t&&(ad?af(ad):af())}if(!ac.length){return af()}var ad,t=0;ac.forEach(function(ak){function am(aq){ad=aq,al++,al===aj.length&&ab()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ab()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ag(ak.data._attachments[ap],am)}})}function hv(ax,al,az,af,aA,t,aa,aw){if(h1(al.rev_tree,az.metadata.rev)){return af[aA]=az,t()}var am=al.winningRev||hB(al),au="deleted" in al?al.deleted:jg(al,am),ah="deleted" in az.metadata?az.metadata.deleted:jg(az.metadata),aq=/^1-/.test(az.metadata.rev);if(au&&!ah&&aw&&aq){var ay=az.data;ay._rev=am,ay._id=az.metadata.id,az=g5(ay,aw)}var av=hr(al.rev_tree,az.metadata.rev_tree[0],ax),ak=aw&&(au&&ah||!au&&"new_leaf"!==av.conflicts||au&&!ah&&"new_branch"===av.conflicts);if(ak){var ag=iu(ik);return af[aA]=ag,t()}var ac=az.metadata.rev;az.metadata.rev_tree=av.tree,az.stemmedRevs=av.stemmedRevs||[],al.rev_map&&(az.metadata.rev_map=al.rev_map);var ad,aj=hB(az.metadata),ap=jg(az.metadata,aj),ab=au===ap?0:ap>au?-1:1;ad=ac===aj?ap:jg(az.metadata,ac),aa(az,aj,ap,ad,!0,ab,aA,t)}function gI(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function ja(aq,am,ag,af,ak,ac,aa,ah,ap){function al(aC,aw,aA){var ay=hB(aC.metadata),az=jg(aC.metadata,ay);if("was_delete" in ah&&az){return ac[aw]=iu(i8,"deleted"),aA()}var av=ad&&gI(aC);if(av){var ax=iu(ik);return ac[aw]=ax,aA()}var aB=az?0:1;aa(aC,ay,az,az,!1,aB,aw,aA)}function au(){++aj===t&&ap&&ap()}aq=aq||1000;var ad=ah.new_edits,ab=new hi.Map,aj=0,t=am.length;am.forEach(function(aw,ay){if(aw._id&&gz(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void ag[ax](aw,{ctx:ak},function(aA,az){ac[ay]=aA||az,au()})}var av=aw.metadata.id;ab.has(av)?(t--,ab.get(av).push([aw,ay])):ab.set(av,[[aw,ay]])}),ab.forEach(function(ay,aw){function ax(){++az<ay.length?av():au()}function av(){var aC=ay[az],aA=aC[0],aB=aC[1];if(af.has(aw)){hv(aq,af.get(aw),aA,ac,aB,ax,aa,ad)}else{var aD=hr([],aA.metadata.rev_tree[0],aq);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],al(aA,aB,ax)}}var az=0;av()})}function gj(aa){try{return JSON.parse(aa)}catch(t){return jC.parse(aa)}}function S(t){return t.length<50000?JSON.parse(t):gj(t)}function dt(aa){try{return JSON.stringify(aa)}catch(t){return jC.stringify(aa)}}function bn(ac,t,aa,ad){try{ac.apply(t,aa)}catch(ab){ad.emit("error",ab)}}function hf(aa){if(!o.running&&o.queue.length){o.running=!0;var t=o.queue.shift();t.action(function(ac,ab){bn(t.callback,this,[ac,ab],aa),o.running=!1,g9.nextTick(function(){hf(aa)})})}}function R(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(iu(h7,aa,ab.type))}}function jn(t,aa,ab){return{data:dt(t),winningRev:aa,deletedOrLocal:ab?"1":"0",seq:t.seq,id:t.id}}function ci(aa){if(!aa){return null}var t=S(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function gy(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function jD(t,ab,ac,aa){ac?aa(t?"string"!=typeof t?t:h0(t,ab):z([""],{type:ab})):t?"string"!=typeof t?I(t,function(ad){aa(gu(ad))}):aa(t):aa("")}function iJ(ac,aa,af,ah){function ag(){++t===ad.length&&ah&&ah()}function ab(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=af.objectStore(gr).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ag()}}var ad=Object.keys(ac._attachments||{});if(!ad.length){return ah&&ah()}var t=0;ad.forEach(function(aj){aa.attachments&&aa.include_docs?ab(ac,aj):(ac._attachments[aj].stub=!0,ag())})}function i2(aa,t){return hK.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return hK.all(ab.map(function(ag){var ad=ac.doc._attachments[ag];if("body" in ad){var ah=ad.body,af=ad.content_type;return new hK(function(aj){jD(ah,af,t,function(ak){ac.doc._attachments[ag]=gc.extend(co(ad,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function jq(aa,aj,ad){function ag(){t--,t||af()}function af(){ac.length&&ac.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ah["delete"](am)}})}var ac=[],ak=ad.objectStore(gv),ah=ad.objectStore(gr),ab=ad.objectStore(iR),t=aa.length;aa.forEach(function(al){var am=ak.index("_doc_id_rev"),ap=aj+"::"+al;am.getKey(ap).onsuccess=function(aq){var au=aq.target.result;if("number"!=typeof au){return ag()}ak["delete"](au);var av=ab.index("seq").openCursor(IDBKeyRange.only(au));av.onsuccess=function(ay){var aw=ay.target.result;if(aw){var ax=aw.value.digestSeq.split("::")[0];ac.push(ax),ab["delete"](aw.primaryKey),aw["continue"]()}else{ag()}}}})}function hL(t,ab,ac){try{return{txn:t.transaction(ab,ac)}}catch(aa){return{error:aa}}}function ib(aI,az,ag,au,ax,aD,aF){function aH(){var aN=[h8,gv,gr,ir,iR],aO=hL(ax,aN,"readwrite");return aO.error?aF(aO.error):(aC=aO.txn,aC.onabort=R(aF),aC.ontimeout=R(aF),aC.oncomplete=aJ,av=aC.objectStore(h8),aB=aC.objectStore(gv),ah=aC.objectStore(gr),aa=aC.objectStore(iR),void aM(function(aP){return aP?(ac=!0,aF(aP)):void aL()}))}function aG(){ja(aI.revs_limit,aw,au,aq,aC,aE,aj,ag)}function aL(){function aO(){++aT===aw.length&&aG()}function aQ(aU){var aV=ci(aU.target.result);aV&&aq.set(aV.id,aV),aO()}if(aw.length){for(var aT=0,aP=0,aN=aw.length;aN>aP;aP++){var aR=aw[aP];if(aR._id&&gz(aR._id)){aO()}else{var aS=av.get(aR.metadata.id);aS.onsuccess=aQ}}}}function aJ(){ac||(aD.notify(au._meta.name),au._meta.docCount+=aA,aF(null,aE))}function am(aO,aP){var aN=ah.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=iu(ht,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(aw.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){am(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function aj(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?ap(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(bc){var ba=aP.stemmedRevs||[];aV&&au.auto_compaction&&(ba=ba.concat(iT(aP.metadata))),ba&&ba.length&&jq(ba,aP.metadata.id,aC),aT.seq=bc.target.result,delete aT.rev;var bb=jn(aT,aW,aU),aZ=av.put(bb);aZ.onsuccess=aN}function aX(ba){ba.preventDefault(),ba.stopPropagation();var bb=aB.index("_doc_id_rev"),aZ=bb.getKey(aR._doc_id_rev);aZ.onsuccess=function(bc){var bd=aB.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){aE[aS]={ok:!0,id:aT.id,rev:aW},aq.set(aP.metadata.id,aP.metadata),ay(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=aB.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function ap(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aY){var bb=aP.data._attachments[aY];if(bb.stub){aO++,aN()}else{var aZ=bb.data;delete bb.data,bb.revpos=parseInt(aW,10);var ba=bb.digest;al(ba,aZ,aV)}})}function ay(aP,aS,aN){function aQ(){++aT===aU.length&&aN()}function aO(aW){var aX=aP.data._attachments[aW].digest,aV=aa.put({seq:aS,digestSeq:aX+"::"+aS});aV.onsuccess=aQ,aV.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aQ()}}var aT=0,aU=Object.keys(aP.data._attachments||{});if(!aU.length){return aN()}for(var aR=0;aR<aU.length;aR++){aO(aU[aR])}}function al(aO,aQ,aN){var aP=ah.count(aO);aP.onsuccess=function(aT){var aS=aT.target.result;if(aS){return aN()}var aU={digest:aO,body:aQ},aR=ah.put(aU);aR.onsuccess=aN}}for(var aC,av,aB,ah,aa,ab,aw=az.docs,aA=0,t=0,af=aw.length;af>t;t++){var ak=aw[t];ak._id&&gz(ak._id)||(ak=aw[t]=g5(ak,ag.new_edits),ak.error&&!ab&&(ab=ak))}if(ab){return aF(ab)}var aE=new Array(aw.length),aq=new hi.Map,ac=!1,aK=au._meta.blobSupport?"blob":"base64";Z(aw,aK,function(aN){return aN?aF(aN):void aH()})}function hk(ac,t,aa,ad,ab){try{if(ac&&t){return ab?IDBKeyRange.bound(t,ac,!aa,!1):IDBKeyRange.bound(ac,t,!1,!aa)}if(ac){return ab?IDBKeyRange.upperBound(ac):IDBKeyRange.lowerBound(ac)}if(t){return ab?IDBKeyRange.lowerBound(t,!aa):IDBKeyRange.upperBound(t,!aa)}if(ad){return IDBKeyRange.only(ad)}}catch(af){return{error:af}}return null}function hz(t,ab,ac,aa){return"DataError"===ac.name&&0===ac.code?aa(null,{total_rows:t._meta.docCount,offset:ab.skip,rows:[]}):void aa(iu(h7,ac.name,ac.message))}function ix(ac,t,aa,ad){function ab(aE,aq){function ay(aL,aM,aK){var aN=aL.id+"::"+aK;az.get(aN).onsuccess=function(aO){aM.doc=gy(aO.target.result),aE.conflicts&&(aM.doc._conflicts=gs(aL)),iJ(aM.doc,aE,au)}}function av(aL,aO,aK){var aM={id:aK.id,key:aK.id,value:{rev:aO}},aN=aK.deleted;if("ok"===aE.deleted){aJ.push(aM),aN?(aM.value.deleted=!0,aM.doc=null):aE.include_docs&&ay(aK,aM,aO)}else{if(!aN&&al--<=0&&(aJ.push(aM),aE.include_docs&&ay(aK,aM,aO),0===--aw)){return}}aL["continue"]()}function ah(aK){ag=t._meta.docCount;var aM=aK.target.result;if(aM){var aL=ci(aM.value),aN=aL.winningRev;av(aM,aN,aL)}}function aG(){aq(null,{total_rows:ag,offset:aE.skip,rows:aJ})}function aB(){aE.attachments?i2(aJ,aE.binary).then(aG):aG()}var aA="startkey" in aE?aE.startkey:!1,aC="endkey" in aE?aE.endkey:!1,am="key" in aE?aE.key:!1,al=aE.skip||0,aw="number"==typeof aE.limit?aE.limit:-1,ax=aE.inclusive_end!==!1,ak="descending" in aE&&aE.descending?"prev":null,aH=hk(aA,aC,ax,am,ak);if(aH&&aH.error){return hz(t,aE,aH.error,aq)}var aj=[h8,gv];aE.attachments&&aj.push(gr);var aD=hL(aa,aj,"readonly");if(aD.error){return aq(aD.error)}var au=aD.txn,aI=au.objectStore(h8),ap=au.objectStore(gv),aF=ak?aI.openCursor(aH,ak):aI.openCursor(aH),az=ap.index("_doc_id_rev"),aJ=[],ag=0;au.oncomplete=aB,aF.onsuccess=ah}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:t._meta.docCount,offset:ah.skip,rows:[]}):void ab(ah,ag)}af(ac,ad)}function jA(t){return new hK(function(ab){var aa=z([""]);t.objectStore(iw).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function a8(t,aa){var ab=this;o.queue.push({action:function(ac){hN(ab,t,ac)},callback:aa}),hf(ab.constructor)}function hN(am,al,ag){function ad(au){var av=au.createObjectStore(h8,{keyPath:"id"});au.createObjectStore(gv,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(gr,{keyPath:"digest"}),au.createObjectStore(h6,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(iw),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(ir,{keyPath:"_id"});var aw=au.createObjectStore(iR,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function ac(au,av){var aw=au.objectStore(h8);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=jg(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function ah(au){au.createObjectStore(ir,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ap(ax,av){var aw=ax.objectStore(ir),az=ax.objectStore(h8),ay=ax.objectStore(gv),au=az.openCursor();au.onsuccess=function(aB){var aE=aB.target.result;if(aE){var aK=aE.value,aH=aK.id,aI=gz(aH),aL=hB(aK);if(aI){var aC=aH+"::"+aL,aF=aH+"::",aA=aH+"::~",aD=ay.index("_doc_id_rev"),aG=IDBKeyRange.bound(aF,aA,!1,!1),aJ=aD.openCursor(aG);aJ.onsuccess=function(aN){if(aJ=aN.target.result){var aM=aJ.value;aM._doc_id_rev===aC&&aw.put(aM),ay["delete"](aJ.primaryKey),aJ["continue"]()}else{az["delete"](aE.primaryKey),aE["continue"]()}}}else{aE["continue"]()}}else{av&&av()}}}function ab(au){var av=au.createObjectStore(iR,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function aa(ax,av){var aw=ax.objectStore(gv),az=ax.objectStore(gr),ay=ax.objectStore(iR),au=az.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (aw.openCursor().onsuccess=function(aD){var aH=aD.target.result;if(!aH){return av()}for(var aI=aH.value,aF=aH.primaryKey,aL=Object.keys(aI._attachments||{}),aJ={},aK=0;aK<aL.length;aK++){var aC=aI._attachments[aL[aK]];aJ[aC.digest]=!0}var aE=Object.keys(aJ);for(aK=0;aK<aE.length;aK++){var aG=aE[aK];ay.put({seq:aF,digestSeq:aG+"::"+aF})}aH["continue"]()}):av()}}function ak(av){function au(az){return az.data?ci(az):(az.deleted="1"===az.deletedOrLocal,az)}var aw=av.objectStore(gv),ax=av.objectStore(h8),ay=ax.openCursor();ay.onsuccess=function(aC){function aB(){var aF=az.id+"::",aH=az.id+"::￿",aG=aw.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aD()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aD(){var aE=jn(az,az.winningRev,az.deleted),aF=ax.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var az=au(aA.value);return az.winningRev=az.winningRev||hB(az),az.seq?aD():void aB()}}}var af=al.name,aj=null;am._meta=null,am.type=function(){return"idb"},am._id=fc(function(au){au(null,am._meta.instanceId)}),am._bulkDocs=function(aw,av,au){ib(al,aw,av,am,aj,f,au)},am._get=function(av,aA,aB){function ax(){aB(au,{doc:aw,metadata:ay,ctx:az})}var aw,ay,au,az=aA.ctx;if(!az){var aC=hL(aj,[h8,gv,gr],"readonly");if(aC.error){return aB(aC.error)}az=aC.txn}az.objectStore(h8).get(av).onsuccess=function(aG){if(ay=ci(aG.target.result),!ay){return au=iu(i8,"missing"),ax()}if(jg(ay)&&!aA.rev){return au=iu(i8,"deleted"),ax()}var aE=az.objectStore(gv),aD=aA.rev||ay.winningRev,aF=ay.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aw=aH.target.result,aw&&(aw=gy(aw)),aw?void ax():(au=iu(i8,"missing"),ax())}}},am._getAttachment=function(av,aA,aB,ax,aw){var ay;if(ax.ctx){ay=ax.ctx}else{var au=hL(aj,[h8,gv,gr],"readonly");if(au.error){return aw(au.error)}ay=au.txn}var az=aB.digest,aC=aB.content_type;ay.objectStore(gr).get(az).onsuccess=function(aE){var aD=aE.target.result.body;jD(aD,aC,ax.binary,function(aF){aw(null,aF)})}},am._info=function(av){if(null===aj||!B.has(af)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var au,aw,ax=hL(aj,[gv],"readonly");if(ax.error){return av(ax.error)}var ay=ax.txn,az=ay.objectStore(gv).openCursor(null,"prev");az.onsuccess=function(aB){var aC=aB.target.result;au=aC?aC.key:0,aw=am._meta.docCount},ay.oncomplete=function(){av(null,{doc_count:aw,update_seq:au,idb_attachment_format:am._meta.blobSupport?"binary":"base64"})}},am._allDocs=function(av,au){ix(av,am,aj,au)},am._changes=function(aD){function av(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aL=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=aB.get(aU);aT.onsuccess=function(aV){aO(gy(aV.target.result))}}function aO(aU){var aT=aD.processChange(aU,aN,aD);aT.seq=aN.seq;var aV=aI(aT);return"object"==typeof aV?aD.complete(aV):(aV&&(aH++,aJ&&aw.push(aT),aD.attachments&&aD.include_docs?iJ(aU,aD,ax,function(){i2([aT],aD.binary).then(function(){aD.onChange(aT)})}):aD.onChange(aT)),void (aH!==aG&&aS["continue"]()))}var aQ=gy(aS.value),aR=aS.key;if(aK&&!aK.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aF.get(aQ._id).onsuccess=function(aT){aN=ci(aT.target.result),ay.set(aQ._id,aN),aM()})}function aE(aN){var aM=aN.target.result;aM&&av(aM)}function aA(){var aM=[h8,gv];aD.attachments&&aM.push(gr);var aN=hL(aj,aM,"readonly");if(aN.error){return aD.complete(aN.error)}ax=aN.txn,ax.onabort=R(aD.complete),ax.oncomplete=au,az=ax.objectStore(gv),aF=ax.objectStore(h8),aB=az.index("_doc_id_rev");var aO;aO=aD.descending?az.openCursor(null,"prev"):az.openCursor(IDBKeyRange.lowerBound(aD.since,!0)),aO.onsuccess=aE}function au(){function aM(){aD.complete(null,{results:aw,last_seq:aL})}!aD.continuous&&aD.attachments?i2(aw).then(aM):aM()}if(aD=gl(aD),aD.continuous){var aC=af+":"+gO();return f.addListener(af,aC,am,aD),f.notify(af),{cancel:function(){f.removeListener(af,aC)}}}var aK=aD.doc_ids&&new hi.Set(aD.doc_ids);aD.since=aD.since||0;var aL=aD.since,aG="limit" in aD?aD.limit:-1;0===aG&&(aG=1);var aJ;aJ="return_docs" in aD?aD.return_docs:"returnDocs" in aD?aD.returnDocs:!0;var ax,az,aF,aB,aw=[],aH=0,aI=hn(aD),ay=new hi.Map;aA()},am._close=function(au){return null===aj?au(iu(hy)):(aj.close(),B["delete"](af),aj=null,void au())},am._getRevisionTree=function(av,au){var aw=hL(aj,[h8],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(h8).get(av);ay.onsuccess=function(aA){var az=ci(aA.target.result);az?au(null,az.rev_tree):au(iu(i8))}},am._doCompaction=function(aA,av,aw){var az=[h8,gv,gr,iR],au=hL(aj,az,"readwrite");if(au.error){return aw(au.error)}var ax=au.txn,ay=ax.objectStore(h8);ay.get(aA).onsuccess=function(aC){var aE=ci(aC.target.result);di(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==av.indexOf(aF)&&(aK.status="missing")}),jq(av,aA,ax);var aD=aE.winningRev,aB=aE.deleted;ax.objectStore(h8).put(jn(aE,aD,aB))},ax.onabort=R(aw),ax.oncomplete=function(){aw()}},am._getLocal=function(av,au){var aw=hL(aj,[ir],"readonly");if(aw.error){return au(aw.error)}var ax=aw.txn,ay=ax.objectStore(ir).get(av);ay.onerror=R(au),ay.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,au(null,az)):au(iu(i8))}},am._putLocal=function(ay,aD,av){"function"==typeof aD&&(av=aD,aD={}),delete ay._revisions;var aA=ay._rev,az=ay._id;aA?ay._rev="0-"+(parseInt(aA.split("-")[1],10)+1):ay._rev="0-1";var aB,aw=aD.ctx;if(!aw){var aC=hL(aj,[ir],"readwrite");if(aC.error){return av(aC.error)}aw=aC.txn,aw.onerror=R(av),aw.oncomplete=function(){aB&&av(null,aB)}}var au,ax=aw.objectStore(ir);aA?(au=ax.get(az),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aA){var aG=ax.put(ay);aG.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)}}else{av(iu(ik))}}):(au=ax.add(ay),au.onerror=function(aE){av(iu(ik)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)})},am._removeLocal=function(av,aA,aB){"function"==typeof aA&&(aB=aA,aA={});var ax=aA.ctx;if(!ax){var aw=hL(aj,[ir],"readwrite");if(aw.error){return aB(aw.error)}ax=aw.txn,ax.oncomplete=function(){ay&&aB(null,ay)}}var ay,au=av._id,az=ax.objectStore(ir),aC=az.get(au);aC.onerror=R(aB),aC.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===av._rev?(az["delete"](au),ay={ok:!0,id:au,rev:"0-0"},aA.ctx&&aB(null,ay)):aB(iu(i8))}},am._destroy=function(aw,au){f.removeAllListeners(af);var av=hJ.get(af);av&&av.result&&(av.result.close(),B["delete"](af));var ax=indexedDB.deleteDatabase(af);ax.onsuccess=function(){hJ["delete"](af),ga()&&af in localStorage&&delete localStorage[af],au(null,{ok:!0})},ax.onerror=R(au)};var aq=B.get(af);if(aq){return aj=aq.idb,am._meta=aq.global,void g9.nextTick(function(){ag(null,am)})}var t;t=al.storage?jy(af,al.storage):indexedDB.open(af,g2),hJ.set(af,t),t.onupgradeneeded=function(av){function ax(){var aA=ay[au-1];au++,aA&&aA(aw,ax)}var az=av.target.result;if(av.oldVersion<1){return ad(az)}var aw=av.currentTarget.transaction;av.oldVersion<3&&ah(az),av.oldVersion<4&&ab(az);var ay=[ac,ap,aa,ak],au=av.oldVersion;ax()},t.onsuccess=function(az){aj=az.target.result,aj.onversionchange=function(){aj.close(),B["delete"](af)},aj.onabort=function(aA){go("error","Database has a global failure",aA.target.error),aj.close(),B["delete"](af)};var aw=aj.transaction([h6,iw,h8],"readwrite"),ay=aw.objectStore(h6).get(h6),av=null,ax=null,au=null;ay.onsuccess=function(aB){var aD=function(){null!==av&&null!==ax&&null!==au&&(am._meta={name:af,instanceId:au,blobSupport:av,docCount:ax},B.set(af,{idb:aj,global:am._meta}),ag(null,am))},aA=aB.target.result||{id:h6};af+"_id" in aA?(au=aA[af+"_id"],aD()):(au=gO(),aA[af+"_id"]=au,aw.objectStore(h6).put(aA).onsuccess=function(){aD()}),fm||(fm=jA(aw)),fm.then(function(aE){av=aE,aD()});var aC=aw.objectStore(h8).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ax=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";go("error",au),ag(iu(h7,au))}}function jy(t,aa){try{return indexedDB.open(t,{version:g2,storage:aa})}catch(ab){return indexedDB.open(t,g2)}}function ji(t){t.adapter("idb",a8,!0)}function jf(t){return decodeURIComponent(escape(t))}function id(t){return 65>t?t-48:t-55}function iI(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(id(t.charCodeAt(ab++))<<4|id(t.charCodeAt(ab++)))}return aa}function hT(t,ab,ac){for(var aa="";ac>ab;){aa+=String.fromCharCode(id(t.charCodeAt(ab+2))<<12|id(t.charCodeAt(ab+3))<<8|id(t.charCodeAt(ab))<<4|id(t.charCodeAt(ab+1))),ab+=4}return aa}function jc(aa,t){return"UTF-8"===t?jf(iI(aa,0,aa.length)):hT(aa,0,aa.length)}function hW(t){return"'"+t+"'"}function jh(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function js(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jv(t){return delete t._id,delete t._rev,JSON.stringify(t)}function gn(t,aa,ab){return t=JSON.parse(t),t._id=aa,t._rev=ab,t}function ft(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function ig(ac,t,aa,ad,ab){return"SELECT "+ac+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(aa?" ON "+aa:"")+(ad?" WHERE "+("string"==typeof ad?ad:ad.join(" AND ")):"")+(ab?" ORDER BY "+ab:"")}function jx(ab,ad,ag){function ac(){++t===ab.length&&aa()}function aa(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+gS+" WHERE seq IN "+ft(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+gS+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+gS+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new hi.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+gS+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+iH+" WHERE digest=?",[az]))})})})}})}}if(ab.length){var t=0,af=[];ab.forEach(function(aj){var ah="SELECT seq FROM "+i9+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[ad,aj],function(al,am){if(!am.rows.length){return ac()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+i9+" WHERE seq=?",[ak],ac)})})}}function hD(t){return function(ad){go("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(iu(hM,ab,ac))}}function hX(aa){if("size" in aa){return 1000000*aa.size}var t="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5000000:1}function it(ab,af,aB,av,au,aj,ak){function ax(){return ac?ak(ac):(aj.notify(av._name),av._docCount=-1,void ak(null,ah))}function ag(aD,aE){var aC="SELECT count(*) as cnt FROM "+iH+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=iu(ht,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function aa(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){ag(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function t(aN,aF,aK,aP,aC,aI,aD,aG){function aL(){function aW(bc,bb){function ba(){return ++bf===bg.length&&bb(),!1}function aZ(bh){var bj="INSERT INTO "+gS+" (digest, seq) VALUES (?,?)",bi=[aX._attachments[bh].digest,bc];ap.executeSql(bj,bi,ba,ba)}var bf=0,bg=Object.keys(aX._attachments||{});if(!bg.length){return bb()}for(var bd=0;bd<bg.length;bd++){aZ(bg[bd])}}var aX=aN.data,aU=aP?1:0,aR=aX._id,aV=aX._rev,aT=jv(aX),aS="INSERT INTO "+i9+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aY=[aR,aV,aT,aU];ap.executeSql(aS,aY,function(aZ,ba){var bb=ba.insertId;aW(bb,function(){aM(aZ,bb)})},function(){var aZ=ig("seq",i9,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aR,aV],function(bc,bb){var bf=bb.rows.item(0).seq,bd="UPDATE "+i9+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aT,aU,aR,aV];bc.executeSql(bd,ba,function(bg){aW(bf,function(){aM(bg,bf)})})}),!1})}function aO(aR){aQ||(aR?(aQ=aR,aG(aQ)):aH===aJ.length&&aL())}function aE(aR){aH++,aO(aR)}function aM(aR,aS){var aW=aN.metadata.id,aX=aN.stemmedRevs||[];aC&&av.auto_compaction&&(aX=iT(aN.metadata).concat(aX)),aX.length&&jx(aX,aW,aR),aN.metadata.seq=aS,delete aN.metadata.rev;var aV=aC?"UPDATE "+gH+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+i9+" WHERE doc_id="+gH+".id AND rev=?) WHERE id=?":"INSERT INTO "+gH+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aU=dt(aN.metadata),aT=aC?[aU,aS,aF,aW]:[aW,aS,aS,aU];aR.executeSql(aV,aT,function(){ah[aD]={ok:!0,id:aN.metadata.id,rev:aF},am.set(aW,aN.metadata),aG()})}var aQ=null,aH=0;aN.data._id=aN.metadata.id,aN.data._rev=aN.metadata.rev;var aJ=Object.keys(aN.data._attachments||{});aP&&(aN.data._deleted=!0),aJ.forEach(function(aU){var aS=aN.data._attachments[aU];if(aS.stub){aH++,aO()}else{var aR=aS.data;delete aS.data,aS.revpos=parseInt(aF,10);var aT=aS.digest;ad(aT,aR,aE)}}),aJ.length||aL()}function al(){ja(ab.revs_limit,aq,av,am,ap,ah,t,aB)}function az(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&gz(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+gH+" WHERE id = ?",[aF],function(aH,aI){if(aI.rows.length){var aJ=S(aI.rows.item(0).json);am.set(aF,aJ)}aE()})})}function ad(aD,aF,aC){var aE="SELECT digest FROM "+iH+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+iH+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,jh(aF)],function(){aC()},function(){return aC(),!1}))})}var aw=aB.new_edits,ay=af.docs,aq=ay.map(function(aC){if(aC._id&&gz(aC._id)){return aC}var aD=g5(aC,aw);return aD}),aA=aq.filter(function(aC){return aC.error});if(aA.length){return ak(aA[0])}var ap,ac,ah=new Array(aq.length),am=new hi.Map;Z(aq,"binary",function(aC){return aC?ak(aC):void au.transaction(function(aD){ap=aD,aa(function(aE){aE?ac=aE:az(al)})},hD(ak),ax)})}function gQ(t){return t.websql(t.name,t.version,t.description,t.size)}function i0(aa){try{return{db:gQ(aa)}}catch(t){return{error:t}}}function hQ(aa){var t=U.get(aa.name);return t||(t=i0(aa),U.set(aa.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}function ff(ad,aa,ag,aj,af){function ac(){++ab===ah.length&&af&&af()}function t(am,ak){var al=am._attachments[ak],ap={binary:aa.binary,ctx:aj};ag._getAttachment(am._id,ak,al,ap,function(aq,au){am._attachments[ak]=gc.extend(co(al,["digest","content_type"]),{data:au}),ac()})}var ah=Object.keys(ad._attachments||{});if(!ah.length){return af&&af()}var ab=0;ah.forEach(function(ak){aa.attachments&&aa.include_docs?t(ad,ak):(ad._attachments[ak].stub=!0,ac())})}function a4(ap,ay){function aa(){ga()&&(window.localStorage["_pouch__websqldb_"+ag._name]=!0),ay(null,ag)}function aw(aD,aE){aD.executeSql(gq),aD.executeSql("ALTER TABLE "+i9+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(a2),aD.executeSql("ALTER TABLE "+gH+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+gH+" (local, id)");var aF="SELECT "+gH+".winningseq AS seq, "+gH+".json AS metadata FROM "+i9+" JOIN "+gH+" ON "+i9+".seq = "+gH+".winningseq";aD.executeSql(aF,[],function(aI,aM){for(var aJ=[],aG=[],aN=0;aN<aM.rows.length;aN++){var aL=aM.rows.item(aN),aK=aL.seq,aH=JSON.parse(aL.metadata);jg(aH)&&aJ.push(aK),gz(aH.id)&&aG.push(aH.id)}aI.executeSql("UPDATE "+gH+"SET local = 1 WHERE id IN "+ft(aG.length),aG,function(){aI.executeSql("UPDATE "+i9+" SET deleted = 1 WHERE seq IN "+ft(aJ.length),aJ,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+hm+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+gH+".id AS id, "+i9+".json AS data FROM "+i9+" JOIN "+gH+" ON "+i9+".seq = "+gH+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aL,aJ){function aH(){if(!aK.length){return aF(aL)}var aM=aK.shift(),aN=JSON.parse(aM.data)._rev;aL.executeSql("INSERT INTO "+hm+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+gH+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+i9+" WHERE seq=?",[aM.seq],function(){aH()})})})}for(var aK=[],aI=0;aI<aJ.rows.length;aI++){aK.push(aJ.rows.item(aI))}aH()})})}function aC(aE,aG){function aD(aI){function aH(){if(!aI.length){return aG(aE)}var aL=aI.shift(),aN=jc(aL.hex,az),aK=aN.lastIndexOf("::"),aM=aN.substring(0,aK),aO=aN.substring(aK+2),aJ="UPDATE "+i9+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aJ,[aM,aO,aN],function(){aH()})}aH()}var aF="ALTER TABLE "+i9+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aI){var aH="ALTER TABLE "+i9+" ADD COLUMN rev";aI.executeSql(aH,[],function(aJ){aJ.executeSql(J,[],function(aL){var aK="SELECT hex(doc_id_rev) as hex FROM "+i9;aL.executeSql(aK,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function ab(aE,aG){function aD(aH){var aI="SELECT COUNT(*) AS cnt FROM "+iH;aH.executeSql(aI,[],function(aM,aK){function aN(){var aP=ig(fl+", "+gH+".id AS id",[gH,i9],K,null,gH+".id ");aP+=" LIMIT "+aJ+" OFFSET "+aO,aO+=aJ,aM.executeSql(aP,[],function(ba,aS){function aX(bc,bd){var bf=aZ[bc]=aZ[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aS.rows.length){return aG(ba)}for(var aZ={},aV=0;aV<aS.rows.length;aV++){for(var aT=aS.rows.item(aV),aU=gn(aT.data,aT.id,aT.rev),aY=Object.keys(aU._attachments||{}),aW=0;aW<aY.length;aW++){var aQ=aU._attachments[aY[aW]];aX(aQ.digest,aT.seq)}}var aR=[];if(Object.keys(aZ).forEach(function(bc){var bd=aZ[bc];bd.forEach(function(bf){aR.push([bc,bf])})}),!aR.length){return aN()}var bb=0;aR.forEach(function(bd){var bc="INSERT INTO "+gS+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++bb===aR.length&&aN()})})})}var aL=aK.rows.item(0).cnt;if(!aL){return aG(aM)}var aO=0,aJ=10;aN()})}var aF="CREATE TABLE IF NOT EXISTS "+gS+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(iL,[],function(aI){aI.executeSql(hV,[],aD)})})}function am(aE,aF){var aD="ALTER TABLE "+iH+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ad(aE,aF){var aD="ALTER TABLE "+gH+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+gH+" SET max_seq=(SELECT MAX(seq) FROM "+i9+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+gH+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ah(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;az=2===aG.length?"UTF-8":"UTF-16",aE()})}function ac(){for(;af.length>0;){var aD=af.pop();aD(null,av)}}function aj(aH,aL){if(0===aL){var aO="CREATE TABLE IF NOT EXISTS "+il+" (dbid, db_version INTEGER)",aF="CREATE TABLE IF NOT EXISTS "+iH+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aI="CREATE TABLE IF NOT EXISTS "+gS+" (digest, seq INTEGER)",aK="CREATE TABLE IF NOT EXISTS "+gH+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aJ="CREATE TABLE IF NOT EXISTS "+i9+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aD="CREATE TABLE IF NOT EXISTS "+hm+" (id UNIQUE, rev, json)";aH.executeSql(aF),aH.executeSql(aD),aH.executeSql(aI,[],function(){aH.executeSql(hV),aH.executeSql(iL)}),aH.executeSql(aK,[],function(){aH.executeSql(gq),aH.executeSql(aJ,[],function(){aH.executeSql(a2),aH.executeSql(J),aH.executeSql(aO,[],function(){var aP="INSERT INTO "+il+" (db_version, dbid) VALUES (?,?)";av=gO();var aQ=[T,av];aH.executeSql(aP,aQ,function(){ac()})})})})}else{var aN=function(){var aQ=T>aL;aQ&&aH.executeSql("UPDATE "+il+" SET db_version = "+T);var aP="SELECT dbid FROM "+il;aH.executeSql(aP,[],function(aR,aS){av=aS.rows.item(0).dbid,ac()})},aE=[aw,aq,aC,ab,am,ad,aN],aG=aL,aM=function(aP){aE[aG-1](aP,aM),aG++};aM(aH)}}function au(){ax.transaction(function(aD){ah(aD,function(){ak(aD)})},hD(ay),aa)}function ak(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+il;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+il,[],function(aH,aI){var aJ=aI.rows.item(0).db_version;aj(aH,aJ)}):aF.executeSql("ALTER TABLE "+il+" ADD COLUMN db_version INTEGER",[],function(){aj(aF,1)}):aj(aF,0)})}function aB(aE,aF){if(-1!==ag._docCount){return aF(ag._docCount)}var aD=ig("COUNT("+gH+".id) AS 'num'",[gH,i9],K,i9+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ag._docCount=aH.rows.item(0).num,aF(ag._docCount)})}var az,ag=this,av=null,al=hX(ap),af=[];ag._docCount=-1,ag._name=ap.name;var t=gc.extend({},ap,{version:hb,description:ap.name,size:al}),aA=hQ(t);if(aA.error){return hD(ay)(aA.error)}var ax=aA.db;"function"!=typeof ax.readTransaction&&(ax.readTransaction=ax.transaction),au(),ag.type=function(){return"websql"},ag._id=fc(function(aD){aD(null,av)}),ag._info=function(aD){ax.readTransaction(function(aE){aB(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+i9;aE.executeSql(aG,[],function(aI,aH){var aJ=aH.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aJ,sqlite_plugin:ax._sqlitePlugin,websql_encoding:az})})})},hD(aD))},ag._bulkDocs=function(aF,aD,aE){it(ap,aF,aD,ag,ax,ie,aE)},ag._get=function(aK,aJ,aM){function aF(){aM(aH,{doc:aE,metadata:aL,ctx:aD})}var aE,aL,aH,aD=aJ.ctx;if(!aD){return ax.readTransaction(function(aN){ag._get(aK,gc.extend({ctx:aN},aJ),aM)})}var aG,aI;aJ.rev?(aG=ig(fl,[gH,i9],gH+".id="+i9+".doc_id",[i9+".doc_id=?",i9+".rev=?"]),aI=[aK,aJ.rev]):(aG=ig(fl,[gH,i9],K,gH+".id=?"),aI=[aK]),aD.executeSql(aG,aI,function(aP,aO){if(!aO.rows.length){return aH=iu(i8,"missing"),aF()}var aN=aO.rows.item(0);return aL=S(aN.metadata),aN.deleted&&!aJ.rev?(aH=iu(i8,"deleted"),aF()):(aE=gn(aN.data,aL.id,aN.rev),void aF())})},ag._allDocs=function(aJ,aN){var aM,aF=[],aD="startkey" in aJ?aJ.startkey:!1,aI="endkey" in aJ?aJ.endkey:!1,aP="key" in aJ?aJ.key:!1,aL="descending" in aJ?aJ.descending:!1,aO="limit" in aJ?aJ.limit:-1,aQ="skip" in aJ?aJ.skip:0,aG=aJ.inclusive_end!==!1,aK=[],aE=[];if(aP!==!1){aE.push(gH+".id = ?"),aK.push(aP)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aE.push(gH+".id "+(aL?"<=":">=")+" ?"),aK.push(aD)),aI!==!1){var aH=aL?">":"<";aG&&(aH+="="),aE.push(gH+".id "+aH+" ?"),aK.push(aI)}aP!==!1&&(aE.push(gH+".id = ?"),aK.push(aP))}}"ok"!==aJ.deleted&&aE.push(i9+".deleted = 0"),ax.readTransaction(function(aR){aB(aR,function(aT){if(aM=aT,0!==aO){var aS=ig(fl,[gH,i9],K,aE,gH+".id "+(aL?"DESC":"ASC"));aS+=" LIMIT "+aO+" OFFSET "+aQ,aR.executeSql(aS,aK,function(bc,aZ){for(var ba=0,aW=aZ.rows.length;aW>ba;ba++){var aU=aZ.rows.item(ba),bb=S(aU.metadata),aX=bb.id,aV=gn(aU.data,aX,aU.rev),aY=aV._rev,bd={id:aX,key:aX,value:{rev:aY}};if(aJ.include_docs&&(bd.doc=aV,bd.doc._rev=aY,aJ.conflicts&&(bd.doc._conflicts=gs(bb)),ff(bd.doc,aJ,ag,bc)),aU.deleted){if("ok"!==aJ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aF.push(bd)}})}})},hD(aN),function(){aN(null,{total_rows:aM,offset:aJ.skip,rows:aF})})},ag._changes=function(aJ){function aI(){var aN=gH+".json AS metadata, "+gH+".max_seq AS maxSeq, "+i9+".json AS winningDoc, "+i9+".rev AS winningRev ",aM=gH+" JOIN "+i9,aO=gH+".id="+i9+".doc_id AND "+gH+".winningseq="+i9+".seq",aP=["maxSeq > ?"],aR=[aJ.since];aJ.doc_ids&&(aP.push(gH+".id IN "+ft(aJ.doc_ids.length)),aR=aR.concat(aJ.doc_ids));var aL="maxSeq "+(aE?"DESC":"ASC"),aS=ig(aN,aM,aO,aP,aL),aT=hn(aJ);aJ.view||aJ.filter||(aS+=" LIMIT "+aH);var aQ=aJ.since||0;ax.readTransaction(function(aU){aU.executeSql(aS,aR,function(aX,aW){function aY(bg){return function(){aJ.onChange(bg)}}for(var bc=0,bd=aW.rows.length;bd>bc;bc++){var aV=aW.rows.item(bc),aZ=S(aV.metadata);aQ=aV.maxSeq;var bf=gn(aV.winningDoc,aZ.id,aV.winningRev),ba=aJ.processChange(bf,aZ,aJ);ba.seq=aV.maxSeq;var bb=aT(ba);if("object"==typeof bb){return aJ.complete(bb)}if(bb&&(aF++,aK&&aD.push(ba),aJ.attachments&&aJ.include_docs?ff(bf,aJ,ag,aX,aY(ba)):aY(ba)()),aF===aH){break}}})},hD(aJ.complete),function(){aJ.continuous||aJ.complete(null,{results:aD,last_seq:aQ})})}if(aJ=gl(aJ),aJ.continuous){var aG=ag._name+":"+gO();return ie.addListener(ag._name,aG,ag,aJ),ie.notify(ag._name),{cancel:function(){ie.removeListener(ag._name,aG)}}}var aE=aJ.descending;aJ.since=aJ.since&&!aE?aJ.since:0;var aH="limit" in aJ?aJ.limit:-1;0===aH&&(aH=1);var aK;aK="return_docs" in aJ?aJ.return_docs:"returnDocs" in aJ?aJ.returnDocs:!0;var aD=[],aF=0;aI()},ag._close=function(aD){aD()},ag._getAttachment=function(aK,aJ,aM,aF,aE){var aL,aH=aF.ctx,aD=aM.digest,aG=aM.content_type,aI="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+iH+" WHERE digest=?";aH.executeSql(aI,[aD],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?js(aO.body):jc(aO.body,az);aL=aF.binary?eu(aN,aG):gu(aN),aE(null,aL)})},ag._getRevisionTree=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+gH+" WHERE id = ?";aF.executeSql(aG,[aD],function(aH,aJ){if(aJ.rows.length){var aI=S(aJ.rows.item(0).metadata);aE(null,aI.rev_tree)}else{aE(iu(i8))}})})},ag._doCompaction=function(aE,aF,aD){return aF.length?void ax.transaction(function(aH){var aG="SELECT json AS metadata FROM "+gH+" WHERE id = ?";aH.executeSql(aG,[aE],function(aL,aJ){var aI=S(aJ.rows.item(0).metadata);di(aI.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aK="UPDATE "+gH+" SET json = ? WHERE id = ?";aL.executeSql(aK,[dt(aI),aE])}),jx(aF,aE,aH)},hD(aD),function(){aD()}):aD()},ag._getLocal=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json, rev FROM "+hm+" WHERE id=?";aF.executeSql(aG,[aD],function(aK,aI){if(aI.rows.length){var aH=aI.rows.item(0),aJ=gn(aH.json,aD,aH.rev);aE(null,aJ)}else{aE(iu(i8))}})})},ag._putLocal=function(aL,aH,aE){function aG(aO){var aM,aN;aD?(aM="UPDATE "+hm+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aF,aI,aJ,aD]):(aM="INSERT INTO "+hm+" (id, rev, json) VALUES (?,?,?)",aN=[aJ,aF,aI]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aK={ok:!0,id:aJ,rev:aF},aH.ctx&&aE(null,aK)):aE(iu(ik))},function(){return aE(iu(ik)),!1})}"function"==typeof aH&&(aE=aH,aH={}),delete aL._revisions;var aF,aD=aL._rev,aJ=aL._id;aF=aD?aL._rev="0-"+(parseInt(aD.split("-")[1],10)+1):aL._rev="0-1";var aK,aI=jv(aL);aH.ctx?aG(aH.ctx):ax.transaction(aG,hD(aE),function(){aK&&aE(null,aK)})},ag._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+hm+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(iu(i8))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):ax.transaction(aF,hD(aH),function(){aD&&aH(null,aD)})},ag._destroy=function(aD,aE){ie.removeAllListeners(ag._name),ax.transaction(function(aF){var aG=[gH,i9,iH,il,hm,gS];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},hD(aE),function(){ga()&&(delete window.localStorage["_pouch__websqldb_"+ag._name],delete window.localStorage[ag._name]),aE(null,{ok:!0})})}}function an(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function ha(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var t=ga(),aa="_pouch__websqldb_valid_"+navigator.userAgent;if(t&&localStorage[aa]){return"1"===localStorage[aa]}var ab=an();return t&&(localStorage[aa]=ab?"1":"0"),ab}function eo(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:ha()}function iM(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=gc.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function L(t,ab){var ac=iM(t),aa=gc.extend({websql:ac},t);a4.call(this,aa,ab)}function ip(t){t.adapter("websql",L,!0)}function P(){for(var t={},ab=new hK(function(af,ad){t.resolve=af,t.reject=ad}),ac=new Array(arguments.length),aa=0;aa<ac.length;aa++){ac[aa]=arguments[aa]}return t.promise=ab,hK.resolve().then(function(){return fetch.apply(null,ac)}).then(function(ad){t.resolve(ad)})["catch"](function(ad){t.reject(ad)}),t}function hZ(ab,ad){var ag,ac,aa,t=new Headers,af={method:ab.method,credentials:"include",headers:t};return ab.json&&(t.set("Accept","application/json"),t.set("Content-Type",ab.headers["Content-Type"]||"application/json")),ab.body&&ab.body instanceof Blob?H(ab.body,function(ah){af.body=ah}):ab.body&&ab.processData&&"string"!=typeof ab.body?af.body=JSON.stringify(ab.body):"body" in ab?af.body=ab.body:af.body=null,Object.keys(ab.headers).forEach(function(ah){ab.headers.hasOwnProperty(ah)&&t.set(ah,ab.headers[ah])}),ag=P(ab.url,af),ab.timeout>0&&(ac=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ab.url))},ab.timeout)),ag.promise.then(function(ah){return aa={statusCode:ah.status},ab.timeout>0&&clearTimeout(ac),aa.statusCode>=200&&aa.statusCode<300?ab.binary?ah.blob():ah.text():ah.json()}).then(function(ah){aa.statusCode>=200&&aa.statusCode<300?ad(null,aa,ah):ad(ah,aa)})["catch"](function(ah){ad(ah,aa)}),{abort:ag.reject}}function V(ad,aa){var ag,aj,af=!1,ac=function(){ag.abort()},t=function(){af=!0,ag.abort()};ag=ad.xhr?new ad.xhr:new XMLHttpRequest;try{ag.open(ad.method,ad.url)}catch(ah){aa(ah,{statusCode:413})}ag.withCredentials="withCredentials" in ad?ad.withCredentials:!0,"GET"===ad.method?delete ad.headers["Content-Type"]:ad.json&&(ad.headers.Accept="application/json",ad.headers["Content-Type"]=ad.headers["Content-Type"]||"application/json",ad.body&&ad.processData&&"string"!=typeof ad.body&&(ad.body=JSON.stringify(ad.body))),ad.binary&&(ag.responseType="arraybuffer"),"body" in ad||(ad.body=null);for(var ab in ad.headers){ad.headers.hasOwnProperty(ab)&&ag.setRequestHeader(ab,ad.headers[ab])}return ad.timeout>0&&(aj=setTimeout(t,ad.timeout),ag.onprogress=function(){clearTimeout(aj),4!==ag.readyState&&(aj=setTimeout(t,ad.timeout))},"undefined"!=typeof ag.upload&&(ag.upload.onprogress=ag.onprogress)),ag.onreadystatechange=function(){if(4===ag.readyState){var ak={statusCode:ag.status};if(ag.status>=200&&ag.status<300){var am;am=ad.binary?z([ag.response||""],{type:ag.getResponseHeader("Content-Type")}):ag.responseText,aa(null,ak,am)}else{var ap={};if(af){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ag.response)}catch(al){}}aa(ap,ak)}}},ad.body&&ad.body instanceof Blob?H(ad.body,function(ak){ag.send(ak)}):ag.send(ad.body),{abort:ac}}function ar(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function g(aa,t){return iG||aa.xhr?V(aa,t):hZ(aa,t)}function i6(){return""}function ev(ac,t){function aa(af,ag,aj){if(!ac.binary&&ac.json&&"string"==typeof af){try{af=JSON.parse(af)}catch(ah){return aj(ah)}}Array.isArray(af)&&(af=af.map(function(ak){return ak.error||ak.missing?jt(ak):ak})),ac.binary&&iY(af,ag),aj(null,af,ag)}function ad(aj,al){var ag,ak;if(aj.code&&aj.status){var ah=new Error(aj.message||aj.code);return ah.status=aj.status,al(ah)}if(aj.message&&"ETIMEDOUT"===aj.message){return al(aj)}try{ag=JSON.parse(aj.responseText),ak=jt(ag)}catch(af){ak=jt(aj)}al(ak)}ac=gl(ac);var ab={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ac=gc.extend(ab,ac),ac.json&&(ac.binary||(ac.headers.Accept="application/json"),ac.headers["Content-Type"]=ac.headers["Content-Type"]||"application/json"),ac.binary&&(ac.encoding=null,ac.json=!1),ac.processData||(ac.json=!1),g(ac,function(aj,am,ag){if(aj){return aj.status=am?am.statusCode:400,ad(aj,t)}var al,af=am.headers&&am.headers["content-type"],ah=ag||i6();if(!ac.binary&&(ac.json||!ac.processData)&&"object"!=typeof ah&&(/json/.test(af)||/^[\s]*\{/.test(ah)&&/\}[\s]*$/.test(ah))){try{ah=JSON.parse(ah.toString())}catch(ak){}}am.statusCode>=200&&am.statusCode<300?aa(ah,am,t):(al=jt(ah),al.status=am.statusCode,t(al))})}function g7(aa,aj){var ad=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ag=-1!==ad.indexOf("safari")&&-1===ad.indexOf("chrome"),af=-1!==ad.indexOf("msie"),ac=-1!==ad.indexOf("edge"),ak=ag||(af||ac)&&"GET"===aa.method,ah="cache" in aa?aa.cache:!0,ab=/^blob:/.test(aa.url);if(!ab&&(ak||!ah)){var t=-1!==aa.url.indexOf("?");aa.url+=(t?"&":"?")+"_nonce="+Date.now()}return ev(aa,aj)}function fw(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=h0(ab.data,ab.content_type)})}function gK(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function i1(t){return t._attachments&&Object.keys(t._attachments)?hK.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new hK(function(ac){jk(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):hK.resolve()}function gY(t){var aa=jd(t);(aa.user||aa.password)&&(aa.auth={username:aa.user,password:aa.password});var ab=aa.path.replace(/(^\/|\/$)/g,"").split("/");return aa.db=ab.pop(),-1===aa.db.indexOf("%")&&(aa.db=encodeURIComponent(aa.db)),aa.path=ab.join("/"),aa}function gV(aa,t){return fT(aa,aa.db+"/"+t)}function fT(t,aa){var ab=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+ab+aa}function a0(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function r(aj,ac){function ap(ax,ay,aw){var aA=ax.ajax||{},az=gc.extend(gl(aa),aA,ay);return hu(az.method+" "+az.url),ah._ajax(az,aw)}function ab(ax,aw){return new hK(function(az,ay){ap(ax,aw,function(aA,aB){return aA?ay(aA):void az(aB)})})}function ak(ax,aw){return fZ(ax,g1(function(ay){aq().then(function(){return aw.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function aq(){if(aj.skipSetup||aj.skip_setup){return hK.resolve()}if(af){return af}var aw={method:"GET",url:al};return af=ab({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(hs(404,"PouchDB is just detecting if the remote exists."),ab({},{method:"PUT",url:al})):hK.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:hK.reject(ax)}),af["catch"](function(){af=null}),af}function am(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ah=this,au=gY;aj.getHost&&(au=aj.getHost);var ad=au(aj.name,aj),al=gV(ad,"");aj=gl(aj);var aa=aj.ajax||{};if(ah.getUrl=function(){return al},ah.getHeaders=function(){return aa.headers||{}},aj.auth||ad.auth){var av=aj.auth||ad.auth,t=av.username+":"+av.password,ag=gu(unescape(encodeURIComponent(t)));aa.headers=aa.headers||{},aa.headers.Authorization="Basic "+ag}ah._ajax=g7;var af;setTimeout(function(){ac(null,ah)}),ah.type=function(){return"http"},ah.id=ak("id",function(aw){ap({},{method:"GET",url:fT(ad,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+ad.db:gV(ad,"");aw(null,ay)})}),ah.request=ak("request",function(ax,aw){ax.url=gV(ad,ax.url),ap({},ax,aw)}),ah.compact=ak("compact",function(ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ax=gl(ax),ap(ax,{url:gV(ad,"_compact"),method:"POST"},function(){function ay(){ah.info(function(az,aA){aA&&!aA.compact_running?aw(null,{ok:!0}):setTimeout(ay,ax.interval||200)})}ay()})}),ah.bulkGet=fZ("bulkGet",function(aC,aA){function aB(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ap({},{url:gV(ad,"_bulk_get"+a0(aE)),method:"POST",body:{docs:aC.docs}},aD)}function ax(){function aI(aK){return function(aM,aL){aF[aK]=aL.results,++aH===aD&&aA(null,{results:fa(aF)})}}for(var aE=jz,aD=Math.ceil(aC.docs.length/aE),aH=0,aF=new Array(aD),aG=0;aD>aG;aG++){var aJ=co(aC,["revs","attachments"]);aJ.ajax=aa,aJ.docs=aC.docs.slice(aG*aE,Math.min(aC.docs.length,(aG+1)*aE)),gf(az,aJ,aI(aG))}}var az=this,ay=fT(ad,""),aw=ce[ay];"boolean"!=typeof aw?aB(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(ce[ay]=!1,hs(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aF)}else{ce[ay]=!0,aA(null,aE)}}):aw?aB(aA):ax()}),ah._info=function(aw){aq().then(function(){ap({},{method:"GET",url:gV(ad,"")},function(ay,ax){return ay?aw(ay):(ax.host=gV(ad,""),void aw(null,ax))})})["catch"](aw)},ah.get=ak("get",function(aA,aC,aB){function ax(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?hK.all(aF.map(function(aH){var aG=aD[aH],aI=gK(aE._id)+"/"+am(aH)+"?rev="+aE._rev;return ab(aC,{method:"GET",url:gV(ad,aI),binary:!0}).then(function(aJ){return aC.binary?aJ:new hK(function(aK){jk(aJ,aK)})}).then(function(aJ){delete aG.stub,delete aG.length,aG.data=aJ})})):void 0}function az(aD){return Array.isArray(aD)?hK.all(aD.map(function(aE){return aE.ok?ax(aE.ok):void 0})):ax(aD)}"function"==typeof aC&&(aB=aC,aC={}),aC=gl(aC);var aw={};aC.revs&&(aw.revs=!0),aC.revs_info&&(aw.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),aw.open_revs=aC.open_revs),aC.rev&&(aw.rev=aC.rev),aC.conflicts&&(aw.conflicts=aC.conflicts),aA=gK(aA);var ay={method:"GET",url:gV(ad,aA+a0(aw))};ab(aC,ay).then(function(aD){return hK.resolve().then(function(){return aC.attachments?az(aD):void 0}).then(function(){aB(null,aD)})})["catch"](aB)}),ah.remove=ak("remove",function(aB,az,ax,ay){var aA;"string"==typeof az?(aA={_id:aB,_rev:az},"function"==typeof ax&&(ay=ax,ax={})):(aA=aB,"function"==typeof az?(ay=az,ax={}):(ay=ax,ax=az));var aw=aA._rev||ax.rev;ap(ax,{method:"DELETE",url:gV(ad,gK(aA._id))+"?rev="+aw},ay)}),ah.getAttachment=ak("getAttachment",function(aB,ax,az,aA){"function"==typeof az&&(aA=az,az={});var aw=az.rev?"?rev="+az.rev:"",ay=gV(ad,gK(aB))+"/"+am(ax)+aw;ap(az,{method:"GET",url:ay,binary:!0},aA)}),ah.removeAttachment=ak("removeAttachment",function(ax,ay,aA,aw){var az=gV(ad,gK(ax)+"/"+am(ay))+"?rev="+aA;ap({},{method:"DELETE",url:az},aw)}),ah.putAttachment=ak("putAttachment",function(ax,aE,aC,aB,az,aD){"function"==typeof az&&(aD=az,az=aB,aB=aC,aC=null);var aF=gK(ax)+"/"+am(aE),aG=gV(ad,aF);if(aC&&(aG+="?rev="+aC),"string"==typeof aB){var aA;try{aA=bt(aB)}catch(aw){return aD(iu(fn,"Attachment is not a valid base64 string"))}aB=aA?eu(aA,az):""}var ay={headers:{"Content-Type":az},method:"PUT",url:aG,processData:!1,body:aB,timeout:aa.timeout||60000};ap({},ay,aD)}),ah._bulkDocs=function(ax,aw,ay){ax.new_edits=aw.new_edits,aq().then(function(){return hK.all(ax.docs.map(i1))}).then(function(){ap(aw,{method:"POST",url:gV(ad,"_bulk_docs"),body:ax},function(aA,az){return aA?ay(aA):(az.forEach(function(aB){aB.ok=!0}),void ay(null,az))})})["catch"](ay)},ah.allDocs=ak("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=gl(aA);var aB,ax={},az="GET";aA.conflicts&&(ax.conflicts=!0),aA.descending&&(ax.descending=!0),aA.include_docs&&(ax.include_docs=!0),aA.attachments&&(ax.attachments=!0),aA.key&&(ax.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(ax.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(ax.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(ax.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(ax.limit=aA.limit),"undefined"!=typeof aA.skip&&(ax.skip=aA.skip);var ay=a0(ax);if("undefined"!=typeof aA.keys){var aw="keys="+encodeURIComponent(JSON.stringify(aA.keys));aw.length+ay.length+1<=dr?ay+="&"+aw:(az="POST",aB={keys:aA.keys})}ab(aA,{method:az,url:gV(ad,"_all_docs"+ay),body:aB}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(fw),aC(null,aD)})["catch"](aC)}),ah._changes=function(ay){var aF="batch_size" in ay?ay.batch_size:a6;ay=gl(ay),ay.timeout="timeout" in ay?ay.timeout:"timeout" in aa?aa.timeout:30000;var aH,az=ay.timeout?{timeout:ay.timeout-5000}:{},aw="undefined"!=typeof ay.limit?ay.limit:!1;aH="return_docs" in ay?ay.return_docs:"returnDocs" in ay?ay.returnDocs:!0;var aB=aw;if(ay.style&&(az.style=ay.style),(ay.include_docs||ay.filter&&"function"==typeof ay.filter)&&(az.include_docs=!0),ay.attachments&&(az.attachments=!0),ay.continuous&&(az.feed="longpoll"),ay.conflicts&&(az.conflicts=!0),ay.descending&&(az.descending=!0),"heartbeat" in ay?ay.heartbeat&&(az.heartbeat=ay.heartbeat):az.heartbeat=10000,ay.filter&&"string"==typeof ay.filter&&(az.filter=ay.filter),ay.view&&"string"==typeof ay.view&&(az.filter="_view",az.view=ay.view),ay.query_params&&"object"==typeof ay.query_params){for(var aD in ay.query_params){ay.query_params.hasOwnProperty(aD)&&(az[aD]=ay.query_params[aD])}}var aJ,aK="GET";if(ay.doc_ids){az.filter="_doc_ids";var ax=JSON.stringify(ay.doc_ids);ax.length<dr?az.doc_ids=ax:(aK="POST",aJ={doc_ids:ay.doc_ids})}var aA,aC,aE=function(aM,aN){if(!ay.aborted){az.since=aM,"object"==typeof az.since&&(az.since=JSON.stringify(az.since)),ay.descending?aw&&(az.limit=aB):az.limit=!aw||aB>aF?aF:aB;var aL={method:aK,url:gV(ad,"_changes"+a0(az)),timeout:ay.timeout,body:aJ};aC=aM,ay.aborted||aq().then(function(){aA=ap(ay,aL,aN)})["catch"](aN)}},aG={results:[]},aI=function(aN,aL){if(!ay.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aG.last_seq=aL.last_seq;var aP={};aP.query=ay.query_params,aL.results=aL.results.filter(function(aR){aB--;var aQ=hn(ay)(aR);return aQ&&(ay.include_docs&&ay.attachments&&ay.binary&&fw(aR),aH&&aG.results.push(aR),ay.onChange(aR)),aQ})}else{if(aN){return ay.aborted=!0,void ay.complete(aN)}}aL&&aL.last_seq&&(aC=aL.last_seq);var aO=aw&&0>=aB||aL&&aF>aM||ay.descending;(!ay.continuous||aw&&0>=aB)&&aO?ay.complete(null,aG):setTimeout(function(){aE(aC,aI)},0)}};return aE(ay.since||0,aI),{cancel:function(){ay.aborted=!0,aA&&aA.abort()}}},ah.revsDiff=ak("revsDiff",function(ax,aw,ay){"function"==typeof aw&&(ay=aw,aw={}),ap(aw,{method:"POST",url:gV(ad,"_revs_diff"),body:ax},ay)}),ah._close=function(aw){aw()},ah._destroy=function(ax,aw){ap(ax,{url:gV(ad,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?aw(az):void aw(null,ay)})}}function gF(t){t.adapter("http",r,!1),t.adapter("https",r,!1)}function v(){this.promise=new hK(function(t){t()})}function iN(ac){var aa=ac.db,af=ac.viewName,ah=ac.map,ag=ac.reduce,ab=ac.temporary,ad=ah.toString()+(ag&&ag.toString())+"undefined";if(!ab&&aa._cachedViews){var t=aa._cachedViews[ad];if(t){return hK.resolve(t)}}return aa.info().then(function(ak){function al(am){am.views=am.views||{};var aq=af;-1===aq.indexOf("/")&&(aq=af+"/"+af);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ab?"temp":fx(ad));return O(aa,"_local/mrviews",al).then(function(){return aa.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:aa,adapter:aa.adapter,mapFun:ah,reduceFun:ag};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ab||(aa._cachedViews=aa._cachedViews||{},aa._cachedViews[ad]=aq,aq.db.once("destroyed",function(){delete aa._cachedViews[ad]})),aq})})})})}function ey(ac,t,aa,ad,ab,af){return hO("return ("+ac.replace(/;\s*$/,"")+");",{emit:t,sum:aa,log:ad,isArray:ab,toJSON:af})}function j(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function iQ(t){return 1===t.length&&/^1-/.test(t[0].rev)}function hd(t,aa){try{t.emit("error",aa)}catch(ab){go("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),go("error",aa)}}function iE(t,ab,ac){try{return{output:ab.apply(null,ac)}}catch(aa){return hd(t,aa),{error:aa}}}function g8(t,aa){var ab=h5.collate(t.key,aa.key);return 0!==ab?ab:h5.collate(t.value,aa.value)}function gG(t,aa,ab){return ab=ab||0,"number"==typeof aa?t.slice(ab,aa+ab):ab>0?t.slice(ab):t}function gJ(t){var aa=t.value,ab=aa&&"object"==typeof aa&&aa._id||t.id;return ab}function ao(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=h0(ac.data,ac.content_type)})})}function ae(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&ao(aa),aa}}function fe(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new N(t)}function W(ac){for(var aa=0,af=0,ah=ac.length;ah>af;af++){var ag=ac[af];if("number"!=typeof ag){if(!Array.isArray(ag)){throw fe("_sum")}aa="number"==typeof aa?[aa]:aa;for(var ab=0,ad=ag.length;ad>ab;ab++){var t=ag[ab];if("number"!=typeof t){throw fe("_sum")}"undefined"==typeof aa[ab]?aa.push(t):aa[ab]+=t}}else{"number"==typeof aa?aa+=ag:aa[0]+=ag}}return aa}function h(ac,t,aa,ad){var ab=t[ac];"undefined"!=typeof ab&&(ad&&(ab=encodeURIComponent(JSON.stringify(ab))),aa.push(ac+"="+ab))}function F(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function s(t){return t.group_level=F(t.group_level),t.limit=F(t.limit),t.skip=F(t.skip),t}function a1(t){if(t){if("number"!=typeof t){return new fY('Invalid value for integer: "'+t+'"')}if(0>t){return new fY('Invalid value for positive integer: "'+t+'"')}}}function k(t,ab){var ac=t.descending?"endkey":"startkey",aa=t.descending?"startkey":"endkey";if("undefined"!=typeof t[ac]&&"undefined"!=typeof t[aa]&&h5.collate(t[ac],t[aa])>0){throw new fY("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ab.reduce&&t.reduce!==!1){if(t.include_docs){throw new fY("{include_docs:true} is invalid for reduce")}if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level){throw new fY("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=a1(t[af]);if(ad){throw ad}})}function M(ad,aa,ag){var aj,af=[],ac="GET";if(h("reduce",ag,af),h("include_docs",ag,af),h("attachments",ag,af),h("limit",ag,af),h("descending",ag,af),h("group",ag,af),h("group_level",ag,af),h("skip",ag,af),h("stale",ag,af),h("conflicts",ag,af),h("startkey",ag,af,!0),h("start_key",ag,af,!0),h("endkey",ag,af,!0),h("end_key",ag,af,!0),h("inclusive_end",ag,af),h("key",ag,af,!0),af=af.join("&"),af=""===af?"":"?"+af,"undefined"!=typeof ag.keys){var t=2000,ah="keys="+encodeURIComponent(JSON.stringify(ag.keys));ah.length+af.length+1<=t?af+=("?"===af[0]?"&":"?")+ah:(ac="POST","string"==typeof aa?aj={keys:ag.keys}:aa.keys=ag.keys)}if("string"==typeof aa){var ab=j(aa);return ad.request({method:ac,url:"_design/"+ab[0]+"/_view/"+ab[1]+af,body:aj}).then(ae(ag))}return aj=aj||{},Object.keys(aa).forEach(function(ak){Array.isArray(aa[ak])?aj[ak]=aa[ak]:aj[ak]=aa[ak].toString()}),ad.request({method:"POST",url:"_temp_view"+af,body:aj}).then(ae(ag))}function fj(t,aa,ab){return new hK(function(ad,ac){t._query(aa,ab,function(af,ag){return af?ac(af):void ad(ag)})})}function Q(t){return new hK(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function n(t){return function(aa){if(404===aa.status){return t}throw aa}}function br(ak,af,al){function ac(){return iQ(ab)?hK.resolve(ag):af.db.get(aj)["catch"](n(ag))}function ad(am){return am.keys.length?af.db.allDocs({keys:am.keys,include_docs:!0}):hK.resolve({rows:[]})}function aa(ax,au){for(var am=[],ap={},aA=0,az=au.rows.length;az>aA;aA++){var aw=au.rows[aA],aq=aw.doc;if(aq&&(am.push(aq),ap[aq._id]=!0,aq._deleted=!t[aq._id],!aq._deleted)){var av=t[aq._id];"value" in av&&(aq.value=av.value)}}var ay=Object.keys(t);return ay.forEach(function(aD){if(!ap[aD]){var aB={_id:aD},aC=t[aD];"value" in aC&&(aB.value=aC.value),am.push(aB)}}),ax.keys=hp(ay.concat(ax.keys)),am.push(ax),am}var aj="_local/doc_"+ak,ag={_id:aj,keys:[]},ah=al[ak],t=ah.indexableKeysToKeyValues,ab=ah.changes;return ac().then(function(am){return ad(am).then(function(ap){return aa(am,ap)})})}function A(t,ab,ac){var aa="_local/lastSeq";return t.db.get(aa)["catch"](n({_id:aa,seq:0})).then(function(af){var ad=Object.keys(ab);return hK.all(ad.map(function(ag){return br(ag,t,ab)})).then(function(ah){var ag=fa(ah);return af.seq=ac,ag.push(af),t.db.bulkDocs({docs:ag})})})}function es(t){var aa="string"==typeof t?t:t.name,ab=hP[aa];return ab||(ab=hP[aa]=new v),ab}function X(t){return jr(es(t),function(){return fb(t)})()}function fb(ad){function aa(am,ak){var al={id:af._id,key:h5.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=h5.normalizeKey(ak)),aj.push(al)}function ag(ak,al){return function(){return A(ad,ak,al)}}var aj,af,ac;if("function"==typeof ad.mapFun&&2===ad.mapFun.length){var t=ad.mapFun;ac=function(ak){return t(ak,aa)}}else{ac=ey(ad.mapFun.toString(),aa,W,jb,Array.isArray,JSON.parse)}var ah=ad.seq||0,ab=new v;return new hK(function(ap,ak){function al(){ab.finish().then(function(){ad.seq=ah,ap()})}function am(){function aq(au){ak(au)}ad.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ah,limit:hh}).on("complete",function(av){var aA=av.results;if(!aA.length){return al()}for(var au={},aD=0,aF=aA.length;aF>aD;aD++){var ax=aA[aD];if("_"!==ax.doc._id[0]){aj=[],af=ax.doc,af._deleted||iE(ad.sourceDB,ac,[af]),aj.sort(g8);for(var ay,aC={},az=0,aG=aj.length;aG>az;az++){var aE=aj[az],aB=[aE.key,aE.id];0===h5.collate(aE.key,ay)&&aB.push(az);var aw=h5.toIndexableString(aB);aC[aw]=aE,ay=aE.key}au[ax.doc._id]={indexableKeysToKeyValues:aC,changes:ax.changes}}ah=ax.seq}return ab.add(ag(au,ah)),aA.length<hh?al():am()}).on("error",aq)}am()})}function fr(ak,af,al){0===al.group_level&&delete al.group_level;var ac,ad=al.group||al.group_level;ac=jp[ak.reduceFun]?jp[ak.reduceFun]:ey(ak.reduceFun.toString(),null,W,jb,Array.isArray,JSON.parse);var aa=[],aj=isNaN(al.group_level)?Number.POSITIVE_INFINITY:al.group_level;af.forEach(function(aq){var am=aa[aa.length-1],ap=ad?aq.key:null;return ad&&Array.isArray(ap)&&(ap=ap.slice(0,aj)),am&&0===h5.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void aa.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),af=[];for(var ag=0,ah=aa.length;ah>ag;ag++){var t=aa[ag],ab=iE(ak.sourceDB,ac,[t.keys,t.values,!1]);if(ab.error&&ab.error instanceof N){throw ab.error}af.push({value:ab.error?null:ab.output,key:t.groupKey})}return{rows:gG(af,al.limit,al.skip)}}function at(aa,t){return jr(es(aa),function(){return x(aa,t)})()}function x(t,ag){function ac(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ad=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=h5.parseIndexableString(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function af(au){var av;if(av=aa?fr(t,au,ag):{total_rows:ad,offset:aj,rows:au},ag.include_docs){var aq=hp(au.map(gJ));return t.sourceDB.allDocs({keys:aq,include_docs:!0,conflicts:ag.conflicts,attachments:ag.attachments,binary:ag.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),au.forEach(function(ay){var aA=gJ(ay),az=aw["$"+aA];az&&(ay.doc=az)}),av})}return av}var ad,aa=t.reduceFun&&ag.reduce!==!1,aj=ag.skip||0;if("undefined"==typeof ag.keys||ag.keys.length||(ag.limit=0,delete ag.keys),"undefined"!=typeof ag.keys){var ap=ag.keys,ah=ap.map(function(au){var aq={startkey:h5.toIndexableString([au]),endkey:h5.toIndexableString([au,{}])};return ac(aq)});return hK.all(ah).then(fa).then(af)}var ak={descending:ag.descending};if(ag.start_key&&(ag.startkey=ag.start_key),ag.end_key&&(ag.endkey=ag.end_key),"undefined"!=typeof ag.startkey&&(ak.startkey=ag.descending?h5.toIndexableString([ag.startkey,{}]):h5.toIndexableString([ag.startkey])),"undefined"!=typeof ag.endkey){var am=ag.inclusive_end!==!1;ag.descending&&(am=!am),ak.endkey=h5.toIndexableString(am?[ag.endkey,{}]:[ag.endkey])}if("undefined"!=typeof ag.key){var ab=h5.toIndexableString([ag.key]),al=h5.toIndexableString([ag.key,{}]);ak.descending?(ak.endkey=ab,ak.startkey=al):(ak.startkey=ab,ak.endkey=al)}return aa||("number"==typeof ag.limit&&(ak.limit=ag.limit),ak.skip=aj),ac(ak).then(af)}function i(t){return t.request({method:"POST",url:"_view_cleanup"})}function a5(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ah){var af=j(ah),ad="_design/"+af[0],ag=af[1];aa[ad]=aa[ad]||{},aa[ad][ag]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ah){var ag={};ah.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ag[au]=ag[au]||am})})});var ad=Object.keys(ag).filter(function(aj){return !ag[aj]}),af=ad.map(function(aj){return jr(es(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return hK.all(af).then(function(){return{ok:!0}})})},n({ok:!0}))}function be(ag,t,ac){if("http"===ag.type()){return M(ag,t,ac)}if("function"==typeof ag._query){return fj(ag,t,ac)}if("string"!=typeof t){k(ac,t);var af={db:ag,viewName:"temp_view/temp_view",map:t.map,reduce:t.reduce,temporary:!0};return en.add(function(){return iN(af).then(function(ak){function aj(){return ak.db.destroy()}return p(X(ak).then(function(){return at(ak,ac)}),aj)})}),en.finish()}var aa=t,ad=j(aa),ah=ad[0],ab=ad[1];return ag.get("_design/"+ah).then(function(al){var ak=al.views&&al.views[ab];if(!ak||"string"!=typeof ak.map){throw new iZ("ddoc "+ah+" has no view named "+ab)}k(ac,ak);var aj={db:ag,viewName:aa,map:ak.map,reduce:ak.reduce};return iN(aj).then(function(am){return"ok"===ac.stale||"update_after"===ac.stale?("update_after"===ac.stale&&g9.nextTick(function(){X(am)}),at(am,ac)):X(am).then(function(){return at(am,ac)})})})}function fY(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,fY)}catch(t){}}function iZ(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,iZ)}catch(t){}}function N(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,N)}catch(t){}}function iA(t){return/^1-/.test(t)}function ai(t,aa,ab){return !t._attachments||!t._attachments[ab]||t._attachments[ab].digest!==aa._attachments[ab].digest}function h4(t,aa){var ab=Object.keys(aa._attachments);return hK.all(ab.map(function(ac){return t.getAttachment(aa._id,ac,{rev:aa._rev})}))}function gb(ac,t,aa){var ad="http"===t.type()&&"http"!==ac.type(),ab=Object.keys(aa._attachments);return ad?ac.get(aa._id).then(function(af){return hK.all(ab.map(function(ag){return ai(af,aa,ag)?t.getAttachment(aa._id,ag):ac.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return h4(t,aa)}):h4(t,aa)}function gm(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0}}function ho(al,ag,aa,ad){function ac(){var am=gm(aa);if(am.docs.length){return al.bulkGet(am).then(function(ap){if(ad.cancelled){throw new Error("cancelled")}return hK.all(ap.results.map(function(aq){return hK.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(ab=!1),av&&av._attachments?gb(ag,al,av).then(function(ax){var aw=Object.keys(av._attachments);return ax.forEach(function(az,aA){var ay=av._attachments[aw[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){t=t.concat(fa(aq).filter(Boolean))})})}}function ak(am){return am._attachments&&Object.keys(am._attachments).length>0}function aj(am){return al.allDocs({keys:am,include_docs:!0}).then(function(ap){if(ad.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&iA(aq.value.rev)&&!ak(aq.doc)&&(t.push(aq.doc),delete aa[aq.id])})})}function af(){var am=Object.keys(aa).filter(function(aq){var ap=aa[aq].missing;return 1===ap.length&&iA(ap[0])});return am.length>0?aj(am):void 0}function ah(){return{ok:ab,docs:t}}aa=gl(aa);var t=[],ab=!0;return hK.resolve().then(af).then(ac).then(ah)}function cr(ac,t,aa,ad,ab){return ac.get(t)["catch"](function(af){if(404===af.status){return"http"===ac.type()&&hs(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ad,_id:t,history:[],replicator:gU,version:h9}}throw af}).then(function(af){return ab.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ad}),af.history.unshift({last_seq:aa,session_id:ad}),af.history=af.history.slice(0,fk),af.version=h9,af.replicator=gU,af.session_id=ad,af.last_seq=aa,ac.put(af)["catch"](function(ag){if(409===ag.status){return cr(ac,t,aa,ad,ab)}throw ag}))})}function i7(t,ab,ac,aa){this.src=t,this.target=ab,this.id=ac,this.returnValue=aa}function hI(aa,t){return aa.session_id===t.session_id?{last_seq:aa.last_seq,history:aa.history}:G(aa.history,t.history)}function G(ac,aa){var af=ac[0],ah=ac.slice(1),ag=aa[0],ab=aa.slice(1);if(!af||0===aa.length){return{last_seq:jj,history:[]}}var ad=af.session_id;if(gR(ad,aa)){return{last_seq:af.last_seq,history:ac}}var t=ag.session_id;return gR(t,ah)?{last_seq:ag.last_seq,history:ab}:G(ah,ab)}function gR(t,ab){var ac=ab[0],aa=ab.slice(1);return t&&0!==ab.length?t===ac.session_id?!0:gR(t,aa):!1}function fs(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function gD(t,ab,ac,aa){return t.retry===!1?(ab.emit("error",ac),void ab.removeAllListeners()):("function"!=typeof t.back_off_function&&(t.back_off_function=iC),ab.emit("requestError",ac),"active"!==ab.state&&"pending"!==ab.state||(ab.emit("paused",ac),ab.state="stopped",ab.once("active",function(){t.current_back_off=ia})),t.current_back_off=t.current_back_off||ia,t.current_back_off=t.back_off_function(t.current_back_off),void setTimeout(aa,t.current_back_off))}function gg(t){return Object.keys(t).sort(h5.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function iF(ab,ad,ag){var ac=ag.doc_ids?ag.doc_ids.sort(h5.collate):"",aa=ag.filter?ag.filter.toString():"",t="",af="";return ag.filter&&ag.query_params&&(t=JSON.stringify(gg(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),hK.all([ab.id(),ad.id()]).then(function(ah){var aj=ah[0]+ah[1]+aa+af+t+ac;return new hK(function(ak){Y(aj,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function gP(ak,aR,aF,aK,aG){function az(){return aq?hK.resolve():iF(ak,aR,aF).then(function(aS){ab=aS,aq=new i7(ak,aR,ab,aK)})}function aL(){if(aN=[],0!==am.docs.length){var aS=am.docs;return aR.bulkDocs({docs:aS,new_edits:!1}).then(function(aX){if(aK.cancelled){throw aH(),new Error("cancelled")}var aV=[],aT={};aX.forEach(function(aY){aY.error&&(aG.doc_write_failures++,aV.push(aY),aT[aY.id]=aY)}),al=al.concat(aV),aG.docs_written+=am.docs.length-aV.length;var aU=aV.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aT[aZ._id];aY?aK.emit("denied",gl(aY)):aN.push(aZ)}),aU.length>0){var aW=new Error("bulkDocs error");throw aW.other_errors=aV,ay("target.bulkDocs failed to write docs",aW),new Error("bulkWrite partial failure")}},function(aT){throw aG.doc_write_failures+=aS.length,aT})}}function aQ(){if(am.error){throw new Error("There was a problem getting docs.")}aG.last_seq=aA=am.seq;var aS=gl(aG);return aN.length&&(aS.docs=aN,aK.emit("change",aS)),aw=!0,aq.writeCheckpoint(am.seq,aj).then(function(){if(aw=!1,aK.cancelled){throw aH(),new Error("cancelled")}am=void 0,aD()})["catch"](aa)}function ag(){var aS={};return am.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aR.revsDiff(aS).then(function(aT){if(aK.cancelled){throw aH(),new Error("cancelled")}am.diffs=aT})}function au(){return ho(ak,aR,am.diffs,aK).then(function(aS){am.error=!aS.ok,aS.docs.forEach(function(aT){delete am.diffs[aT._id],aG.docs_read++,am.docs.push(aT)})})}function aC(){if(!aK.cancelled&&!am){if(0===aB.length){return void ad(!0)}am=aB.shift(),ag().then(au).then(aL).then(aQ).then(aC)["catch"](function(aS){ay("batch processing terminated with error",aS)})}}function ad(aS){return 0===aI.changes.length?void (0!==aB.length||am||((aO&&aE.live||aM)&&(aK.state="pending",aK.emit("paused")),aM&&aH())):void ((aS||aM||aI.changes.length>=af)&&(aB.push(aI),aI={seq:0,changes:[],docs:[]},"pending"!==aK.state&&"stopped"!==aK.state||(aK.state="active",aK.emit("active")),aC()))}function ay(aT,aS){av||(aS.message||(aS.message=aT),aG.ok=!1,aG.status="aborting",aG.errors.push(aS),al=al.concat(aS),aB=[],aI={seq:0,changes:[],docs:[]},aH())}function aH(){if(!(av||aK.cancelled&&(aG.status="cancelled",aw))){aG.status=aG.status||"complete",aG.end_time=new Date,aG.last_seq=aA,av=!0;var aT=al.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=al.pop();al.length>0&&(aS.other_errors=al),aS.result=aG,gD(aF,aK,aS,function(){gP(ak,aR,aF,aK)})}else{aG.errors=al,aK.emit("complete",aG),aK.removeAllListeners()}}}function ah(aT){if(aK.cancelled){return aH()}var aS=hn(aF)(aT);aS&&(aI.seq=aT.seq,aI.changes.push(aT),ad(0===aB.length&&aE.live))}function t(aT){if(aP=!1,aK.cancelled){return aH()}if(aT.results.length>0){aE.since=aT.last_seq,aD(),ad(!0)}else{var aS=function(){aO?(aE.live=!0,aD()):aM=!0,ad(!0)};am||0!==aT.results.length?aS():(aw=!0,aq.writeCheckpoint(aT.last_seq,aj).then(function(){aw=!1,aG.last_seq=aA=aT.last_seq,aS()})["catch"](aa))}}function aJ(aS){return aP=!1,aK.cancelled?aH():void ay("changes rejected",aS)}function aD(){function aS(){aT.cancel()}function aU(){aK.removeListener("cancel",aS)}if(!aP&&!aM&&aB.length<ac){aP=!0,aK._changes&&(aK.removeListener("cancel",aK._abortChanges),aK._changes.cancel()),aK.once("cancel",aS);var aT=ak.changes(aE).on("change",ah);aT.then(aU,aU),aT.then(t)["catch"](aJ),aF.retry&&(aK._changes=aT,aK._abortChanges=aS)}}function ax(){az().then(function(){return aK.cancelled?void aH():aq.getCheckpoint().then(function(aS){aA=aS,aE={since:aA,limit:af,batch_size:af,style:"all_docs",doc_ids:ap,return_docs:!0},aF.filter&&("string"!=typeof aF.filter?aE.include_docs=!0:aE.filter=aF.filter),"heartbeat" in aF&&(aE.heartbeat=aF.heartbeat),"timeout" in aF&&(aE.timeout=aF.timeout),aF.query_params&&(aE.query_params=aF.query_params),aF.view&&(aE.view=aF.view),aD()})})["catch"](function(aS){ay("getCheckpoint rejected with ",aS)})}function aa(aS){throw aw=!1,ay("writeCheckpoint completed with error",aS),aS}var am,ab,aq,aB=[],aI={seq:0,changes:[],docs:[]},aw=!1,aM=!1,av=!1,aA=0,aO=aF.continuous||aF.live||!1,af=aF.batch_size||100,ac=aF.batches_limit||10,aP=!1,ap=aF.doc_ids,al=[],aN=[],aj=gO();aG=aG||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aE={};return aK.ready(ak,aR),aK.cancelled?void aH():(aK._addedListeners||(aK.once("cancel",aH),"function"==typeof aF.complete&&(aK.once("error",aF.complete),aK.once("complete",function(aS){aF.complete(null,aS)})),aK._addedListeners=!0),void ("undefined"==typeof aF.since?ax():az().then(function(){return aw=!0,aq.writeCheckpoint(aF.since,aj)}).then(function(){return aw=!1,aK.cancelled?void aH():(aA=aF.since,void ax())})["catch"](aa)))}function he(){je.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new hK(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function gw(t,aa){var ab=aa.PouchConstructor;return"string"==typeof t?new ab(t,aa):t}function iq(ab,ad,ag,ac){if("function"==typeof ag&&(ac=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw iu(gB,"`doc_ids` filter parameter is not a list.")}ag.complete=ac,ag=gl(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var aa=new he(ag),t=gw(ab,ag),af=gw(ad,ag);return gP(t,af,ag,aa),aa}function gp(t,ab,ac,aa){return"function"==typeof ac&&(aa=ac,ac={}),"undefined"==typeof ac&&(ac={}),ac=gl(ac),ac.PouchConstructor=ac.PouchConstructor||this,t=gw(t,ac),ab=gw(ab,ac),new hw(t,ab,ac,aa)}function hw(t,ah,ag,ap){function aj(ay){ab.emit("change",{direction:"pull",change:ay})}function ac(ay){ab.emit("change",{direction:"push",change:ay})}function ak(ay){ab.emit("denied",{direction:"push",doc:ay})}function af(ay){ab.emit("denied",{direction:"pull",doc:ay})}function av(){ab.pushPaused=!0,ab.pullPaused&&ab.emit("paused")}function am(){ab.pullPaused=!0,ab.pushPaused&&ab.emit("paused")}function aa(){ab.pushPaused=!1,ab.pullPaused&&ab.emit("active",{direction:"push"})}function ad(){ab.pullPaused=!1,ab.pushPaused&&ab.emit("active",{direction:"pull"})}function aq(ay){return function(aC,az){var aE="change"===aC&&(az===aj||az===ac),aA="denied"===aC&&(az===af||az===ak),aD="paused"===aC&&(az===am||az===av),aB="active"===aC&&(az===ad||az===aa);(aE||aA||aD||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ab.removeAllListeners(aC))}}var ab=this;this.canceled=!1;var al=ag.push?gc.extend({},ag,ag.push):ag,aw=ag.pull?gc.extend({},ag,ag.pull):ag;this.push=iq(t,ah,al),this.pull=iq(ah,t,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ag.live&&(this.push.on("complete",ab.pull.cancel.bind(ab.pull)),this.pull.on("complete",ab.push.cancel.bind(ab.push))),this.on("newListener",function(ay){"change"===ay?(ab.pull.on("change",aj),ab.push.on("change",ac)):"denied"===ay?(ab.pull.on("denied",af),ab.push.on("denied",ak)):"active"===ay?(ab.pull.on("active",ad),ab.push.on("active",aa)):"paused"===ay&&(ab.pull.on("paused",am),ab.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ab.pull.removeListener("change",aj),ab.push.removeListener("change",ac)):"denied"===ay?(ab.pull.removeListener("denied",af),ab.push.removeListener("denied",ak)):"active"===ay?(ab.pull.removeListener("active",ad),ab.push.removeListener("active",aa)):"paused"===ay&&(ab.pull.removeListener("paused",am),ab.push.removeListener("paused",av))}),this.pull.on("removeListener",aq("pull")),this.push.on("removeListener",aq("push"));var au=hK.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ab.emit("complete",az),ap&&ap(null,az),ab.removeAllListeners(),az},function(ay){if(ab.cancel(),ap?ap(ay):ab.emit("error",ay),ab.removeAllListeners(),ap){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function hg(t){t.replicate=iq,t.sync=gp}var de,gc=e(9),hS=er(e(5)),gN=er(e(8)),ij=er(e(10)),hi=e(14),g1=er(e(4)),je=e(1),hO=er(e(15)),hc=er(e(16)),jC=er(e(17)),h5=e(12),hK="function"==typeof Promise?Promise:ij,fz=Function.prototype.toString,gi=fz.call(Object),hx=hS("pouchdb:api"),i5=6;if(iv()){de=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),de=!!localStorage.getItem("_pouch_check_localstorage")}catch(jm){de=!1}}gN(ge,je.EventEmitter),ge.prototype.addListener=function(ab,ad,ag,ac){function aa(){function ah(){af=!1}if(t._listeners[ad]){if(af){return void (af="waiting")}af=!0;var aj=co(ac,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>ac.since&&!ac.cancelled&&(ac.since=ak.seq,ac.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){aa()},0),af=!1}).on("error",ah)}}if(!this._listeners[ad]){var t=this,af=!1;this._listeners[ad]=aa,this.on(ab,aa)}},ge.prototype.removeListener=function(aa,t){t in this._listeners&&je.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},ge.prototype.notifyLocalWindows=function(t){iv()?chrome.storage.local.set({dbName:t}):ga()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},ge.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},gN(gh,Error),gh.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var fV=new gh({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),ju=new gh({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),i8=new gh({status:404,error:"not_found",reason:"missing"}),ik=new gh({status:409,error:"conflict",reason:"Document update conflict"}),io=new gh({status:400,error:"invalid_id",reason:"_id field must contain a string"}),g3=new gh({status:412,error:"missing_id",reason:"_id is required for puts"}),m=new gh({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),hy=new gh({status:412,error:"precondition_failed",reason:"Database not open"}),gx=new gh({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),fn=new gh({status:500,error:"badarg",reason:"Some query argument is invalid"}),ew=new gh({status:400,error:"invalid_request",reason:"Request was invalid"}),gW=new gh({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),ez=new gh({status:500,error:"doc_validation",reason:"Bad special document member"}),gB=new gh({status:400,error:"bad_request",reason:"Something wrong with the request"}),hl=new gh({status:400,error:"bad_request",reason:"Document must be a JSON object"}),hG=new gh({status:404,error:"not_found",reason:"Database not found"}),h7=new gh({status:500,error:"indexed_db_went_bad",reason:"unknown"}),hM=new gh({status:500,error:"web_sql_went_bad",reason:"unknown"}),gL=new gh({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),fX=new gh({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),iX=new gh({status:400,error:"bad_request",reason:"Invalid rev format"}),gT=new gh({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),ht=new gh({status:412,error:"missing_stub"}),fo=new gh({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),hY=[fV,ju,i8,ik,io,g3,m,hy,gx,fn,ew,gW,ez,gB,hl,hG,hM,gL,fX,iX,gT,ht,h7,fo],h3=function(t,ab,ac){var aa=hY.filter(function(ad){return ad[t]===ab});return ac&&aa.filter(function(ad){return ad.message===ac})[0]||aa[0]},dn=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],D="queryKey",u=/(?:^|&)([^&=]*)=?([^&]*)/g,et=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,q="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");gN(fu,je.EventEmitter),fu.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},fu.prototype.doChanges=function(ac){var t=this,aa=ac.complete;if(ac=gl(ac),"live" in ac&&!("continuous" in ac)&&(ac.continuous=ac.live),ac.processChange=fg,"latest"===ac.since&&(ac.since="now"),ac.since||(ac.since=0),"now"===ac.since){return void this.db.info().then(function(af){return t.isCancelled?void aa(null,{status:"cancelled"}):(ac.since=af.update_seq,void t.doChanges(ac))},aa)}if(ac.continuous&&"now"!==ac.since&&this.db.info().then(function(af){t.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ac.view&&!ac.filter&&(ac.filter="_view"),ac.filter&&"string"==typeof ac.filter&&("_view"===ac.filter?ac.view=fh(ac.view):ac.filter=fh(ac.filter),"http"!==this.db.type()&&!ac.doc_ids)){return this.filterChanges(ac)}"descending" in ac||(ac.descending=!1),ac.limit=0===ac.limit?1:ac.limit,ac.complete=aa;var ad=this.db._changes(ac);if(ad&&"function"==typeof ad.cancel){var ab=t.cancel;t.cancel=g1(function(af){ad.cancel(),ab.apply(this,af)})}},fu.prototype.filterChanges=function(ac){var t=this,aa=ac.complete;if("_view"===ac.filter){if(!ac.view||"string"!=typeof ac.view){var ad=iu(gB,"`view` filter parameter not found or invalid.");return aa(ad)}var ab=iS(ac.view);this.db.get("_design/"+ab[0],function(aj,ag){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(aj){return aa(jt(aj))}var ah=ag&&ag.views&&ag.views[ab[1]]&&ag.views[ab[1]].map;return ah?(ac.filter=w(ah),void t.doChanges(ac)):aa(iu(i8,ag.views?"missing json key: "+ab[1]:"missing json key: views"))})}else{var af=iS(ac.filter);if(!af){return t.doChanges(ac)}this.db.get("_design/"+af[0],function(ah,ag){if(t.isCancelled){return aa(null,{status:"cancelled"})}if(ah){return aa(jt(ah))}var aj=ag&&ag.filters&&ag.filters[af[1]];return aj?(ac.filter=hU(aj),void t.doChanges(ac)):aa(iu(i8,ag&&ag.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},gN(gM,je.EventEmitter),gM.prototype.post=fZ("post",function(t,aa,ab){return"function"==typeof aa&&(ab=aa,aa={}),"object"!=typeof t||Array.isArray(t)?ab(iu(hl)):void this.bulkDocs({docs:[t]},aa,iD(ab))}),gM.prototype.put=fZ("put",g1(function(ad){function aa(){t||(go("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),t=!0)}var ag,aj,af,ac,t=!1,ah=ad.shift(),ab="_id" in ah;if("object"!=typeof ah||Array.isArray(ah)){return(ac=ad.pop())(iu(hl))}for(;;){if(ag=ad.shift(),aj=typeof ag,"string"!==aj||ab?"string"!==aj||!ab||"_rev" in ah?"object"===aj?af=ag:"function"===aj&&(ac=ag):(aa(),ah._rev=ag):(aa(),ah._id=ag,ab=!0),!ad.length){break}}return af=af||{},ii(ah._id),gz(ah._id)&&"function"==typeof this._putLocal?ah._deleted?this._removeLocal(ah,ac):this._putLocal(ah,ac):void this.bulkDocs({docs:[ah]},af,iD(ac))})),gM.prototype.putAttachment=fZ("putAttachment",function(ab,ad,ag,ac,aa){function t(aj){var ah="_rev" in aj?parseInt(aj._rev,10):0;return aj._attachments=aj._attachments||{},aj._attachments[ad]={content_type:aa,data:ac,revpos:++ah},af.put(aj)}var af=this;return"function"==typeof aa&&(aa=ac,ac=ag,ag=null),"undefined"==typeof aa&&(aa=ac,ac=ag,ag=null),af.get(ab).then(function(ah){if(ah._rev!==ag){throw iu(ik)}return t(ah)},function(ah){if(ah.reason===i8.message){return t({_id:ab})}throw ah})}),gM.prototype.removeAttachment=fZ("removeAttachment",function(ac,t,aa,ad){var ab=this;ab.get(ac,function(af,ag){return af?void ad(af):ag._rev!==aa?void ad(iu(ik)):ag._attachments?(delete ag._attachments[t],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ab.put(ag,ad)):ad()})}),gM.prototype.remove=fZ("remove",function(ac,t,aa,ad){var ab;"string"==typeof t?(ab={_id:ac,_rev:t},"function"==typeof aa&&(ad=aa,aa={})):(ab=ac,"function"==typeof t?(ad=t,aa={}):(ad=aa,aa=t)),aa=aa||{},aa.was_delete=!0;var af={_id:ab._id,_rev:ab._rev||aa.rev};return af._deleted=!0,gz(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ab,ad):void this.bulkDocs({docs:[af]},aa,iD(ad))}),gM.prototype.revsDiff=fZ("revsDiff",function(ac,aa,af){function ah(ak,aj){t.has(ak)||t.set(ak,{missing:[]}),t.get(ak).missing.push(aj)}function ag(aj,ak){var al=ac[aj].slice(0);di(ak,function(av,aw,am,aq,ap){var au=aw+"-"+am,ax=al.indexOf(au);-1!==ax&&(al.splice(ax,1),"available"!==ap.status&&ah(aj,au))}),al.forEach(function(am){ah(aj,am)})}"function"==typeof aa&&(af=aa,aa={});var ab=Object.keys(ac);if(!ab.length){return af(null,{})}var ad=0,t=new hi.Map;ab.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){t.set(aj,{missing:ac[aj]})}else{if(al){return af(al)}ag(aj,am)}if(++ad===ab.length){var ak={};return t.forEach(function(ap,aq){ak[aq]=ap}),af(null,ak)}})},this)}),gM.prototype.bulkGet=fZ("bulkGet",function(aa,t){gf(this,aa,t)}),gM.prototype.compactDocument=fZ("compactDocument",function(t,ab,ac){var aa=this;this._getRevisionTree(t,function(aj,af){if(aj){return ac(aj)}var ah=g6(af),ad=[],ag=[];Object.keys(ah).forEach(function(ak){ah[ak]>ab&&ad.push(ak)}),di(af,function(ap,au,al,aq,am){var ak=au+"-"+al;"available"===am.status&&-1!==ad.indexOf(ak)&&ag.push(ak)}),aa._doCompaction(t,ag,ac)})}),gM.prototype.compact=fZ("compact",function(t,aa){"function"==typeof t&&(aa=t,t={});var ab=this;t=t||{},ab._compactionQueue=ab._compactionQueue||[],ab._compactionQueue.push({opts:t,callback:aa}),1===ab._compactionQueue.length&&ct(ab)}),gM.prototype._compact=function(ab,ad){function ag(ah){af.push(aa.compactDocument(ah.id,0))}function ac(aj){var ah=aj.last_seq;hK.all(af).then(function(){return O(aa,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){ad(null,{ok:!0})})["catch"](ad)}var aa=this,t={return_docs:!1,last_seq:ab.last_seq||0},af=[];aa.changes(t).on("change",ag).on("complete",ac).on("error",ad)},gM.prototype.get=fZ("get",function(ac,aa,af){function ah(){var ak=[],aj=ag.length;return aj?void ag.forEach(function(al){ab.get(ac,{rev:al,revs:aa.revs,attachments:aa.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||af(null,ak)})}):af(null,ak)}if("function"==typeof aa&&(af=aa,aa={}),"string"!=typeof ac){return af(iu(io))}if(gz(ac)&&"function"==typeof this._getLocal){return this._getLocal(ac,af)}var ag=[],ab=this;if(!aa.open_revs){return this._get(ac,aa,function(az,aB){if(az){return af(az)}var aq=aB.doc,ay=aB.metadata,ap=aB.ctx;if(aa.conflicts){var al=gs(ay);al.length&&(aq._conflicts=al)}if(jg(ay,aq._rev)&&(aq._deleted=!0),aa.revs||aa.revs_info){var au=fS(ay.rev_tree),aj=fq(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(aq._rev.split("-")[1])}),aA=aj.ids.map(function(aC){return aC.id}).indexOf(aq._rev.split("-")[1])+1,ax=aj.ids.length-aA;if(aj.ids.splice(aA,ax),aj.ids.reverse(),aa.revs&&(aq._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),aa.revs_info){var aw=aj.pos+aj.ids.length;aq._revs_info=aj.ids.map(function(aC){return aw--,{rev:aw+"-"+aC.id,status:aC.opts.status}})}}if(aa.attachments&&aq._attachments){var av=aq._attachments,am=Object.keys(av).length;if(0===am){return af(null,aq)}Object.keys(av).forEach(function(aC){this._getAttachment(aq._id,aC,av[aC],{rev:aq._rev,binary:aa.binary,ctx:ap},function(aE,aD){var aF=aq._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--am||af(null,aq)})},ab)}else{if(aq._attachments){for(var ak in aq._attachments){aq._attachments.hasOwnProperty(ak)&&(aq._attachments[ak].stub=!0)}}af(null,aq)}})}if("all"===aa.open_revs){this._getRevisionTree(ac,function(ak,aj){return ak?af(ak):(ag=g0(aj).map(function(al){return al.rev}),void ah())})}else{if(!Array.isArray(aa.open_revs)){return af(iu(gx,"function_clause"))}ag=aa.open_revs;for(var ad=0;ad<ag.length;ad++){var t=ag[ad];if("string"!=typeof t||!/^\d+-/.test(t)){return af(iu(iX))}}ah()}}),gM.prototype.getAttachment=fZ("getAttachment",function(ac,t,aa,ad){var ab=this;aa instanceof Function&&(ad=aa,aa={}),this._get(ac,aa,function(af,ag){return af?ad(af):ag.doc._attachments&&ag.doc._attachments[t]?(aa.ctx=ag.ctx,aa.binary=!0,ab._getAttachment(ac,t,ag.doc._attachments[t],aa,ad),void 0):ad(iu(i8))})}),gM.prototype.allDocs=fZ("allDocs",function(t,aa){if("function"==typeof t&&(aa=t,t={}),t.skip="undefined"!=typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys" in t){if(!Array.isArray(t.keys)){return aa(new TypeError("options.keys must be an array"))}var ab=["startkey","endkey","key"].filter(function(ac){return ac in t})[0];if(ab){return void aa(iu(gW,"Query parameter `"+ab+"` is not compatible with multi-get"))}if("http"!==this.type()){return im(this,t,aa)}}return this._allDocs(t,aa)}),gM.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new fu(this,aa,t)},gM.prototype.close=fZ("close",function(t){return this._closed=!0,this._close(t)}),gM.prototype.info=fZ("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),gM.prototype.id=fZ("id",function(t){return this._id(t)}),gM.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},gM.prototype.bulkDocs=fZ("bulkDocs",function(ac,t,aa){if("function"==typeof t&&(aa=t,t={}),t=t||{},Array.isArray(ac)&&(ac={docs:ac}),!ac||!ac.docs||!Array.isArray(ac.docs)){return aa(iu(ju))}for(var ad=0;ad<ac.docs.length;++ad){if("object"!=typeof ac.docs[ad]||Array.isArray(ac.docs[ad])){return aa(iu(hl))}}var ab;return ac.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ab=ab||gE(ag)})}),ab?aa(iu(gB,ab)):("new_edits" in t||("new_edits" in ac?t.new_edits=ac.new_edits:t.new_edits=!0),t.new_edits||"http"===this.type()||ac.docs.sort(gA),E(ac.docs),this._bulkDocs(ac,t,function(af,ag){return af?aa(af):(t.new_edits||(ag=ag.filter(function(ah){return ah.error})),void aa(null,ag))}))}),gM.prototype.registerDependentDatabase=fZ("registerDependentDatabase",function(t,ab){function ac(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[t]?!1:(ad.dependentDbs[t]=!0,ad)}var aa=new this.constructor(t,this.__opts);O(this,"_local/_pouch_dependentDbs",ac).then(function(){ab(null,{db:aa})})["catch"](ab)}),gM.prototype.destroy=fZ("destroy",function(ac,t){function aa(){ad._destroy(ac,function(ag,af){return ag?t(ag):(ad._destroyed=!0,ad.emit("destroyed"),void t(null,af||{ok:!0}))})}"function"==typeof ac&&(t=ac,ac={});var ad=this,ab="use_prefix" in ad?ad.use_prefix:!0;return"http"===ad.type()?aa():void ad.get("_local/_pouch_dependentDbs",function(aj,af){if(aj){return 404!==aj.status?t(aj):aa()}var ah=af.dependentDbs,ak=ad.constructor,ag=Object.keys(ah).map(function(al){var am=ab?al.replace(new RegExp("^"+ak.prefix),""):al;return new ak(am,ad.__opts).destroy()});hK.all(ag).then(aa,t)})}),ih.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},ih.prototype.fail=function(t){this.failed=t,this.execute()},ih.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},ih.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},gN(i3,gM),i3.debug=hS,i3.adapters={},i3.preferredAdapters=[],i3.prefix="_pouch_";var iV=new je.EventEmitter;iy(i3),i3.parseAdapter=function(ac,aa){var af,ah,ag=ac.match(/([a-z\-]*):\/\/(.*)/);if(ag){if(ac=/http(s?)/.test(ag[1])?ag[1]+"://"+ag[2]:ag[2],af=ag[1],!i3.adapters[af].valid()){throw"Invalid adapter"}return{name:ac,adapter:ag[1]}}var ab="idb" in i3.adapters&&"websql" in i3.adapters&&ga()&&localStorage["_pouch__websqldb_"+i3.prefix+ac];if(aa.adapter){ah=aa.adapter}else{if("undefined"!=typeof aa&&aa.db){ah="leveldb"}else{for(var ad=0;ad<i3.preferredAdapters.length;++ad){if(ah=i3.preferredAdapters[ad],ah in i3.adapters){if(ab&&"idb"===ah){go("log",'PouchDB is downgrading "'+ac+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}af=i3.adapters[ah];var t=af&&"use_prefix" in af?af.use_prefix:!0;return{name:t?i3.prefix+ac:ac,adapter:ah}},i3.adapter=function(t,aa,ab){aa.valid()&&(i3.adapters[t]=aa,ab&&i3.preferredAdapters.push(t))},i3.plugin=function(t){return"function"==typeof t?t(i3):Object.keys(t).forEach(function(aa){i3.prototype[aa]=t[aa]}),i3},i3.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=gc.extend({},aa,ad),void i3.call(this,ab,ad,ac)):new t(ab,ad,ac)}return gN(t,i3),t.preferredAdapters=i3.preferredAdapters.slice(),Object.keys(i3).forEach(function(ab){ab in t||(t[ab]=i3[ab])}),t};var ei="5.4.4";i3.version=ei;var fm,iB=hA(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gt=hA(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),bt=function(t){return atob(t)},gu=function(t){return btoa(t)},i4=iO.setImmediate||iO.setTimeout,iU=32768,g2=5,h8="document-store",gv="by-sequence",gr="attach-store",iR="attach-seq-store",h6="meta-store",ir="local-store",iw="detect-blob-support",o={running:!1,queue:[]},B=new hi.Map,f=new ge,hJ=new hi.Map;a8.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var T=7,gH=hW("document-store"),i9=hW("by-sequence"),iH=hW("attach-store"),hm=hW("local-store"),il=hW("metadata-store"),gS=hW("attach-seq-store"),U=new hi.Map,ie=new ge,hb=1,a2="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+i9+" (seq, deleted)",J="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+i9+" (doc_id, rev)",gq="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+gH+" (winningseq)",hV="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+gS+" (seq)",iL="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+gS+" (digest, seq)",K=i9+".seq = "+gH+".winningseq",fl=i9+".seq AS seq, "+i9+".deleted AS deleted, "+i9+".json AS data, "+i9+".rev AS rev, "+gH+".json AS metadata";L.valid=eo,L.use_prefix=!0;var iG=ar(),iY=function(){},a6=25,jz=50,ce={},dr=1800,hu=hS("pouchdb:http");r.valid=function(){return !0},v.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},v.prototype.finish=function(){return this.promise};var C=function(aa,t){return t&&aa.then(function(ab){g9.nextTick(function(){t(null,ab)})},function(ab){g9.nextTick(function(){t(ab)})}),aa},ic=function(t){return g1(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&C(ab,aa),ab})},p=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},jr=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},hp=function(ac){for(var t={},aa=0,ad=ac.length;ad>aa;aa++){t["$"+ac[aa]]=!0}var ab=Object.keys(t),af=new Array(ab.length);for(aa=0,ad=ab.length;ad>aa;aa++){af[aa]=ab[aa].substring(1)}return af},hP={},en=new v,hh=50,jb=go.bind(null,"log"),jp={_sum:function(aa,t){return W(t)},_count:function(aa,t){return t.length},_stats:function(t,aa){function ab(af){for(var ah=0,ac=0,ag=af.length;ag>ac;ac++){var ad=af[ac];ah+=ad*ad}return ah}return{sum:W(aa),min:Math.min.apply(null,aa),max:Math.max.apply(null,aa),count:aa.length,sumsqr:ab(aa)}}},gZ=ic(function(){var t=this;return"http"===t.type()?i(t):"function"==typeof t._viewCleanup?Q(t):a5(t)}),iK=function(ac,t,aa){"function"==typeof t&&(aa=t,t={}),t=t?s(t):{},"function"==typeof ac&&(ac={map:ac});var ad=this,ab=hK.resolve().then(function(){return be(ad,ac,t)});return C(ab,aa),ab};gN(fY,Error),gN(iZ,Error),gN(N,Error);var hj={query:iK,viewCleanup:gZ},h9=1,gU="pouchdb",fk=5,jj=0;i7.prototype.writeCheckpoint=function(t,aa){var ab=this;return this.updateTarget(t,aa).then(function(){return ab.updateSource(t,aa)})},i7.prototype.updateTarget=function(aa,t){return cr(this.target,this.id,aa,t,this.returnValue)},i7.prototype.updateSource=function(t,aa){var ab=this;return this.readOnlySource?hK.resolve(!0):cr(this.src,this.id,t,aa,this.returnValue)["catch"](function(ac){if(fs(ac)){return ab.readOnlySource=!0,!0}throw ac})};var hC={undefined:function(aa,t){return 0===h5.collate(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return hI(t,aa).last_seq}};i7.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?hK.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return jj}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hC?hC[ab](aa,ac):jj},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:jj}).then(function(){return jj},function(ac){return fs(ac)?(t.readOnlySource=!0,aa.last_seq):jj})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return jj})};var ia=0;gN(he,je.EventEmitter),he.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},he.prototype.ready=function(ac,t){function aa(){ab.cancel()}function ad(){ac.removeListener("destroyed",aa),t.removeListener("destroyed",aa)}var ab=this;ab._readyCalled||(ab._readyCalled=!0,ac.once("destroyed",aa),t.once("destroyed",aa),ab.once("complete",ad))},gN(hw,je.EventEmitter),hw.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},i3.plugin(ji).plugin(ip).plugin(gF).plugin(hj).plugin(hg),a.exports=i3}).call(this,e(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var f="color: "+this.color;h=[h[0],f,"color: inherit"].concat(Array.prototype.slice.call(h,1));var j=0,g=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(j++,"%c"===l&&(g=j))}),h.splice(g,0,f),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(e,t,n){function r(){return n.colors[f++%n.colors.length]}function o(j){function g(){}function k(){var q=k,m=+new Date,p=m-(b||m);q.diff=p,q.prev=b,q.curr=m,b=m,null==q.useColors&&(q.useColors=n.useColors()),null==q.color&&q.useColors&&(q.color=r());var w=Array.prototype.slice.call(arguments);w[0]=n.coerce(w[0]),"string"!=typeof w[0]&&(w=["%o"].concat(w));var l=0;w[0]=w[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}l++;var x=n.formatters[A];if("function"==typeof x){var z=w[l];y=x.call(q,z),w.splice(l,1),l--}return y}),"function"==typeof n.formatArgs&&(w=n.formatArgs.apply(q,w));var v=k.log||n.log||console.log.bind(console);v.apply(q,w)}g.enabled=!1,k.enabled=!0;var h=n.enabled(j)?k:g;return h.namespace=j,h}function i(k){n.save(k);for(var j=(k||"").split(/[\s,]+/),g=j.length,h=0;g>h;h++){j[h]&&(k=j[h].replace(/\*/g,".*?"),"-"===k[0]?n.skips.push(new RegExp("^"+k.substr(1)+"$")):n.names.push(new RegExp("^"+k+"$")))}}function a(){n.enable("")}function s(g){var j,h;for(j=0,h=n.skips.length;h>j;j++){if(n.skips[j].test(g)){return !1}}for(j=0,h=n.names.length;h>j;j++){if(n.names[j].test(g)){return !0}}return !1}function u(g){return g instanceof Error?g.stack||g.message:g}n=t.exports=o,n.coerce=u,n.disable=a,n.enable=i,n.enabled=s,n.humanize=e(11),n.names=[],n.skips=[],n.formatters={};var b,f=0},{11:11}],7:[function(e,a,b){(function(y){function l(){z=!0;for(var j,g,h=i.length;h;){for(g=i,i=[],j=-1;++j<h;){g[j]()}h=i.length}z=!1}function r(g){1!==i.push(g)||z||o()}var o,f=y.MutationObserver||y.WebKitMutationObserver;if(f){var x=0,s=new f(l),u=y.document.createTextNode("");s.observe(u,{characterData:!0}),o=function(){u.data=x=++x%2}}else{if(y.setImmediate||"undefined"==typeof y.MessageChannel){o="document" in y&&"onreadystatechange" in y.document.createElement("script")?function(){var g=y.document.createElement("script");g.onreadystatechange=function(){l(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},y.document.documentElement.appendChild(g)}:function(){setTimeout(l,0)}}else{var n=new y.MessageChannel;n.port1.onmessage=l,o=function(){n.port2.postMessage(0)}}}var z,i=[];a.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,a,b){"function"==typeof Object.create?a.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(e,a,b){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(m){if(m){for(var n in m){"object"==typeof m[n]&&h[n]?f.call(h,h[n],m[n]):h[n]=m[n]}}}),h};this.extend=f}).call(this)},{}],10:[function(o,u,s){function n(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=h,this.queue=[],this.outcome=void 0,g!==n&&y(this,g)}function a(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function e(j,k,g){i(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function p(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(k,g){function w(A){x||(x=!0,K.reject(k,A))}function q(A){x||(x=!0,K.resolve(k,A))}function j(){g(q,w)}var x=!1,z=l(j);"error"===z.status&&w(z.value)}function l(k,g){var j={};try{j.value=k(g),j.status="success"}catch(q){j.status="error",j.value=q}return j}function r(g){return g instanceof this?g:K.resolve(new this(n),g)}function f(g){var j=new this(n);return K.reject(j,g)}function m(k){function x(E,D){function C(F){B[D]=F,++j!==w||A||(A=!0,K.resolve(g,B))}q.resolve(E).then(C,function(F){A||(A=!0,K.reject(g,F))})}var q=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var w=k.length,A=!1;if(!w){return this.resolve([])}for(var B=new Array(w),j=0,z=-1,g=new this(n);++z<w;){x(k[z],z)}return g}function t(k){function g(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(q,B))},function(B){x||(x=!0,K.reject(q,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(k)){return this.reject(new TypeError("must be an array"))}var j=k.length,x=!1;if(!j){return this.resolve([])}for(var z=-1,q=new this(n);++z<j;){g(k[z])}return q}var i=o(7),K={},L=["REJECTED"],b=["FULFILLED"],h=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(q,g){if("function"!=typeof q&&this.state===b||"function"!=typeof g&&this.state===L){return this}var j=new this.constructor(n);if(this.state!==h){var k=this.state===b?q:g;e(j,k,this.outcome)}else{this.queue.push(new a(j,q,g))}return j},a.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},a.prototype.otherCallFulfilled=function(g){e(this.promise,this.onFulfilled,g)},a.prototype.callRejected=function(g){K.reject(this.promise,g)},a.prototype.otherCallRejected=function(g){e(this.promise,this.onRejected,g)},K.resolve=function(q,w){var j=l(p,w);if("error"===j.status){return K.reject(q,j.value)}var g=j.value;if(g){y(q,g)}else{q.state=b,q.outcome=w;for(var k=-1,x=q.queue.length;++k<x;){q.queue[k].callFulfilled(w)}}return q},K.reject=function(k,g){k.state=L,k.outcome=g;for(var j=-1,q=k.queue.length;++j<q;){k.queue[j].callRejected(g)}return k},v.resolve=r,v.reject=f,v.all=m,v.race=t},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(l,o,h){function b(m){if(null!==m){switch(typeof m){case"boolean":return m?1:0;case"number":return a(m);case"string":return m.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var j=Array.isArray(m),w=j?m:Object.keys(m),q=-1,v=w.length,g="";if(j){for(;++q<v;){g+=h.toIndexableString(w[q])}}else{for(;++q<v;){var k=w[q];g+=h.toIndexableString(k)+h.toIndexableString(m[k])}}return g}}return""}function r(w,k){var y,g=k,z="1"===w[k];if(z){y=0,k++}else{var x="0"===w[k];k++;var q="",j=w.substring(k,k+p),m=parseInt(j,10)+t;for(x&&(m=-m),k+=p;;){var v=w[k];if("\x00"===v){break}q+=v,k++}q=q.split("."),y=1===q.length?parseInt(q,10):parseFloat(q[0]+"."+q[1]),x&&(y-=10),0!==m&&(y=parseFloat(y+"e"+m))}return{num:y,length:k-g}}function D(w,q){var j=w.pop();if(q.length){var g=q[q.length-1];j===g.element&&(q.pop(),g=q[q.length-1]);var v=g.element,m=g.index;if(Array.isArray(v)){v.push(j)}else{if(m===w.length-2){var k=w.pop();v[k]=j}else{w.push(j)}}}}function s(g,k){for(var j=Math.min(g.length,k.length),q=0;j>q;q++){var m=h.collate(g[q],k[q]);if(0!==m){return m}}return g.length===k.length?0:g.length>k.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(m,j){for(var w=Object.keys(m),q=Object.keys(j),v=Math.min(w.length,q.length),g=0;v>g;g++){var k=h.collate(w[g],q[g]);if(0!==k){return k}if(k=h.collate(m[w[g]],j[q[g]]),0!==k){return k}}return w.length===q.length?0:w.length>q.length?1:-1}function i(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function a(y){if(0===y){return"1"}var v=y.toExponential().split(/e\+?/),j=parseInt(v[1],10),m=0>y,k=m?"0":"2",g=(m?-j:j)-t,x=n.padLeft(g.toString(),"0",p);k+=f+x;var q=Math.abs(parseFloat(v[0]));m&&(q=10-q);var w=q.toFixed(20);return w=w.replace(/\.?0+$/,""),k+=f+w}var t=-324,p=3,f="",n=l(13);h.collate=function(j,m){if(j===m){return 0}j=h.normalizeKey(j),m=h.normalizeKey(m);var k=i(j),g=i(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?s(j,m):u(j,m)},h.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var m=0;j>m;m++){g[m]=h.normalizeKey(k[m])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var q in k){if(k.hasOwnProperty(q)){var v=k[q];"undefined"!=typeof v&&(g[q]=h.normalizeKey(v))}}}}}return g},h.toIndexableString=function(g){var j="\x00";return g=h.normalizeKey(g),i(g)+f+b(g)+j},h.parseIndexableString=function(w){for(var k=[],z=[],g=0;;){var q=w[g++];if("\x00"!==q){switch(q){case"1":k.push(null);break;case"2":k.push("1"===w[g]),g++;break;case"3":var j=r(w,g);k.push(j.num),g+=j.length;break;case"4":for(var m="";;){var v=w[g];if("\x00"===v){break}m+=v,g++}m=m.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),k.push(m);break;case"5":var x={element:[],index:k.length};k.push(x.element),z.push(x);break;case"6":var y={element:{},index:k.length};k.push(y.element),z.push(y);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+q)}}else{if(1===k.length){return k.pop()}D(k,z)}}}},{13:13}],13:[function(h,b,e){function a(l,n,f){for(var m="",g=f-l.length;m.length<g;){m+=n}return m}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var g,o=r.length,f=n.length;for(g=0;o>g;g++){if(g===f){return 1}var i=r.charAt(g),q=n.charAt(g);if(i!==q){return q>i?-1:1}}return f>o?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(j,b,e){function a(){this.store={}}function i(g){if(this.store=new a,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}e.Map=a,e.Set=i,a.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},a.prototype.unmangle=function(f){return f.substring(1)},a.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},a.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},a.prototype.has=function(f){var g=this.mangle(f);return g in this.store},a.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},a.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},i.prototype.add=function(f){return this.store.set(f,!0)},i.prototype.has=function(f){return this.store.has(f)},i.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(e,a,b){(function(){var h={}.hasOwnProperty,f=[].slice;a.exports=function(p,q){var g,n,o,r;n=[],r=[];for(g in q){h.call(q,g)&&(o=q[g],"this"!==g&&(n.push(g),r.push(o)))}return Function.apply(null,f.call(n).concat([p])).apply(q["this"],r)}}).call(this)},{}],16:[function(a,b,f){!function(i){if("object"==typeof f){b.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(p){function v(q,w,z,j,k,x){return w=i(i(w,q),i(j,x)),i(w<<k|w>>>32-k,z)}function o(j,A,k,w,q,z,x){return v(A&k|~A&w,j,A,q,z,x)}function n(j,A,k,w,q,z,x){return v(A&w|k&~w,j,A,q,z,x)}function r(j,A,k,w,q,z,x){return v(A^k^w,j,A,q,z,x)}function O(j,A,k,w,q,z,x){return v(k^(A|~w),j,A,q,z,x)}function g(q,w){var z=q[0],j=q[1],x=q[2],k=q[3];z=o(z,j,x,k,w[0],7,-680876936),k=o(k,z,j,x,w[1],12,-389564586),x=o(x,k,z,j,w[2],17,606105819),j=o(j,x,k,z,w[3],22,-1044525330),z=o(z,j,x,k,w[4],7,-176418897),k=o(k,z,j,x,w[5],12,1200080426),x=o(x,k,z,j,w[6],17,-1473231341),j=o(j,x,k,z,w[7],22,-45705983),z=o(z,j,x,k,w[8],7,1770035416),k=o(k,z,j,x,w[9],12,-1958414417),x=o(x,k,z,j,w[10],17,-42063),j=o(j,x,k,z,w[11],22,-1990404162),z=o(z,j,x,k,w[12],7,1804603682),k=o(k,z,j,x,w[13],12,-40341101),x=o(x,k,z,j,w[14],17,-1502002290),j=o(j,x,k,z,w[15],22,1236535329),z=n(z,j,x,k,w[1],5,-165796510),k=n(k,z,j,x,w[6],9,-1069501632),x=n(x,k,z,j,w[11],14,643717713),j=n(j,x,k,z,w[0],20,-373897302),z=n(z,j,x,k,w[5],5,-701558691),k=n(k,z,j,x,w[10],9,38016083),x=n(x,k,z,j,w[15],14,-660478335),j=n(j,x,k,z,w[4],20,-405537848),z=n(z,j,x,k,w[9],5,568446438),k=n(k,z,j,x,w[14],9,-1019803690),x=n(x,k,z,j,w[3],14,-187363961),j=n(j,x,k,z,w[8],20,1163531501),z=n(z,j,x,k,w[13],5,-1444681467),k=n(k,z,j,x,w[2],9,-51403784),x=n(x,k,z,j,w[7],14,1735328473),j=n(j,x,k,z,w[12],20,-1926607734),z=r(z,j,x,k,w[5],4,-378558),k=r(k,z,j,x,w[8],11,-2022574463),x=r(x,k,z,j,w[11],16,1839030562),j=r(j,x,k,z,w[14],23,-35309556),z=r(z,j,x,k,w[1],4,-1530992060),k=r(k,z,j,x,w[4],11,1272893353),x=r(x,k,z,j,w[7],16,-155497632),j=r(j,x,k,z,w[10],23,-1094730640),z=r(z,j,x,k,w[13],4,681279174),k=r(k,z,j,x,w[0],11,-358537222),x=r(x,k,z,j,w[3],16,-722521979),j=r(j,x,k,z,w[6],23,76029189),z=r(z,j,x,k,w[9],4,-640364487),k=r(k,z,j,x,w[12],11,-421815835),x=r(x,k,z,j,w[15],16,530742520),j=r(j,x,k,z,w[2],23,-995338651),z=O(z,j,x,k,w[0],6,-198630844),k=O(k,z,j,x,w[7],10,1126891415),x=O(x,k,z,j,w[14],15,-1416354905),j=O(j,x,k,z,w[5],21,-57434055),z=O(z,j,x,k,w[12],6,1700485571),k=O(k,z,j,x,w[3],10,-1894986606),x=O(x,k,z,j,w[10],15,-1051523),j=O(j,x,k,z,w[1],21,-2054922799),z=O(z,j,x,k,w[8],6,1873313359),k=O(k,z,j,x,w[15],10,-30611744),x=O(x,k,z,j,w[6],15,-1560198380),j=O(j,x,k,z,w[13],21,1309151649),z=O(z,j,x,k,w[4],6,-145523070),k=O(k,z,j,x,w[11],10,-1120210379),x=O(x,k,z,j,w[2],15,718787259),j=O(j,x,k,z,w[9],21,-343485551),q[0]=i(z,q[0]),q[1]=i(j,q[1]),q[2]=i(x,q[2]),q[3]=i(k,q[3])}function t(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q.charCodeAt(j)+(q.charCodeAt(j+1)<<8)+(q.charCodeAt(j+2)<<16)+(q.charCodeAt(j+3)<<24)}return k}function P(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q[j]+(q[j+1]<<8)+(q[j+2]<<16)+(q[j+3]<<24)}return k}function u(C){var k,B,q,j,x,z,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;A>=k;k+=64){g(w,t(C.substring(k-64,k)))}for(C=C.substring(k-64),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;B>k;k+=1){q[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(q[k>>2]|=128<<(k%4<<3),k>55){for(g(w,q),k=0;16>k;k+=1){q[k]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),z=parseInt(j[1],16)||0,q[14]=x,q[15]=z,g(w,q),w}function s(C){var z,B,q,j,x,k,A=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(z=64;A>=z;z+=64){g(w,P(C.subarray(z-64,z)))}for(C=A>z-64?C.subarray(z-64):new Uint8Array(0),B=C.length,q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=0;B>z;z+=1){q[z>>2]|=C[z]<<(z%4<<3)}if(q[z>>2]|=128<<(z%4<<3),z>55){for(g(w,q),z=0;16>z;z+=1){q[z]=0}}return j=8*A,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,q[14]=x,q[15]=k,g(w,q),w}function Q(q){var j,k="";for(j=0;4>j;j+=1){k+=h[q>>8*j+4&15]+h[q>>8*j&15]}return k}function m(j){var k;for(k=0;k<j.length;k+=1){j[k]=Q(j[k])}return j.join("")}function y(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(q,w){var z,j=q.length,k=new ArrayBuffer(j),x=new Uint8Array(k);for(z=0;j>z;z+=1){x[z]=q.charCodeAt(z)}return w?x:k}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(q,w,k){var j=new Uint8Array(q.byteLength+w.byteLength);return j.set(new Uint8Array(q)),j.set(new Uint8Array(w),q.byteLength),k?j:j.buffer}function e(q){var w,k=[],j=q.length;for(w=0;j-1>w;w+=2){k.push(parseInt(q.substr(w,2),16))}return String.fromCharCode.apply(String,k)}function l(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==m(u("hello"))&&(i=function(q,w){var k=(65535&q)+(65535&w),j=(q>>16)+(w>>16)+(k>>16);return j<<16|65535&k}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(z,D){var C,A,w,k,x=this.byteLength,q=j(z,x),B=x;return D!==p&&(B=j(D,x)),q>B?new ArrayBuffer(0):(C=B-q,A=new ArrayBuffer(C),w=new Uint8Array(A),k=new Uint8Array(this,q,C),w.set(k),A)}}(),l.prototype.append=function(j){return this.appendBinary(y(j)),this},l.prototype.appendBinary=function(q){this._buff+=q,this._length+=q.length;var j,k=this._buff.length;for(j=64;k>=j;j+=64){g(this._hash,t(this._buff.substring(j-64,j)))}return this._buff=this._buff.substring(j-64),this},l.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j.charCodeAt(w)<<(w%4<<3)}return this._finish(x,k),z=m(this._hash),q&&(z=e(z)),this.reset(),z},l.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},l.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},l.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},l.prototype._finish=function(q,w){var z,j,k,x=w;if(q[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,q),x=0;16>x;x+=1){q[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(z[2],16),k=parseInt(z[1],16)||0,q[14]=j,q[15]=k,g(this._hash,q)},l.hash=function(j,k){return l.hashBinary(y(j),k)},l.hashBinary=function(q,w){var k=u(q),j=m(k);return w?e(j):j},l.ArrayBuffer=function(){this.reset()},l.ArrayBuffer.prototype.append=function(q){var w,k=T(this._buff.buffer,q,!0),j=k.length;for(this._length+=q.byteLength,w=64;j>=w;w+=64){g(this._hash,P(k.subarray(w-64,w)))}return this._buff=j>w-64?new Uint8Array(k.buffer.slice(w-64)):new Uint8Array(0),this},l.ArrayBuffer.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j[w]<<(w%4<<3)}return this._finish(x,k),z=m(this._hash),q&&(z=e(z)),this.reset(),z},l.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.ArrayBuffer.prototype.getState=function(){var j=l.prototype.getState.call(this);return j.buff=S(j.buff),j},l.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),l.prototype.setState.call(this,j)},l.ArrayBuffer.prototype.destroy=l.prototype.destroy,l.ArrayBuffer.prototype._finish=l.prototype._finish,l.ArrayBuffer.hash=function(q,w){var k=s(new Uint8Array(q)),j=m(k);return w?e(j):j},l})},{}],17:[function(h,b,e){function a(r,n,g){var o=g[g.length-1];r===o.element&&(g.pop(),o=g[g.length-1]);var f=o.element,i=o.index;if(Array.isArray(f)){f.push(r)}else{if(i===n.length-2){var q=n.pop();f[q]=r}else{n.push(r)}}}e.stringify=function(l){var E=[];E.push({obj:l});for(var u,g,F,n,f,i,D,r,s,o,C,t="";u=E.pop();){if(g=u.obj,F=u.prefix||"",n=u.val||"",t+=F,n){t+=n}else{if("object"!=typeof g){t+="undefined"==typeof g?null:JSON.stringify(g)}else{if(null===g){t+="null"}else{if(Array.isArray(g)){for(E.push({val:"]"}),f=g.length-1;f>=0;f--){i=0===f?"":",",E.push({obj:g[f],prefix:i})}E.push({val:"["})}else{D=[];for(r in g){g.hasOwnProperty(r)&&D.push(r)}for(E.push({val:"}"}),f=D.length-1;f>=0;f--){s=D[f],o=g[s],C=f>0?",":"",C+=JSON.stringify(s)+":",E.push({obj:o,prefix:C})}E.push({val:"{"})}}}}}return t},e.parse=function(C){for(var n,D,g,t,A,i,l,B,u,f=[],o=[],s=0;;){if(n=C[s++],"}"!==n&&"]"!==n&&"undefined"!=typeof n){switch(n){case" ":case"	":case"\n":case":":case",":break;case"n":s+=3,a(null,f,o);break;case"t":s+=3,a(!0,f,o);break;case"f":s+=4,a(!1,f,o);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(D="",s--;;){if(g=C[s++],!/[\d\.\-e\+]/.test(g)){s--;break}D+=g}a(parseFloat(D),f,o);break;case'"':for(t="",A=void 0,i=0;;){if(l=C[s++],'"'===l&&("\\"!==A||i%2!==1)){break}t+=l,A=l,"\\"===A?i++:i=0}a(JSON.parse('"'+t+'"'),f,o);break;case"[":B={element:[],index:f.length},f.push(B.element),o.push(B);break;case"{":u={element:{},index:f.length},f.push(u.element),o.push(u);break;default:throw new Error("unexpectedly reached end of input: "+n)}}else{if(1===f.length){return f.pop()}a(f.pop(),f,o)}}}},{}]},{},[3])(3)});