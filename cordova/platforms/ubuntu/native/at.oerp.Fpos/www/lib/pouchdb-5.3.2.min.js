!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(l,i,b){function a(n,h){if(!i[n]){if(!l[n]){var j="function"==typeof require&&require;if(!h&&j){return j(n,!0)}if(e){return e(n,!0)}var f=new Error("Cannot find module '"+n+"'");throw f.code="MODULE_NOT_FOUND",f}var g=i[n]={exports:{}};l[n][0].call(g.exports,function(p){var m=l[n][1][p];return a(m?m:p)},g,g.exports,d,l,i,b)}return i[n].exports}for(var e="function"==typeof require&&require,k=0;k<b.length;k++){a(b[k])}return a}({1:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],2:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var f="color: "+this.color;k=[k[0],f,"color: inherit"].concat(Array.prototype.slice.call(k,1));var j=0,g=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(j++,"%c"===l&&(g=j))}),k.splice(g,0,f),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(3),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{3:3}],3:[function(b,s,i){function o(){return i.colors[e++%i.colors.length]}function n(h){function k(){}function j(){var q=j,m=+new Date,p=m-(a||m);q.diff=p,q.prev=a,q.curr=m,a=m,null==q.useColors&&(q.useColors=i.useColors()),null==q.color&&q.useColors&&(q.color=o());var w=Array.prototype.slice.call(arguments);w[0]=i.coerce(w[0]),"string"!=typeof w[0]&&(w=["%o"].concat(w));var l=0;w[0]=w[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}l++;var x=i.formatters[A];if("function"==typeof x){var z=w[l];y=x.call(q,z),w.splice(l,1),l--}return y}),"function"==typeof i.formatArgs&&(w=i.formatArgs.apply(q,w));var v=j.log||i.log||console.log.bind(console);v.apply(q,w)}k.enabled=!1,j.enabled=!0;var g=i.enabled(h)?j:k;return g.namespace=h,g}function f(j){i.save(j);for(var h=(j||"").split(/[\s,]+/),k=h.length,g=0;k>g;g++){h[g]&&(j=h[g].replace(/\*/g,".*?"),"-"===j[0]?i.skips.push(new RegExp("^"+j.substr(1)+"$")):i.names.push(new RegExp("^"+j+"$")))}}function u(){i.enable("")}function r(g){var j,h;for(j=0,h=i.skips.length;h>j;j++){if(i.skips[j].test(g)){return !1}}for(j=0,h=i.names.length;h>j;j++){if(i.names[j].test(g)){return !0}}return !1}function t(g){return g instanceof Error?g.stack||g.message:g}i=s.exports=n,i.coerce=t,i.disable=u,i.enable=f,i.enabled=r,i.humanize=b(9),i.names=[],i.skips=[],i.formatters={};var a,e=0},{9:9}],4:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function m(f){return"number"==typeof f}function i(f){return"object"==typeof f&&null!==f}function p(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!m(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,l,j,r,f,h;if(this._events||(this._events={}),"error"===k&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(l=this._events[k],p(l)){return !1}if(b(l)){switch(arguments.length){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),l.apply(this,r)}}else{if(i(l)){for(r=Array.prototype.slice.call(arguments,1),h=l.slice(),j=h.length,f=0;j>f;f++){h[f].apply(this,r)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?i(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,i(this._events[f])&&!this._events[f].warned&&(h=p(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(g,j){function f(){this.removeListener(g,f),h||(h=!0,j.apply(this,arguments))}if(!b(j)){throw TypeError("listener must be a function")}var h=!1;return f.listener=j,this.on(g,f),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(i(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],5:[function(e,a,b){(function(x){function i(){y=!0;for(var j,g,h=f.length;h;){for(g=f,f=[],j=-1;++j<h;){g[j]()}h=f.length}y=!1}function o(g){1!==f.push(g)||y||n()}var n,z=x.MutationObserver||x.WebKitMutationObserver;if(z){var u=0,r=new z(i),s=x.document.createTextNode("");r.observe(s,{characterData:!0}),n=function(){s.data=u=++u%2}}else{if(x.setImmediate||"undefined"==typeof x.MessageChannel){n="document" in x&&"onreadystatechange" in x.document.createElement("script")?function(){var g=x.document.createElement("script");g.onreadystatechange=function(){i(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},x.document.documentElement.appendChild(g)}:function(){setTimeout(i,0)}}else{var l=new x.MessageChannel;l.port1.onmessage=i,n=function(){l.port2.postMessage(0)}}}var y,f=[];a.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(e,a,b){"function"==typeof Object.create?a.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],7:[function(e,a,b){(function(f){f("object"==typeof b?b:this)}).call(this,function(j){var l=Array.prototype.slice,f=Array.prototype.forEach,k=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=l.call(arguments,1);return f.call(g,function(i){if(i){for(var n in i){"object"==typeof i[n]&&h[n]?k.call(h,h[n],i[n]):h[n]=i[n]}}}),h};j.extend=k})},{}],8:[function(t,u,i){function r(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=a,this.queue=[],this.outcome=void 0,g!==r&&y(this,g)}function h(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function p(j,k,g){n(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function e(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(q,j){function w(A){x||(x=!0,K.reject(q,A))}function g(A){x||(x=!0,K.resolve(q,A))}function k(){j(g,w)}var x=!1,z=o(k);"error"===z.status&&w(z.value)}function o(q,j){var k={};try{k.value=q(j),k.status="success"}catch(g){k.status="error",k.value=g}return k}function f(g){return g instanceof this?g:K.resolve(new this(r),g)}function l(g){var j=new this(r);return K.reject(j,g)}function b(B){function A(E,D){function C(F){w[D]=F,++z!==k||g||(g=!0,K.resolve(x,w))}j.resolve(E).then(C,function(F){g||(g=!0,K.reject(x,F))})}var j=this;if("[object Array]"!==Object.prototype.toString.call(B)){return this.reject(new TypeError("must be an array"))}var k=B.length,g=!1;if(!k){return this.resolve([])}for(var w=new Array(k),z=0,q=-1,x=new this(r);++q<k;){A(B[q],q)}return x}function s(q){function j(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(g,B))},function(B){x||(x=!0,K.reject(g,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(q)){return this.reject(new TypeError("must be an array"))}var k=q.length,x=!1;if(!k){return this.resolve([])}for(var z=-1,g=new this(r);++z<k;){j(q[z])}return g}var n=t(5),K={},L=["REJECTED"],m=["FULFILLED"],a=["PENDING"];u.exports=i=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(g,j){if("function"!=typeof g&&this.state===m||"function"!=typeof j&&this.state===L){return this}var k=new this.constructor(r);if(this.state!==a){var q=this.state===m?g:j;p(k,q,this.outcome)}else{this.queue.push(new h(k,g,j))}return k},h.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},h.prototype.otherCallFulfilled=function(g){p(this.promise,this.onFulfilled,g)},h.prototype.callRejected=function(g){K.reject(this.promise,g)},h.prototype.otherCallRejected=function(g){p(this.promise,this.onRejected,g)},K.resolve=function(g,w){var k=o(e,w);if("error"===k.status){return K.reject(g,k.value)}var j=k.value;if(j){y(g,j)}else{g.state=m,g.outcome=w;for(var q=-1,x=g.queue.length;++q<x;){g.queue[q].callFulfilled(w)}}return g},K.reject=function(q,j){q.state=L,q.outcome=j;for(var k=-1,g=q.queue.length;++k<g;){q.queue[k].callRejected(j)}return q},i.resolve=f,i.reject=l,i.all=b,i.race=s},{5:5}],9:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],10:[function(h,l,a){function s(j){if(null!==j){switch(typeof j){case"boolean":return j?1:0;case"number":return p(j);case"string":return j.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var m=Array.isArray(j),v=m?j:Object.keys(j),g=-1,w=v.length,q="";if(m){for(;++g<w;){q+=a.toIndexableString(v[g])}}else{for(;++g<w;){var k=v[g];q+=a.toIndexableString(k)+a.toIndexableString(j[k])}}return q}}return""}function o(g,w){var k,q=w,m="1"===g[w];if(m){k=0,w++}else{var j="0"===g[w];w++;var y="",v=g.substring(w,w+n),x=parseInt(v,10)+e;for(j&&(x=-x),w+=n;;){var z=g[w];if("\x00"===z){break}y+=z,w++}y=y.split("."),k=1===y.length?parseInt(y,10):parseFloat(y[0]+"."+y[1]),j&&(k-=10),0!==x&&(k=parseFloat(k+"e"+x))}return{num:k,length:w-q}}function D(v,g){var m=v.pop();if(g.length){var q=g[g.length-1];m===q.element&&(g.pop(),q=g[g.length-1]);var w=q.element,j=q.index;if(Array.isArray(w)){w.push(m)}else{if(j===v.length-2){var k=v.pop();w[k]=m}else{v.push(m)}}}}function b(j,m){for(var k=Math.min(j.length,m.length),g=0;k>g;g++){var q=a.collate(j[g],m[g]);if(0!==q){return q}}return j.length===m.length?0:j.length>m.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(j,m){for(var v=Object.keys(j),g=Object.keys(m),w=Math.min(v.length,g.length),q=0;w>q;q++){var k=a.collate(v[q],g[q]);if(0!==k){return k}if(k=a.collate(j[v[q]],m[g[q]]),0!==k){return k}}return v.length===g.length?0:v.length>g.length?1:-1}function r(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function p(v){if(0===v){return"1"}var k=v.toExponential().split(/e\+?/),x=parseInt(k[1],10),g=0>v,y=g?"0":"2",w=(g?-x:x)-e,q=i.padLeft(w.toString(),"0",n);y+=u+q;var j=Math.abs(parseFloat(k[0]));g&&(j=10-j);var m=j.toFixed(20);return m=m.replace(/\.?0+$/,""),y+=u+m}var e=-324,n=3,u="",i=h(11);a.collate=function(j,m){if(j===m){return 0}j=a.normalizeKey(j),m=a.normalizeKey(m);var k=r(j),g=r(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?b(j,m):f(j,m)},a.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var m=0;j>m;m++){g[m]=a.normalizeKey(k[m])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var q in k){if(k.hasOwnProperty(q)){var v=k[q];"undefined"!=typeof v&&(g[q]=a.normalizeKey(v))}}}}}return g},a.toIndexableString=function(g){var j="\x00";return g=a.normalizeKey(g),r(g)+u+s(g)+j},a.parseIndexableString=function(g){for(var w=[],m=[],q=0;;){var y=g[q++];if("\x00"!==y){switch(y){case"1":w.push(null);break;case"2":w.push("1"===g[q]),q++;break;case"3":var v=o(g,q);w.push(v.num),q+=v.length;break;case"4":for(var x="";;){var z=g[q];if("\x00"===z){break}x+=z,q++}x=x.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),w.push(x);break;case"5":var j={element:[],index:w.length};w.push(j.element),m.push(j);break;case"6":var k={element:{},index:w.length};w.push(k.element),m.push(k);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+y)}}else{if(1===w.length){return w.pop()}D(w,m)}}}},{11:11}],11:[function(b,h,a){function e(m,f,g){for(var n="",l=g-m.length;n.length<l;){n+=f}return n}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var g,o=n.length,f=r.length;for(g=0;o>g;g++){if(g===f){return 1}var q=n.charAt(g),i=r.charAt(g);if(q!==i){return i>q?-1:1}}return f>o?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],12:[function(e,j,a){function i(){this.store={}}function b(g){if(this.store=new i,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}a.Map=i,a.Set=b,i.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},i.prototype.unmangle=function(f){return f.substring(1)},i.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},i.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},i.prototype.has=function(f){var g=this.mangle(f);return g in this.store},i.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},i.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},b.prototype.add=function(f){return this.store.set(f,!0)},b.prototype.has=function(f){return this.store.has(f)},b.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],13:[function(b,s,l){function o(){e=!1,r.length?a=r.concat(a):i=-1,a.length&&n()}function n(){if(!e){var g=setTimeout(o);e=!0;for(var h=a.length;h;){for(r=a,a=[];++i<h;){r&&r[i].run()}i=-1,h=a.length}r=null,e=!1,clearTimeout(g)}}function f(g,h){this.fun=g,this.array=h}function u(){}var r,t=s.exports={},a=[],e=!1,i=-1;t.nextTick=function(h){var j=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){j[g-1]=arguments[g]}}a.push(new f(h,j)),1!==a.length||e||setTimeout(n,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=u,t.addListener=u,t.once=u,t.off=u,t.removeListener=u,t.removeAllListeners=u,t.emit=u,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],14:[function(e,a,b){(function(){var h={}.hasOwnProperty,f=[].slice;a.exports=function(o,p){var q,g,n,r;g=[],r=[];for(q in p){h.call(p,q)&&(n=p[q],"this"!==q&&(g.push(q),r.push(n)))}return Function.apply(null,f.call(g).concat([o])).apply(p["this"],r)}}).call(this)},{}],15:[function(a,b,f){!function(i){if("object"==typeof f){b.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(l){function Q(q,w,z,j,k,x){return w=i(i(w,q),i(j,x)),i(w<<k|w>>>32-k,z)}function s(j,A,k,w,q,z,x){return Q(A&k|~A&w,j,A,q,z,x)}function y(j,A,k,w,q,z,x){return Q(A&w|k&~w,j,A,q,z,x)}function u(j,A,k,w,q,z,x){return Q(A^k^w,j,A,q,z,x)}function o(j,A,k,w,q,z,x){return Q(k^(A|~w),j,A,q,z,x)}function g(q,w){var z=q[0],j=q[1],x=q[2],k=q[3];z=s(z,j,x,k,w[0],7,-680876936),k=s(k,z,j,x,w[1],12,-389564586),x=s(x,k,z,j,w[2],17,606105819),j=s(j,x,k,z,w[3],22,-1044525330),z=s(z,j,x,k,w[4],7,-176418897),k=s(k,z,j,x,w[5],12,1200080426),x=s(x,k,z,j,w[6],17,-1473231341),j=s(j,x,k,z,w[7],22,-45705983),z=s(z,j,x,k,w[8],7,1770035416),k=s(k,z,j,x,w[9],12,-1958414417),x=s(x,k,z,j,w[10],17,-42063),j=s(j,x,k,z,w[11],22,-1990404162),z=s(z,j,x,k,w[12],7,1804603682),k=s(k,z,j,x,w[13],12,-40341101),x=s(x,k,z,j,w[14],17,-1502002290),j=s(j,x,k,z,w[15],22,1236535329),z=y(z,j,x,k,w[1],5,-165796510),k=y(k,z,j,x,w[6],9,-1069501632),x=y(x,k,z,j,w[11],14,643717713),j=y(j,x,k,z,w[0],20,-373897302),z=y(z,j,x,k,w[5],5,-701558691),k=y(k,z,j,x,w[10],9,38016083),x=y(x,k,z,j,w[15],14,-660478335),j=y(j,x,k,z,w[4],20,-405537848),z=y(z,j,x,k,w[9],5,568446438),k=y(k,z,j,x,w[14],9,-1019803690),x=y(x,k,z,j,w[3],14,-187363961),j=y(j,x,k,z,w[8],20,1163531501),z=y(z,j,x,k,w[13],5,-1444681467),k=y(k,z,j,x,w[2],9,-51403784),x=y(x,k,z,j,w[7],14,1735328473),j=y(j,x,k,z,w[12],20,-1926607734),z=u(z,j,x,k,w[5],4,-378558),k=u(k,z,j,x,w[8],11,-2022574463),x=u(x,k,z,j,w[11],16,1839030562),j=u(j,x,k,z,w[14],23,-35309556),z=u(z,j,x,k,w[1],4,-1530992060),k=u(k,z,j,x,w[4],11,1272893353),x=u(x,k,z,j,w[7],16,-155497632),j=u(j,x,k,z,w[10],23,-1094730640),z=u(z,j,x,k,w[13],4,681279174),k=u(k,z,j,x,w[0],11,-358537222),x=u(x,k,z,j,w[3],16,-722521979),j=u(j,x,k,z,w[6],23,76029189),z=u(z,j,x,k,w[9],4,-640364487),k=u(k,z,j,x,w[12],11,-421815835),x=u(x,k,z,j,w[15],16,530742520),j=u(j,x,k,z,w[2],23,-995338651),z=o(z,j,x,k,w[0],6,-198630844),k=o(k,z,j,x,w[7],10,1126891415),x=o(x,k,z,j,w[14],15,-1416354905),j=o(j,x,k,z,w[5],21,-57434055),z=o(z,j,x,k,w[12],6,1700485571),k=o(k,z,j,x,w[3],10,-1894986606),x=o(x,k,z,j,w[10],15,-1051523),j=o(j,x,k,z,w[1],21,-2054922799),z=o(z,j,x,k,w[8],6,1873313359),k=o(k,z,j,x,w[15],10,-30611744),x=o(x,k,z,j,w[6],15,-1560198380),j=o(j,x,k,z,w[13],21,1309151649),z=o(z,j,x,k,w[4],6,-145523070),k=o(k,z,j,x,w[11],10,-1120210379),x=o(x,k,z,j,w[2],15,718787259),j=o(j,x,k,z,w[9],21,-343485551),q[0]=i(z,q[0]),q[1]=i(j,q[1]),q[2]=i(x,q[2]),q[3]=i(k,q[3])}function m(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q.charCodeAt(j)+(q.charCodeAt(j+1)<<8)+(q.charCodeAt(j+2)<<16)+(q.charCodeAt(j+3)<<24)}return k}function r(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q[j]+(q[j+1]<<8)+(q[j+2]<<16)+(q[j+3]<<24)}return k}function O(C){var x,A,B,w,k,q,z=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;z>=x;x+=64){g(j,m(C.substring(x-64,x)))}for(C=C.substring(x-64),A=C.length,B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;A>x;x+=1){B[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(B[x>>2]|=128<<(x%4<<3),x>55){for(g(j,B),x=0;16>x;x+=1){B[x]=0}}return w=8*z,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),q=parseInt(w[1],16)||0,B[14]=k,B[15]=q,g(j,B),j}function v(C){var q,A,B,w,k,x,z=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(q=64;z>=q;q+=64){g(j,r(C.subarray(q-64,q)))}for(C=z>q-64?C.subarray(q-64):new Uint8Array(0),A=C.length,B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=0;A>q;q+=1){B[q>>2]|=C[q]<<(q%4<<3)}if(B[q>>2]|=128<<(q%4<<3),q>55){for(g(j,B),q=0;16>q;q+=1){B[q]=0}}return w=8*z,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,B[14]=k,B[15]=x,g(j,B),j}function P(q){var j,k="";for(j=0;4>j;j+=1){k+=h[q>>8*j+4&15]+h[q>>8*j&15]}return k}function t(j){var k;for(k=0;k<j.length;k+=1){j[k]=P(j[k])}return j.join("")}function n(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(q,w){var z,j=q.length,k=new ArrayBuffer(j),x=new Uint8Array(k);for(z=0;j>z;z+=1){x[z]=q.charCodeAt(z)}return w?x:k}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(q,w,k){var j=new Uint8Array(q.byteLength+w.byteLength);return j.set(new Uint8Array(q)),j.set(new Uint8Array(w),q.byteLength),k?j:j.buffer}function e(q){var w,k=[],j=q.length;for(w=0;j-1>w;w+=2){k.push(parseInt(q.substr(w,2),16))}return String.fromCharCode.apply(String,k)}function p(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==t(O("hello"))&&(i=function(q,w){var k=(65535&q)+(65535&w),j=(q>>16)+(w>>16)+(k>>16);return j<<16|65535&k}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(D,x){var k,w,A,q,z=this.byteLength,C=j(D,z),B=z;return x!==l&&(B=j(x,z)),C>B?new ArrayBuffer(0):(k=B-C,w=new ArrayBuffer(k),A=new Uint8Array(w),q=new Uint8Array(this,C,k),A.set(q),w)}}(),p.prototype.append=function(j){return this.appendBinary(n(j)),this},p.prototype.appendBinary=function(q){this._buff+=q,this._length+=q.length;var j,k=this._buff.length;for(j=64;k>=j;j+=64){g(this._hash,m(this._buff.substring(j-64,j)))}return this._buff=this._buff.substring(j-64),this},p.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j.charCodeAt(w)<<(w%4<<3)}return this._finish(x,k),z=t(this._hash),q&&(z=e(z)),this.reset(),z},p.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},p.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},p.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},p.prototype._finish=function(q,w){var z,j,k,x=w;if(q[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,q),x=0;16>x;x+=1){q[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(z[2],16),k=parseInt(z[1],16)||0,q[14]=j,q[15]=k,g(this._hash,q)},p.hash=function(j,k){return p.hashBinary(n(j),k)},p.hashBinary=function(q,w){var k=O(q),j=t(k);return w?e(j):j},p.ArrayBuffer=function(){this.reset()},p.ArrayBuffer.prototype.append=function(q){var w,k=T(this._buff.buffer,q,!0),j=k.length;for(this._length+=q.byteLength,w=64;j>=w;w+=64){g(this._hash,r(k.subarray(w-64,w)))}return this._buff=j>w-64?new Uint8Array(k.buffer.slice(w-64)):new Uint8Array(0),this},p.ArrayBuffer.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j[w]<<(w%4<<3)}return this._finish(x,k),z=t(this._hash),q&&(z=e(z)),this.reset(),z},p.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.ArrayBuffer.prototype.getState=function(){var j=p.prototype.getState.call(this);return j.buff=S(j.buff),j},p.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),p.prototype.setState.call(this,j)},p.ArrayBuffer.prototype.destroy=p.prototype.destroy,p.ArrayBuffer.prototype._finish=p.prototype._finish,p.ArrayBuffer.hash=function(q,w){var k=v(new Uint8Array(q)),j=t(k);return w?e(j):j},p})},{}],16:[function(b,h,a){function e(n,r,g){var o=g[g.length-1];n===o.element&&(g.pop(),o=g[g.length-1]);var f=o.element,q=o.index;if(Array.isArray(f)){f.push(n)}else{if(q===r.length-2){var i=r.pop();f[i]=n}else{r.push(n)}}}a.stringify=function(E){var u=[];u.push({obj:E});for(var i,D,s,n,f,l,g,r,F,o,C,t="";i=u.pop();){if(D=i.obj,s=i.prefix||"",n=i.val||"",t+=s,n){t+=n}else{if("object"!=typeof D){t+="undefined"==typeof D?null:JSON.stringify(D)}else{if(null===D){t+="null"}else{if(Array.isArray(D)){for(u.push({val:"]"}),f=D.length-1;f>=0;f--){l=0===f?"":",",u.push({obj:D[f],prefix:l})}u.push({val:"["})}else{g=[];for(r in D){D.hasOwnProperty(r)&&g.push(r)}for(u.push({val:"}"}),f=g.length-1;f>=0;f--){F=g[f],o=D[F],C=f>0?",":"",C+=JSON.stringify(F)+":",u.push({obj:o,prefix:C})}u.push({val:"{"})}}}}}return t},a.parse=function(s){for(var i,B,D,A,l,f,g,o,t,C=[],n=[],u=0;;){if(i=s[u++],"}"!==i&&"]"!==i&&"undefined"!=typeof i){switch(i){case" ":case"	":case"\n":case":":case",":break;case"n":u+=3,e(null,C,n);break;case"t":u+=3,e(!0,C,n);break;case"f":u+=4,e(!1,C,n);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(B="",u--;;){if(D=s[u++],!/[\d\.\-e\+]/.test(D)){u--;break}B+=D}e(parseFloat(B),C,n);break;case'"':for(A="",l=void 0,f=0;;){if(g=s[u++],'"'===g&&("\\"!==l||f%2!==1)){break}A+=g,l=g,"\\"===l?f++:f=0}e(JSON.parse('"'+A+'"'),C,n);break;case"[":o={element:[],index:C.length},C.push(o.element),n.push(o);break;case"{":t={element:{},index:C.length},C.push(t.element),n.push(t);break;default:throw new Error("unexpectedly reached end of input: "+i)}}else{if(1===C.length){return C.pop()}e(C.pop(),C,n)}}}},{}],17:[function(e,a,b){(function(a0,ib){function js(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function hE(ab,ad){for(var t={},ac=0,aa=ad.length;aa>ac;ac++){var af=ad[ac];af in ab&&(t[af]=ab[af])}return t}function bo(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function i6(ac){if("function"==typeof ac.slice){return ac.slice(0)}var aa=new ArrayBuffer(ac.byteLength),ab=new Uint8Array(aa),t=new Uint8Array(ac);return ab.set(t),aa}function jr(t){if(t instanceof ArrayBuffer){return i6(t)}var aa=t.size,ab=t.type;return"function"==typeof t.slice?t.slice(0,aa,ab):t.webkitSlice(0,aa,ab)}function iC(ab){var ad,t,ac;if(!ab||"object"!=typeof ab){return ab}if(Array.isArray(ab)){for(ad=[],t=0,ac=ab.length;ac>t;t++){ad[t]=iC(ab[t])}return ad}if(ab instanceof Date){return ab.toISOString()}if(bo(ab)){return jr(ab)}ad={};for(t in ab){if(Object.prototype.hasOwnProperty.call(ab,t)){var aa=iC(ab[t]);"undefined"!=typeof aa&&(ad[t]=aa)}}return ad}function ho(t){var aa=!1;return h5(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function iv(t){return h5(function(ac){ac=iC(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){a0.nextTick(function(){ad(ah,ag)})});var af=new jA(function(ag,ah){var ak;try{var al=ho(function(ap,am){ap?ah(ap):ag(am)});ac.push(al),ak=t.apply(aa,ac),ak&&"function"==typeof ak.then&&ag(ak)}catch(aj){ah(aj)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function fY(t,aa){function ab(af,ah,ac){if(jk.enabled){for(var ag=[af._db_name,ah],ad=0;ad<ac.length-1;ad++){ag.push(ac[ad])}jk.apply(null,ag);var aj=ac[ac.length-1];ac[ac.length-1]=function(ak,am){var al=[af._db_name,ah];al=al.concat(ak?["error",ak]:["success",am]),jk.apply(null,al),aj(ak,am)}}}return iv(h5(function(ad){if(this._closed){return jA.reject(new Error("database is closed"))}if(this._destroyed){return jA.reject(new Error("database is destroyed"))}var ac=this;return ab(ac,t,ad),this.taskqueue.isReady?aa.apply(this,ad):new jA(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[t].apply(ac,ad))})})}))}function hj(t,aa,ab){return new jA(function(ad,ac){t.get(aa,function(ag,aj){if(ag){if(404!==ag.status){return ac(ag)}aj={}}var af=aj._rev,ah=ab(aj);return ah?(ah._id=aa,ah._rev=af,void ad(H(t,ah,ab))):ad({updated:!1,rev:af})})})}function H(t,aa,ab){return t.put(aa).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return hj(t,aa._id,ab)})}function gQ(t){for(var ap,ak,am,al,ah=t.rev_tree.slice();al=ah.pop();){var ab=al.ids,ag=ab[2],aa=al.pos;if(ag.length){for(var ac=0,af=ag.length;af>ac;ac++){ah.push({pos:aa+1,ids:ag[ac]})}}else{var aj=!!ab[1].deleted,ad=ab[0];ap&&!(am!==aj?am:ak!==aa?aa>ak:ad>ap)||(ap=ad,ak=aa,am=aj)}}return ak+"-"+ap}function a4(t){return t.ids}function je(ab,ad){ad||(ad=gQ(ab));for(var t,ac=ad.substring(ad.indexOf("-")+1),aa=ab.rev_tree.map(a4);t=aa.pop();){if(t[0]===ac){return !!t[1].deleted}aa=aa.concat(t[2])}}function gC(t){return br("return "+t+";",{})}function gO(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function dr(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function P(t){var aa=dr(t);return aa?aa.join("/"):null}function hf(ak,ah){for(var ac,af=ak.slice();ac=af.pop();){for(var ad=ac.pos,aa=ac.ids,aj=aa[2],ag=ah(0===aj.length,ad,aa[0],ac.ctx,aa[1]),t=0,ab=aj.length;ab>t;t++){af.push({pos:ad+1,ids:aj[t],ctx:ag})}}}function hS(t,aa){return t.pos-aa.pos}function fl(ac){var aa=[];hf(ac,function(ad,ah,af,aj,ag){ad&&aa.push({rev:ah+"-"+af,pos:ah,opts:ag})}),aa.sort(hS).reverse();for(var ab=0,t=aa.length;t>ab;ab++){delete aa[ab].pos}return aa}function bt(aa){for(var ac=gQ(aa),ag=fl(aa.rev_tree),ab=[],t=0,ad=ag.length;ad>t;t++){var af=ag[t];af.rev===ac||af.opts.deleted||ab.push(af.rev)}return ab}function gm(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function hK(ac,aa,ab){function t(af){for(var ad in ac){"function"!=typeof ac[ad]&&(this[ad]=ac[ad])}void 0!==ab&&(this.name=ab),void 0!==af&&(this.reason=af)}return t.prototype=gm.prototype,new t(aa)}function h3(ab){var ad,t,ac,aa,af;return t=ab.error===!0&&"string"==typeof ab.name?ab.name:ab.error,af=ab.reason,ac=ih("name",t,af),ab.missing||"missing"===af||"deleted"===af||"not_found"===t?ac=u:"doc_validation"===t?(ac=x,aa=af):"bad_request"===t&&ac.message!==af&&(ac=g4),ac||(ac=ih("status",ab.status,af)||Q),ad=hK(ac,af,t),aa&&(ad.message=aa),ab.id&&(ad.id=ab.id),ab.status&&(ad.status=ab.status),ab.missing&&(ad.missing=ab.missing),ad}function fS(aa,ac,ag){function ab(){t.cancel()}jy.EventEmitter.call(this);var t=this;this.db=aa,ac=ac?iC(ac):{};var ad=ac.complete=ho(function(ah,aj){ah?t.emit("error",ah):t.emit("complete",aj),t.removeAllListeners(),aa.removeListener("destroyed",ab)});ag&&(t.on("complete",function(ah){ag(null,ah)}),t.on("error",ag)),aa.once("destroyed",ab),ac.onChange=function(ah){ac.isCancelled||(t.emit("change",ah),t.startSeq&&t.startSeq<=ah.seq&&(t.startSeq=!1))};var af=new jA(function(ah,aj){ac.complete=function(al,ak){al?aj(al):ah(ak)}});t.once("cancel",function(){aa.removeListener("destroyed",ab),ac.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ad(null,ah)},ad),aa.taskqueue.isReady?t.doChanges(ac):aa.taskqueue.addTask(function(){t.isCancelled?t.emit("cancel"):t.doChanges(ac)})}function hA(ab,ad,t){var ac=[{rev:ab._rev}];"all_docs"===t.style&&(ac=fl(ad.rev_tree).map(function(af){return{rev:af.rev}}));var aa={id:ad.id,changes:ac,doc:ab};return je(ad,ab._rev)&&(aa.deleted=!0),t.conflicts&&(aa.doc._conflicts=bt(ad),aa.doc._conflicts.length||delete aa.doc._conflicts),aa}function hi(ac,aj,ad){function ag(){var am=[];ab.forEach(function(ap){ap.docs.forEach(function(aq){am.push({id:ap.id,docs:[aq]})})}),ad(null,{results:am})}function af(){++t===al&&ag()}function aa(aq,am,ap){ab[aq]={id:am,docs:ap},af()}var ah=Array.isArray(aj)?aj:aj.docs,ak={};ah.forEach(function(am){am.id in ak?ak[am.id].push(am):ak[am.id]=[am]});var al=Object.keys(ak).length,t=0,ab=new Array(al);Object.keys(ak).forEach(function(am,aq){var av=ak[am],ap=hE(av[0],["atts_since","attachments"]);ap.open_revs=av.map(function(aw){return aw.rev}),ap.open_revs=ap.open_revs.filter(function(aw){return aw});var au=function(aw){return aw};0===ap.open_revs.length&&(delete ap.open_revs,au=function(aw){return[{ok:aw}]}),["revs","attachments","binary","ajax"].forEach(function(aw){aw in aj&&(ap[aw]=aj[aw])}),ac.get(am,ap,function(aw,ax){aa(aq,am,aw?[{error:aw}]:au(ax))})})}function D(t){return/^_local/.test(t)}function ft(t){for(var ap,ak=[],am=t.slice();ap=am.pop();){var al=ap.pos,ah=ap.ids,ab=ah[0],ag=ah[1],aa=ah[2],ac=0===aa.length,af=ap.history?ap.history.slice():[];af.push({id:ab,opts:ag}),ac&&ak.push({pos:al+1-af.length,ids:af});for(var aj=0,ad=aa.length;ad>aj;aj++){am.push({pos:al+1,ids:aa[aj],history:af})}}return ak.reverse()}function iN(t){return 0|Math.random()*t}function iF(ac,aa){aa=aa||f.length;var ab="",t=-1;if(ac){for(;++t<ac;){ab+=f[iN(aa)]}return ab}for(;++t<36;){switch(t){case 8:case 13:case 18:case 23:ab+="-";break;case 19:ab+=f[3&iN(16)|8];break;default:ab+=f[iN(16)]}}return ab}function jb(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function hU(t){var aa;if(t?"string"!=typeof t?aa=hK(hZ):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=hK(jq)):aa=hK(h9),aa){throw aa}}function gG(ac){if(!/^\d+\-./.test(ac)){return hK(bn)}var aa=ac.indexOf("-"),ab=ac.substring(0,aa),t=ac.substring(aa+1);return{prefix:parseInt(ab,10),id:t}}function fy(aa,ac){for(var ag=aa.start-aa.ids.length+1,ab=aa.ids,t=[ab[0],ac,[]],ad=1,af=ab.length;af>ad;ad++){t=[ab[ad],{status:"missing"},[t]]}return[{pos:ag,ids:t}]}function gX(ak,ah){var ac,af,ad,aa={status:"available"};if(ak._deleted&&(aa.deleted=!0),ah){if(ak._id||(ak._id=iF()),af=iF(32,16).toLowerCase(),ak._rev){if(ad=gG(ak._rev),ad.error){return ad}ak._rev_tree=[{pos:ad.prefix,ids:[ad.id,{status:"missing"},[[af,aa,[]]]]}],ac=ad.prefix+1}else{ak._rev_tree=[{pos:1,ids:[af,aa,[]]}],ac=1}}else{if(ak._revisions&&(ak._rev_tree=fy(ak._revisions,aa),ac=ak._revisions.start,af=ak._revisions.ids[0]),!ak._rev_tree){if(ad=gG(ak._rev),ad.error){return ad}ac=ad.prefix,af=ad.id,ak._rev_tree=[{pos:ac,ids:[af,aa,[]]}]}}hU(ak._id),ak._rev=ac+"-"+af;var aj={metadata:{},data:{}};for(var ag in ak){if(Object.prototype.hasOwnProperty.call(ak,ag)){var t="_"===ag[0];if(t&&!fm[ag]){var ab=hK(x,ag);throw ab.message=x.message+": "+ag,ab}t&&!gh[ag]?aj.metadata[ag.slice(1)]=ak[ag]:aj.data[ag]=ak[ag]}}return aj}function fb(t,aa){return aa>t?-1:t>aa?1:0}function de(t,aa){for(var ab=0;ab<t.length;ab++){if(aa(t[ab],ab)===!0){return t[ab]}}}function eq(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function et(ab){for(var ad=0;ad<ab.length;ad++){var t=ab[ad];if(t._deleted){delete t._attachments}else{if(t._attachments){for(var ac=Object.keys(t._attachments),aa=0;aa<ac.length;aa++){var af=ac[aa];t._attachments[af]=hE(t._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function gT(ab,ad){var t=fb(ab._id,ad._id);if(0!==t){return t}var ac=ab._revisions?ab._revisions.start:0,aa=ad._revisions?ad._revisions.start:0;return fb(ac,aa)}function iq(t){var aa={},ab=[];return hf(t,function(ac,ad,ah,af){var ag=ad+"-"+ah;return ac&&(aa[ag]=0),void 0!==af&&ab.push({from:af,to:ag}),ag}),ab.reverse(),ab.forEach(function(ac){void 0===aa[ac.from]?aa[ac.from]=1+aa[ac.to]:aa[ac.from]=Math.min(aa[ac.from],1+aa[ac.to])}),aa}function hl(ab,ad,t){var ac="limit" in ad?ad.keys.slice(ad.skip,ad.limit+ad.skip):ad.skip>0?ad.keys.slice(ad.skip):ad.keys;if(ad.descending&&ac.reverse(),!ac.length){return ab._allDocs({limit:0},t)}var aa={offset:ad.skip};return jA.all(ac.map(function(af){var ag=iJ.extend({key:af,deleted:"ok"},ad);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new jA(function(ah,aj){ab._allDocs(ag,function(ak,al){return ak?aj(ak):(aa.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return aa.rows=af,aa})}function ie(ac){var aa=ac._compactionQueue[0],t=aa.opts,ab=aa.callback;ac.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(t.last_seq=ad.last_seq),ac._compact(t,function(ag,af){ag?ab(ag):ab(null,af),a0.nextTick(function(){ac._compactionQueue.shift(),ac._compactionQueue.length&&ie(ac)})})})}function a8(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function j(ab,ad,t,ac){ad.seq=ad.seq||0;var aa={doc_ids:["_design/"+t],limit:1,since:ad.seq};ab.changes(aa).then(function(ag){var af=ag.results&&ag.results.length&&ag.results[0].seq;af&&af>ad.seq&&(ad.seq=af,delete ad.promise),ac()})["catch"](ac)}function fk(ac,aa,ab){ac._ddocCache=ac._ddocCache||{},ac._ddocCache[aa]=ac._ddocCache[aa]||{};var t=ac._ddocCache[aa];j(ac,t,aa,function(ad){return ad?ab(ad):(t.promise||(t.promise=new jA(function(af,ag){ac._get("_design/"+aa,{},function(ah,aj){if(ah){return ag(ah)}var ak={};["views","filters"].forEach(function(al){ak[al]=aj.doc[al]}),af(ak)})})),void t.promise.then(function(af){ab(null,af)})["catch"](ab))})}function ig(ab,ad,t,ac,aa){fk(ab,ad,function(ag,ah){if(ag){return aa(ag)}var af=ah[t]&&ah[t][ac];return af?void aa(null,af):aa(hK(u))})}function jf(){jy.EventEmitter.call(this)}function iS(){this.isReady=!1,this.failed=!1,this.queue=[]}function v(t){t&&ib.debug&&console.error(t)}function fU(aa,ac){function ag(){ad.emit("destroyed",t)}function ab(){aa.removeListener("destroyed",ag),aa.emit("destroyed",aa)}var t=ac.originalName,ad=aa.constructor,af=ad._destructionListeners;aa.once("destroyed",ag),af.has(t)||af.set(t,[]),af.get(t).push(ab)}function gy(ab,ad,t){if(!(this instanceof gy)){return new gy(ab,ad,t)}var ac=this;"function"!=typeof ad&&"undefined"!=typeof ad||(t=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),"undefined"==typeof t&&(t=v),ab=ab||ad.name,ad=iC(ad),delete ad.name,this.__opts=ad;var aa=t;ac.auto_compaction=ad.auto_compaction,ac.prefix=gy.prefix,jf.call(ac),ac.taskqueue=new iS;var af=new jA(function(ag,aj){t=function(ap,am){return ap?aj(ap):(delete am.then,void ag(am))},ad=iC(ad);var al,ah,ak=ad.name||ab;return function(){try{if("string"!=typeof ak){throw ah=new Error("Missing/invalid DB name"),ah.code=400,ah}if(al=gy.parseAdapter(ak,ad),ad.originalName=ak,ad.name=al.name,ad.prefix&&"http"!==al.adapter&&"https"!==al.adapter&&(ad.name=ad.prefix+ad.name),ad.adapter=ad.adapter||al.adapter,ac._adapter=ad.adapter,iG("pouchdb:adapter")("Picked adapter: "+ad.adapter),ac._db_name=ak,!gy.adapters[ad.adapter]){throw ah=new Error("Adapter is missing"),ah.code=404,ah}if(!gy.adapters[ad.adapter].valid()){throw ah=new Error("Invalid Adapter"),ah.code=404,ah}}catch(am){ac.taskqueue.fail(am)}}(),ah?aj(ah):(ac.adapter=ad.adapter,ac.replicate={},ac.replicate.from=function(aq,am,ap){return ac.constructor.replicate(aq,ac,am,ap)},ac.replicate.to=function(aq,am,ap){return ac.constructor.replicate(ac,aq,am,ap)},ac.sync=function(aq,am,ap){return ac.constructor.sync(ac,aq,am,ap)},ac.replicate.sync=ac.sync,void gy.adapters[ad.adapter].call(ac,ad,function(am){return am?(ac.taskqueue.fail(am),void t(am)):(fU(ac,ad),ac.emit("created",ac),gy.emit("created",ad.originalName),ac.taskqueue.ready(ac),void t(null,ac))}))});af.then(function(ag){aa(null,ag)},aa),ac.then=af.then.bind(af),ac["catch"]=af["catch"].bind(af)}function iP(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function gv(){return hp}function iX(t){Object.keys(jy.EventEmitter.prototype).forEach(function(ab){"function"==typeof jy.EventEmitter.prototype[ab]&&(t[ab]=i8[ab].bind(i8))});var aa=t._destructionListeners=new gA.Map;t.on("destroyed",function(ab){aa.has(ab)&&(aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab))})}function hB(ab,ad){ab=ab||[],ad=ad||{};try{return new Blob(ab,ad)}catch(t){if("TypeError"!==t.name){throw t}for(var ac="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,aa=new ac,af=0;af<ab.length;af+=1){aa.append(ab[af])}return aa.getBlob(ad.type)}}function i9(t,aa){if("undefined"==typeof FileReader){return aa((new FileReaderSync).readAsArrayBuffer(t))}var ab=new FileReader;ab.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);aa(ac)},ab.readAsArrayBuffer(t)}function jt(){for(var ac={},aa=new jA(function(af,ad){ac.resolve=af,ac.reject=ad}),ab=new Array(arguments.length),t=0;t<ab.length;t++){ab[t]=arguments[t]}return ac.promise=aa,jA.resolve().then(function(){return fetch.apply(null,ab)}).then(function(ad){ac.resolve(ad)})["catch"](function(ad){ac.reject(ad)}),ac}function gp(aa,ac){var ag,ab,t,ad=new Headers,af={method:aa.method,credentials:"include",headers:ad};return aa.json&&(ad.set("Accept","application/json"),ad.set("Content-Type",aa.headers["Content-Type"]||"application/json")),aa.body&&aa.body instanceof Blob?i9(aa.body,function(ah){af.body=ah}):aa.body&&aa.processData&&"string"!=typeof aa.body?af.body=JSON.stringify(aa.body):"body" in aa?af.body=aa.body:af.body=null,Object.keys(aa.headers).forEach(function(ah){aa.headers.hasOwnProperty(ah)&&ad.set(ah,aa.headers[ah])}),ag=jt(aa.url,af),aa.timeout>0&&(ab=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+aa.url))},aa.timeout)),ag.promise.then(function(ah){return t={statusCode:ah.status},aa.timeout>0&&clearTimeout(ab),t.statusCode>=200&&t.statusCode<300?aa.binary?ah.blob():ah.text():ah.json()}).then(function(ah){t.statusCode>=200&&t.statusCode<300?ac(null,t,ah):ac(ah,t)})["catch"](function(ah){ac(ah,t)}),{abort:ag.reject}}function a2(ab,aa){var ad,ag,af=!1,ac=function(){ad.abort()},aj=function(){af=!0,ad.abort()};ad=ab.xhr?new ab.xhr:new XMLHttpRequest;try{ad.open(ab.method,ab.url)}catch(ah){aa(ah,{statusCode:413})}ad.withCredentials="withCredentials" in ab?ab.withCredentials:!0,"GET"===ab.method?delete ab.headers["Content-Type"]:ab.json&&(ab.headers.Accept="application/json",ab.headers["Content-Type"]=ab.headers["Content-Type"]||"application/json",ab.body&&ab.processData&&"string"!=typeof ab.body&&(ab.body=JSON.stringify(ab.body))),ab.binary&&(ad.responseType="arraybuffer"),"body" in ab||(ab.body=null);for(var t in ab.headers){ab.headers.hasOwnProperty(t)&&ad.setRequestHeader(t,ab.headers[t])}return ab.timeout>0&&(ag=setTimeout(aj,ab.timeout),ad.onprogress=function(){clearTimeout(ag),4!==ad.readyState&&(ag=setTimeout(aj,ab.timeout))},"undefined"!=typeof ad.upload&&(ad.upload.onprogress=ad.onprogress)),ad.onreadystatechange=function(){if(4===ad.readyState){var ak={statusCode:ad.status};if(ad.status>=200&&ad.status<300){var am;am=ab.binary?hB([ad.response||""],{type:ad.getResponseHeader("Content-Type")}):ad.responseText,aa(null,ak,am)}else{var ap={};if(af){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ad.response)}catch(al){}}aa(ap,ak)}}},ab.body&&ab.body instanceof Blob?i9(ab.body,function(ak){ad.send(ak)}):ad.send(ab.body),{abort:ac}}function L(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function hH(t,aa){return iO||t.xhr?a2(t,aa):gp(t,aa)}function hW(){return""}function iw(ab,ad){function t(aj,af,ah){if(!ab.binary&&ab.json&&"string"==typeof aj){try{aj=JSON.parse(aj)}catch(ag){return ah(ag)}}Array.isArray(aj)&&(aj=aj.map(function(ak){return ak.error||ak.missing?h3(ak):ak})),ab.binary&&ew(aj,af),ah(null,aj,af)}function ac(af,ah){var ak,ag;if(af.code&&af.status){var al=new Error(af.message||af.code);return al.status=af.status,ah(al)}if(af.message&&"ETIMEDOUT"===af.message){return ah(af)}try{ak=JSON.parse(af.responseText),ag=h3(ak)}catch(aj){ag=h3(af)}ah(ag)}ab=iC(ab);var aa={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ab=iJ.extend(aa,ab),ab.json&&(ab.binary||(ab.headers.Accept="application/json"),ab.headers["Content-Type"]=ab.headers["Content-Type"]||"application/json"),ab.binary&&(ab.encoding=null,ab.json=!1),ab.processData||(ab.json=!1),hH(ab,function(af,aj,al){if(af){return af.status=aj?aj.statusCode:400,ac(af,ad)}var ah,ak=aj.headers&&aj.headers["content-type"],am=al||hW();if(!ab.binary&&(ab.json||!ab.processData)&&"object"!=typeof am&&(/json/.test(ak)||/^[\s]*\{/.test(am)&&/\}[\s]*$/.test(am))){try{am=JSON.parse(am.toString())}catch(ag){}}aj.statusCode>=200&&aj.statusCode<300?t(am,aj,ad):(ah=h3(am),ah.status=aj.statusCode,ad(ah))})}function i7(ak,ah){var ac=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",af=-1!==ac.indexOf("safari")&&-1===ac.indexOf("chrome"),ad=-1!==ac.indexOf("msie"),aa=-1!==ac.indexOf("edge"),aj=af||(ad||aa)&&"GET"===ak.method,ag="cache" in ak?ak.cache:!0,t=/^blob:/.test(ak.url);if(!t&&(aj||!ag)){var ab=-1!==ak.url.indexOf("?");ak.url+=(ab?"&":"?")+"_nonce="+Date.now()}return iw(ak,ah)}function G(aa){for(var ac=gk.exec(aa),ag={},ab=14;ab--;){var t=ar[ab],ad=ac[ab]||"",af=-1!==["user","password"].indexOf(t);ag[t]=af?decodeURIComponent(ad):ad}return ag[ez]={},ag[ar[12]].replace(gn,function(ah,ak,aj){ak&&(ag[ez][ak]=aj)}),ag}function gx(ab){for(var ad=ab.length,t=new ArrayBuffer(ad),ac=new Uint8Array(t),aa=0;ad>aa;aa++){ac[aa]=ab.charCodeAt(aa)}return t}function hT(t,aa){return hB([gx(t)],{type:aa})}function hN(ab,ad,t){try{return !ab(ad,t)}catch(ac){var aa="Filter function threw: "+ac.toString();return hK(g4,aa)}}function m(t){var aa={},ab=t.filter&&"function"==typeof t.filter;return aa.query=t.query_params,function(ad){ad.doc||(ad.doc={});var ac=ab&&hN(t.filter,ad.doc,aa);if("object"==typeof ac){return ac}if(ac){return !1}if(t.include_docs){if(!t.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function jd(t,aa){"console" in ib&&"info" in console&&console.info("The above "+t+" is totally normal. "+aa)}function gL(ab,ad,t,ac,aa){return ab.get(ad)["catch"](function(af){if(404===af.status){return"http"===ab.type()&&jd(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ac,_id:ad,history:[],replicator:gN,version:ii}}throw af}).then(function(af){return aa.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ac}),af.history.unshift({last_seq:t,session_id:ac}),af.history=af.history.slice(0,i3),af.version=ii,af.replicator=gN,af.session_id=ac,af.last_seq=t,ab.put(af)["catch"](function(ag){if(409===ag.status){return gL(ab,ad,t,ac,aa)}throw ag}))})}function h8(ac,aa,ab,t){this.src=ac,this.target=aa,this.id=ab,this.returnValue=t}function hd(ac,aa){if(ac.session_id===aa.session_id){return{last_seq:ac.last_seq,history:ac.history||[]}}var ab=ac.history||[],t=aa.history||[];return fx(ab,t)}function fx(aa,ah){var ad=aa[0],ag=aa.slice(1),af=ah[0],t=ah.slice(1);if(!ad||0===ah.length){return{last_seq:iV,history:[]}}var ab=ad.session_id;if(hq(ab,ah)){return{last_seq:ad.last_seq,history:aa}}var ac=af.session_id;return hq(ac,ag)?{last_seq:af.last_seq,history:t}:fx(ag,t)}function hq(ac,aa){var ab=aa[0],t=aa.slice(1);return ac&&0!==aa.length?ac===ab.session_id?!0:hq(ac,t):!1}function iB(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function ae(ac,aa){ac=parseInt(ac,10)||0,aa=parseInt(aa,10),aa!==aa||ac>=aa?aa=(ac||1)<<1:aa+=1;var ab=Math.random(),t=aa-ac;return ~~(t*ab+ac)}function id(t){var aa=0;return t||(aa=2000),ae(t,aa)}function iR(ac,aa,ab,t){return ac.retry===!1?(aa.emit("error",ab),void aa.removeAllListeners()):("function"!=typeof ac.back_off_function&&(ac.back_off_function=id),aa.emit("requestError",ab),"active"!==aa.state&&"pending"!==aa.state||(aa.emit("paused",ab),aa.state="stopped",aa.once("active",function(){ac.current_back_off=K})),ac.current_back_off=ac.current_back_off||K,ac.current_back_off=ac.back_off_function(ac.current_back_off),void setTimeout(t,ac.current_back_off))}function g5(t){return hz(t)}function ia(ac,aa,ab,t){(ab>0||t<aa.byteLength)&&(aa=new Uint8Array(aa,ab,Math.min(t,aa.byteLength)-ab)),ac.append(aa)}function fZ(ac,aa,ab,t){(ab>0||t<aa.length)&&(aa=aa.substring(ab,t)),ac.appendBinary(aa)}function g9(t){return Object.keys(t).sort(gf.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function M(aa,ac,ag){var ab=ag.doc_ids?ag.doc_ids.sort(gf.collate):"",t=ag.filter?ag.filter.toString():"",ad="",af="";return ag.filter&&ag.query_params&&(ad=JSON.stringify(g9(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),jA.all([aa.id(),ac.id()]).then(function(aj){var ah=aj[0]+aj[1]+t+af+ad+ab;return hw(ah)}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function dt(t){return/^1-/.test(t)}function s(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0,attachments:!0,binary:!0}}function hn(ab,ah,ac){function af(){var al=s(ah);if(al.docs.length){return ab.bulkGet(al).then(function(am){if(ac.cancelled){throw new Error("cancelled")}am.results.forEach(function(ap){ap.docs.forEach(function(aq){aq.ok?ak.push(aq.ok):void 0!==aq.error&&(t=!1)})})})}}function ag(al){return al._attachments&&Object.keys(al._attachments).length>0}function ad(al){return ab.allDocs({keys:al,include_docs:!0}).then(function(am){if(ac.cancelled){throw new Error("cancelled")}am.rows.forEach(function(ap){!ap.deleted&&ap.doc&&dt(ap.value.rev)&&!ag(ap.doc)&&(ak.push(ap.doc),delete ah[ap.id])})})}function aa(){var al=Object.keys(ah).filter(function(ap){var am=ah[ap].missing;return 1===am.length&&dt(am[0])});return al.length>0?ad(al):void 0}function aj(){return{ok:t,docs:ak}}ah=iC(ah);var ak=[],t=!0;return jA.resolve().then(aa).then(af).then(aj)}function i4(al,ab,aG,aL,aH){function aA(){return ax?jA.resolve():M(al,ab,aG).then(function(aS){aQ=aS,ax=new h8(al,ab,aQ,aL)})}function aM(){if(aO=[],0!==ap.docs.length){var aS=ap.docs;return ab.bulkDocs({docs:aS,new_edits:!1}).then(function(aV){if(aL.cancelled){throw aI(),new Error("cancelled")}var aT=[],aW={};aV.forEach(function(aY){aY.error&&(aH.doc_write_failures++,aT.push(aY),aW[aY.id]=aY)}),am=am.concat(aT),aH.docs_written+=ap.docs.length-aT.length;var aX=aT.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aW[aZ._id];aY?aL.emit("denied",iC(aY)):aO.push(aZ)}),aX.length>0){var aU=new Error("bulkDocs error");throw aU.other_errors=aT,az("target.bulkDocs failed to write docs",aU),new Error("bulkWrite partial failure")}},function(aT){throw aH.doc_write_failures+=aS.length,aT})}}function aa(){if(ap.error){throw new Error("There was a problem getting docs.")}aH.last_seq=aq=ap.seq;var aS=iC(aH);return aO.length&&(aS.docs=aO,aL.emit("change",aS)),aw=!0,ax.writeCheckpoint(ap.seq,ak).then(function(){if(aw=!1,aL.cancelled){throw aI(),new Error("cancelled")}ap=void 0,aE()})["catch"](function(aT){throw aw=!1,az("writeCheckpoint completed with error",aT),aT})}function ah(){var aS={};return ap.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),ab.revsDiff(aS).then(function(aT){if(aL.cancelled){throw aI(),new Error("cancelled")}ap.diffs=aT})}function av(){return hn(al,ap.diffs,aL).then(function(aS){ap.error=!aS.ok,aS.docs.forEach(function(aT){delete ap.diffs[aT._id],aH.docs_read++,ap.docs.push(aT)})})}function aD(){if(!aL.cancelled&&!ap){if(0===aC.length){return void ag(!0)}ap=aC.shift(),ah().then(av).then(aM).then(aa).then(aD)["catch"](function(aS){az("batch processing terminated with error",aS)})}}function ag(aS){return 0===aJ.changes.length?void (0!==aC.length||ap||((aB&&aR.live||aN)&&(aL.state="pending",aL.emit("paused")),aN&&aI())):void ((aS||aN||aJ.changes.length>=aP)&&(aC.push(aJ),aJ={seq:0,changes:[],docs:[]},"pending"!==aL.state&&"stopped"!==aL.state||(aL.state="active",aL.emit("active")),aD()))}function az(aS,aT){aF||(aT.message||(aT.message=aS),aH.ok=!1,aH.status="aborting",aH.errors.push(aT),am=am.concat(aT),aC=[],aJ={seq:0,changes:[],docs:[]},aI())}function aI(){if(!(aF||aL.cancelled&&(aH.status="cancelled",aw))){aH.status=aH.status||"complete",aH.end_time=new Date,aH.last_seq=aq,aF=!0;var aS=am.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=am.pop();am.length>0&&(aT.other_errors=am),aT.result=aH,iR(aG,aL,aT,function(){i4(al,ab,aG,aL)})}else{aH.errors=am,aL.emit("complete",aH),aL.removeAllListeners()}}}function aj(aS){if(aL.cancelled){return aI()}var aT=m(aG)(aS);aT&&(aJ.seq=aS.seq,aJ.changes.push(aS),ag(aR.live))}function t(aS){return af=!1,aL.cancelled?aI():(aS.results.length>0?(aR.since=aS.last_seq,aE()):aB?(aR.live=!0,aE()):aN=!0,void ag(!0))}function aK(aS){return af=!1,aL.cancelled?aI():void az("changes rejected",aS)}function aE(){function aS(){aT.cancel()}function aU(){aL.removeListener("cancel",aS)}if(!af&&!aN&&aC.length<ad){af=!0,aL._changes&&(aL.removeListener("cancel",aL._abortChanges),aL._changes.cancel()),aL.once("cancel",aS);var aT=al.changes(aR).on("change",aj);aT.then(aU,aU),aT.then(t)["catch"](aK),aG.retry&&(aL._changes=aT,aL._abortChanges=aS)}}function ay(){aA().then(function(){return aL.cancelled?void aI():ax.getCheckpoint().then(function(aS){aq=aS,aR={since:aq,limit:aP,batch_size:aP,style:"all_docs",doc_ids:au,return_docs:!0},aG.filter&&("string"!=typeof aG.filter?aR.include_docs=!0:aR.filter=aG.filter),"heartbeat" in aG&&(aR.heartbeat=aG.heartbeat),"timeout" in aG&&(aR.timeout=aG.timeout),aG.query_params&&(aR.query_params=aG.query_params),aG.view&&(aR.view=aG.view),aE()})})["catch"](function(aS){az("getCheckpoint rejected with ",aS)})}function ac(aS){throw aw=!1,az("writeCheckpoint completed with error",aS),aS}var ap,aQ,ax,aC=[],aJ={seq:0,changes:[],docs:[]},aw=!1,aN=!1,aF=!1,aq=0,aB=aG.continuous||aG.live||!1,aP=aG.batch_size||100,ad=aG.batches_limit||10,af=!1,au=aG.doc_ids,am=[],aO=[],ak=iF();aH=aH||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aR={};return aL.ready(al,ab),aL.cancelled?void aI():(aL._addedListeners||(aL.once("cancel",aI),"function"==typeof aG.complete&&(aL.once("error",aG.complete),aL.once("complete",function(aS){aG.complete(null,aS)})),aL._addedListeners=!0),void ("undefined"==typeof aG.since?ay():aA().then(function(){return aw=!0,ax.writeCheckpoint(aG.since,ak)}).then(function(){return aw=!1,aL.cancelled?void aI():(aq=aG.since,void ay())})["catch"](ac)))}function fo(){jy.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new jA(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function jp(t,aa){var ab=aa.PouchConstructor;return"string"==typeof t?new ab(t,aa):t}function ev(aa,ac,ag,ab){if("function"==typeof ag&&(ab=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw hK(g4,"`doc_ids` filter parameter is not a list.")}ag.complete=ab,ag=iC(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var t=new fo(ag),ad=jp(aa,ag),af=jp(ac,ag);return i4(ad,af,ag,t),t}function eo(ac,aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"undefined"==typeof ab&&(ab={}),ab=iC(ab),ab.PouchConstructor=ab.PouchConstructor||this,ac=he.toPouch(ac,ab),aa=he.toPouch(aa,ab),new gU(ac,aa,ab,t)}function gU(am,ad,ac,ak){function af(ay){aq.emit("change",{direction:"pull",change:ay})}function t(ay){aq.emit("change",{direction:"push",change:ay})}function ag(ay){aq.emit("denied",{direction:"push",doc:ay})}function ab(ay){aq.emit("denied",{direction:"pull",doc:ay})}function av(){aq.pushPaused=!0,aq.pullPaused&&aq.emit("paused")}function aj(){aq.pullPaused=!0,aq.pushPaused&&aq.emit("paused")}function ap(){aq.pushPaused=!1,aq.pullPaused&&aq.emit("active",{direction:"push"})}function aa(){aq.pullPaused=!1,aq.pushPaused&&aq.emit("active",{direction:"pull"})}function al(ay){return function(aC,az){var aE="change"===aC&&(az===af||az===t),aA="denied"===aC&&(az===ab||az===ag),aD="paused"===aC&&(az===aj||az===av),aB="active"===aC&&(az===aa||az===ap);(aE||aA||aD||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&aq.removeAllListeners(aC))}}var aq=this;this.canceled=!1;var ah=ac.push?iJ.extend({},ac,ac.push):ac,aw=ac.pull?iJ.extend({},ac,ac.pull):ac;this.push=ex(am,ad,ah),this.pull=ex(ad,am,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ac.live&&(this.push.on("complete",aq.pull.cancel.bind(aq.pull)),this.pull.on("complete",aq.push.cancel.bind(aq.push))),this.on("newListener",function(ay){"change"===ay?(aq.pull.on("change",af),aq.push.on("change",t)):"denied"===ay?(aq.pull.on("denied",ab),aq.push.on("denied",ag)):"active"===ay?(aq.pull.on("active",aa),aq.push.on("active",ap)):"paused"===ay&&(aq.pull.on("paused",aj),aq.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(aq.pull.removeListener("change",af),aq.push.removeListener("change",t)):"denied"===ay?(aq.pull.removeListener("denied",ab),aq.push.removeListener("denied",ag)):"active"===ay?(aq.pull.removeListener("active",aa),aq.push.removeListener("active",ap)):"paused"===ay&&(aq.pull.removeListener("paused",aj),aq.push.removeListener("paused",av))}),this.pull.on("removeListener",al("pull")),this.push.on("removeListener",al("push"));var au=jA.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return aq.emit("complete",az),ak&&ak(null,az),aq.removeAllListeners(),az},function(ay){if(aq.cancel(),ak?ak(ay):aq.emit("error",ay),aq.removeAllListeners(),ak){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function hs(t,aa){return hT(il(t),aa)}function T(ab){for(var ad="",t=new Uint8Array(ab),ac=t.byteLength,aa=0;ac>aa;aa++){ad+=String.fromCharCode(t[aa])}return ad}function hQ(ac,aa){if("undefined"==typeof FileReader){return aa(T((new FileReaderSync).readAsArrayBuffer(ac)))}var ab=new FileReader,t="function"==typeof ab.readAsBinaryString;ab.onloadend=function(af){var ad=af.target.result||"";return t?aa(ad):void aa(T(ad))},t?ab.readAsBinaryString(ac):ab.readAsArrayBuffer(ac)}function ei(t){return new jA(function(aa){hQ(t,function(ab){aa(hz(ab))})})}function h(ac){for(var aa=[],ab=0,t=ac.length;t>ab;ab++){aa=aa.concat(ac[ab])}return aa}function ci(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=hs(ab.data,ab.content_type)})}function O(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function iu(t){return t._attachments&&Object.keys(t._attachments)?jA.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?ei(aa.data).then(function(ac){aa.data=ac}):void 0})):jA.resolve()}function i2(t){var aa=G(t);(aa.user||aa.password)&&(aa.auth={username:aa.user,password:aa.password});var ab=aa.path.replace(/(^\/|\/$)/g,"").split("/");return aa.db=ab.pop(),-1===aa.db.indexOf("%")&&(aa.db=encodeURIComponent(aa.db)),aa.path=ab.join("/"),aa}function a1(t,aa){return fr(t,t.db+"/"+aa)}function fr(t,aa){var ab=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+ab+aa}function hG(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function hJ(ac,ak){function af(ax,ay,aw){var aA=ax.ajax||{},az=iJ.extend(iC(ab),aA,ay);return F(az.method+" "+az.url),en.ajax(az,aw)}function aj(aw,ax){return new jA(function(ay,az){af(aw,ax,function(aA,aB){return aA?az(aA):void ay(aB)})})}function aa(aw,ax){return fY(aw,h5(function(ay){ap().then(function(){return ax.apply(this,ay)})["catch"](function(aA){var az=ay.pop();az(aA)})}))}function ap(){if(ac.skipSetup||ac.skip_setup){return jA.resolve()}if(am){return am}var aw={method:"GET",url:au};return am=aj({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(jd(404,"PouchDB is just detecting if the remote exists."),aj({},{method:"PUT",url:au})):jA.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:jA.reject(ax)}),am["catch"](function(){am=null}),am}function ah(aw){return aw.split("/").map(encodeURIComponent).join("/")}var aq=this,al=i2;ac.getHost&&(al=ac.getHost);var ag=al(ac.name,ac),au=a1(ag,"");ac=iC(ac);var ab=ac.ajax||{};if(aq.getUrl=function(){return au},aq.getHeaders=function(){return ab.headers||{}},ac.auth||ag.auth){var av=ac.auth||ag.auth,t=av.username+":"+av.password,ad=hz(unescape(encodeURIComponent(t)));ab.headers=ab.headers||{},ab.headers.Authorization="Basic "+ad}var am;setTimeout(function(){ak(null,aq)}),aq.type=function(){return"http"},aq.id=aa("id",function(aw){af({},{method:"GET",url:fr(ag,"")},function(ay,az){var ax=az&&az.uuid?az.uuid+ag.db:a1(ag,"");aw(null,ax)})}),aq.request=aa("request",function(aw,ax){aw.url=a1(ag,aw.url),af({},aw,ax)}),aq.compact=aa("compact",function(aw,ax){"function"==typeof aw&&(ax=aw,aw={}),aw=iC(aw),af(aw,{url:a1(ag,"_compact"),method:"POST"},function(){function ay(){aq.info(function(aA,az){az&&!az.compact_running?ax(null,{ok:!0}):setTimeout(ay,aw.interval||200)})}ay()})}),aq.bulkGet=fY("bulkGet",function(aA,aC){function ax(aE){var aD={};aA.revs&&(aD.revs=!0),aA.attachments&&(aD.attachments=!0),af({},{url:a1(ag,"_bulk_get"+hG(aD)),method:"POST",body:{docs:aA.docs}},aE)}function aB(){function aG(aK){return function(aL,aM){aF[aK]=aM.results,++aE===aI&&aC(null,{results:h(aF)})}}for(var aD=gi,aI=Math.ceil(aA.docs.length/aD),aE=0,aF=new Array(aI),aH=0;aI>aH;aH++){var aJ=hE(aA,["revs","attachments"]);aJ.ajax=ab,aJ.docs=aA.docs.slice(aH*aD,Math.min(aA.docs.length,(aH+1)*aD)),hi(aw,aJ,aG(aH))}}var aw=this,az=fr(ag,""),ay=gz[az];"boolean"!=typeof ay?ax(function(aE,aD){if(aE){var aF=Math.floor(aE.status/100);4===aF||5===aF?(gz[az]=!1,jd(aE.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aB()):aC(aE)}else{gz[az]=!0,aC(null,aD)}}):ay?ax(aC):aB()}),aq._info=function(aw){ap().then(function(){af({},{method:"GET",url:a1(ag,"")},function(ay,ax){return ay?aw(ay):(ax.host=a1(ag,""),void aw(null,ax))})})["catch"](aw)},aq.get=aa("get",function(aA,aC,aB){function ax(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?jA.all(aF.map(function(aH){var aI=aD[aH],aG=O(aE._id)+"/"+ah(aH)+"?rev="+aE._rev;return aj(aC,{method:"GET",url:a1(ag,aG),binary:!0}).then(function(aJ){return aC.binary?aJ:ei(aJ)}).then(function(aJ){delete aI.stub,delete aI.length,aI.data=aJ})})):void 0}function az(aD){return Array.isArray(aD)?jA.all(aD.map(function(aE){return aE.ok?ax(aE.ok):void 0})):ax(aD)}"function"==typeof aC&&(aB=aC,aC={}),aC=iC(aC);var aw={};aC.revs&&(aw.revs=!0),aC.revs_info&&(aw.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),aw.open_revs=aC.open_revs),aC.rev&&(aw.rev=aC.rev),aC.conflicts&&(aw.conflicts=aC.conflicts),aA=O(aA);var ay={method:"GET",url:a1(ag,aA+hG(aw))};aj(aC,ay).then(function(aD){return jA.resolve().then(function(){return aC.attachments?az(aD):void 0}).then(function(){aB(null,aD)})})["catch"](aB)}),aq.remove=aa("remove",function(aB,az,ax,ay){var aw;"string"==typeof az?(aw={_id:aB,_rev:az},"function"==typeof ax&&(ay=ax,ax={})):(aw=aB,"function"==typeof az?(ay=az,ax={}):(ay=ax,ax=az));var aA=aw._rev||ax.rev;af(ax,{method:"DELETE",url:a1(ag,O(aw._id))+"?rev="+aA},ay)}),aq.getAttachment=aa("getAttachment",function(aB,az,ax,ay){"function"==typeof ax&&(ay=ax,ax={});var aw=ax.rev?"?rev="+ax.rev:"",aA=a1(ag,O(aB))+"/"+ah(az)+aw;af(ax,{method:"GET",url:aA,binary:!0},ay)}),aq.removeAttachment=aa("removeAttachment",function(ax,aA,ay,az){var aw=a1(ag,O(ax)+"/"+ah(aA))+"?rev="+ay;af({},{method:"DELETE",url:aw},az)}),aq.putAttachment=aa("putAttachment",function(aA,aG,aF,aE,aD,ay){"function"==typeof aD&&(ay=aD,aD=aE,aE=aF,aF=null);var ax=O(aA)+"/"+ah(aG),az=a1(ag,ax);if(aF&&(az+="?rev="+aF),"string"==typeof aE){var aB;try{aB=il(aE)}catch(aw){return ay(hK(gB,"Attachment is not a valid base64 string"))}aE=aB?hT(aB,aD):""}var aC={headers:{"Content-Type":aD},method:"PUT",url:az,processData:!1,body:aE,timeout:ab.timeout||60000};af({},aC,ay)}),aq._bulkDocs=function(ax,aw,ay){ax.new_edits=aw.new_edits,ap().then(function(){return jA.all(ax.docs.map(iu))}).then(function(){af(aw,{method:"POST",url:a1(ag,"_bulk_docs"),body:ax},function(az,aA){return az?ay(az):(aA.forEach(function(aB){aB.ok=!0}),void ay(null,aA))})})["catch"](ay)},aq.allDocs=aa("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=iC(aA);var ax,aB={},az="GET";aA.conflicts&&(aB.conflicts=!0),aA.descending&&(aB.descending=!0),aA.include_docs&&(aB.include_docs=!0),aA.attachments&&(aB.attachments=!0),aA.key&&(aB.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(aB.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(aB.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(aB.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(aB.limit=aA.limit),"undefined"!=typeof aA.skip&&(aB.skip=aA.skip);var ay=hG(aB);if("undefined"!=typeof aA.keys){var aw="keys="+encodeURIComponent(JSON.stringify(aA.keys));aw.length+ay.length+1<=hI?ay+="&"+aw:(az="POST",ax={keys:aA.keys})}aj(aA,{method:az,url:a1(ag,"_all_docs"+ay),body:ax}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(ci),aC(null,aD)})["catch"](aC)}),aq._changes=function(aw){var aJ="batch_size" in aw?aw.batch_size:io;aw=iC(aw),aw.timeout="timeout" in aw?aw.timeout:"timeout" in ab?ab.timeout:30000;var aB,az=aw.timeout?{timeout:aw.timeout-5000}:{},aD="undefined"!=typeof aw.limit?aw.limit:!1;aB="return_docs" in aw?aw.return_docs:"returnDocs" in aw?aw.returnDocs:!0;var aF=aD;if(aw.style&&(az.style=aw.style),(aw.include_docs||aw.filter&&"function"==typeof aw.filter)&&(az.include_docs=!0),aw.attachments&&(az.attachments=!0),aw.continuous&&(az.feed="longpoll"),aw.conflicts&&(az.conflicts=!0),aw.descending&&(az.descending=!0),"heartbeat" in aw?aw.heartbeat&&(az.heartbeat=aw.heartbeat):az.heartbeat=10000,aw.filter&&"string"==typeof aw.filter&&(az.filter=aw.filter,"_view"===aw.filter&&aw.view&&"string"==typeof aw.view&&(az.view=aw.view)),aw.query_params&&"object"==typeof aw.query_params){for(var aH in aw.query_params){aw.query_params.hasOwnProperty(aH)&&(az[aH]=aw.query_params[aH])}}var ay,aA="GET";if(aw.doc_ids){az.filter="_doc_ids";var aC=JSON.stringify(aw.doc_ids);aC.length<hI?az.doc_ids=aC:(aA="POST",ay={doc_ids:aw.doc_ids})}var aE,aG,aI=function(aL,aM){if(!aw.aborted){az.since=aL,"object"==typeof az.since&&(az.since=JSON.stringify(az.since)),aw.descending?aD&&(az.limit=aF):az.limit=!aD||aF>aJ?aJ:aF;var aN={method:aA,url:a1(ag,"_changes"+hG(az)),timeout:aw.timeout,body:ay};aG=aL,aw.aborted||ap().then(function(){aE=af(aw,aN,aM)})["catch"](aM)}},aK={results:[]},ax=function(aM,aP){if(!aw.aborted){var aO=0;if(aP&&aP.results){aO=aP.results.length,aK.last_seq=aP.last_seq;var aL={};aL.query=aw.query_params,aP.results=aP.results.filter(function(aR){aF--;var aQ=m(aw)(aR);return aQ&&(aw.include_docs&&aw.attachments&&aw.binary&&ci(aR),aB&&aK.results.push(aR),aw.onChange(aR)),aQ})}else{if(aM){return aw.aborted=!0,void aw.complete(aM)}}aP&&aP.last_seq&&(aG=aP.last_seq);var aN=aD&&0>=aF||aP&&aJ>aO||aw.descending;(!aw.continuous||aD&&0>=aF)&&aN?aw.complete(null,aK):setTimeout(function(){aI(aG,ax)},0)}};return aI(aw.since||0,ax),{cancel:function(){aw.aborted=!0,aE&&aE.abort()}}},aq.revsDiff=aa("revsDiff",function(ax,aw,ay){"function"==typeof aw&&(ay=aw,aw={}),af(aw,{method:"POST",url:a1(ag,"_revs_diff"),body:ax},ay)}),aq._close=function(aw){aw()},aq._destroy=function(ax,aw){af(ax,{url:a1(ag,""),method:"DELETE"},function(ay,az){return ay&&ay.status&&404!==ay.status?aw(ay):(aq.emit("destroyed"),aq.constructor.emit("destroyed",ac.name),void aw(null,az))})}}function gb(){this.promise=new jA(function(t){t()})}function ct(t){return fT.hash(t)}function a5(aa){var ah=aa.db,ad=aa.viewName,ag=aa.map,af=aa.reduce,t=aa.temporary,ab=ag.toString()+(af&&af.toString())+"undefined";if(!t&&ah._cachedViews){var ac=ah._cachedViews[ab];if(ac){return jA.resolve(ac)}}return ah.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ad;-1===aq.indexOf("/")&&(aq=ad+"/"+ad);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(t?"temp":ct(ab));return hj(ah,"_local/mrviews",al).then(function(){return ah.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ah,adapter:ah.adapter,mapFun:ag,reduceFun:af};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,t||(ah._cachedViews=ah._cachedViews||{},ah._cachedViews[ab]=aq,aq.db.once("destroyed",function(){delete ah._cachedViews[ab]})),aq})})})})}function gV(ab,ad,t,ac,aa,af){return br("return ("+ab.replace(/;\s*$/,"")+");",{emit:ad,sum:t,log:ac,isArray:aa,toJSON:af})}function fe(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function B(t){return 1===t.length&&/^1-/.test(t[0].rev)}function fn(t,aa){try{t.emit("error",aa)}catch(ab){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(aa)}}function an(ac,aa,ab){try{return{output:aa.apply(null,ab)}}catch(t){return fn(ac,t),{error:t}}}function o(t,aa){var ab=hX(t.key,aa.key);return 0!==ab?ab:hX(t.value,aa.value)}function q(t,aa,ab){return ab=ab||0,"number"==typeof aa?t.slice(ab,aa+ab):ab>0?t.slice(ab):t}function fv(t){var aa=t.value,ab=aa&&"object"==typeof aa&&aa._id||t.id;return ab}function gF(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=hs(ac.data,ac.content_type)})})}function V(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&gF(aa),aa}}function gZ(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new fc(aa)}function J(aa){for(var ah=0,ad=0,ag=aa.length;ag>ad;ad++){var af=aa[ad];if("number"!=typeof af){if(!Array.isArray(af)){throw gZ("_sum")}ah="number"==typeof ah?[ah]:ah;for(var t=0,ab=af.length;ab>t;t++){var ac=af[t];if("number"!=typeof ac){throw gZ("_sum")}"undefined"==typeof ah[t]?ah.push(ac):ah[t]+=ac}}else{"number"==typeof ah?ah+=af:ah[0]+=af}}return ah}function iW(ab,ad,t,ac){var aa=ad[ab];"undefined"!=typeof aa&&(ac&&(aa=encodeURIComponent(JSON.stringify(aa))),t.push(ab+"="+aa))}function gl(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function g1(t){return t.group_level=gl(t.group_level),t.limit=gl(t.limit),t.skip=gl(t.skip),t}function iK(t){if(t){if("number"!=typeof t){return new be('Invalid value for integer: "'+t+'"')}if(0>t){return new be('Invalid value for positive integer: "'+t+'"')}}}function ao(ac,aa){var ab=ac.descending?"endkey":"startkey",t=ac.descending?"startkey":"endkey";if("undefined"!=typeof ac[ab]&&"undefined"!=typeof ac[t]&&hX(ac[ab],ac[t])>0){throw new be("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(aa.reduce&&ac.reduce!==!1){if(ac.include_docs){throw new be("{include_docs:true} is invalid for reduce")}if(ac.keys&&ac.keys.length>1&&!ac.group&&!ac.group_level){throw new be("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=iK(ac[af]);if(ad){throw ad}})}function hD(ab,aa,ad){var ag,af=[],ac="GET";if(iW("reduce",ad,af),iW("include_docs",ad,af),iW("attachments",ad,af),iW("limit",ad,af),iW("descending",ad,af),iW("group",ad,af),iW("group_level",ad,af),iW("skip",ad,af),iW("stale",ad,af),iW("conflicts",ad,af),iW("startkey",ad,af,!0),iW("start_key",ad,af,!0),iW("endkey",ad,af,!0),iW("end_key",ad,af,!0),iW("inclusive_end",ad,af),iW("key",ad,af,!0),af=af.join("&"),af=""===af?"":"?"+af,"undefined"!=typeof ad.keys){var aj=2000,ah="keys="+encodeURIComponent(JSON.stringify(ad.keys));ah.length+af.length+1<=aj?af+=("?"===af[0]?"&":"?")+ah:(ac="POST","string"==typeof aa?ag={keys:ad.keys}:aa.keys=ad.keys)}if("string"==typeof aa){var t=fe(aa);return ab.request({method:ac,url:"_design/"+t[0]+"/_view/"+t[1]+af,body:ag}).then(V(ad))}return ag=ag||{},Object.keys(aa).forEach(function(ak){Array.isArray(aa[ak])?ag[ak]=aa[ak]:ag[ak]=aa[ak].toString()}),ab.request({method:"POST",url:"_temp_view"+af,body:ag}).then(V(ad))}function fX(t,aa,ab){return new jA(function(ad,ac){t._query(aa,ab,function(af,ag){return af?ac(af):void ad(ag)})})}function hc(t){return new jA(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function hV(t){return function(aa){if(404===aa.status){return t}throw aa}}function gI(ac,aj,ad){function ag(){return B(t)?jA.resolve(ak):aj.db.get(aa)["catch"](hV(ak))}function ah(am){return am.keys.length?aj.db.allDocs({keys:am.keys,include_docs:!0}):jA.resolve({rows:[]})}function af(am,ay){for(var au=[],aw={},av=0,aq=ay.rows.length;aq>av;av++){var aA=ay.rows[av],ax=aA.doc;if(ax&&(au.push(ax),aw[ax._id]=!0,ax._deleted=!al[ax._id],!ax._deleted)){var az=al[ax._id];"value" in az&&(ax.value=az.value)}}var ap=Object.keys(al);return ap.forEach(function(aD){if(!aw[aD]){var aB={_id:aD},aC=al[aD];"value" in aC&&(aB.value=aC.value),au.push(aB)}}),am.keys=i(ap.concat(am.keys)),au.push(am),au}var aa="_local/doc_"+ac,ak={_id:aa,keys:[]},ab=ad[ac],al=ab.indexableKeysToKeyValues,t=ab.changes;return ag().then(function(am){return ah(am).then(function(ap){return af(am,ap)})})}function fd(ac,aa,ab){var t="_local/lastSeq";return ac.db.get(t)["catch"](hV({_id:t,seq:0})).then(function(af){var ad=Object.keys(aa);return jA.all(ad.map(function(ag){return gI(ag,ac,aa)})).then(function(ag){var ah=h(ag);return af.seq=ab,ah.push(af),ac.db.bulkDocs({docs:ah})})})}function k(t){var aa="string"==typeof t?t:t.name,ab=h6[aa];return ab||(ab=h6[aa]=new gb),ab}function p(t){return iM(k(t),function(){return es(t)})()}function es(ab){function aa(am,ak){var al={id:af._id,key:g7(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=g7(ak)),ag.push(al)}function ad(ak,al){return function(){return fd(ab,ak,al)}}var ag,af,ac;if("function"==typeof ab.mapFun&&2===ab.mapFun.length){var aj=ab.mapFun;ac=function(ak){return aj(ak,aa)}}else{ac=gV(ab.mapFun.toString(),aa,J,h1,Array.isArray,JSON.parse)}var ah=ab.seq||0,t=new gb;return new jA(function(ap,ak){function al(){t.finish().then(function(){ab.seq=ah,ap()})}function am(){function aq(au){ak(au)}ab.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ah,limit:iE}).on("complete",function(aA){var aF=aA.results;if(!aF.length){return al()}for(var aE={},av=0,ax=aF.length;ax>av;av++){var aD=aF[av];if("_"!==aD.doc._id[0]){ag=[],af=aD.doc,af._deleted||an(ab.sourceDB,ac,[af]),ag.sort(o);for(var au,aC={},ay=0,az=ag.length;az>ay;ay++){var aw=ag[ay],aG=[aw.key,aw.id];0===hX(aw.key,au)&&aG.push(ay);var aB=fa(aG);aC[aB]=aw,au=aw.key}aE[aD.doc._id]={indexableKeysToKeyValues:aC,changes:aD.changes}}ah=aD.seq}return t.add(ad(aE,ah)),aF.length<iE?al():am()}).on("error",aq)}am()})}function E(ac,aj,ad){0===ad.group_level&&delete ad.group_level;var ag,ah=ad.group||ad.group_level;ag=ip[ac.reduceFun]?ip[ac.reduceFun]:gV(ac.reduceFun.toString(),null,J,h1,Array.isArray,JSON.parse);var af=[],aa=isNaN(ad.group_level)?Number.POSITIVE_INFINITY:ad.group_level;aj.forEach(function(aq){var am=af[af.length-1],ap=ah?aq.key:null;return ah&&Array.isArray(ap)&&(ap=ap.slice(0,aa)),am&&0===hX(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void af.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),aj=[];for(var ak=0,ab=af.length;ab>ak;ak++){var al=af[ak],t=an(ac.sourceDB,ag,[al.keys,al.values,!1]);if(t.error&&t.error instanceof fc){throw t.error}aj.push({value:t.error?null:t.output,key:al.groupKey})}return{rows:q(aj,ad.limit,ad.skip)}}function hv(t,aa){return iM(k(t),function(){return ce(t,aa)})()}function ce(t,ap){function ak(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return al=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=cr(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function am(au){var av;if(av=ah?E(t,au,ap):{total_rows:al,offset:ab,rows:au},ap.include_docs){var aq=i(au.map(fv));return t.sourceDB.allDocs({keys:aq,include_docs:!0,conflicts:ap.conflicts,attachments:ap.attachments,binary:ap.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),au.forEach(function(ay){var aA=fv(ay),az=ax["$"+aA];az&&(ay.doc=az)}),av})}return av}var al,ah=t.reduceFun&&ap.reduce!==!1,ab=ap.skip||0;if("undefined"==typeof ap.keys||ap.keys.length||(ap.limit=0,delete ap.keys),"undefined"!=typeof ap.keys){var ag=ap.keys,aa=ag.map(function(aq){var au={startkey:fa([aq]),endkey:fa([aq,{}])};return ak(au)});return jA.all(aa).then(h).then(am)}var ac={descending:ap.descending};if(ap.start_key&&(ap.startkey=ap.start_key),ap.end_key&&(ap.endkey=ap.end_key),"undefined"!=typeof ap.startkey&&(ac.startkey=fa(ap.descending?[ap.startkey,{}]:[ap.startkey])),"undefined"!=typeof ap.endkey){var af=ap.inclusive_end!==!1;ap.descending&&(af=!af),ac.endkey=fa(af?[ap.endkey,{}]:[ap.endkey])}if("undefined"!=typeof ap.key){var aj=fa([ap.key]),ad=fa([ap.key,{}]);ac.descending?(ac.endkey=aj,ac.startkey=ad):(ac.startkey=aj,ac.endkey=ad)}return ah||("number"==typeof ap.limit&&(ac.limit=ap.limit),ac.skip=ab),ak(ac).then(am)}function g(t){return t.request({method:"POST",url:"_view_cleanup"})}function S(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ag){var ad=fe(ag),ah="_design/"+ad[0],af=ad[1];aa[ah]=aa[ah]||{},aa[ah][af]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ag){var af={};ag.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){af[au]=af[au]||am})})});var ah=Object.keys(af).filter(function(aj){return !af[aj]}),ad=ah.map(function(aj){return iM(k(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return jA.all(ad).then(function(){return{ok:!0}})})},hV({ok:!0}))}function im(af,ac,aa){if("http"===af.type()){return hD(af,ac,aa)}if("function"==typeof af._query){return fX(af,ac,aa)}if("string"!=typeof ac){ao(aa,ac);var ad={db:af,viewName:"temp_view/temp_view",map:ac.map,reduce:ac.reduce,temporary:!0};return a3.add(function(){return a5(ad).then(function(ak){function aj(){return ak.db.destroy()}return at(p(ak).then(function(){return hv(ak,aa)}),aj)})}),a3.finish()}var ah=ac,ab=fe(ah),ag=ab[0],t=ab[1];return af.getView(ag,t).then(function(aj){ao(aa,aj);var ak={db:af,viewName:ah,map:aj.map,reduce:aj.reduce};return a5(ak).then(function(al){return"ok"===aa.stale||"update_after"===aa.stale?("update_after"===aa.stale&&a0.nextTick(function(){p(al)}),hv(al,aa)):p(al).then(function(){return hv(al,aa)})})})}function be(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,be)}catch(aa){}}function fc(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,fc)}catch(aa){}}function ga(t){return hz(T(t))}function gJ(aa,ah,ad){function ag(al){try{return il(al)}catch(aj){var ak=hK(gB,"Attachment is not a valid base64 string");return{error:ak}}}function af(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ag(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===ah?aj.data=hT(al,aj.content_type):"base64"===ah?aj.data=hz(al):aj.data=al,hw(al).then(function(am){aj.digest="md5-"+am,ak()})}else{i9(aj.data,function(am){"binary"===ah?aj.data=T(am):"base64"===ah&&(aj.data=ga(am)),hw(am).then(function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function t(){ac++,aa.length===ac&&(ab?ad(ab):ad())}if(!aa.length){return ad()}var ab,ac=0;aa.forEach(function(ak){function am(aq){ab=aq,al++,al===aj.length&&t()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return t()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&af(ak.data._attachments[ap],am)}})}function hO(t,aa){return t.pos-aa.pos}function iU(ab,ad,t){for(var ac,aa=0,af=ab.length;af>aa;){ac=aa+af>>>1,t(ab[ac],ad)<0?aa=ac+1:af=ac}return aa}function gD(ac,aa,ab){var t=iU(ac,aa,ab);ac.splice(t,0,aa)}function ir(aa,ah){for(var ad,ag,af=ah,t=aa.length;t>af;af++){var ab=aa[af],ac=[ab.id,ab.opts,[]];ag?(ag[2].push(ac),ag=ac):ad=ag=ac}return ad}function er(t,aa){return t[0]<aa[0]?-1:1}function g3(ak,ah){for(var ac=[{tree1:ak,tree2:ah}],af=!1;ac.length>0;){var ad=ac.pop(),aa=ad.tree1,aj=ad.tree2;(aa[1].status||aj[1].status)&&(aa[1].status="available"===aa[1].status||"available"===aj[1].status?"available":"missing");for(var ag=0;ag<aj[2].length;ag++){if(aa[2][0]){for(var t=!1,ab=0;ab<aa[2].length;ab++){aa[2][ab][0]===aj[2][ag][0]&&(ac.push({tree1:aa[2][ab],tree2:aj[2][ag]}),t=!0)}t||(af="new_branch",gD(aa[2],aj[2][ag],er))}else{af="new_leaf",aa[2][0]=aj[2][ag]}}}return{conflicts:af,tree:ak}}function a6(ap,ak,aq){var ab,av=[],al=!1,aa=!1;if(!ap.length){return{tree:[ak],conflicts:"new_leaf"}}for(var ah=0,aw=ap.length;aw>ah;ah++){var t=ap[ah];if(t.pos===ak.pos&&t.ids[0]===ak.ids[0]){ab=g3(t.ids,ak.ids),av.push({pos:t.pos,ids:ab.tree}),al=al||ab.conflicts,aa=!0}else{if(aq!==!0){var ad=t.pos<ak.pos?t:ak,am=t.pos<ak.pos?ak:t,ac=am.pos-ad.pos,aj=[],ax=[];for(ax.push({ids:ad.ids,diff:ac,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],ag=0,af=az.length;af>ag;ag++){ax.push({ids:az[ag],diff:ay.diff-1,parent:ay.ids,parentIdx:ag})}}else{ay.ids[0]===am.ids[0]&&aj.push(ay)}}var au=aj[0];au?(ab=g3(au.ids,am.ids),au.parent[2][au.parentIdx]=ab.tree,av.push({pos:ad.pos,ids:ad.ids}),al=al||ab.conflicts,aa=!0):av.push(t)}else{av.push(t)}}}return aa||av.push(ak),av.sort(hO),{tree:av,conflicts:al||"internal_node"}}function gY(t,ap){for(var ak,am=ft(t),al={},ah=0,ab=am.length;ab>ah;ah++){for(var ag=am[ah],aa=ag.ids,ac=Math.max(0,aa.length-ap),af={pos:ag.pos+ac,ids:ir(aa,ac)},aj=0;ac>aj;aj++){var ad=ag.pos+aj+"-"+aa[aj].id;al[ad]=!0}ak=ak?a6(ak,af,!0).tree:[af]}return hf(ak,function(av,aq,au){delete al[aq+"-"+au]}),{tree:ak,revs:Object.keys(al)}}function gj(ab,ad,t){var ac=a6(ab,ad),aa=gY(ac.tree,t);return{tree:aa.tree,stemmedRevs:aa.revs,conflicts:ac.conflicts}}function fu(ak,ah){for(var ac,af=ak.slice(),ad=ah.split("-"),aa=parseInt(ad[0],10),aj=ad[1];ac=af.pop();){if(ac.pos===aa&&ac.ids[0]===aj){return !0}for(var ag=ac.ids[2],t=0,ab=ag.length;ab>t;t++){af.push({pos:ac.pos+1,ids:ag[t]})}}return !1}function jn(af,am,au,ax,t,aa,ac,ak){if(fu(am.rev_tree,au.metadata.rev)){return ax[t]=au,aa()}var aw=am.winningRev||gQ(am),ad="deleted" in am?am.deleted:je(am,aw),ah="deleted" in au.metadata?au.metadata.deleted:je(au.metadata),az=/^1-/.test(au.metadata.rev);if(ad&&!ah&&ak&&az){var ag=au.data;ag._rev=aw,ag._id=au.metadata.id,au=gX(ag,ak)}var al=gj(am.rev_tree,au.metadata.rev_tree[0],af),av=ak&&(ad&&ah||!ad&&"new_leaf"!==al.conflicts||ad&&!ah&&"new_branch"===al.conflicts);if(av){var ay=hK(jC);return ax[t]=ay,aa()}var aq=au.metadata.rev;au.metadata.rev_tree=al.tree,au.stemmedRevs=al.stemmedRevs||[],am.rev_map&&(au.metadata.rev_map=am.rev_map);var aj,aA=gQ(au.metadata),ap=je(au.metadata,aA),ab=ad===ap?0:ap>ad?-1:1;aj=aq===aA?ap:je(au.metadata,aq),ac(au,aA,ap,aj,!0,ab,t,aa)}function jh(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function jv(aa,ag,ah,aq,am,ab,ak,af,aj){function al(aC,aw,aA){var az=gQ(aC.metadata),ax=je(aC.metadata,az);if("was_delete" in af&&ax){return ab[aw]=hK(u,"deleted"),aA()}var ay=ac&&jh(aC);if(ay){var av=hK(jC);return ab[aw]=av,aA()}var aB=ax?0:1;ak(aC,az,ax,ax,!1,aB,aw,aA)}function t(){++ad===au&&aj&&aj()}aa=aa||1000;var ac=af.new_edits,ap=new gA.Map,ad=0,au=ag.length;ag.forEach(function(ay,aw){if(ay._id&&D(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void ah[av](ay,{ctx:am},function(aA,az){ab[aw]=aA||az,t()})}var ax=ay.metadata.id;ap.has(ax)?(au--,ap.get(ax).push([ay,aw])):ap.set(ax,[[ay,aw]])}),ap.forEach(function(aw,ay){function az(){++ax<aw.length?av():t()}function av(){var aC=aw[ax],aA=aC[0],aB=aC[1];if(aq.has(ay)){jn(aa,aq.get(ay),aA,ab,aB,az,ak,ac)}else{var aD=gj([],aA.metadata.rev_tree[0],aa);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],al(aA,aB,az)}}var ax=0;av()})}function fg(t){var aa=[];return hf(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function h4(t){try{return JSON.parse(t)}catch(aa){return jg.parse(t)}}function ja(t){return t.length<50000?JSON.parse(t):h4(t)}function gq(t){try{return JSON.stringify(t)}catch(aa){return jg.stringify(t)}}function h0(ab,ad,t,ac){try{ab.apply(ad,t)}catch(aa){ac.emit("error",aa)}}function it(t){if(!iA.running&&iA.queue.length){iA.running=!0;var aa=iA.queue.shift();aa.action(function(ac,ab){h0(aa.callback,this,[ac,ab],t),iA.running=!1,a0.nextTick(function(){it(t)})})}}function X(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(hK(hr,aa,ab.type))}}function ji(t,aa,ab){return{data:gq(t),winningRev:aa,deletedOrLocal:ab?"1":"0",seq:t.seq,id:t.id}}function Y(t){if(!t){return null}var aa=ja(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function gd(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function fh(ac,aa,ab,t){ab?t(ac?"string"!=typeof ac?ac:hs(ac,aa):hB([""],{type:aa})):ac?"string"!=typeof ac?hQ(ac,function(ad){t(hz(ad))}):t(ac):t("")}function gH(aa,ah,ad,ag){function af(){++ac===ab.length&&ag&&ag()}function t(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ad.objectStore(gr).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,af()}}var ab=Object.keys(aa._attachments||{});if(!ab.length){return ag&&ag()}var ac=0;ab.forEach(function(aj){ah.attachments&&ah.include_docs?t(aa,aj):(aa._attachments[aj].stub=!0,af())})}function hm(t,aa){return jA.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return jA.all(ab.map(function(af){var ah=ac.doc._attachments[af];if("body" in ah){var ag=ah.body,ad=ah.content_type;return new jA(function(aj){fh(ag,ad,aa,function(ak){ac.doc._attachments[af]=iJ.extend(hE(ah,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function gE(ak,ah,ac){function af(){ab--,ab||ad()}function ad(){aa.length&&aa.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ag["delete"](am)}})}var aa=[],aj=ac.objectStore(N),ag=ac.objectStore(gr),t=ac.objectStore(iT),ab=ak.length;ak.forEach(function(al){var am=aj.index("_doc_id_rev"),ap=ah+"::"+al;am.getKey(ap).onsuccess=function(aq){var au=aq.target.result;if("number"!=typeof au){return af()}aj["delete"](au);var av=t.index("seq").openCursor(IDBKeyRange.only(au));av.onsuccess=function(ay){var aw=ay.target.result;if(aw){var ax=aw.value.digestSeq.split("::")[0];aa.push(ax),t["delete"](aw.primaryKey),aw["continue"]()}else{af()}}}})}function cn(ac,aa,ab){try{return{txn:ac.transaction(aa,ab)}}catch(t){return{error:t}}}function hb(aM,aw,aq,ac,aH,af,ab){function aB(){var aO=[hF,N,gr,C,iT],aP=cn(aH,aO,"readwrite");return aP.error?ab(aP.error):(aj=aP.txn,aj.onabort=X(ab),aj.ontimeout=X(ab),aj.oncomplete=aN,aF=aj.objectStore(hF),ah=aj.objectStore(N),al=aj.objectStore(gr),aD=aj.objectStore(iT),void aL(function(aQ){return aQ?(aK=!0,ab(aQ)):void aE()}))}function aC(){jv(aM.revs_limit,ap,ac,aI,aj,aG,ad,aq)}function aE(){function aO(){++aT===ap.length&&aC()}function aQ(aV){var aW=Y(aV.target.result);aW&&aI.set(aW.id,aW),aO()}if(ap.length){for(var aT=0,aP=0,aU=ap.length;aU>aP;aP++){var aR=ap[aP];if(aR._id&&D(aR._id)){aO()}else{var aS=aF.get(aR.metadata.id);aS.onsuccess=aQ}}}}function aN(){aK||(af.notify(ac._meta.name),ac._meta.docCount+=aA,ab(null,aG))}function t(aP,aQ){var aO=al.get(aP);aO.onsuccess=function(aR){if(aR.target.result){aQ()}else{var aS=hK(iz,"unknown stub attachment with digest "+aP);aS.status=412,aQ(aS)}}}function aL(aQ){function aS(){++aP===aO.length&&aQ(aR)}var aO=[];if(ap.forEach(function(aT){aT.data&&aT.data._attachments&&Object.keys(aT.data._attachments).forEach(function(aU){var aV=aT.data._attachments[aU];aV.stub&&aO.push(aV.digest)})}),!aO.length){return aQ()}var aR,aP=0;aO.forEach(function(aT){t(aT,function(aU){aU&&!aR&&(aR=aU),aS()})})}function ad(aR,aX,aT,aV,aU,aS,aP,aW){aA+=aS,aR.metadata.winningRev=aX,aR.metadata.deleted=aT;var aO=aR.data;aO._id=aR.metadata.id,aO._rev=aR.metadata.rev,aV&&(aO._deleted=!0);var aQ=aO._attachments&&Object.keys(aO._attachments).length;return aQ?am(aR,aX,aT,aU,aP,aW):void aa(aR,aX,aT,aU,aP,aW)}function ay(aO){var aP=fg(aO.metadata);gE(aP,aO.metadata.id,aj)}function aa(aS,aZ,aW,aX,aU,aP){function aY(ba){aX&&ac.auto_compaction?ay(aS):aS.stemmedRevs.length&&gE(aS.stemmedRevs,aS.metadata.id,aj),aV.seq=ba.target.result,delete aV.rev;var bb=ji(aV,aZ,aW),bc=aF.put(bb);bc.onsuccess=aQ}function aO(bb){bb.preventDefault(),bb.stopPropagation();var bc=ah.index("_doc_id_rev"),ba=bc.getKey(aT._doc_id_rev);ba.onsuccess=function(bd){var bf=ah.put(aT,bd.target.result);bf.onsuccess=aY}}function aQ(){aG[aU]={ok:!0,id:aV.id,rev:aZ},aI.set(aS.metadata.id,aS.metadata),av(aS,aV.seq,aP)}var aT=aS.data,aV=aS.metadata;aT._doc_id_rev=aV.id+"::"+aV.rev,delete aT._id,delete aT._rev;var aR=ah.put(aT);aR.onsuccess=aY,aR.onerror=aO}function am(aQ,aX,aT,aV,aU,aS){function aO(){aP===aR.length&&aa(aQ,aX,aT,aV,aU,aS)}function aW(){aP++,aO()}var aY=aQ.data,aP=0,aR=Object.keys(aY._attachments);aR.forEach(function(aZ){var bb=aQ.data._attachments[aZ];if(bb.stub){aP++,aO()}else{var ba=bb.data;delete bb.data,bb.revpos=parseInt(aX,10);var bc=bb.digest;ak(bc,ba,aW)}})}function av(aU,aP,aS){function aV(){++aQ===aR.length&&aS()}function aT(aW){var aX=aU.data._attachments[aW].digest,aY=aD.put({seq:aP,digestSeq:aX+"::"+aP});aY.onsuccess=aV,aY.onerror=function(aZ){aZ.preventDefault(),aZ.stopPropagation(),aV()}}var aQ=0,aR=Object.keys(aU.data._attachments||{});if(!aR.length){return aS()}for(var aO=0;aO<aR.length;aO++){aT(aR[aO])}}function ak(aP,aR,aO){var aQ=al.count(aP);aQ.onsuccess=function(aU){var aT=aU.target.result;if(aT){return aO()}var aV={digest:aP,body:aR},aS=al.put(aV);aS.onsuccess=aO}}for(var aj,aF,ah,al,aD,ax,ap=aw.docs,aA=0,az=0,ag=ap.length;ag>az;az++){var aJ=ap[az];aJ._id&&D(aJ._id)||(aJ=ap[az]=gX(aJ,aq.new_edits),aJ.error&&!ax&&(ax=aJ))}if(ax){return ab(ax)}var aG=new Array(ap.length),aI=new gA.Map,aK=!1,au=ac._meta.blobSupport?"blob":"base64";gJ(ap,au,function(aO){return aO?ab(aO):void aB()})}function hg(ab,ad,t,ac,aa){try{if(ab&&ad){return aa?IDBKeyRange.bound(ad,ab,!t,!1):IDBKeyRange.bound(ab,ad,!1,!t)}if(ab){return aa?IDBKeyRange.upperBound(ab):IDBKeyRange.lowerBound(ab)}if(ad){return aa?IDBKeyRange.lowerBound(ad,!t):IDBKeyRange.upperBound(ad,!t)}if(ac){return IDBKeyRange.only(ac)}}catch(af){return{error:af}}return null}function co(ac,aa,ab,t){return"DataError"===ab.name&&0===ab.code?t(null,{total_rows:ac._meta.docCount,offset:aa.skip,rows:[]}):void t(hK(hr,ab.name,ab.message))}function z(ab,ad,t,ac){function aa(ax,al){function aB(aN,aM,aL){var aK=aN.id+"::"+aL;aJ.get(aK).onsuccess=function(aO){aM.doc=gd(aO.target.result),ax.conflicts&&(aM.doc._conflicts=bt(aN)),gH(aM.doc,ax,aw)}}function av(aM,aK,aL){var aN={id:aL.id,key:aL.id,value:{rev:aK}},aO=aL.deleted;if("ok"===ax.deleted){ag.push(aN),aO?(aN.value.deleted=!0,aN.doc=null):ax.include_docs&&aB(aL,aN,aK)}else{if(!aO&&aE--<=0&&(ag.push(aN),ax.include_docs&&aB(aL,aN,aK),0===--ak)){return}}aM["continue"]()}function ay(aL){aI=ad._meta.docCount;var aM=aL.target.result;if(aM){var aN=Y(aM.value),aK=aN.winningRev;av(aM,aK,aN)}}function am(){al(null,{total_rows:aI,offset:ax.skip,rows:ag})}function aA(){ax.attachments?hm(ag,ax.binary).then(am):am()}var aD="startkey" in ax?ax.startkey:!1,ah="endkey" in ax?ax.endkey:!1,aG="key" in ax?ax.key:!1,aE=ax.skip||0,ak="number"==typeof ax.limit?ax.limit:-1,aF=ax.inclusive_end!==!1,aq="descending" in ax&&ax.descending?"prev":null,aj=hg(aD,ah,aF,aG,aq);if(aj&&aj.error){return co(ad,ax,aj.error,al)}var aH=[hF,N];ax.attachments&&aH.push(gr);var aC=cn(t,aH,"readonly");if(aC.error){return al(aC.error)}var aw=aC.txn,ap=aw.objectStore(hF),au=aw.objectStore(N),az=aq?ap.openCursor(aj,aq):ap.openCursor(aj),aJ=au.index("_doc_id_rev"),ag=[],aI=0;aw.oncomplete=aA,az.onsuccess=ay}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:ad._meta.docCount,offset:ag.skip,rows:[]}):void aa(ag,ah)}af(ab,ac)}function i0(t){return new jA(function(ab){var aa=hB([""]);t.objectStore(hR).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function y(t){iP()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):gv()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function iY(){jy.EventEmitter.call(this),this._listeners={},y(this)}function jc(t,aa){var ab=this;iA.queue.push({action:function(ac){ix(ab,t,ac)},callback:aa}),it(ab.constructor)}function ix(aj,am,af){function ac(av){var aw=av.createObjectStore(hF,{keyPath:"id"});av.createObjectStore(N,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),av.createObjectStore(gr,{keyPath:"digest"}),av.createObjectStore(hL,{keyPath:"id",autoIncrement:!1}),av.createObjectStore(hR),aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),av.createObjectStore(C,{keyPath:"_id"});var au=av.createObjectStore(iT,{autoIncrement:!0});au.createIndex("seq","seq"),au.createIndex("digestSeq","digestSeq",{unique:!0})}function aa(av,aw){var au=av.objectStore(hF);au.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.openCursor().onsuccess=function(aA){var ay=aA.target.result;if(ay){var ax=ay.value,az=je(ax);ax.deletedOrLocal=az?"1":"0",au.put(ax),ay["continue"]()}else{aw()}}}function aq(au){au.createObjectStore(C,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ap(ax,az){var aw=ax.objectStore(C),ay=ax.objectStore(hF),av=ax.objectStore(N),au=ay.openCursor();au.onsuccess=function(aK){var aB=aK.target.result;if(aB){var aG=aB.value,aE=aG.id,aF=D(aE),aI=gQ(aG);if(aF){var aL=aE+"::"+aI,aC=aE+"::",aJ=aE+"::~",aA=av.index("_doc_id_rev"),aD=IDBKeyRange.bound(aC,aJ,!1,!1),aH=aA.openCursor(aD);aH.onsuccess=function(aN){if(aH=aN.target.result){var aM=aH.value;aM._doc_id_rev===aL&&aw.put(aM),av["delete"](aH.primaryKey),aH["continue"]()}else{ay["delete"](aB.primaryKey),aB["continue"]()}}}else{aB["continue"]()}}else{az&&az()}}}function ab(au){var av=au.createObjectStore(iT,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ak(ax,az){var aw=ax.objectStore(N),ay=ax.objectStore(gr),av=ax.objectStore(iT),au=ay.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (aw.openCursor().onsuccess=function(aG){var aK=aG.target.result;if(!aK){return az()}for(var aL=aK.value,aI=aK.primaryKey,aE=Object.keys(aL._attachments||{}),aC={},aD=0;aD<aE.length;aD++){var aF=aL._attachments[aE[aD]];aC[aF.digest]=!0}var aH=Object.keys(aC);for(aD=0;aD<aH.length;aD++){var aJ=aH[aD];av.put({seq:aI,digestSeq:aJ+"::"+aI})}aK["continue"]()}):az()}}function ah(au){function ax(az){return az.data?Y(az):(az.deleted="1"===az.deletedOrLocal,az)}var aw=au.objectStore(N),av=au.objectStore(hF),ay=av.openCursor();ay.onsuccess=function(aC){function aB(){var aF=aD.id+"::",aH=aD.id+"::",aG=aw.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,az()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function az(){var aE=ji(aD,aD.winningRev,aD.deleted),aF=av.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var aD=ax(aA.value);return aD.winningRev=aD.winningRev||gQ(aD),aD.seq?az():void aB()}}}var al=am.name,ad=null;aj._meta=null,aj.type=function(){return"idb"},aj._id=iv(function(au){au(null,aj._meta.instanceId)}),aj._bulkDocs=function(au,aw,av){hb(am,au,aw,aj,ad,U,av)},aj._get=function(ay,av,az){function aB(){az(ax,{doc:aA,metadata:aC,ctx:au})}var aA,aC,ax,au=av.ctx;if(!au){var aw=cn(ad,[hF,N,gr],"readonly");if(aw.error){return az(aw.error)}au=aw.txn}au.objectStore(hF).get(ay).onsuccess=function(aG){if(aC=Y(aG.target.result),!aC){return ax=hK(u,"missing"),aB()}if(je(aC)&&!av.rev){return ax=hK(u,"deleted"),aB()}var aE=au.objectStore(N),aD=av.rev||aC.winningRev,aF=aC.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aA=aH.target.result,aA&&(aA=gd(aA)),aA?void aB():(ax=hK(u,"missing"),aB())}}},aj._getAttachment=function(av,aA,ay){var ax;if(aA.ctx){ax=aA.ctx}else{var au=cn(ad,[hF,N,gr],"readonly");if(au.error){return ay(au.error)}ax=au.txn}var az=av.digest,aw=av.content_type;ax.objectStore(gr).get(az).onsuccess=function(aC){var aB=aC.target.result.body;fh(aB,aw,aA.binary,function(aD){ay(null,aD)})}},aj._info=function(aA){if(null===ad||!gg.has(al)){var av=new Error("db isn't open");return av.id="idbNull",aA(av)}var ax,ay,az=cn(ad,[N],"readonly");if(az.error){return aA(az.error)}var aw=az.txn,au=aw.objectStore(N).openCursor(null,"prev");au.onsuccess=function(aB){var aC=aB.target.result;ax=aC?aC.key:0,ay=aj._meta.docCount},aw.oncomplete=function(){aA(null,{doc_count:ay,update_seq:ax,idb_attachment_format:aj._meta.blobSupport?"binary":"base64"})}},aj._allDocs=function(av,au){z(av,aj,ad,au)},aj._changes=function(aJ){function aD(aS){function aN(){return aO.seq!==aM?aS["continue"]():(aF=aM,aO.winningRev===aR._rev?aP(aR):void aQ())}function aQ(){var aU=aR._id+"::"+aO.winningRev,aT=aK.get(aU);aT.onsuccess=function(aV){aP(gd(aV.target.result))}}function aP(aU){var aT=aJ.processChange(aU,aO,aJ);aT.seq=aO.seq;var aV=aL(aT);return"object"==typeof aV?aJ.complete(aV):(aV&&(aB++,av&&aI.push(aT),aJ.attachments&&aJ.include_docs?gH(aU,aJ,aG,function(){hm([aT],aJ.binary).then(function(){aJ.onChange(aT)})}):aJ.onChange(aT)),void (aB!==az&&aS["continue"]()))}var aR=gd(aS.value),aM=aS.key;if(aH&&!aH.has(aR._id)){return aS["continue"]()}var aO;return(aO=ay.get(aR._id))?aN():void (aE.get(aR._id).onsuccess=function(aT){aO=Y(aT.target.result),ay.set(aR._id,aO),aN()})}function aA(aM){var aN=aM.target.result;aN&&aD(aN)}function au(){var aN=[hF,N];aJ.attachments&&aN.push(gr);var aO=cn(ad,aN,"readonly");if(aO.error){return aJ.complete(aO.error)}aG=aO.txn,aG.onabort=X(aJ.complete),aG.oncomplete=aC,ax=aG.objectStore(N),aE=aG.objectStore(hF),aK=ax.index("_doc_id_rev");var aM;aM=aJ.descending?ax.openCursor(null,"prev"):ax.openCursor(IDBKeyRange.lowerBound(aJ.since,!0)),aM.onsuccess=aA}function aC(){function aM(){aJ.complete(null,{results:aI,last_seq:aF})}!aJ.continuous&&aJ.attachments?hm(aI).then(aM):aM()}if(aJ=iC(aJ),aJ.continuous){var aw=al+":"+iF();return U.addListener(al,aw,aj,aJ),U.notify(al),{cancel:function(){U.removeListener(al,aw)}}}var aH=aJ.doc_ids&&new gA.Set(aJ.doc_ids);aJ.since=aJ.since||0;var aF=aJ.since,az="limit" in aJ?aJ.limit:-1;0===az&&(az=1);var av;av="return_docs" in aJ?aJ.return_docs:"returnDocs" in aJ?aJ.returnDocs:!0;var aG,ax,aE,aK,aI=[],aB=0,aL=m(aJ),ay=new gA.Map;au()},aj._close=function(au){return null===ad?au(hK(ee)):(ad.close(),gg["delete"](al),ad=null,void au())},aj._getRevisionTree=function(au,ax){var aw=cn(ad,[hF],"readonly");if(aw.error){return ax(aw.error)}var av=aw.txn,ay=av.objectStore(hF).get(au);ay.onsuccess=function(aA){var az=Y(aA.target.result);az?ax(null,az.rev_tree):ax(hK(u))}},aj._doCompaction=function(av,aA,ay){var ax=[hF,N,gr,iT],au=cn(ad,ax,"readwrite");if(au.error){return ay(au.error)}var az=au.txn,aw=az.objectStore(hF);aw.get(av).onsuccess=function(aC){var aE=Y(aC.target.result);hf(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==aA.indexOf(aI)&&(aH.status="missing")}),gE(aA,av,az);var aD=aE.winningRev,aB=aE.deleted;az.objectStore(hF).put(ji(aE,aD,aB))},az.onabort=X(ay),az.oncomplete=function(){ay()}},aj._getLocal=function(au,ax){var aw=cn(ad,[C],"readonly");if(aw.error){return ax(aw.error)}var av=aw.txn,ay=av.objectStore(C).get(au);ay.onerror=X(ax),ay.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,ax(null,az)):ax(hK(u))}},aj._putLocal=function(aD,az,au){"function"==typeof az&&(au=az,az={}),delete aD._revisions;var aw=aD._rev,av=aD._id;aw?aD._rev="0-"+(parseInt(aw.split("-")[1],10)+1):aD._rev="0-1";var ax,aB=az.ctx;if(!aB){var ay=cn(ad,[C],"readwrite");if(ay.error){return au(ay.error)}aB=ay.txn,aB.onerror=X(au),aB.oncomplete=function(){ax&&au(null,ax)}}var aA,aC=aB.objectStore(C);aw?(aA=aC.get(av),aA.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aw){var aG=aC.put(aD);aG.onsuccess=function(){ax={ok:!0,id:aD._id,rev:aD._rev},az.ctx&&au(null,ax)}}else{au(hK(jC))}}):(aA=aC.add(aD),aA.onerror=function(aE){au(hK(jC)),aE.preventDefault(),aE.stopPropagation()},aA.onsuccess=function(){ax={ok:!0,id:aD._id,rev:aD._rev},az.ctx&&au(null,ax)})},aj._removeLocal=function(ay,av,az){"function"==typeof av&&(az=av,av={});var aB=av.ctx;if(!aB){var aA=cn(ad,[C],"readwrite");if(aA.error){return az(aA.error)}aB=aA.txn,aB.oncomplete=function(){aC&&az(null,aC)}}var aC,ax=ay._id,au=aB.objectStore(C),aw=au.get(ax);aw.onerror=X(az),aw.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===ay._rev?(au["delete"](ax),aC={ok:!0,id:ax,rev:"0-0"},av.ctx&&az(null,aC)):az(hK(u))}},aj._destroy=function(aw,au){U.removeAllListeners(al);var av=iI.get(al);av&&av.result&&(av.result.close(),gg["delete"](al));var ax=indexedDB.deleteDatabase(al);ax.onsuccess=function(){iI["delete"](al),gv()&&al in localStorage&&delete localStorage[al],au(null,{ok:!0})},ax.onerror=X(au)};var ag=gg.get(al);if(ag){return ad=ag.idb,aj._meta=ag.global,void a0.nextTick(function(){af(null,aj)})}var t;t=am.storage?jw(al,am.storage):indexedDB.open(al,fW),iI.set(al,t),t.onupgradeneeded=function(az){function av(){var aA=ay[au-1];au++,aA&&aA(aw,av)}var ax=az.target.result;if(az.oldVersion<1){return ac(ax)}var aw=az.currentTarget.transaction;az.oldVersion<3&&aq(ax),az.oldVersion<4&&ab(ax);var ay=[aa,ap,ak,ah],au=az.oldVersion;av()},t.onsuccess=function(ay){ad=ay.target.result,ad.onversionchange=function(){ad.close(),gg["delete"](al)},ad.onabort=function(aA){console.error("Database has a global failure",aA.target.error),ad.close(),gg["delete"](al)};var az=ad.transaction([hL,hR,hF],"readwrite"),av=az.objectStore(hL).get(hL),ax=null,aw=null,au=null;av.onsuccess=function(aB){var aD=function(){null!==ax&&null!==aw&&null!==au&&(aj._meta={name:al,instanceId:au,blobSupport:ax,docCount:aw},gg.set(al,{idb:ad,global:aj._meta}),af(null,aj))},aA=aB.target.result||{id:hL};al+"_id" in aA?(au=aA[al+"_id"],aD()):(au=iF(),aA[al+"_id"]=au,az.objectStore(hL).put(aA).onsuccess=function(){aD()}),go||(go=i0(az)),go.then(function(aE){ax=aE,aD()});var aC=az.objectStore(hF).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){aw=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";console.error(au),af(hK(hr,au))}}function jw(t,aa){try{return indexedDB.open(t,{version:fW,storage:aa})}catch(ab){return indexedDB.open(t,fW)}}function a9(t){return decodeURIComponent(window.escape(t))}function iZ(t){return 65>t?t-48:t-55}function R(ac,aa,ab){for(var t="";ab>aa;){t+=String.fromCharCode(iZ(ac.charCodeAt(aa++))<<4|iZ(ac.charCodeAt(aa++)))}return t}function iQ(ac,aa,ab){for(var t="";ab>aa;){t+=String.fromCharCode(iZ(ac.charCodeAt(aa+2))<<12|iZ(ac.charCodeAt(aa+3))<<8|iZ(ac.charCodeAt(aa))<<4|iZ(ac.charCodeAt(aa+1))),aa+=4}return t}function g2(t,aa){return"UTF-8"===aa?a9(R(t,0,t.length)):iQ(t,0,t.length)}function dn(t){return"'"+t+"'"}function jB(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(t){return openDatabase(t.name,t.version,t.description,t.size)}:void 0}function hY(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function ht(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function ge(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jo(t){return delete t._id,delete t._rev,JSON.stringify(t)}function gc(t,aa,ab){return t=JSON.parse(t),t._id=aa,t._rev=ab,t}function i1(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function w(ab,ad,t,ac,aa){return"SELECT "+ab+" FROM "+("string"==typeof ad?ad:ad.join(" JOIN "))+(t?" ON "+t:"")+(ac?" WHERE "+("string"==typeof ac?ac:ac.join(" AND ")):"")+(aa?" ORDER BY "+aa:"")}function hu(aa,ac,ag){function ab(){++ad===aa.length&&t()}function t(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+I+" WHERE seq IN "+i1(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+I+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+I+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new gA.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+I+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+ij+" WHERE digest=?",[az]))})})})}})}}if(aa.length){var ad=0,af=[];aa.forEach(function(ah){var aj="SELECT seq FROM "+hh+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[ac,ah],function(al,am){if(!am.rows.length){return ab()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+hh+" WHERE seq=?",[ak],ab)})})}}function iD(t){return function(ad){console.error("WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(hK(ik,ab,ac))}}function A(t){if("size" in t){return 1000000*t.size}var aa="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return aa?5000000:1}function n(t,aa){try{return{db:t(aa)}}catch(ab){return{error:ab}}}function gt(t){var aa=hk.get(t.name);if(!aa){var ab=jB();aa=n(ab,t),hk.set(t.name,aa),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return aa}function fw(ab,ag,au,ax,av,ak,al){function az(){return ac?al(ac):(ak.notify(ax._name),ax._docCount=-1,void al(null,ah))}function ay(aD,aE){var aC="SELECT count(*) as cnt FROM "+ij+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=hK(iz,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function aa(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){ay(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function aA(aQ,aI,aN,aD,aF,aL,aG,aJ){function aO(){function aR(bc,ba){function bb(){return ++bf===bg.length&&ba(),!1}function aZ(bh){var bj="INSERT INTO "+I+" (digest, seq) VALUES (?,?)",bi=[aS._attachments[bh].digest,bc];ap.executeSql(bj,bi,bb,bb)}var bf=0,bg=Object.keys(aS._attachments||{});if(!bg.length){return ba()}for(var bd=0;bd<bg.length;bd++){aZ(bg[bd])}}var aS=aQ.data,aX=aD?1:0,aU=aS._id,aY=aS._rev,aW=jo(aS),aV="INSERT INTO "+hh+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aT=[aU,aY,aW,aX];ap.executeSql(aV,aT,function(aZ,ba){var bb=ba.insertId;aR(bb,function(){aP(aZ,bb)})},function(){var aZ=w("seq",hh,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aU,aY],function(bd,bc){var bb=bc.rows.item(0).seq,bf="UPDATE "+hh+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aW,aX,aU,aY];bd.executeSql(bf,ba,function(bg){aR(bb,function(){aP(bg,bb)})})}),!1})}function aC(aR){aE||(aR?(aE=aR,aJ(aE)):aK===aM.length&&aO())}function aH(aR){aK++,aC(aR)}function aP(aW,aS){var aV=aQ.metadata.id;aF&&ax.auto_compaction?hu(fg(aQ.metadata),aV,aW):aQ.stemmedRevs.length&&hu(aQ.stemmedRevs,aV,aW),aQ.metadata.seq=aS,delete aQ.metadata.rev;var aR=aF?"UPDATE "+hP+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+hh+" WHERE doc_id="+hP+".id AND rev=?) WHERE id=?":"INSERT INTO "+hP+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aU=gq(aQ.metadata),aT=aF?[aU,aS,aI,aV]:[aV,aS,aS,aU];aW.executeSql(aR,aT,function(){ah[aG]={ok:!0,id:aQ.metadata.id,rev:aI},am.set(aV,aQ.metadata),aJ()})}var aE=null,aK=0;aQ.data._id=aQ.metadata.id,aQ.data._rev=aQ.metadata.rev;var aM=Object.keys(aQ.data._attachments||{});aD&&(aQ.data._deleted=!0),aM.forEach(function(aS){var aU=aQ.data._attachments[aS];if(aU.stub){aK++,aC()}else{var aT=aU.data;delete aU.data,aU.revpos=parseInt(aI,10);var aR=aU.digest;af(aR,aT,aH)}}),aM.length||aO()}function aw(){jv(ab.revs_limit,aq,ax,am,ap,ah,aA,au)}function aB(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&D(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+hP+" WHERE id = ?",[aF],function(aH,aI){if(aI.rows.length){var aJ=ja(aI.rows.item(0).json);am.set(aF,aJ)}aE()})})}function af(aD,aF,aC){var aE="SELECT digest FROM "+ij+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+ij+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,ht(aF)],function(){aC()},function(){return aC(),!1}))})}var aj=au.new_edits,ad=ag.docs,aq=ad.map(function(aC){if(aC._id&&D(aC._id)){return aC}var aD=gX(aC,aj);return aD}),t=aq.filter(function(aC){return aC.error});if(t.length){return al(t[0])}var ap,ac,ah=new Array(aq.length),am=new gA.Map;gJ(aq,"binary",function(aC){return aC?al(aC):void av.transaction(function(aD){ap=aD,aa(function(aE){aE?ac=aE:aB(aw)})},iD(al),az)})}function hM(ad,aj,ac,af,ag){function aa(){++ab===t.length&&ag&&ag()}function ah(al,ak){var am=al._attachments[ak],ap={binary:aj.binary,ctx:af};ac._getAttachment(am,ap,function(au,aq){al._attachments[ak]=iJ.extend(hE(am,["digest","content_type"]),{data:aq}),aa()})}var t=Object.keys(ad._attachments||{});if(!t.length){return ag&&ag()}var ab=0;t.forEach(function(ak){aj.attachments&&aj.include_docs?ah(ad,ak):(ad._attachments[ak].stub=!0,aa())})}function gM(ab,av){function am(){gv()&&(window.localStorage["_pouch__websqldb_"+az._name]=!0),av(null,az)}function aC(aD,aE){aD.executeSql(gw),aD.executeSql("ALTER TABLE "+hh+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(i5),aD.executeSql("ALTER TABLE "+hP+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+hP+" (local, id)");var aF="SELECT "+hP+".winningseq AS seq, "+hP+".json AS metadata FROM "+hh+" JOIN "+hP+" ON "+hh+".seq = "+hP+".winningseq";aD.executeSql(aF,[],function(aN,aJ){for(var aG=[],aL=[],aK=0;aK<aJ.rows.length;aK++){var aI=aJ.rows.item(aK),aH=aI.seq,aM=JSON.parse(aI.metadata);je(aM)&&aG.push(aH),D(aM.id)&&aL.push(aM.id)}aN.executeSql("UPDATE "+hP+"SET local = 1 WHERE id IN "+i1(aL.length),aL,function(){aN.executeSql("UPDATE "+hh+" SET deleted = 1 WHERE seq IN "+i1(aG.length),aG,aE)})})})})}function ak(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+ic+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+hP+".id AS id, "+hh+".json AS data FROM "+hh+" JOIN "+hP+" ON "+hh+".seq = "+hP+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aK,aI){function aL(){if(!aJ.length){return aF(aK)}var aM=aJ.shift(),aN=JSON.parse(aM.data)._rev;aK.executeSql("INSERT INTO "+ic+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+hP+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+hh+" WHERE seq=?",[aM.seq],function(){aL()})})})}for(var aJ=[],aH=0;aH<aI.rows.length;aH++){aJ.push(aI.rows.item(aH))}aL()})})}function ag(aE,aG){function aD(aI){function aH(){if(!aI.length){return aG(aE)}var aM=aI.shift(),aO=g2(aM.hex,aj),aK=aO.lastIndexOf("::"),aN=aO.substring(0,aK),aJ=aO.substring(aK+2),aL="UPDATE "+hh+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aL,[aN,aJ,aO],function(){aH()})}aH()}var aF="ALTER TABLE "+hh+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aI){var aH="ALTER TABLE "+hh+" ADD COLUMN rev";aI.executeSql(aH,[],function(aJ){aJ.executeSql(Z,[],function(aK){var aL="SELECT hex(doc_id_rev) as hex FROM "+hh;aK.executeSql(aL,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function ad(aE,aG){function aD(aH){var aI="SELECT COUNT(*) AS cnt FROM "+ij;aH.executeSql(aI,[],function(aN,aL){function aO(){var aP=w(fi+", "+hP+".id AS id",[hP,hh],h2,null,hP+".id ");aP+=" LIMIT "+aK+" OFFSET "+aJ,aJ+=aK,aN.executeSql(aP,[],function(ba,aV){function aS(bc,bd){var bf=aT[bc]=aT[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aV.rows.length){return aG(ba)}for(var aT={},aY=0;aY<aV.rows.length;aY++){for(var aW=aV.rows.item(aY),aX=gc(aW.data,aW.id,aW.rev),aQ=Object.keys(aX._attachments||{}),aZ=0;aZ<aQ.length;aZ++){var aU=aX._attachments[aQ[aZ]];aS(aU.digest,aW.seq)}}var bb=[];if(Object.keys(aT).forEach(function(bc){var bd=aT[bc];bd.forEach(function(bf){bb.push([bc,bf])})}),!bb.length){return aO()}var aR=0;bb.forEach(function(bd){var bc="INSERT INTO "+I+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aR===bb.length&&aO()})})})}var aM=aL.rows.item(0).cnt;if(!aM){return aG(aN)}var aJ=0,aK=10;aO()})}var aF="CREATE TABLE IF NOT EXISTS "+I+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(hx,[],function(aI){aI.executeSql(jz,[],aD)})})}function au(aE,aF){var aD="ALTER TABLE "+ij+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ah(aE,aF){var aD="ALTER TABLE "+hP+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aH){var aG="UPDATE "+hP+" SET max_seq=(SELECT MAX(seq) FROM "+hh+" WHERE doc_id=id)";aH.executeSql(aG,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+hP+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ap(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aG,aF){var aH=aF.rows.item(0).hex;aj=2===aH.length?"UTF-8":"UTF-16",aE()})}function al(){for(;af.length>0;){var aD=af.pop();aD(null,aa)}}function ac(aD,aH){if(0===aH){var aL="CREATE TABLE IF NOT EXISTS "+gu+" (dbid, db_version INTEGER)",aO="CREATE TABLE IF NOT EXISTS "+ij+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aE="CREATE TABLE IF NOT EXISTS "+I+" (digest, seq INTEGER)",aG="CREATE TABLE IF NOT EXISTS "+hP+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aF="CREATE TABLE IF NOT EXISTS "+hh+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aM="CREATE TABLE IF NOT EXISTS "+ic+" (id UNIQUE, rev, json)";aD.executeSql(aO),aD.executeSql(aM),aD.executeSql(aE,[],function(){aD.executeSql(jz),aD.executeSql(hx)}),aD.executeSql(aG,[],function(){aD.executeSql(gw),aD.executeSql(aF,[],function(){aD.executeSql(i5),aD.executeSql(Z),aD.executeSql(aL,[],function(){var aQ="INSERT INTO "+gu+" (db_version, dbid) VALUES (?,?)";aa=iF();var aP=[jj,aa];aD.executeSql(aQ,aP,function(){al()})})})})}else{var aJ=function(){var aP=jj>aH;aP&&aD.executeSql("UPDATE "+gu+" SET db_version = "+jj);var aQ="SELECT dbid FROM "+gu;aD.executeSql(aQ,[],function(aR,aS){aa=aS.rows.item(0).dbid,al()})},aN=[aC,ak,ag,ad,au,ah,aJ],aK=aH,aI=function(aP){aN[aK-1](aP,aI),aK++};aI(aD)}}function aq(){ax.transaction(function(aD){ap(aD,function(){aw(aD)})},iD(av),am)}function aw(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+gu;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+gu,[],function(aI,aJ){var aH=aJ.rows.item(0).db_version;ac(aI,aH)}):aF.executeSql("ALTER TABLE "+gu+" ADD COLUMN db_version INTEGER",[],function(){ac(aF,1)}):ac(aF,0)})}function ay(aE,aF){if(-1!==az._docCount){return aF(az._docCount)}var aD=w("COUNT("+hP+".id) AS 'num'",[hP,hh],h2,hh+".deleted=0");aE.executeSql(aD,[],function(aH,aG){az._docCount=aG.rows.item(0).num,aF(az._docCount)})}var aj,az=this,aa=null,aA=A(ab),af=[];az._docCount=-1,az._name=ab.name;var t=iJ.extend({},ab,{size:aA,version:jx}),aB=gt(t);if(aB.error){return iD(av)(aB.error)}var ax=aB.db;"function"!=typeof ax.readTransaction&&(ax.readTransaction=ax.transaction),aq(),az.type=function(){return"websql"},az._id=iv(function(aD){aD(null,aa)}),az._info=function(aD){ax.readTransaction(function(aE){ay(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+hh;aE.executeSql(aG,[],function(aJ,aI){var aH=aI.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aH,sqlite_plugin:ax._sqlitePlugin,websql_encoding:aj})})})},iD(aD))},az._bulkDocs=function(aF,aD,aE){fw(ab,aF,aD,az,ax,gK,aE)},az._get=function(aD,aJ,aF){function aI(){aF(aL,{doc:aH,metadata:aE,ctx:aG})}var aH,aE,aL,aG=aJ.ctx;if(!aG){return ax.readTransaction(function(aN){az._get(aD,iJ.extend({ctx:aN},aJ),aF)})}var aK,aM;aJ.rev?(aK=w(fi,[hP,hh],hP+".id="+hh+".doc_id",[hh+".doc_id=?",hh+".rev=?"]),aM=[aD,aJ.rev]):(aK=w(fi,[hP,hh],h2,hP+".id=?"),aM=[aD]),aG.executeSql(aK,aM,function(aP,aO){if(!aO.rows.length){return aL=hK(u,"missing"),aI()}var aN=aO.rows.item(0);return aE=ja(aN.metadata),aN.deleted&&!aJ.rev?(aL=hK(u,"deleted"),aI()):(aH=gc(aN.data,aE.id,aN.rev),void aI())})},az._allDocs=function(aN,aF){var aI,aM=[],aK="startkey" in aN?aN.startkey:!1,aQ="endkey" in aN?aN.endkey:!1,aH="key" in aN?aN.key:!1,aE="descending" in aN?aN.descending:!1,aG="limit" in aN?aN.limit:-1,aJ="skip" in aN?aN.skip:0,aO=aN.inclusive_end!==!1,aD=[],aL=[];if(aH!==!1){aL.push(hP+".id = ?"),aD.push(aH)}else{if(aK!==!1||aQ!==!1){if(aK!==!1&&(aL.push(hP+".id "+(aE?"<=":">=")+" ?"),aD.push(aK)),aQ!==!1){var aP=aE?">":"<";aO&&(aP+="="),aL.push(hP+".id "+aP+" ?"),aD.push(aQ)}aH!==!1&&(aL.push(hP+".id = ?"),aD.push(aH))}}"ok"!==aN.deleted&&aL.push(hh+".deleted = 0"),ax.readTransaction(function(aR){ay(aR,function(aS){if(aI=aS,0!==aG){var aT=w(fi,[hP,hh],h2,aL,hP+".id "+(aE?"DESC":"ASC"));aT+=" LIMIT "+aG+" OFFSET "+aJ,aR.executeSql(aT,aD,function(aW,bc){for(var aU=0,aZ=bc.rows.length;aZ>aU;aU++){var aX=bc.rows.item(aU),aV=ja(aX.metadata),ba=aV.id,aY=gc(aX.data,ba,aX.rev),bb=aY._rev,bd={id:ba,key:ba,value:{rev:bb}};if(aN.include_docs&&(bd.doc=aY,bd.doc._rev=bb,aN.conflicts&&(bd.doc._conflicts=bt(aV)),hM(bd.doc,aN,az,aW)),aX.deleted){if("ok"!==aN.deleted){continue}bd.value.deleted=!0,bd.doc=null}aM.push(bd)}})}})},iD(aF),function(){aF(null,{total_rows:aI,offset:aN.skip,rows:aM})})},az._changes=function(aF){function aE(){var aN=hP+".json AS metadata, "+hP+".max_seq AS maxSeq, "+hh+".json AS winningDoc, "+hh+".rev AS winningRev ",aM=hP+" JOIN "+hh,aO=hP+".id="+hh+".doc_id AND "+hP+".winningseq="+hh+".seq",aP=["maxSeq > ?"],aS=[aF.since];aF.doc_ids&&(aP.push(hP+".id IN "+i1(aF.doc_ids.length)),aS=aS.concat(aF.doc_ids));var aL="maxSeq "+(aI?"DESC":"ASC"),aR=w(aN,aM,aO,aP,aL),aT=m(aF);aF.view||aF.filter||(aR+=" LIMIT "+aD);var aQ=aF.since||0;ax.readTransaction(function(aU){aU.executeSql(aR,aS,function(aW,aV){function aX(bg){return function(){aF.onChange(bg)}}for(var bb=0,bc=aV.rows.length;bc>bb;bb++){var bd=aV.rows.item(bb),aZ=ja(bd.metadata);aQ=bd.maxSeq;var bf=gc(bd.winningDoc,aZ.id,bd.winningRev),aY=aF.processChange(bf,aZ,aF);aY.seq=bd.maxSeq;var ba=aT(aY);if("object"==typeof ba){return aF.complete(ba)}if(ba&&(aJ++,aG&&aH.push(aY),aF.attachments&&aF.include_docs?hM(bf,aF,az,aW,aX(aY)):aX(aY)()),aJ===aD){break}}})},iD(aF.complete),function(){aF.continuous||aF.complete(null,{results:aH,last_seq:aQ})})}if(aF=iC(aF),aF.continuous){var aK=az._name+":"+iF();return gK.addListener(az._name,aK,az,aF),gK.notify(az._name),{cancel:function(){gK.removeListener(az._name,aK)}}}var aI=aF.descending;aF.since=aF.since&&!aI?aF.since:0;var aD="limit" in aF?aF.limit:-1;0===aD&&(aD=1);var aG;aG="return_docs" in aF?aF.return_docs:"returnDocs" in aF?aF.returnDocs:!0;var aH=[],aJ=0;aE()},az._close=function(aD){aD()},az._getAttachment=function(aF,aE,aK){var aI,aD=aE.ctx,aG=aF.digest,aH=aF.content_type,aJ="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+ij+" WHERE digest=?";aD.executeSql(aJ,[aG],function(aL,aO){var aN=aO.rows.item(0),aM=aN.escaped?ge(aN.body):g2(aN.body,aj);aI=aE.binary?hT(aM,aH):hz(aM),aK(null,aI)})},az._getRevisionTree=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+hP+" WHERE id = ?";aF.executeSql(aG,[aD],function(aI,aH){if(aH.rows.length){var aJ=ja(aH.rows.item(0).metadata);aE(null,aJ.rev_tree)}else{aE(hK(u))}})})},az._doCompaction=function(aE,aF,aD){return aF.length?void ax.transaction(function(aG){var aH="SELECT json AS metadata FROM "+hP+" WHERE id = ?";aG.executeSql(aH,[aE],function(aK,aI){var aL=ja(aI.rows.item(0).metadata);hf(aL.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aJ="UPDATE "+hP+" SET json = ? WHERE id = ?";aK.executeSql(aJ,[gq(aL),aE])}),hu(aF,aE,aG)},iD(aD),function(){aD()}):aD()},az._getLocal=function(aD,aE){ax.readTransaction(function(aF){var aG="SELECT json, rev FROM "+ic+" WHERE id=?";aF.executeSql(aG,[aD],function(aK,aI){if(aI.rows.length){var aH=aI.rows.item(0),aJ=gc(aH.json,aD,aH.rev);aE(null,aJ)}else{aE(hK(u))}})})},az._putLocal=function(aF,aL,aH){function aJ(aO){var aM,aN;aG?(aM="UPDATE "+ic+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aI,aD,aE,aG]):(aM="INSERT INTO "+ic+" (id, rev, json) VALUES (?,?,?)",aN=[aE,aI,aD]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aK={ok:!0,id:aE,rev:aI},aL.ctx&&aH(null,aK)):aH(hK(jC))},function(){return aH(hK(jC)),!1})}"function"==typeof aL&&(aH=aL,aL={}),delete aF._revisions;var aI,aG=aF._rev,aE=aF._id;aI=aG?aF._rev="0-"+(parseInt(aG.split("-")[1],10)+1):aF._rev="0-1";var aK,aD=jo(aF);aL.ctx?aJ(aL.ctx):ax.transaction(aJ,iD(aH),function(){aK&&aH(null,aK)})},az._removeLocal=function(aF,aH,aD){function aG(aI){var aJ="DELETE FROM "+ic+" WHERE id=? AND rev=?",aK=[aF._id,aF._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aE={ok:!0,id:aF._id,rev:"0-0"},void (aH.ctx&&aD(null,aE))):aD(hK(u))})}"function"==typeof aH&&(aD=aH,aH={});var aE;aH.ctx?aG(aH.ctx):ax.transaction(aG,iD(aD),function(){aE&&aD(null,aE)})},az._destroy=function(aD,aE){gK.removeAllListeners(az._name),ax.transaction(function(aF){var aG=[hP,hh,ij,gu,ic,I];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},iD(aE),function(){gv()&&(delete window.localStorage["_pouch__websqldb_"+az._name],delete window.localStorage[az._name]),aE(null,{ok:!0})})}}var iJ=e(7),ha=js(iJ),iG=js(e(2)),iH=js(e(6)),hC=js(e(8)),gA=e(12),h5=js(e(1)),jy=e(4),br=js(e(14)),gf=e(10),fz=js(gf),fT=js(e(15)),jg=js(e(16)),jA="function"==typeof Promise?Promise:hC,jk=iG("pouchdb:api");iH(gm,Error),gm.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var jm=new gm({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),iy=new gm({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),u=new gm({status:404,error:"not_found",reason:"missing"}),jC=new gm({status:409,error:"conflict",reason:"Document update conflict"}),hZ=new gm({status:400,error:"invalid_id",reason:"_id field must contain a string"}),h9=new gm({status:412,error:"missing_id",reason:"_id is required for puts"}),jq=new gm({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),ee=new gm({status:412,error:"precondition_failed",reason:"Database not open"}),Q=new gm({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),gB=new gm({status:500,error:"badarg",reason:"Some query argument is invalid"}),eu=new gm({status:400,error:"invalid_request",reason:"Request was invalid"}),hy=new gm({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),x=new gm({status:500,error:"doc_validation",reason:"Bad special document member"}),g4=new gm({status:400,error:"bad_request",reason:"Something wrong with the request"}),g0=new gm({status:400,error:"bad_request",reason:"Document must be a JSON object"}),a7=new gm({status:404,error:"not_found",reason:"Database not found"}),hr=new gm({status:500,error:"indexed_db_went_bad",reason:"unknown"}),ik=new gm({status:500,error:"web_sql_went_bad",reason:"unknown"}),g6=new gm({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),di=new gm({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),bn=new gm({status:400,error:"bad_request",reason:"Invalid rev format"}),gW=new gm({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),iz=new gm({status:412,error:"missing_stub"}),l=new gm({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),ey={UNAUTHORIZED:jm,MISSING_BULK_DOCS:iy,MISSING_DOC:u,REV_CONFLICT:jC,INVALID_ID:hZ,MISSING_ID:h9,RESERVED_ID:jq,NOT_OPEN:ee,UNKNOWN_ERROR:Q,BAD_ARG:gB,INVALID_REQUEST:eu,QUERY_PARSE_ERROR:hy,DOC_VALIDATION:x,BAD_REQUEST:g4,NOT_AN_OBJECT:g0,DB_MISSING:a7,WSQ_ERROR:ik,LDB_ERROR:g6,FORBIDDEN:di,INVALID_REV:bn,FILE_EXISTS:gW,MISSING_STUB:iz,IDB_ERROR:hr,INVALID_URL:l},ih=function(ab,ad,t){var ac=Object.keys(ey).filter(function(af){var ag=ey[af];return"function"!=typeof ag&&ag[ab]===ad}),aa=t&&ac.filter(function(af){var ag=ey[af];return ag.message===t})[0]||ac[0];return aa?ey[aa]:null};iH(fS,jy.EventEmitter),fS.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},fS.prototype.doChanges=function(ab){var ad=this,t=ab.complete;if(ab=iC(ab),"live" in ab&&!("continuous" in ab)&&(ab.continuous=ab.live),ab.processChange=hA,"latest"===ab.since&&(ab.since="now"),ab.since||(ab.since=0),"now"===ab.since){return void this.db.info().then(function(af){return ad.isCancelled?void t(null,{status:"cancelled"}):(ab.since=af.update_seq,void ad.doChanges(ab))},t)}if(ab.continuous&&"now"!==ab.since&&this.db.info().then(function(af){ad.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ab.filter&&"string"==typeof ab.filter&&("_view"===ab.filter?ab.view=P(ab.view):ab.filter=P(ab.filter),"http"!==this.db.type()&&!ab.doc_ids)){return this.filterChanges(ab)}"descending" in ab||(ab.descending=!1),ab.limit=0===ab.limit?1:ab.limit,ab.complete=t;var ac=this.db._changes(ab);if(ac&&"function"==typeof ac.cancel){var aa=ad.cancel;ad.cancel=h5(function(af){ac.cancel(),aa.apply(this,af)})}},fS.prototype.filterChanges=function(ab){var ad=this,t=ab.complete;if("_view"===ab.filter){if(!ab.view||"string"!=typeof ab.view){var ac=hK(g4,"`view` filter parameter not found or invalid.");return t(ac)}var aa=dr(ab.view);this.db.getView(aa[0],aa[1],function(ag,ah){return ad.isCancelled?t(null,{status:"cancelled"}):ag?t(h3(ag)):ah.map?(ab.filter=gO(ah.map),void ad.doChanges(ab)):t(hK(u))})}else{var af=dr(ab.filter);if(!af){return ad.doChanges(ab)}this.db.getFilter(af[0],af[1],function(ag,ah){return ad.isCancelled?t(null,{status:"cancelled"}):ag?t(h3(ag)):(ab.filter=gC(ah),void ad.doChanges(ab))})}};var f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),fm=jb(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gh=jb(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);iH(jf,jy.EventEmitter),jf.prototype.post=fY("post",function(t,aa,ab){return"function"==typeof aa&&(ab=aa,aa={}),"object"!=typeof t||Array.isArray(t)?ab(hK(g0)):void this.bulkDocs({docs:[t]},aa,eq(ab))}),jf.prototype.put=fY("put",h5(function(aa){var ac,ag,ab,t,ad=aa.shift(),af="_id" in ad;if("object"!=typeof ad||Array.isArray(ad)){return(t=aa.pop())(hK(g0))}for(;;){if(ac=aa.shift(),ag=typeof ac,"string"!==ag||af?"string"!==ag||!af||"_rev" in ad?"object"===ag?ab=ac:"function"===ag&&(t=ac):ad._rev=ac:(ad._id=ac,af=!0),!aa.length){break}}return ab=ab||{},hU(ad._id),D(ad._id)&&"function"==typeof this._putLocal?ad._deleted?this._removeLocal(ad,t):this._putLocal(ad,t):void this.bulkDocs({docs:[ad]},ab,eq(t))})),jf.prototype.putAttachment=fY("putAttachment",function(aa,ac,ag,ab,t){function ad(ah){var aj="_rev" in ah?parseInt(ah._rev,10):0;return ah._attachments=ah._attachments||{},ah._attachments[ac]={content_type:t,data:ab,revpos:++aj},af.put(ah)}var af=this;return"function"==typeof t&&(t=ab,ab=ag,ag=null),"undefined"==typeof t&&(t=ab,ab=ag,ag=null),af.get(aa).then(function(ah){if(ah._rev!==ag){throw hK(jC)}return ad(ah)},function(ah){if(ah.reason===u.message){return ad({_id:aa})}throw ah})}),jf.prototype.removeAttachment=fY("removeAttachment",function(ab,ad,t,ac){var aa=this;aa.get(ab,function(af,ag){return af?void ac(af):ag._rev!==t?void ac(hK(jC)):ag._attachments?(delete ag._attachments[ad],0===Object.keys(ag._attachments).length&&delete ag._attachments,void aa.put(ag,ac)):ac()})}),jf.prototype.remove=fY("remove",function(ab,ad,t,ac){var aa;"string"==typeof ad?(aa={_id:ab,_rev:ad},"function"==typeof t&&(ac=t,t={})):(aa=ab,"function"==typeof ad?(ac=ad,t={}):(ac=t,t=ad)),t=t||{},t.was_delete=!0;var af={_id:aa._id,_rev:aa._rev||t.rev};return af._deleted=!0,D(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(aa,ac):void this.bulkDocs({docs:[af]},t,eq(ac))}),jf.prototype.revsDiff=fY("revsDiff",function(aa,ah,ad){function ag(ak,aj){ac.has(ak)||ac.set(ak,{missing:[]}),ac.get(ak).missing.push(aj)}function af(aj,ak){var al=aa[aj].slice(0);hf(ak,function(am,ap,aq,aw,av){var ax=ap+"-"+aq,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==av.status&&ag(aj,ax))}),al.forEach(function(am){ag(aj,am)})}"function"==typeof ah&&(ad=ah,ah={});var t=Object.keys(aa);if(!t.length){return ad(null,{})}var ab=0,ac=new gA.Map;t.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ac.set(aj,{missing:aa[aj]})}else{if(al){return ad(al)}af(aj,am)}if(++ab===t.length){var ak={};return ac.forEach(function(ap,aq){ak[aq]=ap}),ad(null,ak)}})},this)}),jf.prototype.bulkGet=fY("bulkGet",function(t,aa){hi(this,t,aa)}),jf.prototype.compactDocument=fY("compactDocument",function(ac,aa,ab){var t=this;this._getRevisionTree(ac,function(ah,ad){if(ah){return ab(ah)}var ag=iq(ad),aj=[],af=[];Object.keys(ag).forEach(function(ak){ag[ak]>aa&&aj.push(ak)}),hf(ad,function(ak,am,aq,al,au){var ap=am+"-"+aq;"available"===au.status&&-1!==aj.indexOf(ap)&&af.push(ap)}),t._doCompaction(ac,af,ab)})}),jf.prototype.compact=fY("compact",function(t,aa){"function"==typeof t&&(aa=t,t={});var ab=this;t=t||{},ab._compactionQueue=ab._compactionQueue||[],ab._compactionQueue.push({opts:t,callback:aa}),1===ab._compactionQueue.length&&ie(ab)}),jf.prototype._compact=function(aa,ac){function ag(ah){af.push(t.compactDocument(ah.id,0))}function ab(ah){var aj=ah.last_seq;jA.all(af).then(function(){return hj(t,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){ac(null,{ok:!0})})["catch"](ac)}var t=this,ad={return_docs:!1,last_seq:aa.last_seq||0},af=[];t.changes(ad).on("change",ag).on("complete",ab).on("error",ac)},jf.prototype.get=fY("get",function(aa,ah,ad){function ag(){var ak=[],aj=af.length;return aj?void af.forEach(function(al){t.get(aa,{rev:al,revs:ah.revs,attachments:ah.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ad(null,ak)})}):ad(null,ak)}if("function"==typeof ah&&(ad=ah,ah={}),"string"!=typeof aa){return ad(hK(hZ))}if(D(aa)&&"function"==typeof this._getLocal){return this._getLocal(aa,ad)}var af=[],t=this;if(!ah.open_revs){return this._get(aa,ah,function(al,ap){if(al){return ad(al)}var az=ap.doc,aA=ap.metadata,aw=ap.ctx;if(ah.conflicts){var aB=bt(aA);aB.length&&(az._conflicts=aB)}if(je(aA,az._rev)&&(az._deleted=!0),ah.revs||ah.revs_info){var aj=ft(aA.rev_tree),au=de(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(az._rev.split("-")[1])}),ay=au.ids.map(function(aC){return aC.id}).indexOf(az._rev.split("-")[1])+1,aq=au.ids.length-ay;if(au.ids.splice(ay,aq),au.ids.reverse(),ah.revs&&(az._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),ah.revs_info){var am=au.pos+au.ids.length;az._revs_info=au.ids.map(function(aC){return am--,{rev:am+"-"+aC.id,status:aC.opts.status}})}}if(ah.attachments&&az._attachments){var ak=az._attachments,ax=Object.keys(ak).length;if(0===ax){return ad(null,az)}Object.keys(ak).forEach(function(aC){this._getAttachment(ak[aC],{binary:ah.binary,ctx:aw},function(aE,aD){var aF=az._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--ax||ad(null,az)})},t)}else{if(az._attachments){for(var av in az._attachments){az._attachments.hasOwnProperty(av)&&(az._attachments[av].stub=!0)}}ad(null,az)}})}if("all"===ah.open_revs){this._getRevisionTree(aa,function(ak,aj){return ak?ad(ak):(af=fl(aj).map(function(al){return al.rev}),void ag())})}else{if(!Array.isArray(ah.open_revs)){return ad(hK(Q,"function_clause"))}af=ah.open_revs;for(var ab=0;ab<af.length;ab++){var ac=af[ab];if("string"!=typeof ac||!/^\d+-/.test(ac)){return ad(hK(bn))}}ag()}}),jf.prototype.getView=fY("getView",function(t,aa,ab){ig(this,t,"views",aa,ab)}),jf.prototype.getFilter=fY("getFilter",function(t,aa,ab){ig(this,t,"filters",aa,ab)}),jf.prototype.getAttachment=fY("getAttachment",function(ab,ad,t,ac){var aa=this;t instanceof Function&&(ac=t,t={}),this._get(ab,t,function(af,ag){return af?ac(af):ag.doc._attachments&&ag.doc._attachments[ad]?(t.ctx=ag.ctx,t.binary=!0,aa._getAttachment(ag.doc._attachments[ad],t,ac),void 0):ac(hK(u))})}),jf.prototype.allDocs=fY("allDocs",function(t,aa){if("function"==typeof t&&(aa=t,t={}),t.skip="undefined"!=typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys" in t){if(!Array.isArray(t.keys)){return aa(new TypeError("options.keys must be an array"))}var ab=["startkey","endkey","key"].filter(function(ac){return ac in t})[0];if(ab){return void aa(hK(hy,"Query parameter `"+ab+"` is not compatible with multi-get"))}if("http"!==this.type()){return hl(this,t,aa)}}return this._allDocs(t,aa)}),jf.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new fS(this,t,aa)},jf.prototype.close=fY("close",function(t){return this._closed=!0,this._close(t)}),jf.prototype.info=fY("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),jf.prototype.id=fY("id",function(t){return this._id(t)}),jf.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},jf.prototype.bulkDocs=fY("bulkDocs",function(ab,ad,t){if("function"==typeof ad&&(t=ad,ad={}),ad=ad||{},Array.isArray(ab)&&(ab={docs:ab}),!ab||!ab.docs||!Array.isArray(ab.docs)){return t(hK(iy))}for(var ac=0;ac<ab.docs.length;++ac){if("object"!=typeof ab.docs[ac]||Array.isArray(ab.docs[ac])){return t(hK(g0))}}var aa;return ab.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){aa=aa||a8(ag)})}),aa?t(hK(g4,aa)):("new_edits" in ad||("new_edits" in ab?ad.new_edits=ab.new_edits:ad.new_edits=!0),ad.new_edits||"http"===this.type()||ab.docs.sort(gT),et(ab.docs),this._bulkDocs(ab,ad,function(af,ag){return af?t(af):(ad.new_edits||(ag=ag.filter(function(ah){return ah.error})),void t(null,ag))}))}),jf.prototype.registerDependentDatabase=fY("registerDependentDatabase",function(ac,aa){function ab(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[ac]?!1:(ad.dependentDbs[ac]=!0,ad)}var t=new this.constructor(ac,this.__opts);hj(this,"_local/_pouch_dependentDbs",ab).then(function(){aa(null,{db:t})})["catch"](aa)}),jf.prototype.destroy=fY("destroy",function(ab,ad){function t(){ac._destroy(ab,function(ag,af){return ag?ad(ag):(ac._destroyed=!0,ac.emit("destroyed"),void ad(null,af||{ok:!0}))})}"function"==typeof ab&&(ad=ab,ab={});var ac=this,aa="use_prefix" in ac?ac.use_prefix:!0;return"http"===ac.type()?t():void ac.get("_local/_pouch_dependentDbs",function(ah,ak){if(ah){return 404!==ah.status?ad(ah):t()}var ag=ak.dependentDbs,aj=ac.constructor,af=Object.keys(ag).map(function(al){var am=aa?al.replace(new RegExp("^"+aj.prefix),""):al;return new aj(am,ac.__opts).destroy()});jA.all(af).then(t,ad)})}),iS.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},iS.prototype.fail=function(t){this.failed=t,this.execute()},iS.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},iS.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},iH(gy,jf),gy.debug=iG;var hp;if(iP()){hp=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),hp=!!localStorage.getItem("_pouch_check_localstorage")}catch(iL){hp=!1}}gy.adapters={},gy.preferredAdapters=[],gy.prefix="_pouch_";var i8=new jy.EventEmitter;iX(gy),gy.parseAdapter=function(aa,ah){var ad,ag,af=aa.match(/([a-z\-]*):\/\/(.*)/);if(af){if(aa=/http(s?)/.test(af[1])?af[1]+"://"+af[2]:af[2],ad=af[1],!gy.adapters[ad].valid()){throw"Invalid adapter"}return{name:aa,adapter:af[1]}}var t="idb" in gy.adapters&&"websql" in gy.adapters&&gv()&&localStorage["_pouch__websqldb_"+gy.prefix+aa];if(ah.adapter){ag=ah.adapter}else{if("undefined"!=typeof ah&&ah.db){ag="leveldb"}else{for(var ab=0;ab<gy.preferredAdapters.length;++ab){if(ag=gy.preferredAdapters[ab],ag in gy.adapters){if(t&&"idb"===ag){console.log('PouchDB is downgrading "'+aa+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ad=gy.adapters[ag];var ac=ad&&"use_prefix" in ad?ad.use_prefix:!0;return{name:ac?gy.prefix+aa:aa,adapter:ag}},gy.adapter=function(t,aa,ab){aa.valid()&&(gy.adapters[t]=aa,ab&&gy.preferredAdapters.push(t))},gy.plugin=function(t){return Object.keys(t).forEach(function(aa){gy.prototype[aa]=t[aa]}),gy},gy.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=iJ.extend({},t,ad),void gy.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return iH(aa,gy),iX(aa),aa.preferredAdapters=gy.preferredAdapters.slice(),Object.keys(gy).forEach(function(ab){ab in aa||(aa[ab]=gy[ab])}),aa};var iO=L(),ew=function(){},ar=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ez="queryKey",gn=/(?:^|&)([^&=]*)=?([^&]*)/g,gk=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,il=function(t){return atob(t)},hz=function(t){return btoa(t)},W=ha.extend,en={ajax:i7,parseUri:G,uuid:iF,Promise:jA,atob:il,btoa:hz,binaryStringToBlobOrBuffer:hT,clone:iC,extend:W,createError:hK},gP=fz.collate,ii=1,gN="pouchdb",i3=5,iV=0;h8.prototype.writeCheckpoint=function(t,aa){var ab=this;return this.updateTarget(t,aa).then(function(){return ab.updateSource(t,aa)})},h8.prototype.updateTarget=function(t,aa){return gL(this.target,this.id,t,aa,this.returnValue)},h8.prototype.updateSource=function(t,aa){var ab=this;return this.readOnlySource?jA.resolve(!0):gL(this.src,this.id,t,aa,this.returnValue)["catch"](function(ac){if(iB(ac)){return ab.readOnlySource=!0,!0}throw ac})};var fq={undefined:function(t,aa){return 0===gP(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return hd(aa,t).last_seq}};h8.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?jA.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return iV}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in fq?fq[ab](aa,ac):iV},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:iV}).then(function(){return iV},function(ac){return iB(ac)?(t.readOnlySource=!0,aa.last_seq):iV})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return iV})};var K=0,fV=ib.setImmediate||ib.setTimeout,gR=32768,hw=iv(function(ak,ah){function ac(){var aq=ag*aa,al=aq+aa;if(ag++,aj>ag){ab(t,ak,aq,al),fV(ac)}else{ab(t,ak,aq,al);var ap=t.end(!0),am=g5(ap);ah(null,am),t.destroy()}}var af="string"==typeof ak,ad=af?ak.length:ak.byteLength,aa=Math.min(gR,ad),aj=Math.ceil(ad/aa),ag=0,t=af?new fT:new fT.ArrayBuffer,ab=af?fZ:ia;ac()});iH(fo,jy.EventEmitter),fo.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},fo.prototype.ready=function(ab,ad){function t(){aa.cancel()}function ac(){ab.removeListener("destroyed",t),ad.removeListener("destroyed",t)}var aa=this;aa._readyCalled||(aa._readyCalled=!0,ab.once("destroyed",t),ad.once("destroyed",t),aa.once("complete",ac))};var he={replicate:ev,toPouch:jp},ex=he.replicate;iH(gU,jy.EventEmitter),gU.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var io=25,gi=50,gz={},hI=1800,F=iG("pouchdb:http");hJ.valid=function(){return !0},gb.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},gb.prototype.finish=function(){return this.promise};var h1,fs=function(t,aa){return aa&&t.then(function(ab){a0.nextTick(function(){aa(null,ab)})},function(ab){a0.nextTick(function(){aa(ab)})}),t},ju=function(t){return h5(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&fs(ab,aa),ab})},g8=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},h7=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},ff=function(ab){for(var ad={},t=0,ac=ab.length;ac>t;t++){ad["$"+ab[t]]=!0}var aa=Object.keys(ad),af=new Array(aa.length);for(t=0,ac=aa.length;ac>t;t++){af[t]=aa[t].substring(1)}return af},fj={uniq:ff,sequentialize:h7,fin:g8,callbackify:ju,promisedCallback:fs},hX=fz.collate,fa=fz.toIndexableString,g7=fz.normalizeKey,cr=fz.parseIndexableString;h1="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var ai=fj.callbackify,iM=fj.sequentialize,i=fj.uniq,at=fj.fin,r=fj.promisedCallback,h6={},a3=new gb,iE=50,ip={_sum:function(t,aa){return J(aa)},_count:function(t,aa){return aa.length},_stats:function(t,aa){function ab(ad){for(var ag=0,ah=0,af=ad.length;af>ah;ah++){var ac=ad[ah];ag+=ac*ac}return ag}return{sum:J(aa),min:Math.min.apply(null,aa),max:Math.max.apply(null,aa),count:aa.length,sumsqr:ab(aa)}}},gs=ai(function(){var t=this;return t._ddocCache&&delete t._ddocCache,"http"===t.type()?g(t):"function"==typeof t._viewCleanup?hc(t):S(t)}),fp=function(ab,ad,t){"function"==typeof ad&&(t=ad,ad={}),ad=ad?g1(ad):{},"function"==typeof ab&&(ab={map:ab});var ac=this,aa=jA.resolve().then(function(){return im(ac,ab,ad)});return r(aa,t),aa};iH(be,Error),iH(fc,Error);var gS={query:fp,viewCleanup:gs},fW=5,hF="document-store",N="by-sequence",gr="attach-store",iT="attach-seq-store",hL="meta-store",C="local-store",hR="detect-blob-support",iA={running:!1,queue:[]};iH(iY,jy.EventEmitter),iY.prototype.addListener=function(ab,af,t,ac){function aa(){function ah(){ad=!1}if(ag._listeners[af]){if(ad){return void (ad="waiting")}ad=!0;var aj=hE(ac,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);t.changes(aj).on("change",function(ak){ak.seq>ac.since&&!ac.cancelled&&(ac.since=ak.seq,ac.onChange(ak))}).on("complete",function(){"waiting"===ad&&setTimeout(function(){aa()},0),ad=!1}).on("error",ah)}}if(!this._listeners[af]){var ag=this,ad=!1;this._listeners[af]=aa,this.on(ab,aa)}},iY.prototype.removeListener=function(t,aa){aa in this._listeners&&jy.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},iY.prototype.notifyLocalWindows=function(t){iP()?chrome.storage.local.set({dbName:t}):gv()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},iY.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var go,gg=new gA.Map,U=new iY,iI=new gA.Map;jc.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var jj=7,hP=dn("document-store"),hh=dn("by-sequence"),ij=dn("attach-store"),ic=dn("local-store"),gu=dn("metadata-store"),I=dn("attach-seq-store"),hk=new gA.Map,gK=new iY,jx=1,i5="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+hh+" (seq, deleted)",Z="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+hh+" (doc_id, rev)",gw="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+hP+" (winningseq)",jz="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+I+" (seq)",hx="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+I+" (digest, seq)",h2=hh+".seq = "+hP+".winningseq",fi=hh+".seq AS seq, "+hh+".deleted AS deleted, "+hh+".json AS data, "+hh+".rev AS rev, "+hP+".json AS metadata";gM.use_prefix=!("undefined"!=typeof a0&&!a0.browser),gM.valid=hY;var jl={idb:jc,websql:gM};gy.ajax=i7,gy.utils=en,gy.Errors=ey,gy.replicate=he.replicate,gy.sync=eo,gy.version="5.3.2",gy.adapter("http",hJ),gy.adapter("https",hJ),gy.plugin(gS),Object.keys(jl).forEach(function(t){gy.adapter(t,jl[t],!0)}),a.exports=gy}).call(this,e(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});