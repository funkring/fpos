!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(l,i,b){function a(n,h){if(!i[n]){if(!l[n]){var j="function"==typeof require&&require;if(!h&&j){return j(n,!0)}if(e){return e(n,!0)}var f=new Error("Cannot find module '"+n+"'");throw f.code="MODULE_NOT_FOUND",f}var g=i[n]={exports:{}};l[n][0].call(g.exports,function(m){var p=l[n][1][m];return a(p?p:m)},g,g.exports,d,l,i,b)}return i[n].exports}for(var e="function"==typeof require&&require,k=0;k<b.length;k++){a(b[k])}return a}({1:[function(e,a,n){function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(f){return"function"==typeof f}function m(f){return"number"==typeof f}function i(f){return"object"==typeof f&&null!==f}function p(f){return void 0===f}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(f){if(!m(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},b.prototype.emit=function(g){var k,l,j,r,f,h;if(this._events||(this._events={}),"error"===g&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(k=arguments[1],k instanceof Error){throw k}throw TypeError('Uncaught, unspecified "error" event.')}if(l=this._events[g],p(l)){return !1}if(o(l)){switch(arguments.length){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),l.apply(this,r)}}else{if(i(l)){for(r=Array.prototype.slice.call(arguments,1),h=l.slice(),j=h.length,f=0;j>f;f++){h[f].apply(this,r)}}}return !0},b.prototype.addListener=function(f,g){var h;if(!o(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,o(g.listener)?g.listener:g),this._events[f]?i(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,i(this._events[f])&&!this._events[f].warned&&(h=p(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(f,h){function j(){this.removeListener(f,j),g||(g=!0,h.apply(this,arguments))}if(!o(h)){throw TypeError("listener must be a function")}var g=!1;return j.listener=h,this.on(f,j),this},b.prototype.removeListener=function(f,j){var k,l,h,g;if(!o(j)){throw TypeError("listener must be a function")}if(!this._events||!this._events[f]){return this}if(k=this._events[f],h=k.length,l=-1,k===j||o(k.listener)&&k.listener===j){delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,j)}else{if(i(k)){for(g=h;g-->0;){if(k[g]===j||k[g].listener&&k[g].listener===j){l=g;break}}if(0>l){return this}1===k.length?(k.length=0,delete this._events[f]):k.splice(l,1),this._events.removeListener&&this.emit("removeListener",f,j)}}return this},b.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],o(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},b.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?o(this._events[f])?[this._events[f]]:this._events[f].slice():[]},b.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(o(g)){return 1}if(g){return g.length}}return 0},b.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(r,b,f){function i(){h&&o&&(h=!1,o.length?t=o.concat(t):l=-1,t.length&&e())}function e(){if(!h){var g=a(i);h=!0;for(var j=t.length;j;){for(o=t,t=[];++l<j;){o&&o[l].run()}l=-1,j=t.length}o=null,h=!1,s(g)}}function B(g,j){this.fun=g,this.array=j}function u(){}var a,s,n=b.exports={};!function(){try{a=setTimeout}catch(g){a=function(){throw new Error("setTimeout is not defined")}}try{s=clearTimeout}catch(g){s=function(){throw new Error("clearTimeout is not defined")}}}();var o,t=[],h=!1,l=-1;n.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}t.push(new B(j,k)),1!==t.length||h||a(e,0)},B.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=u,n.addListener=u,n.once=u,n.off=u,n.removeListener=u,n.removeAllListeners=u,n.emit=u,n.binding=function(g){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(g){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],3:[function(e,a,b){(function(fp,gl){function fi(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function cn(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function gC(ab){if("function"==typeof ab.slice){return ab.slice(0)}var t=new ArrayBuffer(ab.byteLength),aa=new Uint8Array(t),ac=new Uint8Array(ab);return aa.set(ac),t}function go(t){if(t instanceof ArrayBuffer){return gC(t)}var aa=t.size,ab=t.type;return"function"==typeof t.slice?t.slice(0,aa,ab):t.webkitSlice(0,aa,ab)}function jd(t){var aa=Object.getPrototypeOf(t);if(null===aa){return !0}var ab=aa.constructor;return"function"==typeof ab&&ab instanceof ab&&at.call(ab)==hc}function iC(ab){var ad,t,ac;if(!ab||"object"!=typeof ab){return ab}if(Array.isArray(ab)){for(ad=[],t=0,ac=ab.length;ac>t;t++){ad[t]=iC(ab[t])}return ad}if(ab instanceof Date){return ab.toISOString()}if(cn(ab)){return go(ab)}if(!jd(ab)){return ab}ad={};for(t in ab){if(Object.prototype.hasOwnProperty.call(ab,t)){var aa=iC(ab[t]);"undefined"!=typeof aa&&(ad[t]=aa)}}return ad}function co(aa){var t=!1;return io(function(ab){if(t){throw new Error("once called more than once")}t=!0,aa.apply(this,ab)})}function fy(t){return io(function(ac){ac=iC(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ag,ah){fp.nextTick(function(){ad(ag,ah)})});var af=new gN(function(ag,ah){var ak;try{var al=co(function(ap,am){ap?ah(ap):ag(am)});ac.push(al),ak=t.apply(aa,ac),ak&&"function"==typeof ak.then&&ag(ak)}catch(aj){ah(aj)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function fc(t,aa){function ab(aj,ad,ag){if(hS.enabled){for(var ac=[aj._db_name,ad],ah=0;ah<ag.length-1;ah++){ac.push(ag[ah])}hS.apply(null,ac);var af=ag[ag.length-1];ag[ag.length-1]=function(ak,am){var al=[aj._db_name,ad];al=al.concat(ak?["error",ak]:["success",am]),hS.apply(null,al),af(ak,am)}}}return fy(io(function(ad){if(this._closed){return gN.reject(new Error("database is closed"))}if(this._destroyed){return gN.reject(new Error("database is destroyed"))}var ac=this;return ab(ac,t,ad),this.taskqueue.isReady?aa.apply(this,ad):new gN(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[t].apply(ac,ad))})})}))}function er(ab,ad){for(var t={},ac=0,aa=ad.length;aa>ac;ac++){var af=ad[ac];af in ab&&(t[af]=ab[af])}return t}function fZ(t){return t}function g9(t){return[{ok:t}]}function gf(aq,ak,aa){function am(){var av=[];t.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),aa(null,{results:av})}function ah(){++aj===ad&&am()}function ac(ax,av,aw){t[ax]={id:av,docs:aw},ah()}function af(){if(!(ag>=ab.length)){var av=Math.min(ag+hK,ab.length),aw=ab.slice(ag,av);ap(aw,ag),ag+=aw.length}}function ap(av,aw){av.forEach(function(ay,aC){var aA=aw+aC,ax=au[ay],az=er(ax[0],["atts_since","attachments"]);az.open_revs=ax.map(function(aD){return aD.rev}),az.open_revs=az.open_revs.filter(fZ);var aB=fZ;0===az.open_revs.length&&(delete az.open_revs,aB=g9),["revs","attachments","binary","ajax"].forEach(function(aD){aD in ak&&(az[aD]=ak[aD])}),aq.get(ay,az,function(aD,aF){var aE;aE=aD?[{error:aD}]:aB(aF),ac(aA,ay,aE),af()})})}var al=ak.docs,au={};al.forEach(function(av){av.id in au?au[av.id].push(av):au[av.id]=[av]});var ad=Object.keys(au).length,aj=0,t=new Array(ad),ab=Object.keys(au),ag=0;af()}function hR(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function ga(){return fz}function fU(t){hR()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):ga()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function ee(){hi.EventEmitter.call(this),this._listeners={},fU(this)}function jt(aa){if("undefined"!==console&&aa in console){var t=Array.prototype.slice.call(arguments,1);console[aa].apply(console,t)}}function ge(ab,ad){var t=600000;ab=parseInt(ab,10)||0,ad=parseInt(ad,10),ad!==ad||ab>=ad?ad=(ab||1)<<1:ad+=1,ad>t&&(ab=t>>1,ad=t);var ac=Math.random(),aa=ad-ab;return ~~(aa*ac+ab)}function gX(aa){var t=0;return aa||(t=2000),ge(aa,t)}function ii(aa,t){jt("info","The above "+aa+" is totally normal. "+t)}function gM(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function hs(ab,t,aa){function ac(af){for(var ad in ab){"function"!=typeof ab[ad]&&(this[ad]=ab[ad])}void 0!==aa&&(this.name=aa),void 0!==af&&(this.reason=af)}return ac.prototype=gM.prototype,new ac(t)}function iO(ab){var ad,t,ac,aa,af;return t=ab.error===!0&&"string"==typeof ab.name?ab.name:ab.error,af=ab.reason,ac=h3("name",t,af),ab.missing||"missing"===af||"deleted"===af||"not_found"===t?ac=he:"doc_validation"===t?(ac=u,aa=af):"bad_request"===t&&ac.message!==af&&(ac=ik),ac||(ac=h3("status",ab.status,af)||hl),ad=hs(ac,af,t),aa&&(ad.message=aa),ab.id&&(ad.id=ab.id),ab.status&&(ad.status=ab.status),ab.missing&&(ad.missing=ab.missing),ad}function jl(ab,ad,t){try{return !ab(ad,t)}catch(ac){var aa="Filter function threw: "+ac.toString();return hs(ik,aa)}}function fa(t){var aa={},ab=t.filter&&"function"==typeof t.filter;return aa.query=t.query_params,function(ad){ad.doc||(ad.doc={});var ac=ab&&jl(t.filter,ad.doc,aa);if("object"==typeof ac){return ac}if(ac){return !1}if(t.include_docs){if(!t.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function gh(ab){for(var t=[],aa=0,ac=ab.length;ac>aa;aa++){t=t.concat(ab[aa])}return t}function iu(aa){var t;if(aa?"string"!=typeof aa?t=hs(jC):/^_/.test(aa)&&!/^_(design|local)/.test(aa)&&(t=hs(be)):t=hs(hy),t){throw t}}function jB(aa,t){return"listenerCount" in aa?aa.listenerCount(t):hi.EventEmitter.listenerCount(aa,t)}function h2(aa){if(!aa){return null}var t=aa.split("/");return 2===t.length?t:1===t.length?[aa,aa]:null}function h0(aa){var t=h2(aa);return t?t.join("/"):null}function iS(aa){for(var ac=m.exec(aa),ag={},ab=14;ab--;){var t=fX[ab],ad=ac[ab]||"",af=-1!==["user","password"].indexOf(t);ag[t]=af?decodeURIComponent(ad):ad}return ag[ht]={},ag[fX[12]].replace(ei,function(ah,ak,aj){ak&&(ag[ht][ak]=aj)}),ag}function i3(t,aa,ab){return new gN(function(ad,ac){t.get(aa,function(af,ah){if(af){if(404!==af.status){return ac(af)}ah={}}var aj=ah._rev,ag=ab(ah);return ag?(ag._id=aa,ag._rev=aj,void ad(gO(t,ag,ab))):ad({updated:!1,rev:aj})})})}function gO(t,aa,ab){return t.put(aa).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return i3(t,aa._id,ab)})}function fd(t){return 0|Math.random()*t}function bo(ab,t){t=t||iV.length;var aa="",ac=-1;if(ab){for(;++ac<ab;){aa+=iV[fd(t)]}return aa}for(;++ac<36;){switch(ac){case 8:case 13:case 18:case 23:aa+="-";break;case 19:aa+=iV[3&fd(16)|8];break;default:aa+=iV[fd(16)]}}return aa}function w(t){for(var ag,ac,af,ad,aa=t.rev_tree.slice();ad=aa.pop();){var aj=ad.ids,ap=aj[2],ah=ad.pos;if(ap.length){for(var ak=0,am=ap.length;am>ak;ak++){aa.push({pos:ah+1,ids:ap[ak]})}}else{var ab=!!aj[1].deleted,al=aj[0];ag&&!(af!==ab?af:ac!==ah?ah>ac:al>ag)||(ag=al,ac=ah,af=ab)}}return ac+"-"+ag}function iD(ad,aa){for(var ag,aj=ad.slice();ag=aj.pop();){for(var ah=ag.pos,af=ag.ids,ac=af[2],ak=aa(0===ac.length,ah,af[0],ag.ctx,af[1]),ab=0,t=ac.length;t>ab;ab++){aj.push({pos:ah+1,ids:ac[ab],ctx:ak})}}}function gs(aa,t){return aa.pos-t.pos}function iP(ab){var t=[];iD(ab,function(ad,ah,af,aj,ag){ad&&t.push({rev:ah+"-"+af,pos:ah,opts:ag})}),t.sort(gs).reverse();for(var aa=0,ac=t.length;ac>aa;aa++){delete t[aa].pos}return t}function jw(aa){for(var ac=w(aa),ag=iP(aa.rev_tree),ab=[],t=0,ad=ag.length;ad>t;t++){var af=ag[t];af.rev===ac||af.opts.deleted||ab.push(af.rev)}return ab}function hU(aa){var t=[];return iD(aa.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(t.push(ag+"-"+ad),af.status="missing")}),t}function g0(t){for(var ag,ac=[],af=t.slice();ag=af.pop();){var ad=ag.pos,aa=ag.ids,aj=aa[0],ap=aa[1],ah=aa[2],ak=0===ah.length,am=ag.history?ag.history.slice():[];am.push({id:aj,opts:ap}),ak&&ac.push({pos:ad+1-am.length,ids:am});for(var ab=0,al=ah.length;al>ab;ab++){af.push({pos:ad+1,ids:ah[ab],history:am})}}return ac.reverse()}function hB(aa,t){return aa.pos-t.pos}function g6(ab,ad,t){for(var ac,aa=0,af=ab.length;af>aa;){ac=aa+af>>>1,t(ab[ac],ad)<0?aa=ac+1:af=ac}return aa}function a3(ab,t,aa){var ac=g6(ab,t,aa);ab.splice(ac,0,t)}function gz(ab,t){for(var ah,ac,aa=t,af=ab.length;af>aa;aa++){var ag=ab[aa],ad=[ag.id,ag.opts,[]];ac?(ac[2].push(ad),ac=ad):ah=ac=ad}return ah}function hr(aa,t){return aa[0]<t[0]?-1:1}function h1(ad,aa){for(var ag=[{tree1:ad,tree2:aa}],aj=!1;ag.length>0;){var ah=ag.pop(),af=ah.tree1,ac=ah.tree2;(af[1].status||ac[1].status)&&(af[1].status="available"===af[1].status||"available"===ac[1].status?"available":"missing");for(var ak=0;ak<ac[2].length;ak++){if(af[2][0]){for(var ab=!1,t=0;t<af[2].length;t++){af[2][t][0]===ac[2][ak][0]&&(ag.push({tree1:af[2][t],tree2:ac[2][ak]}),ab=!0)}ab||(aj="new_branch",a3(af[2],ac[2][ak],hr))}else{aj="new_leaf",af[2][0]=ac[2][ak]}}}return{conflicts:aj,tree:ad}}function L(ap,ak,aq){var ab,av=[],al=!1,aa=!1;if(!ap.length){return{tree:[ak],conflicts:"new_leaf"}}for(var ah=0,aw=ap.length;aw>ah;ah++){var t=ap[ah];if(t.pos===ak.pos&&t.ids[0]===ak.ids[0]){ab=h1(t.ids,ak.ids),av.push({pos:t.pos,ids:ab.tree}),al=al||ab.conflicts,aa=!0}else{if(aq!==!0){var ad=t.pos<ak.pos?t:ak,am=t.pos<ak.pos?ak:t,ag=am.pos-ad.pos,aj=[],ax=[];for(ax.push({ids:ad.ids,diff:ag,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],ac=0,af=az.length;af>ac;ac++){ax.push({ids:az[ac],diff:ay.diff-1,parent:ay.ids,parentIdx:ac})}}else{ay.ids[0]===am.ids[0]&&aj.push(ay)}}var au=aj[0];au?(ab=h1(au.ids,am.ids),au.parent[2][au.parentIdx]=ab.tree,av.push({pos:ad.pos,ids:ad.ids}),al=al||ab.conflicts,aa=!0):av.push(t)}else{av.push(t)}}}return aa||av.push(ak),av.sort(hB),{tree:av,conflicts:al||"internal_node"}}function fS(t,ag){for(var ac,af=g0(t),ad={},aa=0,aj=af.length;aj>aa;aa++){for(var ap=af[aa],ah=ap.ids,ak=Math.max(0,ah.length-ag),am={pos:ap.pos+ak,ids:gz(ah,ak)},ab=0;ak>ab;ab++){var al=ap.pos+ab+"-"+ah[ab].id;ad[al]=!0}ac=ac?L(ac,am,!0).tree:[am]}return iD(ac,function(av,aq,au){delete ad[aq+"-"+au]}),{tree:ac,revs:Object.keys(ad)}}function E(ab,ad,t){var ac=L(ab,ad),aa=fS(ac.tree,t);return{tree:aa.tree,stemmedRevs:aa.revs,conflicts:ac.conflicts}}function jo(ad,aa){for(var ag,aj=ad.slice(),ah=aa.split("-"),af=parseInt(ah[0],10),ac=ah[1];ag=aj.pop();){if(ag.pos===af&&ag.ids[0]===ac){return !0}for(var ak=ag.ids[2],ab=0,t=ak.length;t>ab;ab++){aj.push({pos:ag.pos+1,ids:ak[ab]})}}return !1}function ex(t){return t.ids}function hF(ab,ad){ad||(ad=w(ab));for(var t,ac=ad.substring(ad.indexOf("-")+1),aa=ab.rev_tree.map(ex);t=aa.pop();){if(t[0]===ac){return !!t[1].deleted}aa=aa.concat(t[2])}}function di(t){return/^_local/.test(t)}function iz(t){return i8("return "+t+";",{})}function eo(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function jE(t,aa){try{t.emit("change",aa)}catch(ab){jt("error",'Error in .on("change", function):',ab)}}function iT(aa,ac,ag){function ab(){t.cancel()}hi.EventEmitter.call(this);var t=this;this.db=aa,ac=ac?iC(ac):{};var ad=ac.complete=co(function(aj,ah){aj?jB(t,"error")>0&&t.emit("error",aj):t.emit("complete",ah),t.removeAllListeners(),aa.removeListener("destroyed",ab)});ag&&(t.on("complete",function(ah){ag(null,ah)}),t.on("error",ag)),aa.once("destroyed",ab),ac.onChange=function(ah){ac.isCancelled||(jE(t,ah),t.startSeq&&t.startSeq<=ah.seq&&(t.startSeq=!1))};var af=new gN(function(aj,ah){ac.complete=function(al,ak){al?ah(al):aj(ak)}});t.once("cancel",function(){aa.removeListener("destroyed",ab),ac.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ad(null,ah)},ad),aa.taskqueue.isReady?t.doChanges(ac):aa.taskqueue.addTask(function(){t.isCancelled?t.emit("cancel"):t.doChanges(ac)})}function im(ab,ad,t){var ac=[{rev:ab._rev}];"all_docs"===t.style&&(ac=iP(ad.rev_tree).map(function(af){return{rev:af.rev}}));var aa={id:ad.id,changes:ac,doc:ab};return hF(ad,ab._rev)&&(aa.deleted=!0),t.conflicts&&(aa.doc._conflicts=jw(ad),aa.doc._conflicts.length||delete aa.doc._conflicts),aa}function fu(aa,t){return t>aa?-1:aa>t?1:0}function l(t,aa){for(var ab=0;ab<t.length;ab++){if(aa(t[ab],ab)===!0){return t[ab]}}}function gk(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function ct(ab){for(var ad=0;ad<ab.length;ad++){var t=ab[ad];if(t._deleted){delete t._attachments}else{if(t._attachments){for(var ac=Object.keys(t._attachments),aa=0;aa<ac.length;aa++){var af=ac[aa];t._attachments[af]=er(t._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function ev(ab,ad){var t=fu(ab._id,ad._id);if(0!==t){return t}var ac=ab._revisions?ab._revisions.start:0,aa=ad._revisions?ad._revisions.start:0;return fu(ac,aa)}function iv(t){var aa={},ab=[];return iD(t,function(ac,ad,ah,af){var ag=ad+"-"+ah;return ac&&(aa[ag]=0),void 0!==af&&ab.push({from:af,to:ag}),ag}),ab.reverse(),ab.forEach(function(ac){void 0===aa[ac.from]?aa[ac.from]=1+aa[ac.to]:aa[ac.from]=Math.min(aa[ac.from],1+aa[ac.to])}),aa}function fq(ab,ad,t){var ac="limit" in ad?ad.keys.slice(ad.skip,ad.limit+ad.skip):ad.skip>0?ad.keys.slice(ad.skip):ad.keys;if(ad.descending&&ac.reverse(),!ac.length){return ab._allDocs({limit:0},t)}var aa={offset:ad.skip};return gN.all(ac.map(function(af){var ag=fs.extend({key:af,deleted:"ok"},ad);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new gN(function(aj,ah){ab._allDocs(ag,function(ak,al){return ak?ah(ak):(aa.total_rows=al.total_rows,void aj(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return aa.rows=af,aa})}function iW(ab){var t=ab._compactionQueue[0],ac=t.opts,aa=t.callback;ab.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ac.last_seq=ad.last_seq),ab._compact(ac,function(ag,af){ag?aa(ag):aa(null,af),fp.nextTick(function(){ab._compactionQueue.shift(),ab._compactionQueue.length&&iW(ab)})})})}function g5(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function eu(){hi.EventEmitter.call(this)}function hn(){this.isReady=!1,this.failed=!1,this.queue=[]}function fh(t){t&&gl.debug&&jt("error",t)}function ih(aa,ac){function ag(){ad.emit("destroyed",t)}function ab(){aa.removeListener("destroyed",ag),aa.emit("destroyed",aa)}var t=ac.originalName,ad=aa.constructor,af=ad._destructionListeners;aa.once("destroyed",ag),af.has(t)||af.set(t,[]),af.get(t).push(ab)}function O(aa,ac,ag){if(!(this instanceof O)){return new O(aa,ac,ag)}var ab=this;if("function"!=typeof ac&&"undefined"!=typeof ac||(ag=ac,ac={}),aa&&"object"==typeof aa&&(ac=aa,aa=void 0),"undefined"==typeof ag){ag=fh}else{var t=ag;ag=function(){return jt("warn","Using a callback for new PouchDB()is deprecated."),t.apply(null,arguments)}}aa=aa||ac.name,ac=iC(ac),delete ac.name,this.__opts=ac;var ad=ag;ab.auto_compaction=ac.auto_compaction,ab.prefix=O.prefix,eu.call(ab),ab.taskqueue=new hn;var af=new gN(function(aj,al){ag=function(ap,am){return ap?al(ap):(delete am.then,void aj(am))},ac=iC(ac);var ah,ak;return function(){try{if("string"!=typeof aa){throw ak=new Error("Missing/invalid DB name"),ak.code=400,ak}var ap=(ac.prefix||"")+aa;if(ah=O.parseAdapter(ap,ac),ac.originalName=aa,ac.name=ah.name,ac.adapter=ac.adapter||ah.adapter,ab._adapter=ac.adapter,iq("pouchdb:adapter")("Picked adapter: "+ac.adapter),ab._db_name=aa,!O.adapters[ac.adapter]){throw ak=new Error("Adapter is missing"),ak.code=404,ak}if(!O.adapters[ac.adapter].valid()){throw ak=new Error("Invalid Adapter"),ak.code=404,ak}}catch(am){ab.taskqueue.fail(am)}}(),ak?al(ak):(ab.adapter=ac.adapter,ab.replicate={},ab.replicate.from=function(aq,am,ap){return ab.constructor.replicate(aq,ab,am,ap)},ab.replicate.to=function(aq,am,ap){return ab.constructor.replicate(ab,aq,am,ap)},ab.sync=function(aq,am,ap){return ab.constructor.sync(ab,aq,am,ap)},ab.replicate.sync=ab.sync,void O.adapters[ac.adapter].call(ab,ac,function(am){return am?(ab.taskqueue.fail(am),void ag(am)):(ih(ab,ac),ab.emit("created",ab),O.emit("created",ac.originalName),ab.taskqueue.ready(ab),void ag(null,ab))}))});af.then(function(ah){ad(null,ah)},ad),ab.then=af.then.bind(af),ab["catch"]=af["catch"].bind(af)}function fW(aa){Object.keys(hi.EventEmitter.prototype).forEach(function(ab){"function"==typeof hi.EventEmitter.prototype[ab]&&(aa[ab]=gL[ab].bind(gL))});var t=aa._destructionListeners=new gi.Map;aa.on("destroyed",function(ab){t.get(ab).forEach(function(ac){ac()}),t["delete"](ab)})}function g4(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function hE(ab){if(!/^\d+\-./.test(ab)){return hs(dn)}var t=ab.indexOf("-"),aa=ab.substring(0,t),ac=ab.substring(t+1);return{prefix:parseInt(aa,10),id:ac}}function fv(aa,ac){for(var ag=aa.start-aa.ids.length+1,ab=aa.ids,t=[ab[0],ac,[]],ad=1,af=ab.length;af>ad;ad++){t=[ab[ad],{status:"missing"},[t]]}return[{pos:ag,ids:t}]}function hA(ad,aa){var ag,aj,ah,af={status:"available"};if(ad._deleted&&(af.deleted=!0),aa){if(ad._id||(ad._id=bo()),aj=bo(32,16).toLowerCase(),ad._rev){if(ah=hE(ad._rev),ah.error){return ah}ad._rev_tree=[{pos:ah.prefix,ids:[ah.id,{status:"missing"},[[aj,af,[]]]]}],ag=ah.prefix+1}else{ad._rev_tree=[{pos:1,ids:[aj,af,[]]}],ag=1}}else{if(ad._revisions&&(ad._rev_tree=fv(ad._revisions,af),ag=ad._revisions.start,aj=ad._revisions.ids[0]),!ad._rev_tree){if(ah=hE(ad._rev),ah.error){return ah}ag=ah.prefix,aj=ah.id,ad._rev_tree=[{pos:ag,ids:[aj,af,[]]}]}}iu(ad._id),ad._rev=ag+"-"+aj;var ac={metadata:{},data:{}};for(var ak in ad){if(Object.prototype.hasOwnProperty.call(ad,ak)){var ab="_"===ak[0];if(ab&&!q[ak]){var t=hs(u,ak);throw t.message=u.message+": "+ak,t}ab&&!gt[ak]?ac.metadata[ak.slice(1)]=ad[ak]:ac.data[ak]=ad[ak]}}return ac}function dt(ab){for(var ad="",t=new Uint8Array(ab),ac=t.byteLength,aa=0;ac>aa;aa++){ad+=String.fromCharCode(t[aa])}return ad}function H(t){return gu(dt(t))}function gE(ab,ad){ab=ab||[],ad=ad||{};try{return new Blob(ab,ad)}catch(t){if("TypeError"!==t.name){throw t}for(var ac="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,aa=new ac,af=0;af<ab.length;af+=1){aa.append(ab[af])}return aa.getBlob(ad.type)}}function iy(ab){for(var ad=ab.length,t=new ArrayBuffer(ad),ac=new Uint8Array(t),aa=0;ad>aa;aa++){ac[aa]=ab.charCodeAt(aa)}return t}function I(aa,t){return gE([iy(aa)],{type:t})}function Y(aa,t){return I(fm(aa),t)}function a9(ab,t){if("undefined"==typeof FileReader){return t(dt((new FileReaderSync).readAsArrayBuffer(ab)))}var aa=new FileReader,ac="function"==typeof aa.readAsBinaryString;aa.onloadend=function(af){var ad=af.target.result||"";return ac?t(ad):void t(dt(ad))},ac?aa.readAsBinaryString(ab):aa.readAsArrayBuffer(ab)}function fx(aa,t){a9(aa,function(ab){t(gu(ab))})}function gd(t,aa){if("undefined"==typeof FileReader){return aa((new FileReaderSync).readAsArrayBuffer(t))}var ab=new FileReader;ab.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);aa(ac)},ab.readAsArrayBuffer(t)}function ja(t){return gu(t)}function bn(ab,t,aa,ac){(aa>0||ac<t.byteLength)&&(t=new Uint8Array(t,aa,Math.min(ac,t.byteLength)-aa)),ab.append(t)}function ci(ab,t,aa,ac){(aa>0||ac<t.length)&&(t=t.substring(aa,ac)),ab.appendBinary(t)}function hH(ad,aa){function ag(){var aq=ak*af,al=aq+af;if(ak++,ac>ak){t(ab,ad,aq,al),bt(ag)}else{t(ab,ad,aq,al);var ap=ab.end(!0),am=ja(ap);aa(am),ab.destroy()}}var aj="string"==typeof ad,ah=aj?ad.length:ad.byteLength,af=Math.min(iU,ah),ac=Math.ceil(ah/af),ak=0,ab=aj?new ju:new ju.ArrayBuffer,t=aj?ci:bn;ag()}function R(t){return ju.hash(t)}function gI(ab,t,ah){function ac(al){try{return fm(al)}catch(aj){var ak=hs(g3,"Attachment is not a valid base64 string");return{error:ak}}}function aa(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ac(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===t?aj.data=I(al,aj.content_type):"base64"===t?aj.data=gu(al):aj.data=al,hH(al,function(am){aj.digest="md5-"+am,ak()})}else{gd(aj.data,function(am){"binary"===t?aj.data=dt(am):"base64"===t&&(aj.data=H(am)),hH(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function af(){ad++,ab.length===ad&&(ag?ah(ag):ah())}if(!ab.length){return ah()}var ag,ad=0;ab.forEach(function(ak){function am(aq){ag=aq,al++,al===aj.length&&af()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return af()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&aa(ak.data._attachments[ap],am)}})}function jD(ag,ab,t,aj,av,aA,ad,ak){if(jo(ab.rev_tree,t.metadata.rev)){return aj[av]=t,aA()}var aw=ab.winningRev||w(ab),au="deleted" in ab?ab.deleted:hF(ab,aw),al="deleted" in t.metadata?t.metadata.deleted:hF(t.metadata),aq=/^1-/.test(t.metadata.rev);if(au&&!al&&ak&&aq){var ac=t.data;ac._rev=aw,ac._id=t.metadata.id,t=hA(ac,ak)}var am=E(ab.rev_tree,t.metadata.rev_tree[0],ag),ax=ak&&(au&&al||!au&&"new_leaf"!==am.conflicts||au&&!al&&"new_branch"===am.conflicts);if(ax){var ay=hs(fV);return aj[av]=ay,aA()}var az=t.metadata.rev;t.metadata.rev_tree=am.tree,t.stemmedRevs=am.stemmedRevs||[],ab.rev_map&&(t.metadata.rev_map=ab.rev_map);var ah,aa=w(t.metadata),ap=hF(t.metadata,aa),af=au===ap?0:ap>au?-1:1;ah=az===aa?ap:hF(t.metadata,az),ad(t,aa,ap,ah,!0,af,av,aA)}function a8(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function jA(ac,aa,aq,ak,au,ah,af,am,ag){function t(aC,aw,aA){var ax=w(aC.metadata),av=hF(aC.metadata,ax);if("was_delete" in am&&av){return ah[aw]=hs(he,"deleted"),aA()}var az=ap&&a8(aC);if(az){var ay=hs(fV);return ah[aw]=ay,aA()}var aB=av?0:1;af(aC,ax,av,av,!1,aB,aw,aA)}function ad(){++ab===aj&&ag&&ag()}ac=ac||1000;var ap=am.new_edits,al=new gi.Map,ab=0,aj=aa.length;aa.forEach(function(aw,ay){if(aw._id&&di(aw._id)){var ax=aw._deleted?"_removeLocal":"_putLocal";return void aq[ax](aw,{ctx:au},function(aA,az){ah[ay]=aA||az,ad()})}var av=aw.metadata.id;al.has(av)?(aj--,al.get(av).push([aw,ay])):al.set(av,[[aw,ay]])}),al.forEach(function(ay,aw){function ax(){++az<ay.length?av():ad()}function av(){var aC=ay[az],aA=aC[0],aB=aC[1];if(ak.has(aw)){jD(ac,ak.get(aw),aA,ah,aB,ax,af,ap)}else{var aD=E([],aA.metadata.rev_tree[0],ac);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],t(aA,aB,ax)}}var az=0;av()})}function gn(aa){try{return JSON.parse(aa)}catch(t){return h5.parse(aa)}}function Z(t){return t.length<50000?JSON.parse(t):gn(t)}function y(aa){try{return JSON.stringify(aa)}catch(t){return h5.stringify(aa)}}function gy(ab,ad,t,ac){try{ab.apply(ad,t)}catch(aa){ac.emit("error",aa)}}function jk(aa){if(!hV.running&&hV.queue.length){hV.running=!0;var t=hV.queue.shift();t.action(function(ac,ab){gy(t.callback,this,[ac,ab],aa),hV.running=!1,fp.nextTick(function(){jk(aa)})})}}function iJ(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(hs(ew,aa,ab.type))}}function ib(t,aa,ab){return{data:y(t),winningRev:aa,deletedOrLocal:ab?"1":"0",seq:t.seq,id:t.id}}function a7(aa){if(!aa){return null}var t=Z(aa.data);return t.winningRev=aa.winningRev,t.deleted="1"===aa.deletedOrLocal,t.seq=aa.seq,t}function z(aa){if(!aa){return aa}var t=aa._doc_id_rev.lastIndexOf(":");return aa._id=aa._doc_id_rev.substring(0,t-1),aa._rev=aa._doc_id_rev.substring(t+1),delete aa._doc_id_rev,aa}function hL(ab,t,aa,ac){aa?ac(ab?"string"!=typeof ab?ab:Y(ab,t):gE([""],{type:t})):ab?"string"!=typeof ab?a9(ab,function(ad){ac(gu(ad))}):ac(ab):ac("")}function jq(ab,t,ah,ac){function aa(){++ad===ag.length&&ac&&ac()}function af(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ah.objectStore(hQ).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,aa()}}var ag=Object.keys(ab._attachments||{});if(!ag.length){return ac&&ac()}var ad=0;ag.forEach(function(aj){t.attachments&&t.include_docs?af(ab,aj):(ab._attachments[aj].stub=!0,aa())})}function hN(aa,t){return gN.all(aa.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return gN.all(ab.map(function(ad){var ag=ac.doc._attachments[ad];if("body" in ag){var af=ag.body,ah=ag.content_type;return new gN(function(aj){hL(af,ah,t,function(ak){ac.doc._attachments[ad]=fs.extend(er(ag,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function hv(ad,aa,ag){function aj(){t--,t||ah()}function ah(){af.length&&af.forEach(function(am){var al=ab.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ak["delete"](am)}})}var af=[],ac=ag.objectStore(gv),ak=ag.objectStore(hQ),ab=ag.objectStore(gH),t=ad.length;ad.forEach(function(al){var am=ac.index("_doc_id_rev"),ap=aa+"::"+al;am.getKey(ap).onsuccess=function(aq){var au=aq.target.result;if("number"!=typeof au){return aj()}ac["delete"](au);var av=ab.index("seq").openCursor(IDBKeyRange.only(au));av.onsuccess=function(ay){var aw=ay.target.result;if(aw){var ax=aw.value.digestSeq.split("::")[0];af.push(ax),ab["delete"](aw.primaryKey),aw["continue"]()}else{aj()}}}})}function hz(ab,t,aa){try{return{txn:ab.transaction(t,aa)}}catch(ac){return{error:ac}}}function i2(aj,ax,aH,aJ,aG,ap,az){function au(){var aN=[h8,gv,hQ,J,gH],aO=hz(aG,aN,"readwrite");return aO.error?az(aO.error):(aC=aO.txn,aC.onabort=iJ(az),aC.ontimeout=iJ(az),aC.oncomplete=aF,av=aC.objectStore(h8),aB=aC.objectStore(gv),ah=aC.objectStore(hQ),ac=aC.objectStore(gH),void aM(function(aP){return aP?(ak=!0,az(aP)):void aL()}))}function am(){jA(aj.revs_limit,aa,aJ,aE,aC,t,ay,aH)}function aL(){function aN(){++aS===aa.length&&am()}function aP(aU){var aV=a7(aU.target.result);aV&&aE.set(aV.id,aV),aN()}if(aa.length){for(var aS=0,aO=0,aT=aa.length;aT>aO;aO++){var aQ=aa[aO];if(aQ._id&&di(aQ._id)){aN()}else{var aR=av.get(aQ.metadata.id);aR.onsuccess=aP}}}}function aF(){ak||(ap.notify(aJ._meta.name),aJ._meta.docCount+=aA,az(null,t))}function aI(aO,aP){var aN=ah.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=hs(gT,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(aa.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){aI(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function ay(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?ag(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(ba){var bc=aP.stemmedRevs||[];aV&&aJ.auto_compaction&&(bc=bc.concat(hU(aP.metadata))),bc&&bc.length&&hv(bc,aP.metadata.id,aC),aT.seq=ba.target.result,delete aT.rev;var aZ=ib(aT,aW,aU),bb=av.put(aZ);bb.onsuccess=aN}function aX(ba){ba.preventDefault(),ba.stopPropagation();var bb=aB.index("_doc_id_rev"),aZ=bb.getKey(aR._doc_id_rev);aZ.onsuccess=function(bc){var bd=aB.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){t[aS]={ok:!0,id:aT.id,rev:aW},aE.set(aP.metadata.id,aP.metadata),aD(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=aB.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function ag(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aY){var bb=aP.data._attachments[aY];if(bb.stub){aO++,aN()}else{var aZ=bb.data;delete bb.data,bb.revpos=parseInt(aW,10);var ba=bb.digest;al(ba,aZ,aV)}})}function aD(aT,aO,aR){function aU(){++aP===aQ.length&&aR()}function aS(aW){var aX=aT.data._attachments[aW].digest,aV=ac.put({seq:aO,digestSeq:aX+"::"+aO});aV.onsuccess=aU,aV.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aU()}}var aP=0,aQ=Object.keys(aT.data._attachments||{});if(!aQ.length){return aR()}for(var aN=0;aN<aQ.length;aN++){aS(aQ[aN])}}function al(aO,aQ,aN){var aP=ah.count(aO);aP.onsuccess=function(aT){var aS=aT.target.result;if(aS){return aN()}var aU={digest:aO,body:aQ},aR=ah.put(aU);aR.onsuccess=aN}}for(var aC,av,aB,ah,ac,aq,aa=ax.docs,aA=0,ab=0,af=aa.length;af>ab;ab++){var aw=aa[ab];aw._id&&di(aw._id)||(aw=aa[ab]=hA(aw,aH.new_edits),aw.error&&!aq&&(aq=aw))}if(aq){return az(aq)}var t=new Array(aa.length),aE=new gi.Map,ak=!1,aK=aJ._meta.blobSupport?"blob":"base64";gI(aa,aK,function(aN){return aN?az(aN):void au()})}function jc(ab,ad,t,ac,aa){try{if(ab&&ad){return aa?IDBKeyRange.bound(ad,ab,!t,!1):IDBKeyRange.bound(ab,ad,!1,!t)}if(ab){return aa?IDBKeyRange.upperBound(ab):IDBKeyRange.lowerBound(ab)}if(ad){return aa?IDBKeyRange.lowerBound(ad,!t):IDBKeyRange.upperBound(ad,!t)}if(ac){return IDBKeyRange.only(ac)}}catch(af){return{error:af}}return null}function hf(ab,t,aa,ac){return"DataError"===aa.name&&0===aa.code?ac(null,{total_rows:ab._meta.docCount,offset:t.skip,rows:[]}):void ac(hs(ew,aa.name,aa.message))}function hq(ab,ad,t,ac){function aa(aj,aw){function ak(aN,aK,aM){var aL=aN.id+"::"+aM;aJ.get(aL).onsuccess=function(aO){aK.doc=z(aO.target.result),aj.conflicts&&(aK.doc._conflicts=jw(aN)),jq(aK.doc,aj,au)}}function av(aM,aK,aL){var aN={id:aL.id,key:aL.id,value:{rev:aK}},aO=aL.deleted;if("ok"===aj.deleted){aI.push(aN),aO?(aN.value.deleted=!0,aN.doc=null):aj.include_docs&&ak(aL,aN,aK)}else{if(!aO&&aH--<=0&&(aI.push(aN),aj.include_docs&&ak(aL,aN,aK),0===--ax)){return}}aM["continue"]()}function aA(aM){ag=ad._meta.docCount;var aK=aM.target.result;if(aK){var aN=a7(aK.value),aL=aN.winningRev;av(aK,aL,aN)}}function aD(){aw(null,{total_rows:ag,offset:aj.skip,rows:aI})}function am(){aj.attachments?hN(aI,aj.binary).then(aD):aD()}var aE="startkey" in aj?aj.startkey:!1,aB="endkey" in aj?aj.endkey:!1,aG="key" in aj?aj.key:!1,aH=aj.skip||0,ax="number"==typeof aj.limit?aj.limit:-1,ah=aj.inclusive_end!==!1,al="descending" in aj&&aj.descending?"prev":null,aq=jc(aE,aB,ah,aG,al);if(aq&&aq.error){return hf(ad,aj,aq.error,aw)}var aC=[h8,gv];aj.attachments&&aC.push(hQ);var ay=hz(t,aC,"readonly");if(ay.error){return aw(ay.error)}var au=ay.txn,aF=au.objectStore(h8),az=au.objectStore(gv),ap=al?aF.openCursor(aq,al):aF.openCursor(aq),aJ=az.index("_doc_id_rev"),aI=[],ag=0;au.oncomplete=am,ap.onsuccess=aA}function af(ah,ag){return 0===ah.limit?ag(null,{total_rows:ad._meta.docCount,offset:ah.skip,rows:[]}):void aa(ah,ag)}af(ab,ac)}function jn(t){return new gN(function(ab){var aa=gE([""]);t.objectStore(iw).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function S(t,aa){var ab=this;hV.queue.push({action:function(ac){ix(ab,t,ac)},callback:aa}),jk(ab.constructor)}function ix(ag,af,aa){function ap(au){var av=au.createObjectStore(h8,{keyPath:"id"});au.createObjectStore(gv,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(hQ,{keyPath:"digest"}),au.createObjectStore(ir,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(iw),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(J,{keyPath:"_id"});var aw=au.createObjectStore(gH,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function am(au,av){var aw=au.objectStore(h8);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=hF(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function ab(au){au.createObjectStore(J,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ah(av,ay){var az=av.objectStore(J),ax=av.objectStore(h8),aw=av.objectStore(gv),au=ax.openCursor();au.onsuccess=function(aH){var aK=aH.target.result;if(aK){var aE=aK.value,aB=aE.id,aC=di(aB),aF=w(aE);if(aC){var aI=aB+"::"+aF,aL=aB+"::",aG=aB+"::~",aJ=aw.index("_doc_id_rev"),aA=IDBKeyRange.bound(aL,aG,!1,!1),aD=aJ.openCursor(aA);aD.onsuccess=function(aN){if(aD=aN.target.result){var aM=aD.value;aM._doc_id_rev===aI&&az.put(aM),aw["delete"](aD.primaryKey),aD["continue"]()}else{ax["delete"](aK.primaryKey),aK["continue"]()}}}else{aK["continue"]()}}else{ay&&ay()}}}function al(au){var av=au.createObjectStore(gH,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ak(av,ay){var az=av.objectStore(gv),ax=av.objectStore(hQ),aw=av.objectStore(gH),au=ax.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (az.openCursor().onsuccess=function(aL){var aF=aL.target.result;if(!aF){return ay()}for(var aG=aF.value,aD=aF.primaryKey,aJ=Object.keys(aG._attachments||{}),aH={},aI=0;aI<aJ.length;aI++){var aK=aG._attachments[aJ[aI]];aH[aK.digest]=!0}var aC=Object.keys(aH);for(aI=0;aI<aC.length;aI++){var aE=aC[aI];aw.put({seq:aD,digestSeq:aE+"::"+aD})}aF["continue"]()}):ay()}}function ad(ay){function ax(az){return az.data?a7(az):(az.deleted="1"===az.deletedOrLocal,az)}var au=ay.objectStore(gv),av=ay.objectStore(h8),aw=av.openCursor();aw.onsuccess=function(aC){function aB(){var aF=az.id+"::",aH=az.id+"::￿",aG=au.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aD()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aD(){var aE=ib(az,az.winningRev,az.deleted),aF=av.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var az=ax(aA.value);return az.winningRev=az.winningRev||w(az),az.seq?aD():void aB()}}}var aq=af.name,ac=null;ag._meta=null,ag.type=function(){return"idb"},ag._id=fy(function(au){au(null,ag._meta.instanceId)}),ag._bulkDocs=function(aw,av,au){i2(af,aw,av,ag,ac,a2,au)},ag._get=function(ay,au,av){function aA(){av(ax,{doc:az,metadata:aB,ctx:aC})}var az,aB,ax,aC=au.ctx;if(!aC){var aw=hz(ac,[h8,gv,hQ],"readonly");if(aw.error){return av(aw.error)}aC=aw.txn}aC.objectStore(h8).get(ay).onsuccess=function(aG){if(aB=a7(aG.target.result),!aB){return ax=hs(he,"missing"),aA()}if(hF(aB)&&!au.rev){return ax=hs(he,"deleted"),aA()}var aE=aC.objectStore(gv),aD=au.rev||aB.winningRev,aF=aB.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return az=aH.target.result,az&&(az=z(az)),az?void aA():(ax=hs(he,"missing"),aA())}}},ag._getAttachment=function(ay,au,av,aA,az){var aB;if(aA.ctx){aB=aA.ctx}else{var ax=hz(ac,[h8,gv,hQ],"readonly");if(ax.error){return az(ax.error)}aB=ax.txn}var aC=av.digest,aw=av.content_type;aB.objectStore(hQ).get(aC).onsuccess=function(aE){var aD=aE.target.result.body;hL(aD,aw,aA.binary,function(aF){az(null,aF)})}},ag._info=function(av){if(null===ac||!ie.has(aq)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var au,aw,ax=hz(ac,[gv],"readonly");if(ax.error){return av(ax.error)}var ay=ax.txn,az=ay.objectStore(gv).openCursor(null,"prev");az.onsuccess=function(aB){var aC=aB.target.result;au=aC?aC.key:0,aw=ag._meta.docCount},ay.oncomplete=function(){av(null,{doc_count:aw,update_seq:au,idb_attachment_format:ag._meta.blobSupport?"binary":"base64"})}},ag._allDocs=function(av,au){hq(av,ag,ac,au)},ag._changes=function(aJ){function aD(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aw=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=aK.get(aU);aT.onsuccess=function(aV){aO(z(aV.target.result))}}function aO(aU){var aT=aJ.processChange(aU,aN,aJ);aT.seq=aN.seq;var aV=aC(aT);return"object"==typeof aV?aJ.complete(aV):(aV&&(aB++,av&&au.push(aT),aJ.attachments&&aJ.include_docs?jq(aU,aJ,aG,function(){hN([aT],aJ.binary).then(function(){aJ.onChange(aT)})}):aJ.onChange(aT)),void (aB!==az&&aS["continue"]()))}var aQ=z(aS.value),aR=aS.key;if(aH&&!aH.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aI.get(aQ._id).onsuccess=function(aT){aN=a7(aT.target.result),ay.set(aQ._id,aN),aM()})}function aL(aN){var aM=aN.target.result;aM&&aD(aM)}function aF(){var aM=[h8,gv];aJ.attachments&&aM.push(hQ);var aN=hz(ac,aM,"readonly");if(aN.error){return aJ.complete(aN.error)}aG=aN.txn,aG.onabort=iJ(aJ.complete),aG.oncomplete=aE,ax=aG.objectStore(gv),aI=aG.objectStore(h8),aK=ax.index("_doc_id_rev");var aO;aO=aJ.descending?ax.openCursor(null,"prev"):ax.openCursor(IDBKeyRange.lowerBound(aJ.since,!0)),aO.onsuccess=aL}function aE(){function aM(){aJ.complete(null,{results:au,last_seq:aw})}!aJ.continuous&&aJ.attachments?hN(au).then(aM):aM()}if(aJ=iC(aJ),aJ.continuous){var aA=aq+":"+bo();return a2.addListener(aq,aA,ag,aJ),a2.notify(aq),{cancel:function(){a2.removeListener(aq,aA)}}}var aH=aJ.doc_ids&&new gi.Set(aJ.doc_ids);aJ.since=aJ.since||0;var aw=aJ.since,az="limit" in aJ?aJ.limit:-1;0===az&&(az=1);var av;av="return_docs" in aJ?aJ.return_docs:"returnDocs" in aJ?aJ.returnDocs:!0;var aG,ax,aI,aK,au=[],aB=0,aC=fa(aJ),ay=new gi.Map;aF()},ag._close=function(au){return null===ac?au(hs(gx)):(ac.close(),ie["delete"](aq),ac=null,void au())},ag._getRevisionTree=function(ay,ax){var au=hz(ac,[h8],"readonly");if(au.error){return ax(au.error)}var av=au.txn,aw=av.objectStore(h8).get(ay);aw.onsuccess=function(aA){var az=a7(aA.target.result);az?ax(null,az.rev_tree):ax(hs(he))}},ag._doCompaction=function(aA,av,aw){var az=[h8,gv,hQ,gH],au=hz(ac,az,"readwrite");if(au.error){return aw(au.error)}var ax=au.txn,ay=ax.objectStore(h8);ay.get(aA).onsuccess=function(aC){var aE=a7(aC.target.result);iD(aE.rev_tree,function(aI,aG,aJ,aH,aK){var aF=aG+"-"+aJ;-1!==av.indexOf(aF)&&(aK.status="missing")}),hv(av,aA,ax);var aD=aE.winningRev,aB=aE.deleted;ax.objectStore(h8).put(ib(aE,aD,aB))},ax.onabort=iJ(aw),ax.oncomplete=function(){aw()}},ag._getLocal=function(ay,ax){var au=hz(ac,[J],"readonly");if(au.error){return ax(au.error)}var av=au.txn,aw=av.objectStore(J).get(ay);aw.onerror=iJ(ax),aw.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,ax(null,az)):ax(hs(he))}},ag._putLocal=function(ay,aD,av){"function"==typeof aD&&(av=aD,aD={}),delete ay._revisions;var aA=ay._rev,az=ay._id;aA?ay._rev="0-"+(parseInt(aA.split("-")[1],10)+1):ay._rev="0-1";var aB,aw=aD.ctx;if(!aw){var aC=hz(ac,[J],"readwrite");if(aC.error){return av(aC.error)}aw=aC.txn,aw.onerror=iJ(av),aw.oncomplete=function(){aB&&av(null,aB)}}var au,ax=aw.objectStore(J);aA?(au=ax.get(az),au.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aA){var aG=ax.put(ay);aG.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)}}else{av(hs(fV))}}):(au=ax.add(ay),au.onerror=function(aE){av(hs(fV)),aE.preventDefault(),aE.stopPropagation()},au.onsuccess=function(){aB={ok:!0,id:ay._id,rev:ay._rev},aD.ctx&&av(null,aB)})},ag._removeLocal=function(ay,au,av){"function"==typeof au&&(av=au,au={});var aA=au.ctx;if(!aA){var az=hz(ac,[J],"readwrite");if(az.error){return av(az.error)}aA=az.txn,aA.oncomplete=function(){aB&&av(null,aB)}}var aB,ax=ay._id,aC=aA.objectStore(J),aw=aC.get(ax);aw.onerror=iJ(av),aw.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===ay._rev?(aC["delete"](ax),aB={ok:!0,id:ax,rev:"0-0"},au.ctx&&av(null,aB)):av(hs(he))}},ag._destroy=function(au,aw){a2.removeAllListeners(aq);var ax=o.get(aq);ax&&ax.result&&(ax.result.close(),ie["delete"](aq));var av=indexedDB.deleteDatabase(aq);av.onsuccess=function(){o["delete"](aq),ga()&&aq in localStorage&&delete localStorage[aq],aw(null,{ok:!0})},av.onerror=iJ(aw)};var aj=ie.get(aq);if(aj){return ac=aj.idb,ag._meta=aj.global,void fp.nextTick(function(){aa(null,ag)})}var t;t=af.storage?jy(aq,af.storage):indexedDB.open(aq,g2),o.set(aq,t),t.onupgradeneeded=function(ay){function av(){var aA=aw[au-1];au++,aA&&aA(az,av)}var ax=ay.target.result;if(ay.oldVersion<1){return ap(ax)}var az=ay.currentTarget.transaction;ay.oldVersion<3&&ab(ax),ay.oldVersion<4&&al(ax);var aw=[am,ah,ak,ad],au=ay.oldVersion;av()},t.onsuccess=function(ax){ac=ax.target.result,ac.onversionchange=function(){ac.close(),ie["delete"](aq)},ac.onabort=function(aA){jt("error","Database has a global failure",aA.target.error),ac.close(),ie["delete"](aq)};var az=ac.transaction([ir,iw,h8],"readwrite"),aw=az.objectStore(ir).get(ir),ay=null,av=null,au=null;aw.onsuccess=function(aB){var aD=function(){null!==ay&&null!==av&&null!==au&&(ag._meta={name:aq,instanceId:au,blobSupport:ay,docCount:av},ie.set(aq,{idb:ac,global:ag._meta}),aa(null,ag))},aA=aB.target.result||{id:ir};aq+"_id" in aA?(au=aA[aq+"_id"],aD()):(au=bo(),aA[aq+"_id"]=au,az.objectStore(ir).put(aA).onsuccess=function(){aD()}),iB||(iB=jn(az)),iB.then(function(aE){ay=aE,aD()});var aC=az.objectStore(h8).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){av=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";jt("error",au),aa(hs(ew,au))}}function jy(t,aa){try{return indexedDB.open(t,{version:g2,storage:aa})}catch(ab){return indexedDB.open(t,g2)}}function ji(t){t.adapter("idb",S,!0)}function jf(t){return decodeURIComponent(escape(t))}function js(t){return 65>t?t-48:t-55}function iI(ab,t,aa){for(var ac="";aa>t;){ac+=String.fromCharCode(js(ab.charCodeAt(t++))<<4|js(ab.charCodeAt(t++)))}return ac}function ig(ab,t,aa){for(var ac="";aa>t;){ac+=String.fromCharCode(js(ab.charCodeAt(t+2))<<12|js(ab.charCodeAt(t+3))<<8|js(ab.charCodeAt(t))<<4|js(ab.charCodeAt(t+1))),t+=4}return ac}function id(aa,t){return"UTF-8"===t?jf(iI(aa,0,aa.length)):ig(aa,0,aa.length)}function hX(t){return"'"+t+"'"}function jh(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function hT(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jv(t){return delete t._id,delete t._rev,JSON.stringify(t)}function it(t,aa,ab){return t=JSON.parse(t),t._id=aa,t._rev=ab,t}function gQ(aa){for(var t="(";aa--;){t+="?",aa&&(t+=",")}return t+")"}function hW(ab,ad,t,ac,aa){return"SELECT "+ab+" FROM "+("string"==typeof ad?ad:ad.join(" JOIN "))+(t?" ON "+t:"")+(ac?" WHERE "+("string"==typeof ac?ac:ac.join(" AND ")):"")+(aa?" ORDER BY "+aa:"")}function jx(aa,ac,ag){function ab(){++ad===aa.length&&t()}function t(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+i9+" WHERE seq IN "+gQ(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+i9+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(au){var aq="SELECT digest FROM "+i9+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";au.executeSql(aq,aj,function(av,ay){for(var aw=new gi.Set,ax=0;ax<ay.rows.length;ax++){aw.add(ay.rows.item(ax).digest)}aj.forEach(function(az){aw.has(az)||(av.executeSql("DELETE FROM "+i9+" WHERE digest=?",[az]),av.executeSql("DELETE FROM "+iH+" WHERE digest=?",[az]))})})})}})}}if(aa.length){var ad=0,af=[];aa.forEach(function(aj){var ah="SELECT seq FROM "+T+" WHERE doc_id=? AND rev=?";ag.executeSql(ah,[ac,aj],function(al,am){if(!am.rows.length){return ab()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+T+" WHERE seq=?",[ak],ab)})})}}function ft(t){return function(ad){jt("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(hs(D,ab,ac))}}function gj(aa){if("size" in aa){return 1000000*aa.size}var t="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5000000:1}function hk(aa,ay,au,ax,av,al,aw){function az(){return ac?aw(ac):(al.notify(ax._name),ax._docCount=-1,void aw(null,ah))}function ad(aD,aE){var aC="SELECT count(*) as cnt FROM "+iH+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=hs(gT,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function aA(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){ad(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ab(aQ,aI,aN,aD,aF,aL,aG,aJ){function aO(){function aY(bc,bb){function ba(){return ++bf===bg.length&&bb(),!1}function aZ(bh){var bj="INSERT INTO "+i9+" (digest, seq) VALUES (?,?)",bi=[aR._attachments[bh].digest,bc];ap.executeSql(bj,bi,ba,ba)}var bf=0,bg=Object.keys(aR._attachments||{});if(!bg.length){return bb()}for(var bd=0;bd<bg.length;bd++){aZ(bg[bd])}}var aR=aQ.data,aW=aD?1:0,aT=aR._id,aX=aR._rev,aV=jv(aR),aU="INSERT INTO "+T+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aS=[aT,aX,aV,aW];ap.executeSql(aU,aS,function(aZ,ba){var bb=ba.insertId;aY(bb,function(){aP(aZ,bb)})},function(){var aZ=hW("seq",T,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aT,aX],function(bf,bd){var bc=bd.rows.item(0).seq,bb="UPDATE "+T+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aV,aW,aT,aX];bf.executeSql(bb,ba,function(bg){aY(bc,function(){aP(bg,bc)})})}),!1})}function aC(aR){aE||(aR?(aE=aR,aJ(aE)):aK===aM.length&&aO())}function aH(aR){aK++,aC(aR)}function aP(aV,aW){var aT=aQ.metadata.id,aU=aQ.stemmedRevs||[];aF&&ax.auto_compaction&&(aU=hU(aQ.metadata).concat(aU)),aU.length&&jx(aU,aT,aV),aQ.metadata.seq=aW,delete aQ.metadata.rev;var aS=aF?"UPDATE "+gq+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+T+" WHERE doc_id="+gq+".id AND rev=?) WHERE id=?":"INSERT INTO "+gq+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aR=y(aQ.metadata),aX=aF?[aR,aW,aI,aT]:[aT,aW,aW,aR];aV.executeSql(aS,aX,function(){ah[aG]={ok:!0,id:aQ.metadata.id,rev:aI},am.set(aT,aQ.metadata),aJ()})}var aE=null,aK=0;aQ.data._id=aQ.metadata.id,aQ.data._rev=aQ.metadata.rev;var aM=Object.keys(aQ.data._attachments||{});aD&&(aQ.data._deleted=!0),aM.forEach(function(aU){var aS=aQ.data._attachments[aU];if(aS.stub){aK++,aC()}else{var aR=aS.data;delete aS.data,aS.revpos=parseInt(aI,10);var aT=aS.digest;ag(aT,aR,aH)}}),aM.length||aO()}function aj(){jA(aa.revs_limit,aq,ax,am,ap,ah,ab,au)}function aB(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&di(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+gq+" WHERE id = ?",[aF],function(aH,aI){if(aI.rows.length){var aJ=Z(aI.rows.item(0).json);am.set(aF,aJ)}aE()})})}function ag(aD,aF,aC){var aE="SELECT digest FROM "+iH+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+iH+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,jh(aF)],function(){aC()},function(){return aC(),!1}))})}var ak=au.new_edits,af=ay.docs,aq=af.map(function(aC){if(aC._id&&di(aC._id)){return aC}var aD=hA(aC,ak);return aD}),t=aq.filter(function(aC){return aC.error});if(t.length){return aw(t[0])}var ap,ac,ah=new Array(aq.length),am=new gi.Map;gI(aq,"binary",function(aC){return aC?aw(aC):void av.transaction(function(aD){ap=aD,aA(function(aE){aE?ac=aE:aB(aj)})},ft(aw),az)})}function gr(t){return t.websql(t.name,t.version,t.description,t.size)}function hD(aa){try{return{db:gr(aa)}}catch(t){return{error:t}}}function il(aa){var t=jb.get(aa.name);return t||(t=hD(aa),jb.set(aa.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}function h6(af,ac,ah,aa,aj){function ag(){++ab===t.length&&aj&&aj()}function ad(am,ak){var al=am._attachments[ak],ap={binary:ac.binary,ctx:aa};ah._getAttachment(am._id,ak,al,ap,function(aq,au){am._attachments[ak]=fs.extend(er(al,["digest","content_type"]),{data:au}),ag()})}var t=Object.keys(af._attachments||{});if(!t.length){return aj&&aj()}var ab=0;t.forEach(function(ak){ac.attachments&&ac.include_docs?ad(af,ak):(af._attachments[ak].stub=!0,ag())})}function g(ap,av){function ag(){ga()&&(window.localStorage["_pouch__websqldb_"+am._name]=!0),av(null,am)}function au(aD,aE){aD.executeSql(B),aD.executeSql("ALTER TABLE "+T+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(gS),aD.executeSql("ALTER TABLE "+gq+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+gq+" (local, id)");var aF="SELECT "+gq+".winningseq AS seq, "+gq+".json AS metadata FROM "+T+" JOIN "+gq+" ON "+T+".seq = "+gq+".winningseq";aD.executeSql(aF,[],function(aK,aG){for(var aL=[],aI=[],aH=0;aH<aG.rows.length;aH++){var aN=aG.rows.item(aH),aM=aN.seq,aJ=JSON.parse(aN.metadata);hF(aJ)&&aL.push(aM),di(aJ.id)&&aI.push(aJ.id)}aK.executeSql("UPDATE "+gq+"SET local = 1 WHERE id IN "+gQ(aI.length),aI,function(){aK.executeSql("UPDATE "+T+" SET deleted = 1 WHERE seq IN "+gQ(aL.length),aL,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+f+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+gq+".id AS id, "+T+".json AS data FROM "+T+" JOIN "+gq+" ON "+T+".seq = "+gq+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aJ,aH){function aK(){if(!aI.length){return aF(aJ)}var aM=aI.shift(),aN=JSON.parse(aM.data)._rev;aJ.executeSql("INSERT INTO "+f+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+gq+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+T+" WHERE seq=?",[aM.seq],function(){aK()})})})}for(var aI=[],aL=0;aL<aH.rows.length;aL++){aI.push(aH.rows.item(aL))}aK()})})}function az(aE,aG){function aD(aI){function aH(){if(!aI.length){return aG(aE)}var aL=aI.shift(),aN=id(aL.hex,aw),aK=aN.lastIndexOf("::"),aM=aN.substring(0,aK),aO=aN.substring(aK+2),aJ="UPDATE "+T+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aJ,[aM,aO,aN],function(){aH()})}aH()}var aF="ALTER TABLE "+T+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aI){var aH="ALTER TABLE "+T+" ADD COLUMN rev";aI.executeSql(aH,[],function(aJ){aJ.executeSql(iR,[],function(aL){var aK="SELECT hex(doc_id_rev) as hex FROM "+T;aL.executeSql(aK,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function ah(aE,aG){function aD(aH){var aI="SELECT COUNT(*) AS cnt FROM "+iH;aH.executeSql(aI,[],function(aM,aK){function aN(){var aP=hW(hP+", "+gq+".id AS id",[gq,T],iG,null,gq+".id ");aP+=" LIMIT "+aJ+" OFFSET "+aO,aO+=aJ,aM.executeSql(aP,[],function(ba,aV){function aQ(bc,bd){var bf=aT[bc]=aT[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aV.rows.length){return aG(ba)}for(var aT={},aY=0;aY<aV.rows.length;aY++){for(var aW=aV.rows.item(aY),aX=it(aW.data,aW.id,aW.rev),aS=Object.keys(aX._attachments||{}),aZ=0;aZ<aS.length;aZ++){var aU=aX._attachments[aS[aZ]];aQ(aU.digest,aW.seq)}}var aR=[];if(Object.keys(aT).forEach(function(bc){var bd=aT[bc];bd.forEach(function(bf){aR.push([bc,bf])})}),!aR.length){return aN()}var bb=0;aR.forEach(function(bd){var bc="INSERT INTO "+i9+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++bb===aR.length&&aN()})})})}var aL=aK.rows.item(0).cnt;if(!aL){return aG(aM)}var aO=0,aJ=10;aN()})}var aF="CREATE TABLE IF NOT EXISTS "+i9+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(a6,[],function(aI){aI.executeSql(hm,[],aD)})})}function ac(aE,aF){var aD="ALTER TABLE "+iH+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ad(aE,aF){var aD="ALTER TABLE "+gq+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+gq+" SET max_seq=(SELECT MAX(seq) FROM "+T+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+gq+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function aa(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;aw=2===aG.length?"UTF-8":"UTF-16",aE()})}function aj(){for(;t.length>0;){var aD=t.pop();aD(null,aC)}}function ab(aN,aF){if(0===aF){var aI="CREATE TABLE IF NOT EXISTS "+ff+" (dbid, db_version INTEGER)",aL="CREATE TABLE IF NOT EXISTS "+iH+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aO="CREATE TABLE IF NOT EXISTS "+i9+" (digest, seq INTEGER)",aE="CREATE TABLE IF NOT EXISTS "+gq+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aD="CREATE TABLE IF NOT EXISTS "+T+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aJ="CREATE TABLE IF NOT EXISTS "+f+" (id UNIQUE, rev, json)";aN.executeSql(aL),aN.executeSql(aJ),aN.executeSql(aO,[],function(){aN.executeSql(hm),aN.executeSql(a6)}),aN.executeSql(aE,[],function(){aN.executeSql(B),aN.executeSql(aD,[],function(){aN.executeSql(gS),aN.executeSql(iR),aN.executeSql(aI,[],function(){var aP="INSERT INTO "+ff+" (db_version, dbid) VALUES (?,?)";aC=bo();var aQ=[iL,aC];aN.executeSql(aP,aQ,function(){aj()})})})})}else{var aH=function(){var aQ=iL>aF;aQ&&aN.executeSql("UPDATE "+ff+" SET db_version = "+iL);var aP="SELECT dbid FROM "+ff;aN.executeSql(aP,[],function(aR,aS){aC=aS.rows.item(0).dbid,aj()})},aK=[au,aq,az,ah,ac,ad,aH],aM=aF,aG=function(aP){aK[aM-1](aP,aG),aM++};aG(aN)}}function aB(){aA.transaction(function(aD){aa(aD,function(){ak(aD)})},ft(av),ag)}function ak(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+ff;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+ff,[],function(aH,aI){var aJ=aI.rows.item(0).db_version;ab(aH,aJ)}):aF.executeSql("ALTER TABLE "+ff+" ADD COLUMN db_version INTEGER",[],function(){ab(aF,1)}):ab(aF,0)})}function ay(aE,aF){if(-1!==am._docCount){return aF(am._docCount)}var aD=hW("COUNT("+gq+".id) AS 'num'",[gq,T],iG,T+".deleted=0");aE.executeSql(aD,[],function(aG,aH){am._docCount=aH.rows.item(0).num,aF(am._docCount)})}var aw,am=this,aC=null,af=gj(ap),t=[];am._docCount=-1,am._name=ap.name;var ax=fs.extend({},ap,{version:U,description:ap.name,size:af}),al=il(ax);if(al.error){return ft(av)(al.error)}var aA=al.db;"function"!=typeof aA.readTransaction&&(aA.readTransaction=aA.transaction),aB(),am.type=function(){return"websql"},am._id=fy(function(aD){aD(null,aC)}),am._info=function(aD){aA.readTransaction(function(aE){ay(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+T;aE.executeSql(aG,[],function(aI,aH){var aJ=aH.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aJ,sqlite_plugin:aA._sqlitePlugin,websql_encoding:aw})})})},ft(aD))},am._bulkDocs=function(aF,aD,aE){hk(ap,aF,aD,am,aA,i0,aE)},am._get=function(aI,aH,aK){function aD(){aK(aF,{doc:aM,metadata:aJ,ctx:aL})}var aM,aJ,aF,aL=aH.ctx;if(!aL){return aA.readTransaction(function(aN){am._get(aI,fs.extend({ctx:aN},aH),aK)})}var aE,aG;aH.rev?(aE=hW(hP,[gq,T],gq+".id="+T+".doc_id",[T+".doc_id=?",T+".rev=?"]),aG=[aI,aH.rev]):(aE=hW(hP,[gq,T],iG,gq+".id=?"),aG=[aI]),aL.executeSql(aE,aG,function(aP,aO){if(!aO.rows.length){return aF=hs(he,"missing"),aD()}var aN=aO.rows.item(0);return aJ=Z(aN.metadata),aN.deleted&&!aH.rev?(aF=hs(he,"deleted"),aD()):(aM=it(aN.data,aJ.id,aN.rev),void aD())})},am._allDocs=function(aJ,aN){var aM,aF=[],aD="startkey" in aJ?aJ.startkey:!1,aI="endkey" in aJ?aJ.endkey:!1,aP="key" in aJ?aJ.key:!1,aL="descending" in aJ?aJ.descending:!1,aO="limit" in aJ?aJ.limit:-1,aQ="skip" in aJ?aJ.skip:0,aG=aJ.inclusive_end!==!1,aK=[],aE=[];if(aP!==!1){aE.push(gq+".id = ?"),aK.push(aP)}else{if(aD!==!1||aI!==!1){if(aD!==!1&&(aE.push(gq+".id "+(aL?"<=":">=")+" ?"),aK.push(aD)),aI!==!1){var aH=aL?">":"<";aG&&(aH+="="),aE.push(gq+".id "+aH+" ?"),aK.push(aI)}aP!==!1&&(aE.push(gq+".id = ?"),aK.push(aP))}}"ok"!==aJ.deleted&&aE.push(T+".deleted = 0"),aA.readTransaction(function(aR){ay(aR,function(aT){if(aM=aT,0!==aO){var aS=hW(hP,[gq,T],iG,aE,gq+".id "+(aL?"DESC":"ASC"));aS+=" LIMIT "+aO+" OFFSET "+aQ,aR.executeSql(aS,aK,function(aW,bc){for(var aU=0,aZ=bc.rows.length;aZ>aU;aU++){var aX=bc.rows.item(aU),aV=Z(aX.metadata),ba=aV.id,aY=it(aX.data,ba,aX.rev),bb=aY._rev,bd={id:ba,key:ba,value:{rev:bb}};if(aJ.include_docs&&(bd.doc=aY,bd.doc._rev=bb,aJ.conflicts&&(bd.doc._conflicts=jw(aV)),h6(bd.doc,aJ,am,aW)),aX.deleted){if("ok"!==aJ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aF.push(bd)}})}})},ft(aN),function(){aN(null,{total_rows:aM,offset:aJ.skip,rows:aF})})},am._changes=function(aD){function aK(){var aN=gq+".json AS metadata, "+gq+".max_seq AS maxSeq, "+T+".json AS winningDoc, "+T+".rev AS winningRev ",aM=gq+" JOIN "+T,aO=gq+".id="+T+".doc_id AND "+gq+".winningseq="+T+".seq",aP=["maxSeq > ?"],aR=[aD.since];aD.doc_ids&&(aP.push(gq+".id IN "+gQ(aD.doc_ids.length)),aR=aR.concat(aD.doc_ids));var aL="maxSeq "+(aG?"DESC":"ASC"),aS=hW(aN,aM,aO,aP,aL),aT=fa(aD);aD.view||aD.filter||(aS+=" LIMIT "+aJ);var aQ=aD.since||0;aA.readTransaction(function(aU){aU.executeSql(aS,aR,function(ba,aY){function bb(bg){return function(){aD.onChange(bg)}}for(var aV=0,aW=aY.rows.length;aW>aV;aV++){var aX=aY.rows.item(aV),aZ=Z(aX.metadata);aQ=aX.maxSeq;var bf=it(aX.winningDoc,aZ.id,aX.winningRev),bc=aD.processChange(bf,aZ,aD);bc.seq=aX.maxSeq;var bd=aT(bc);if("object"==typeof bd){return aD.complete(bd)}if(bd&&(aH++,aE&&aF.push(bc),aD.attachments&&aD.include_docs?h6(bf,aD,am,ba,bb(bc)):bb(bc)()),aH===aJ){break}}})},ft(aD.complete),function(){aD.continuous||aD.complete(null,{results:aF,last_seq:aQ})})}if(aD=iC(aD),aD.continuous){var aI=am._name+":"+bo();return i0.addListener(am._name,aI,am,aD),i0.notify(am._name),{cancel:function(){i0.removeListener(am._name,aI)}}}var aG=aD.descending;aD.since=aD.since&&!aG?aD.since:0;var aJ="limit" in aD?aD.limit:-1;0===aJ&&(aJ=1);var aE;aE="return_docs" in aD?aD.return_docs:"returnDocs" in aD?aD.returnDocs:!0;var aF=[],aH=0;aK()},am._close=function(aD){aD()},am._getAttachment=function(aI,aH,aK,aD,aM){var aJ,aF=aD.ctx,aL=aK.digest,aE=aK.content_type,aG="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+iH+" WHERE digest=?";aF.executeSql(aG,[aL],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?hT(aO.body):id(aO.body,aw);aJ=aD.binary?I(aN,aE):gu(aN),aM(null,aJ)})},am._getRevisionTree=function(aD,aE){aA.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+gq+" WHERE id = ?";aF.executeSql(aG,[aD],function(aH,aJ){if(aJ.rows.length){var aI=Z(aJ.rows.item(0).metadata);aE(null,aI.rev_tree)}else{aE(hs(he))}})})},am._doCompaction=function(aE,aF,aD){return aF.length?void aA.transaction(function(aH){var aG="SELECT json AS metadata FROM "+gq+" WHERE id = ?";aH.executeSql(aG,[aE],function(aJ,aL){var aK=Z(aL.rows.item(0).metadata);iD(aK.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aI="UPDATE "+gq+" SET json = ? WHERE id = ?";aJ.executeSql(aI,[y(aK),aE])}),jx(aF,aE,aH)},ft(aD),function(){aD()}):aD()},am._getLocal=function(aD,aE){aA.readTransaction(function(aF){var aG="SELECT json, rev FROM "+f+" WHERE id=?";aF.executeSql(aG,[aD],function(aI,aK){if(aK.rows.length){var aJ=aK.rows.item(0),aH=it(aJ.json,aD,aJ.rev);aE(null,aH)}else{aE(hs(he))}})})},am._putLocal=function(aF,aK,aH){function aJ(aO){var aM,aN;aG?(aM="UPDATE "+f+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aI,aL,aD,aG]):(aM="INSERT INTO "+f+" (id, rev, json) VALUES (?,?,?)",aN=[aD,aI,aL]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aE={ok:!0,id:aD,rev:aI},aK.ctx&&aH(null,aE)):aH(hs(fV))},function(){return aH(hs(fV)),!1})}"function"==typeof aK&&(aH=aK,aK={}),delete aF._revisions;var aI,aG=aF._rev,aD=aF._id;aI=aG?aF._rev="0-"+(parseInt(aG.split("-")[1],10)+1):aF._rev="0-1";var aE,aL=jv(aF);aK.ctx?aJ(aK.ctx):aA.transaction(aJ,ft(aH),function(){aE&&aH(null,aE)})},am._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+f+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(hs(he))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):aA.transaction(aF,ft(aH),function(){aD&&aH(null,aD)})},am._destroy=function(aD,aE){i0.removeAllListeners(am._name),aA.transaction(function(aF){var aG=[gq,T,iH,ff,f,i9];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},ft(aE),function(){ga()&&(delete window.localStorage["_pouch__websqldb_"+am._name],delete window.localStorage[am._name]),aE(null,{ok:!0})})}}function ip(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function gY(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var t=ga(),aa="_pouch__websqldb_valid_"+navigator.userAgent;if(t&&localStorage[aa]){return"1"===localStorage[aa]}var ab=ip();return t&&(localStorage[aa]=ab?"1":"0"),ab}function jg(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:gY()}function r(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=fs.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function fT(ab,t){var aa=r(ab),ac=fs.extend({websql:aa},ab);g.call(this,ac,t)}function P(t){t.adapter("websql",fT,!0)}function hZ(){for(var ab={},t=new gN(function(af,ad){ab.resolve=af,ab.reject=ad}),aa=new Array(arguments.length),ac=0;ac<aa.length;ac++){aa[ac]=arguments[ac]}return ab.promise=t,gN.resolve().then(function(){return fetch.apply(null,aa)}).then(function(ad){ab.resolve(ad)})["catch"](function(ad){ab.reject(ad)}),ab}function a0(aa,ac){var ag,ab,t,ad=new Headers,af={method:aa.method,credentials:"include",headers:ad};return aa.json&&(ad.set("Accept","application/json"),ad.set("Content-Type",aa.headers["Content-Type"]||"application/json")),aa.body&&aa.body instanceof Blob?gd(aa.body,function(ah){af.body=ah}):aa.body&&aa.processData&&"string"!=typeof aa.body?af.body=JSON.stringify(aa.body):"body" in aa?af.body=aa.body:af.body=null,Object.keys(aa.headers).forEach(function(ah){aa.headers.hasOwnProperty(ah)&&ad.set(ah,aa.headers[ah])}),ag=hZ(aa.url,af),aa.timeout>0&&(ab=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+aa.url))},aa.timeout)),ag.promise.then(function(ah){return t={statusCode:ah.status},aa.timeout>0&&clearTimeout(ab),t.statusCode>=200&&t.statusCode<300?aa.binary?ah.blob():ah.text():ah.json()}).then(function(ah){t.statusCode>=200&&t.statusCode<300?ac(null,t,ah):ac(ah,t)})["catch"](function(ah){ac(ah,t)}),{abort:ag.reject}}function gK(af,ac){var ah,aa,aj=!1,ag=function(){ah.abort()},ad=function(){aj=!0,ah.abort()};ah=af.xhr?new af.xhr:new XMLHttpRequest;try{ah.open(af.method,af.url)}catch(t){ac(t,{statusCode:413})}ah.withCredentials="withCredentials" in af?af.withCredentials:!0,"GET"===af.method?delete af.headers["Content-Type"]:af.json&&(af.headers.Accept="application/json",af.headers["Content-Type"]=af.headers["Content-Type"]||"application/json",af.body&&af.processData&&"string"!=typeof af.body&&(af.body=JSON.stringify(af.body))),af.binary&&(ah.responseType="arraybuffer"),"body" in af||(af.body=null);for(var ab in af.headers){af.headers.hasOwnProperty(ab)&&ah.setRequestHeader(ab,af.headers[ab])}return af.timeout>0&&(aa=setTimeout(ad,af.timeout),ah.onprogress=function(){clearTimeout(aa),4!==ah.readyState&&(aa=setTimeout(ad,af.timeout))},"undefined"!=typeof ah.upload&&(ah.upload.onprogress=ah.onprogress)),ah.onreadystatechange=function(){if(4===ah.readyState){var ak={statusCode:ah.status};if(ah.status>=200&&ah.status<300){var am;am=af.binary?gE([ah.response||""],{type:ah.getResponseHeader("Content-Type")}):ah.responseText,ac(null,ak,am)}else{var ap={};if(aj){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ah.response)}catch(al){}}ac(ap,ak)}}},af.body&&af.body instanceof Blob?gd(af.body,function(ak){ah.send(ak)}):ah.send(af.body),{abort:ag}}function i1(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function gA(aa,t){return iY||aa.xhr?gK(aa,t):a0(aa,t)}function v(){return""}function iM(ab,ad){function t(ah,aj,ag){if(!ab.binary&&ab.json&&"string"==typeof ah){try{ah=JSON.parse(ah)}catch(af){return ag(af)}}Array.isArray(ah)&&(ah=ah.map(function(ak){return ak.error||ak.missing?iO(ak):ak})),ab.binary&&h9(ah,aj),ag(null,ah,aj)}function ac(aj,al){var ag,ak;if(aj.code&&aj.status){var ah=new Error(aj.message||aj.code);return ah.status=aj.status,al(ah)}if(aj.message&&"ETIMEDOUT"===aj.message){return al(aj)}try{ag=JSON.parse(aj.responseText),ak=iO(ag)}catch(af){ak=iO(aj)}al(ak)}ab=iC(ab);var aa={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ab=fs.extend(aa,ab),ab.json&&(ab.binary||(ab.headers.Accept="application/json"),ab.headers["Content-Type"]=ab.headers["Content-Type"]||"application/json"),ab.binary&&(ab.encoding=null,ab.json=!1),ab.processData||(ab.json=!1),gA(ab,function(ak,af,ah){if(ak){return ak.status=af?af.statusCode:400,ac(ak,ad)}var am,ag=af.headers&&af.headers["content-type"],aj=ah||v();if(!ab.binary&&(ab.json||!ab.processData)&&"object"!=typeof aj&&(/json/.test(ag)||/^[\s]*\{/.test(aj)&&/\}[\s]*$/.test(aj))){try{aj=JSON.parse(aj.toString())}catch(al){}}af.statusCode>=200&&af.statusCode<300?t(aj,af,ad):(am=iO(aj),am.status=af.statusCode,ad(am))})}function g7(ad,aa){var ag=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",aj=-1!==ag.indexOf("safari")&&-1===ag.indexOf("chrome"),ah=-1!==ag.indexOf("msie"),af=-1!==ag.indexOf("edge"),ac=aj||(ah||af)&&"GET"===ad.method,ak="cache" in ad?ad.cache:!0,ab=/^blob:/.test(ad.url);if(!ab&&(ac||!ak)){var t=-1!==ad.url.indexOf("?");ad.url+=(t?"&":"?")+"_nonce="+Date.now()}return iM(ad,aa)}function fw(aa){var t=aa.doc&&aa.doc._attachments;t&&Object.keys(t).forEach(function(ac){var ab=t[ac];ab.data=Y(ab.data,ab.content_type)})}function a4(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function V(t){return t._attachments&&Object.keys(t._attachments)?gN.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new gN(function(ac){fx(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):gN.resolve()}function ha(t){var aa=iS(t);(aa.user||aa.password)&&(aa.auth={username:aa.user,password:aa.password});var ab=aa.path.replace(/(^\/|\/$)/g,"").split("/");return aa.db=ab.pop(),-1===aa.db.indexOf("%")&&(aa.db=encodeURIComponent(aa.db)),aa.path=ab.join("/"),aa}function hd(aa,t){return fg(aa,aa.db+"/"+t)}function fg(t,aa){var ab=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+ab+aa}function an(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function ar(aj,ac){function ap(ax,ay,aw){var aA=ax.ajax||{},az=fs.extend(iC(aa),aA,ay);return jp(az.method+" "+az.url),ah._ajax(az,aw)}function ab(ax,aw){return new gN(function(az,ay){ap(ax,aw,function(aA,aB){return aA?ay(aA):void az(aB)})})}function aq(ax,aw){return fc(ax,io(function(ay){au().then(function(){return aw.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function au(){if(aj.skipSetup||aj.skip_setup){return gN.resolve()}if(al){return al}var aw={method:"GET",url:av};return al=ab({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(ii(404,"PouchDB is just detecting if the remote exists."),ab({},{method:"PUT",url:av})):gN.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:gN.reject(ax)}),al["catch"](function(){al=null}),al}function am(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ah=this,t=ha;aj.getHost&&(t=aj.getHost);var ak=t(aj.name,aj),av=hd(ak,"");aj=iC(aj);var aa=aj.ajax||{};if(ah.getUrl=function(){return av},ah.getHeaders=function(){return aa.headers||{}},aj.auth||ak.auth){var ad=aj.auth||ak.auth,af=ad.username+":"+ad.password,ag=gu(unescape(encodeURIComponent(af)));aa.headers=aa.headers||{},aa.headers.Authorization="Basic "+ag}ah._ajax=g7;var al;setTimeout(function(){ac(null,ah)}),ah.type=function(){return"http"},ah.id=aq("id",function(aw){ap({},{method:"GET",url:fg(ak,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+ak.db:hd(ak,"");aw(null,ay)})}),ah.request=aq("request",function(ax,aw){ax.url=hd(ak,ax.url),ap({},ax,aw)}),ah.compact=aq("compact",function(ax,aw){"function"==typeof ax&&(aw=ax,ax={}),ax=iC(ax),ap(ax,{url:hd(ak,"_compact"),method:"POST"},function(){function ay(){ah.info(function(az,aA){aA&&!aA.compact_running?aw(null,{ok:!0}):setTimeout(ay,ax.interval||200)})}ay()})}),ah.bulkGet=fc("bulkGet",function(aC,aA){function aB(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ap({},{url:hd(ak,"_bulk_get"+an(aE)),method:"POST",body:{docs:aC.docs}},aD)}function ax(){function aG(aK){return function(aM,aL){aD[aK]=aL.results,++aF===aI&&aA(null,{results:gh(aD)})}}for(var aJ=en,aI=Math.ceil(aC.docs.length/aJ),aF=0,aD=new Array(aI),aE=0;aI>aE;aE++){var aH=er(aC,["revs","attachments"]);aH.ajax=aa,aH.docs=aC.docs.slice(aE*aJ,Math.min(aC.docs.length,(aE+1)*aJ)),gf(az,aH,aG(aE))}}var az=this,ay=fg(ak,""),aw=hp[ay];"boolean"!=typeof aw?aB(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(hp[ay]=!1,ii(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),ax()):aA(aF)}else{hp[ay]=!0,aA(null,aE)}}):aw?aB(aA):ax()}),ah._info=function(aw){au().then(function(){ap({},{method:"GET",url:hd(ak,"")},function(ay,ax){return ay?aw(ay):(ax.host=hd(ak,""),void aw(null,ax))})})["catch"](aw)},ah.get=aq("get",function(aA,aC,aB){function ax(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?gN.all(aF.map(function(aH){var aG=aD[aH],aI=a4(aE._id)+"/"+am(aH)+"?rev="+aE._rev;return ab(aC,{method:"GET",url:hd(ak,aI),binary:!0}).then(function(aJ){return aC.binary?aJ:new gN(function(aK){fx(aJ,aK)})}).then(function(aJ){delete aG.stub,delete aG.length,aG.data=aJ})})):void 0}function az(aD){return Array.isArray(aD)?gN.all(aD.map(function(aE){return aE.ok?ax(aE.ok):void 0})):ax(aD)}"function"==typeof aC&&(aB=aC,aC={}),aC=iC(aC);var aw={};aC.revs&&(aw.revs=!0),aC.revs_info&&(aw.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),aw.open_revs=aC.open_revs),aC.rev&&(aw.rev=aC.rev),aC.conflicts&&(aw.conflicts=aC.conflicts),aA=a4(aA);var ay={method:"GET",url:hd(ak,aA+an(aw))};ab(aC,ay).then(function(aD){return gN.resolve().then(function(){return aC.attachments?az(aD):void 0}).then(function(){aB(null,aD)})})["catch"](aB)}),ah.remove=aq("remove",function(aB,az,ax,ay){var aA;"string"==typeof az?(aA={_id:aB,_rev:az},"function"==typeof ax&&(ay=ax,ax={})):(aA=aB,"function"==typeof az?(ay=az,ax={}):(ay=ax,ax=az));var aw=aA._rev||ax.rev;ap(ax,{method:"DELETE",url:hd(ak,a4(aA._id))+"?rev="+aw},ay)}),ah.getAttachment=aq("getAttachment",function(aB,ax,az,aA){"function"==typeof az&&(aA=az,az={});var aw=az.rev?"?rev="+az.rev:"",ay=hd(ak,a4(aB))+"/"+am(ax)+aw;ap(az,{method:"GET",url:ay,binary:!0},aA)}),ah.removeAttachment=aq("removeAttachment",function(ax,ay,aA,aw){var az=hd(ak,a4(ax)+"/"+am(ay))+"?rev="+aA;ap({},{method:"DELETE",url:az},aw)}),ah.putAttachment=aq("putAttachment",function(aF,aB,az,ay,aw,aA){"function"==typeof aw&&(aA=aw,aw=ay,ay=az,az=null);var aC=a4(aF)+"/"+am(aB),aD=hd(ak,aC);if(az&&(aD+="?rev="+az),"string"==typeof ay){var ax;try{ax=fm(ay)}catch(aE){return aA(hs(g3,"Attachment is not a valid base64 string"))}ay=ax?I(ax,aw):""}var aG={headers:{"Content-Type":aw},method:"PUT",url:aD,processData:!1,body:ay,timeout:aa.timeout||60000};ap({},aG,aA)}),ah._bulkDocs=function(ax,aw,ay){ax.new_edits=aw.new_edits,au().then(function(){return gN.all(ax.docs.map(V))}).then(function(){ap(aw,{method:"POST",url:hd(ak,"_bulk_docs"),body:ax},function(aA,az){return aA?ay(aA):(az.forEach(function(aB){aB.ok=!0}),void ay(null,az))})})["catch"](ay)},ah.allDocs=aq("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=iC(aA);var aB,ax={},az="GET";aA.conflicts&&(ax.conflicts=!0),aA.descending&&(ax.descending=!0),aA.include_docs&&(ax.include_docs=!0),aA.attachments&&(ax.attachments=!0),aA.key&&(ax.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(ax.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(ax.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(ax.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(ax.limit=aA.limit),"undefined"!=typeof aA.skip&&(ax.skip=aA.skip);var ay=an(ax);if("undefined"!=typeof aA.keys){var aw="keys="+encodeURIComponent(JSON.stringify(aA.keys));aw.length+ay.length+1<=fl?ay+="&"+aw:(az="POST",aB={keys:aA.keys})}ab(aA,{method:az,url:hd(ak,"_all_docs"+ay),body:aB}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(fw),aC(null,aD)})["catch"](aC)}),ah._changes=function(ay){var aF="batch_size" in ay?ay.batch_size:hJ;ay=iC(ay),ay.timeout="timeout" in ay?ay.timeout:"timeout" in aa?aa.timeout:30000;var aH,az=ay.timeout?{timeout:ay.timeout-5000}:{},aw="undefined"!=typeof ay.limit?ay.limit:!1;aH="return_docs" in ay?ay.return_docs:"returnDocs" in ay?ay.returnDocs:!0;var aB=aw;if(ay.style&&(az.style=ay.style),(ay.include_docs||ay.filter&&"function"==typeof ay.filter)&&(az.include_docs=!0),ay.attachments&&(az.attachments=!0),ay.continuous&&(az.feed="longpoll"),ay.conflicts&&(az.conflicts=!0),ay.descending&&(az.descending=!0),"heartbeat" in ay?ay.heartbeat&&(az.heartbeat=ay.heartbeat):az.heartbeat=10000,ay.filter&&"string"==typeof ay.filter&&(az.filter=ay.filter),ay.view&&"string"==typeof ay.view&&(az.filter="_view",az.view=ay.view),ay.query_params&&"object"==typeof ay.query_params){for(var aD in ay.query_params){ay.query_params.hasOwnProperty(aD)&&(az[aD]=ay.query_params[aD])}}var aJ,aE="GET";if(ay.doc_ids){az.filter="_doc_ids";var aG=JSON.stringify(ay.doc_ids);aG.length<fl?az.doc_ids=aG:(aE="POST",aJ={doc_ids:ay.doc_ids})}var aI,aK,ax=function(aM,aN){if(!ay.aborted){az.since=aM,"object"==typeof az.since&&(az.since=JSON.stringify(az.since)),ay.descending?aw&&(az.limit=aB):az.limit=!aw||aB>aF?aF:aB;var aL={method:aE,url:hd(ak,"_changes"+an(az)),timeout:ay.timeout,body:aJ};aK=aM,ay.aborted||au().then(function(){aI=ap(ay,aL,aN)})["catch"](aN)}},aA={results:[]},aC=function(aN,aL){if(!ay.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aA.last_seq=aL.last_seq;var aP={};aP.query=ay.query_params,aL.results=aL.results.filter(function(aR){aB--;var aQ=fa(ay)(aR);return aQ&&(ay.include_docs&&ay.attachments&&ay.binary&&fw(aR),aH&&aA.results.push(aR),ay.onChange(aR)),aQ})}else{if(aN){return ay.aborted=!0,void ay.complete(aN)}}aL&&aL.last_seq&&(aK=aL.last_seq);var aO=aw&&0>=aB||aL&&aF>aM||ay.descending;(!ay.continuous||aw&&0>=aB)&&aO?ay.complete(null,aA):setTimeout(function(){ax(aK,aC)},0)}};return ax(ay.since||0,aC),{cancel:function(){ay.aborted=!0,aI&&aI.abort()}}},ah.revsDiff=aq("revsDiff",function(ax,aw,ay){"function"==typeof aw&&(ay=aw,aw={}),ap(aw,{method:"POST",url:hd(ak,"_revs_diff"),body:ax},ay)}),ah._close=function(aw){aw()},ah._destroy=function(ax,aw){ap(ax,{url:hd(ak,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?aw(az):void aw(null,ay)})}}function iN(t){t.adapter("http",ar,!1),t.adapter("https",ar,!1)}function gF(){this.promise=new gN(function(t){t()})}function j(ab){var t=ab.db,ah=ab.viewName,ac=ab.map,aa=ab.reduce,af=ab.temporary,ag=ac.toString()+(aa&&aa.toString())+"undefined";if(!af&&t._cachedViews){var ad=t._cachedViews[ag];if(ad){return gN.resolve(ad)}}return t.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ah;-1===aq.indexOf("/")&&(aq=ah+"/"+ah);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(af?"temp":R(ag));return i3(t,"_local/mrviews",al).then(function(){return t.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:t,adapter:t.adapter,mapFun:ac,reduceFun:aa};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,af||(t._cachedViews=t._cachedViews||{},t._cachedViews[ag]=aq,aq.db.once("destroyed",function(){delete t._cachedViews[ag]})),aq})})})})}function ey(ab,ad,t,ac,aa,af){return i8("return ("+ab.replace(/;\s*$/,"")+");",{emit:ad,sum:t,log:ac,isArray:aa,toJSON:af})}function i6(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function M(t){return 1===t.length&&/^1-/.test(t[0].rev)}function gV(t,aa){try{t.emit("error",aa)}catch(ab){jt("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),jt("error",aa)}}function W(ab,t,aa){try{return{output:t.apply(null,aa)}}catch(ac){return gV(ab,ac),{error:ac}}}function F(t,aa){var ab=gp.collate(t.key,aa.key);return 0!==ab?ab:gp.collate(t.value,aa.value)}function ae(t,aa,ab){return ab=ab||0,"number"==typeof aa?t.slice(ab,aa+ab):ab>0?t.slice(ab):t}function fr(t){var aa=t.value,ab=aa&&"object"==typeof aa&&aa._id||t.id;return ab}function n(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=Y(ac.data,ac.content_type)})})}function ao(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&n(aa),aa}}function s(aa){var t="builtin "+aa+" function requires map values to be numbers or number arrays";return new iZ(t)}function gJ(ab){for(var t=0,ah=0,ac=ab.length;ac>ah;ah++){var aa=ab[ah];if("number"!=typeof aa){if(!Array.isArray(aa)){throw s("_sum")}t="number"==typeof t?[t]:t;for(var af=0,ag=aa.length;ag>af;af++){var ad=aa[af];if("number"!=typeof ad){throw s("_sum")}"undefined"==typeof t[af]?t.push(ad):t[af]+=ad}}else{"number"==typeof t?t+=aa:t[0]+=aa}}return t}function k(ab,ad,t,ac){var aa=ad[ab];"undefined"!=typeof aa&&(ac&&(aa=encodeURIComponent(JSON.stringify(aa))),t.push(ab+"="+aa))}function br(aa){if("undefined"!=typeof aa){var t=Number(aa);return isNaN(t)||t!==parseInt(aa,10)?aa:t}}function A(t){return t.group_level=br(t.group_level),t.limit=br(t.limit),t.skip=br(t.skip),t}function h(t){if(t){if("number"!=typeof t){return new g8('Invalid value for integer: "'+t+'"')}if(0>t){return new g8('Invalid value for positive integer: "'+t+'"')}}}function fb(ab,t){var aa=ab.descending?"endkey":"startkey",ac=ab.descending?"startkey":"endkey";if("undefined"!=typeof ab[aa]&&"undefined"!=typeof ab[ac]&&gp.collate(ab[aa],ab[ac])>0){throw new g8("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(t.reduce&&ab.reduce!==!1){if(ab.include_docs){throw new g8("{include_docs:true} is invalid for reduce")}if(ab.keys&&ab.keys.length>1&&!ab.group&&!ab.group_level){throw new g8("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=h(ab[af]);if(ad){throw ad}})}function es(af,ac,ah){var aa,aj=[],ag="GET";if(k("reduce",ah,aj),k("include_docs",ah,aj),k("attachments",ah,aj),k("limit",ah,aj),k("descending",ah,aj),k("group",ah,aj),k("group_level",ah,aj),k("skip",ah,aj),k("stale",ah,aj),k("conflicts",ah,aj),k("startkey",ah,aj,!0),k("start_key",ah,aj,!0),k("endkey",ah,aj,!0),k("end_key",ah,aj,!0),k("inclusive_end",ah,aj),k("key",ah,aj,!0),aj=aj.join("&"),aj=""===aj?"":"?"+aj,"undefined"!=typeof ah.keys){var ad=2000,t="keys="+encodeURIComponent(JSON.stringify(ah.keys));t.length+aj.length+1<=ad?aj+=("?"===aj[0]?"&":"?")+t:(ag="POST","string"==typeof ac?aa={keys:ah.keys}:ac.keys=ah.keys)}if("string"==typeof ac){var ab=i6(ac);return af.request({method:ag,url:"_design/"+ab[0]+"/_view/"+ab[1]+aj,body:aa}).then(ao(ah))}return aa=aa||{},Object.keys(ac).forEach(function(ak){Array.isArray(ac[ak])?aa[ak]=ac[ak]:aa[ak]=ac[ak].toString()}),af.request({method:"POST",url:"_temp_view"+aj,body:aa}).then(ao(ah))}function G(t,aa,ab){return new gN(function(ad,ac){t._query(aa,ab,function(af,ag){return af?ac(af):void ad(ag)})})}function gR(t){return new gN(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function iQ(t){return function(aa){if(404===aa.status){return t}throw aa}}function gG(ac,aj,ad){function ag(){return M(ab)?gN.resolve(ak):aj.db.get(aa)["catch"](iQ(ak))}function ah(am){return am.keys.length?aj.db.allDocs({keys:am.keys,include_docs:!0}):gN.resolve({rows:[]})}function af(aA,az){for(var av=[],ax={},au=0,ap=az.rows.length;ap>au;au++){var am=az.rows[au],aw=am.doc;if(aw&&(av.push(aw),ax[aw._id]=!0,aw._deleted=!t[aw._id],!aw._deleted)){var ay=t[aw._id];"value" in ay&&(aw.value=ay.value)}}var aq=Object.keys(t);return aq.forEach(function(aD){if(!ax[aD]){var aB={_id:aD},aC=t[aD];"value" in aC&&(aB.value=aC.value),av.push(aB)}}),aA.keys=hu(aq.concat(aA.keys)),av.push(aA),av}var aa="_local/doc_"+ac,ak={_id:aa,keys:[]},al=ad[ac],t=al.indexableKeysToKeyValues,ab=al.changes;return ag().then(function(am){return ah(am).then(function(ap){return af(am,ap)})})}function a1(ab,t,aa){var ac="_local/lastSeq";return ab.db.get(ac)["catch"](iQ({_id:ac,seq:0})).then(function(af){var ad=Object.keys(t);return gN.all(ad.map(function(ag){return gG(ag,ab,t)})).then(function(ah){var ag=gh(ah);return af.seq=aa,ag.push(af),ab.db.bulkDocs({docs:ag})})})}function fY(t){var aa="string"==typeof t?t:t.name,ab=iK[aa];return ab||(ab=iK[aa]=new gF),ab}function ho(t){return jj(fY(t),function(){return iE(t)})()}function iE(af){function ac(am,ak){var al={id:aj._id,key:gp.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=gp.normalizeKey(ak)),aa.push(al)}function ah(ak,al){return function(){return a1(af,ak,al)}}var aa,aj,ag;if("function"==typeof af.mapFun&&2===af.mapFun.length){var ad=af.mapFun;ag=function(ak){return ad(ak,ac)}}else{ag=ey(af.mapFun.toString(),ac,gJ,hh,Array.isArray,JSON.parse)}var t=af.seq||0,ab=new gF;return new gN(function(ap,ak){function al(){ab.finish().then(function(){af.seq=t,ap()})}function am(){function aq(au){ak(au)}af.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:t,limit:hb}).on("complete",function(aA){var aF=aA.results;if(!aF.length){return al()}for(var au={},av=0,ax=aF.length;ax>av;av++){var aD=aF[av];if("_"!==aD.doc._id[0]){aa=[],aj=aD.doc,aj._deleted||W(af.sourceDB,ag,[aj]),aa.sort(F);for(var ay,aC={},aE=0,az=aa.length;az>aE;aE++){var aw=aa[aE],aG=[aw.key,aw.id];0===gp.collate(aw.key,ay)&&aG.push(aE);var aB=gp.toIndexableString(aG);aC[aB]=aw,ay=aw.key}au[aD.doc._id]={indexableKeysToKeyValues:aC,changes:aD.changes}}t=aD.seq}return ab.add(ah(au,t)),aF.length<hb?al():am()}).on("error",aq)}am()})}function fe(ac,aj,ad){0===ad.group_level&&delete ad.group_level;var ag,ah=ad.group||ad.group_level;ag=ce[ac.reduceFun]?ce[ac.reduceFun]:ey(ac.reduceFun.toString(),null,gJ,hh,Array.isArray,JSON.parse);var af=[],aa=isNaN(ad.group_level)?Number.POSITIVE_INFINITY:ad.group_level;aj.forEach(function(aq){var am=af[af.length-1],ap=ah?aq.key:null;return ah&&Array.isArray(ap)&&(ap=ap.slice(0,aa)),am&&0===gp.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void af.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),aj=[];for(var ak=0,al=af.length;al>ak;ak++){var t=af[ak],ab=W(ac.sourceDB,ag,[t.keys,t.values,!1]);if(ab.error&&ab.error instanceof iZ){throw ab.error}aj.push({value:ab.error?null:ab.output,key:t.groupKey})}return{rows:ae(aj,ad.limit,ad.skip)}}function de(aa,t){return jj(fY(aa),function(){return gw(aa,t)})()}function gw(t,ag){function ac(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ad=au.total_rows,au.rows.map(function(ax){if("value" in ax.doc&&"object"==typeof ax.doc.value&&null!==ax.doc.value){var av=Object.keys(ax.doc.value).sort(),aw=["id","key","value"];if(!(aw>av||av>aw)){return ax.doc.value}}var ay=gp.parseIndexableString(ax.doc._id);return{key:ay[0],id:ay[1],value:"value" in ax.doc?ax.doc.value:null}})})}function af(au){var av;if(av=aa?fe(t,au,ag):{total_rows:ad,offset:aj,rows:au},ag.include_docs){var aq=hu(au.map(fr));return t.sourceDB.allDocs({keys:aq,include_docs:!0,conflicts:ag.conflicts,attachments:ag.attachments,binary:ag.binary}).then(function(ax){var aw={};return ax.rows.forEach(function(ay){ay.doc&&(aw["$"+ay.id]=ay.doc)}),au.forEach(function(ay){var aA=fr(ay),az=aw["$"+aA];az&&(ay.doc=az)}),av})}return av}var ad,aa=t.reduceFun&&ag.reduce!==!1,aj=ag.skip||0;if("undefined"==typeof ag.keys||ag.keys.length||(ag.limit=0,delete ag.keys),"undefined"!=typeof ag.keys){var ap=ag.keys,ah=ap.map(function(au){var aq={startkey:gp.toIndexableString([au]),endkey:gp.toIndexableString([au,{}])};return ac(aq)});return gN.all(ah).then(gh).then(af)}var ak={descending:ag.descending};if(ag.start_key&&(ag.startkey=ag.start_key),ag.end_key&&(ag.endkey=ag.end_key),"undefined"!=typeof ag.startkey&&(ak.startkey=ag.descending?gp.toIndexableString([ag.startkey,{}]):gp.toIndexableString([ag.startkey])),"undefined"!=typeof ag.endkey){var am=ag.inclusive_end!==!1;ag.descending&&(am=!am),ak.endkey=gp.toIndexableString(am?[ag.endkey,{}]:[ag.endkey])}if("undefined"!=typeof ag.key){var ab=gp.toIndexableString([ag.key]),al=gp.toIndexableString([ag.key,{}]);ak.descending?(ak.endkey=ab,ak.startkey=al):(ak.startkey=ab,ak.endkey=al)}return aa||("number"==typeof ag.limit&&(ak.limit=ag.limit),ak.skip=aj),ac(ak).then(af)}function a5(t){return t.request({method:"POST",url:"_view_cleanup"})}function gm(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(af){var ah=i6(af),ag="_design/"+ah[0],ad=ah[1];aa[ag]=aa[ag]||{},aa[ag][ad]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(af){var ad={};af.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ad[au]=ad[au]||am})})});var ag=Object.keys(ad).filter(function(aj){return !ad[aj]}),ah=ag.map(function(aj){return jj(fY(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return gN.all(ah).then(function(){return{ok:!0}})})},iQ({ok:!0}))}function et(aa,ad,ab){if("http"===aa.type()){return es(aa,ad,ab)}if("function"==typeof aa._query){return G(aa,ad,ab)}if("string"!=typeof ad){fb(ab,ad);var ah={db:aa,viewName:"temp_view/temp_view",map:ad.map,reduce:ad.reduce,temporary:!0};return p.add(function(){return j(ah).then(function(ak){function aj(){return ak.db.destroy()}return ic(ho(ak).then(function(){return de(ak,ab)}),aj)})}),p.finish()}var t=ad,ag=i6(t),ac=ag[0],af=ag[1];return aa.get("_design/"+ac).then(function(al){var ak=al.views&&al.views[af];if(!ak||"string"!=typeof ak.map){throw new iF("ddoc "+ac+" has no view named "+af)}fb(ab,ak);var aj={db:aa,viewName:t,map:ak.map,reduce:ak.reduce};return j(aj).then(function(am){return"ok"===ab.stale||"update_after"===ab.stale?("update_after"===ab.stale&&fp.nextTick(function(){ho(am)}),de(am,ab)):ho(am).then(function(){return de(am,ab)})})})}function g8(aa){this.status=400,this.name="query_parse_error",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,g8)}catch(t){}}function iF(aa){this.status=404,this.name="not_found",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,iF)}catch(t){}}function iZ(aa){this.status=500,this.name="invalid_value",this.message=aa,this.error=!0;try{Error.captureStackTrace(this,iZ)}catch(t){}}function h4(t){return/^1-/.test(t)}function x(t,aa,ab){return !t._attachments||!t._attachments[ab]||t._attachments[ab].digest!==aa._attachments[ab].digest}function i(t,aa){var ab=Object.keys(aa._attachments);return gN.all(ab.map(function(ac){return t.getAttachment(aa._id,ac,{rev:aa._rev})}))}function X(ab,ad,t){var ac="http"===ad.type()&&"http"!==ab.type(),aa=Object.keys(t._attachments);return ac?ab.get(t._id).then(function(af){return gN.all(aa.map(function(ag){return x(af,t,ag)?ad.getAttachment(t._id,ag):ab.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return i(ad,t)}):i(ad,t)}function fj(aa){var t=[];return Object.keys(aa).forEach(function(ab){var ac=aa[ab].missing;ac.forEach(function(ad){t.push({id:ab,rev:ad})})}),{docs:t,revs:!0}}function i7(ad,ak,af,ah){function ag(){var am=fj(af);if(am.docs.length){return ad.bulkGet(am).then(function(ap){if(ah.cancelled){throw new Error("cancelled")}return gN.all(ap.results.map(function(aq){return gN.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(ab=!1),av&&av._attachments?X(ak,ad,av).then(function(ax){var aw=Object.keys(av._attachments);return ax.forEach(function(az,aA){var ay=av._attachments[aw[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){t=t.concat(gh(aq).filter(Boolean))})})}}function ac(am){return am._attachments&&Object.keys(am._attachments).length>0}function aa(am){return ad.allDocs({keys:am,include_docs:!0}).then(function(ap){if(ah.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&h4(aq.value.rev)&&!ac(aq.doc)&&(t.push(aq.doc),delete af[aq.id])})})}function aj(){var am=Object.keys(af).filter(function(aq){var ap=af[aq].missing;return 1===ap.length&&h4(ap[0])});return am.length>0?aa(am):void 0}function al(){return{ok:ab,docs:t}}af=iC(af);var t=[],ab=!0;return gN.resolve().then(aj).then(ag).then(al)}function Q(ab,ad,t,ac,aa){return ab.get(ad)["catch"](function(af){if(404===af.status){return"http"===ab.type()&&ii(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ac,_id:ad,history:[],replicator:gU,version:K}}throw af}).then(function(af){return aa.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ac}),af.history.unshift({last_seq:t,session_id:ac}),af.history=af.history.slice(0,ia),af.version=K,af.replicator=gU,af.session_id=ac,af.last_seq=t,ab.put(af)["catch"](function(ag){if(409===ag.status){return Q(ab,ad,t,ac,aa)}throw ag}))})}function ai(ab,t,aa,ac){this.src=ab,this.target=t,this.id=aa,this.returnValue=ac}function gg(aa,t){return aa.session_id===t.session_id?{last_seq:aa.last_seq,history:aa.history}:iA(aa.history,t.history)}function iA(ab,t){var ah=ab[0],ac=ab.slice(1),aa=t[0],af=t.slice(1);if(!ah||0===t.length){return{last_seq:gZ,history:[]}}var ag=ah.session_id;if(gD(ag,t)){return{last_seq:ah.last_seq,history:ab}}var ad=aa.session_id;return gD(ad,ac)?{last_seq:aa.last_seq,history:af}:iA(ac,af)}function gD(ab,t){var aa=t[0],ac=t.slice(1);return ab&&0!==t.length?ab===aa.session_id?!0:gD(ab,ac):!1}function cr(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function N(ab,t,aa,ac){return ab.retry===!1?(t.emit("error",aa),void t.removeAllListeners()):("function"!=typeof ab.back_off_function&&(ab.back_off_function=gX),t.emit("requestError",aa),"active"!==t.state&&"pending"!==t.state||(t.emit("paused",aa),t.state="stopped",t.once("active",function(){ab.current_back_off=fk})),ab.current_back_off=ab.current_back_off||fk,ab.current_back_off=ab.back_off_function(ab.current_back_off),void setTimeout(ac,ab.current_back_off))}function gb(t){return Object.keys(t).sort(gp.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function gP(aa,ac,ag){var ab=ag.doc_ids?ag.doc_ids.sort(gp.collate):"",t=ag.filter?ag.filter.toString():"",ad="",af="";return ag.filter&&ag.query_params&&(ad=JSON.stringify(gb(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),gN.all([aa.id(),ac.id()]).then(function(ah){var aj=ah[0]+ah[1]+t+af+ad+ab;return new gN(function(ak){hH(aj,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function hI(ag,aO,aC,aH,aD){function aw(){return al?gN.resolve():gP(ag,aO,aC).then(function(aS){aQ=aS,al=new ai(ag,aO,aQ,aH)})}function aI(){if(aK=[],0!==aj.docs.length){var aS=aj.docs;return aO.bulkDocs({docs:aS,new_edits:!1}).then(function(aV){if(aH.cancelled){throw aE(),new Error("cancelled")}var aT=[],aW={};aV.forEach(function(aY){aY.error&&(aD.doc_write_failures++,aT.push(aY),aW[aY.id]=aY)}),ah=ah.concat(aT),aD.docs_written+=aj.docs.length-aT.length;var aX=aT.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aW[aZ._id];aY?aH.emit("denied",iC(aY)):aK.push(aZ)}),aX.length>0){var aU=new Error("bulkDocs error");throw aU.other_errors=aT,av("target.bulkDocs failed to write docs",aU),new Error("bulkWrite partial failure")}},function(aT){throw aD.doc_write_failures+=aS.length,aT})}}function aN(){if(aj.error){throw new Error("There was a problem getting docs.")}aD.last_seq=ax=aj.seq;var aS=iC(aD);return aK.length&&(aS.docs=aK,aH.emit("change",aS)),aq=!0,al.writeCheckpoint(aj.seq,af).then(function(){if(aq=!1,aH.cancelled){throw aE(),new Error("cancelled")}aj=void 0,aA()})["catch"](aP)}function ac(){var aS={};return aj.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aO.revsDiff(aS).then(function(aT){if(aH.cancelled){throw aE(),new Error("cancelled")}aj.diffs=aT})}function am(){return i7(ag,aO,aj.diffs,aH).then(function(aS){aj.error=!aS.ok,aS.docs.forEach(function(aT){delete aj.diffs[aT._id],aD.docs_read++,aj.docs.push(aT)})})}function az(){if(!aH.cancelled&&!aj){if(0===ay.length){return void aa(!0)}aj=ay.shift(),ac().then(am).then(aI).then(aN).then(az)["catch"](function(aS){av("batch processing terminated with error",aS)})}}function aa(aS){return 0===aF.changes.length?void (0!==ay.length||aj||((aL&&aB.live||aJ)&&(aH.state="pending",aH.emit("paused")),aJ&&aE())):void ((aS||aJ||aF.changes.length>=ab)&&(ay.push(aF),aF={seq:0,changes:[],docs:[]},"pending"!==aH.state&&"stopped"!==aH.state||(aH.state="active",aH.emit("active")),az()))}function av(aT,aS){ap||(aS.message||(aS.message=aT),aD.ok=!1,aD.status="aborting",aD.errors.push(aS),ah=ah.concat(aS),ay=[],aF={seq:0,changes:[],docs:[]},aE())}function aE(){if(!(ap||aH.cancelled&&(aD.status="cancelled",aq))){aD.status=aD.status||"complete",aD.end_time=new Date,aD.last_seq=ax,ap=!0;var aT=ah.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aT.length>0){var aS=ah.pop();ah.length>0&&(aS.other_errors=ah),aS.result=aD,N(aC,aH,aS,function(){hI(ag,aO,aC,aH)})}else{aD.errors=ah,aH.emit("complete",aD),aH.removeAllListeners()}}}function ad(aT){if(aH.cancelled){return aE()}var aS=fa(aC)(aT);aS&&(aF.seq=aT.seq,aF.changes.push(aT),aa(0===ay.length&&aB.live))}function t(aT){if(aM=!1,aH.cancelled){return aE()}if(aT.results.length>0){aB.since=aT.last_seq,aA(),aa(!0)}else{var aS=function(){aL?(aB.live=!0,aA()):aJ=!0,aa(!0)};aj||0!==aT.results.length?aS():(aq=!0,al.writeCheckpoint(aT.last_seq,af).then(function(){aq=!1,aD.last_seq=ax=aT.last_seq,aS()})["catch"](aP))}}function aG(aS){return aM=!1,aH.cancelled?aE():void av("changes rejected",aS)}function aA(){function aS(){aT.cancel()}function aU(){aH.removeListener("cancel",aS)}if(!aM&&!aJ&&ay.length<aR){aM=!0,aH._changes&&(aH.removeListener("cancel",aH._abortChanges),aH._changes.cancel()),aH.once("cancel",aS);var aT=ag.changes(aB).on("change",ad);aT.then(aU,aU),aT.then(t)["catch"](aG),aC.retry&&(aH._changes=aT,aH._abortChanges=aS)}}function au(){aw().then(function(){return aH.cancelled?void aE():al.getCheckpoint().then(function(aS){ax=aS,aB={since:ax,limit:ab,batch_size:ab,style:"all_docs",doc_ids:ak,return_docs:!0},aC.filter&&("string"!=typeof aC.filter?aB.include_docs=!0:aB.filter=aC.filter),"heartbeat" in aC&&(aB.heartbeat=aC.heartbeat),"timeout" in aC&&(aB.timeout=aC.timeout),aC.query_params&&(aB.query_params=aC.query_params),aC.view&&(aB.view=aC.view),aA()})})["catch"](function(aS){av("getCheckpoint rejected with ",aS)})}function aP(aS){throw aq=!1,av("writeCheckpoint completed with error",aS),aS}var aj,aQ,al,ay=[],aF={seq:0,changes:[],docs:[]},aq=!1,aJ=!1,ap=!1,ax=0,aL=aC.continuous||aC.live||!1,ab=aC.batch_size||100,aR=aC.batches_limit||10,aM=!1,ak=aC.doc_ids,ah=[],aK=[],af=bo();aD=aD||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var aB={};return aH.ready(ag,aO),aH.cancelled?void aE():(aH._addedListeners||(aH.once("cancel",aE),"function"==typeof aC.complete&&(aH.once("error",aC.complete),aH.once("complete",function(aS){aC.complete(null,aS)})),aH._addedListeners=!0),void ("undefined"==typeof aC.since?au():aw().then(function(){return aq=!0,al.writeCheckpoint(aC.since,af)}).then(function(){return aq=!1,aH.cancelled?void aE():(ax=aC.since,void au())})["catch"](aP)))}function je(){hi.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var aa=this,t=new gN(function(ac,ab){aa.once("complete",ac),aa.once("error",ab)});aa.then=function(ac,ab){return t.then(ac,ab)},aa["catch"]=function(ab){return t["catch"](ab)},aa["catch"](function(){})}function gc(t,aa){var ab=aa.PouchConstructor;return"string"==typeof t?new ab(t,aa):t}function hw(aa,ac,ag,ab){if("function"==typeof ag&&(ab=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw hs(ik,"`doc_ids` filter parameter is not a list.")}ag.complete=ab,ag=iC(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var t=new je(ag),ad=gc(aa,ag),af=gc(ac,ag);return hI(ad,af,ag,t),t}function i5(ab,t,aa,ac){return"function"==typeof aa&&(ac=aa,aa={}),"undefined"==typeof aa&&(aa={}),aa=iC(aa),aa.PouchConstructor=aa.PouchConstructor||this,ab=gc(ab,aa),t=gc(t,aa),new hg(ab,t,aa,ac)}function hg(aj,aa,t,ag){function ab(ay){al.emit("change",{direction:"pull",change:ay})}function am(ay){al.emit("change",{direction:"push",change:ay})}function ac(ay){al.emit("denied",{direction:"push",doc:ay})}function aq(ay){al.emit("denied",{direction:"pull",doc:ay})}function av(){al.pushPaused=!0,al.pullPaused&&al.emit("paused")}function af(){al.pullPaused=!0,al.pushPaused&&al.emit("paused")}function ak(){al.pushPaused=!1,al.pullPaused&&al.emit("active",{direction:"push"})}function ap(){al.pullPaused=!1,al.pushPaused&&al.emit("active",{direction:"pull"})}function ah(ay){return function(aC,az){var aE="change"===aC&&(az===ab||az===am),aA="denied"===aC&&(az===aq||az===ac),aD="paused"===aC&&(az===af||az===av),aB="active"===aC&&(az===ap||az===ak);(aE||aA||aD||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&al.removeAllListeners(aC))}}var al=this;this.canceled=!1;var ad=t.push?fs.extend({},t,t.push):t,aw=t.pull?fs.extend({},t,t.pull):t;this.push=hw(aj,aa,ad),this.pull=hw(aa,aj,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};t.live&&(this.push.on("complete",al.pull.cancel.bind(al.pull)),this.pull.on("complete",al.push.cancel.bind(al.push))),this.on("newListener",function(ay){"change"===ay?(al.pull.on("change",ab),al.push.on("change",am)):"denied"===ay?(al.pull.on("denied",aq),al.push.on("denied",ac)):"active"===ay?(al.pull.on("active",ap),al.push.on("active",ak)):"paused"===ay&&(al.pull.on("paused",af),al.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(al.pull.removeListener("change",ab),al.push.removeListener("change",am)):"denied"===ay?(al.pull.removeListener("denied",aq),al.push.removeListener("denied",ac)):"active"===ay?(al.pull.removeListener("active",ap),al.push.removeListener("active",ak)):"paused"===ay&&(al.pull.removeListener("paused",af),al.push.removeListener("paused",av))}),this.pull.on("removeListener",ah("pull")),this.push.on("removeListener",ah("push"));var au=gN.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return al.emit("complete",az),ag&&ag(null,az),al.removeAllListeners(),az},function(ay){if(al.cancel(),ag?ag(ay):al.emit("error",ay),al.removeAllListeners(),ag){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function hO(t){t.replicate=hw,t.sync=i5}var fz,fs=e(9),iq=fi(e(5)),hx=fi(e(8)),g1=fi(e(10)),gi=e(14),io=fi(e(4)),hi=e(1),i8=fi(e(15)),ju=fi(e(16)),h5=fi(e(17)),gp=e(12),gN="function"==typeof Promise?Promise:g1,at=Function.prototype.toString,hc=at.call(Object),hS=iq("pouchdb:api"),hK=6;if(hR()){fz=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),fz=!!localStorage.getItem("_pouch_check_localstorage")}catch(ij){fz=!1}}hx(ee,hi.EventEmitter),ee.prototype.addListener=function(aa,ac,ag,ab){function t(){function ah(){af=!1}if(ad._listeners[ac]){if(af){return void (af="waiting")}af=!0;var aj=er(ab,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(aj).on("change",function(ak){ak.seq>ab.since&&!ab.cancelled&&(ab.since=ak.seq,ab.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){t()},0),af=!1}).on("error",ah)}}if(!this._listeners[ac]){var ad=this,af=!1;this._listeners[ac]=t,this.on(aa,t)}},ee.prototype.removeListener=function(aa,t){t in this._listeners&&hi.EventEmitter.prototype.removeListener.call(this,aa,this._listeners[t])},ee.prototype.notifyLocalWindows=function(t){hR()?chrome.storage.local.set({dbName:t}):ga()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},ee.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},hx(gM,Error),gM.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var h7=new gM({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),jm=new gM({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),he=new gM({status:404,error:"not_found",reason:"missing"}),fV=new gM({status:409,error:"conflict",reason:"Document update conflict"}),jC=new gM({status:400,error:"invalid_id",reason:"_id field must contain a string"}),hy=new gM({status:412,error:"missing_id",reason:"_id is required for puts"}),be=new gM({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),gx=new gM({status:412,error:"precondition_failed",reason:"Database not open"}),hl=new gM({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),g3=new gM({status:500,error:"badarg",reason:"Some query argument is invalid"}),gW=new gM({status:400,error:"invalid_request",reason:"Request was invalid"}),fn=new gM({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),u=new gM({status:500,error:"doc_validation",reason:"Bad special document member"}),ik=new gM({status:400,error:"bad_request",reason:"Something wrong with the request"}),gB=new gM({status:400,error:"bad_request",reason:"Document must be a JSON object"}),i4=new gM({status:404,error:"not_found",reason:"Database not found"}),ew=new gM({status:500,error:"indexed_db_went_bad",reason:"unknown"}),D=new gM({status:500,error:"web_sql_went_bad",reason:"unknown"}),hG=new gM({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),hM=new gM({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),dn=new gM({status:400,error:"bad_request",reason:"Invalid rev format"}),fo=new gM({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),gT=new gM({status:412,error:"missing_stub"}),iX=new gM({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),hY=[h7,jm,he,fV,jC,hy,be,gx,hl,g3,gW,fn,u,ik,gB,i4,D,hG,hM,dn,fo,gT,ew,iX],h3=function(ab,t,aa){var ac=hY.filter(function(ad){return ad[ab]===t});return aa&&ac.filter(function(ad){return ad.message===aa})[0]||ac[0]},fX=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ht="queryKey",ei=/(?:^|&)([^&=]*)=?([^&]*)/g,m=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,iV="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");hx(iT,hi.EventEmitter),iT.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},iT.prototype.doChanges=function(ab){var ad=this,t=ab.complete;if(ab=iC(ab),"live" in ab&&!("continuous" in ab)&&(ab.continuous=ab.live),ab.processChange=im,"latest"===ab.since&&(ab.since="now"),ab.since||(ab.since=0),"now"===ab.since){return void this.db.info().then(function(af){return ad.isCancelled?void t(null,{status:"cancelled"}):(ab.since=af.update_seq,void ad.doChanges(ab))},t)}if(ab.continuous&&"now"!==ab.since&&this.db.info().then(function(af){ad.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ab.view&&!ab.filter&&(ab.filter="_view"),ab.filter&&"string"==typeof ab.filter&&("_view"===ab.filter?ab.view=h0(ab.view):ab.filter=h0(ab.filter),"http"!==this.db.type()&&!ab.doc_ids)){return this.filterChanges(ab)}"descending" in ab||(ab.descending=!1),ab.limit=0===ab.limit?1:ab.limit,ab.complete=t;var ac=this.db._changes(ab);if(ac&&"function"==typeof ac.cancel){var aa=ad.cancel;ad.cancel=io(function(af){ac.cancel(),aa.apply(this,af)})}},iT.prototype.filterChanges=function(ab){var ad=this,t=ab.complete;if("_view"===ab.filter){if(!ab.view||"string"!=typeof ab.view){var ac=hs(ik,"`view` filter parameter not found or invalid.");return t(ac)}var aa=h2(ab.view);this.db.get("_design/"+aa[0],function(aj,ag){if(ad.isCancelled){return t(null,{status:"cancelled"})}if(aj){return t(iO(aj))}var ah=ag&&ag.views&&ag.views[aa[1]]&&ag.views[aa[1]].map;return ah?(ab.filter=eo(ah),void ad.doChanges(ab)):t(hs(he,ag.views?"missing json key: "+aa[1]:"missing json key: views"))})}else{var af=h2(ab.filter);if(!af){return ad.doChanges(ab)}this.db.get("_design/"+af[0],function(ah,ag){if(ad.isCancelled){return t(null,{status:"cancelled"})}if(ah){return t(iO(ah))}var aj=ag&&ag.filters&&ag.filters[af[1]];return aj?(ab.filter=iz(aj),void ad.doChanges(ab)):t(hs(he,ag&&ag.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},hx(eu,hi.EventEmitter),eu.prototype.post=fc("post",function(t,aa,ab){return"function"==typeof aa&&(ab=aa,aa={}),"object"!=typeof t||Array.isArray(t)?ab(hs(gB)):void this.bulkDocs({docs:[t]},aa,gk(ab))}),eu.prototype.put=fc("put",io(function(af){function ac(){ad||(jt("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),ad=!0)}var ah,aa,aj,ag,ad=!1,t=af.shift(),ab="_id" in t;if("object"!=typeof t||Array.isArray(t)){return(ag=af.pop())(hs(gB))}for(;;){if(ah=af.shift(),aa=typeof ah,"string"!==aa||ab?"string"!==aa||!ab||"_rev" in t?"object"===aa?aj=ah:"function"===aa&&(ag=ah):(ac(),t._rev=ah):(ac(),t._id=ah,ab=!0),!af.length){break}}return aj=aj||{},iu(t._id),di(t._id)&&"function"==typeof this._putLocal?t._deleted?this._removeLocal(t,ag):this._putLocal(t,ag):void this.bulkDocs({docs:[t]},aj,gk(ag))})),eu.prototype.putAttachment=fc("putAttachment",function(aa,ac,ag,ab,t){function ad(aj){var ah="_rev" in aj?parseInt(aj._rev,10):0;return aj._attachments=aj._attachments||{},aj._attachments[ac]={content_type:t,data:ab,revpos:++ah},af.put(aj)}var af=this;return"function"==typeof t&&(t=ab,ab=ag,ag=null),"undefined"==typeof t&&(t=ab,ab=ag,ag=null),af.get(aa).then(function(ah){if(ah._rev!==ag){throw hs(fV)}return ad(ah)},function(ah){if(ah.reason===he.message){return ad({_id:aa})}throw ah})}),eu.prototype.removeAttachment=fc("removeAttachment",function(ab,ad,t,ac){var aa=this;aa.get(ab,function(af,ag){return af?void ac(af):ag._rev!==t?void ac(hs(fV)):ag._attachments?(delete ag._attachments[ad],0===Object.keys(ag._attachments).length&&delete ag._attachments,void aa.put(ag,ac)):ac()})}),eu.prototype.remove=fc("remove",function(ab,ad,t,ac){var aa;"string"==typeof ad?(aa={_id:ab,_rev:ad},"function"==typeof t&&(ac=t,t={})):(aa=ab,"function"==typeof ad?(ac=ad,t={}):(ac=t,t=ad)),t=t||{},t.was_delete=!0;var af={_id:aa._id,_rev:aa._rev||t.rev};return af._deleted=!0,di(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(aa,ac):void this.bulkDocs({docs:[af]},t,gk(ac))}),eu.prototype.revsDiff=fc("revsDiff",function(ab,t,ah){function ac(ak,aj){ad.has(ak)||ad.set(ak,{missing:[]}),ad.get(ak).missing.push(aj)}function aa(aj,ak){var al=ab[aj].slice(0);iD(ak,function(am,ap,aq,aw,av){var au=ap+"-"+aq,ax=al.indexOf(au);-1!==ax&&(al.splice(ax,1),"available"!==av.status&&ac(aj,au))}),al.forEach(function(am){ac(aj,am)})}"function"==typeof t&&(ah=t,t={});var af=Object.keys(ab);if(!af.length){return ah(null,{})}var ag=0,ad=new gi.Map;af.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ad.set(aj,{missing:ab[aj]})}else{if(al){return ah(al)}aa(aj,am)}if(++ag===af.length){var ak={};return ad.forEach(function(ap,aq){ak[aq]=ap}),ah(null,ak)}})},this)}),eu.prototype.bulkGet=fc("bulkGet",function(aa,t){gf(this,aa,t)}),eu.prototype.compactDocument=fc("compactDocument",function(ab,t,aa){var ac=this;this._getRevisionTree(ab,function(ah,ad){if(ah){return aa(ah)}var ag=iv(ad),aj=[],af=[];Object.keys(ag).forEach(function(ak){ag[ak]>t&&aj.push(ak)}),iD(ad,function(ap,au,al,aq,am){var ak=au+"-"+al;"available"===am.status&&-1!==aj.indexOf(ak)&&af.push(ak)}),ac._doCompaction(ab,af,aa)})}),eu.prototype.compact=fc("compact",function(t,aa){"function"==typeof t&&(aa=t,t={});var ab=this;t=t||{},ab._compactionQueue=ab._compactionQueue||[],ab._compactionQueue.push({opts:t,callback:aa}),1===ab._compactionQueue.length&&iW(ab)}),eu.prototype._compact=function(aa,ac){function ag(ah){af.push(t.compactDocument(ah.id,0))}function ab(aj){var ah=aj.last_seq;gN.all(af).then(function(){return i3(t,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<ah?(ak.last_seq=ah,ak):!1})}).then(function(){ac(null,{ok:!0})})["catch"](ac)}var t=this,ad={return_docs:!1,last_seq:aa.last_seq||0},af=[];t.changes(ad).on("change",ag).on("complete",ab).on("error",ac)},eu.prototype.get=fc("get",function(ab,t,ah){function ac(){var ak=[],aj=aa.length;return aj?void aa.forEach(function(al){af.get(ab,{rev:al,revs:t.revs,attachments:t.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ah(null,ak)})}):ah(null,ak)}if("function"==typeof t&&(ah=t,t={}),"string"!=typeof ab){return ah(hs(jC))}if(di(ab)&&"function"==typeof this._getLocal){return this._getLocal(ab,ah)}var aa=[],af=this;if(!t.open_revs){return this._get(ab,t,function(aB,az){if(aB){return ah(aB)}var ap=az.doc,ax=az.metadata,aA=az.ctx;if(t.conflicts){var am=jw(ax);am.length&&(ap._conflicts=am)}if(hF(ax,ap._rev)&&(ap._deleted=!0),t.revs||t.revs_info){var au=g0(ax.rev_tree),aj=l(au,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(ap._rev.split("-")[1])}),aq=aj.ids.map(function(aC){return aC.id}).indexOf(ap._rev.split("-")[1])+1,aw=aj.ids.length-aq;if(aj.ids.splice(aq,aw),aj.ids.reverse(),t.revs&&(ap._revisions={start:aj.pos+aj.ids.length-1,ids:aj.ids.map(function(aC){return aC.id})}),t.revs_info){var ay=aj.pos+aj.ids.length;ap._revs_info=aj.ids.map(function(aC){return ay--,{rev:ay+"-"+aC.id,status:aC.opts.status}})}}if(t.attachments&&ap._attachments){var av=ap._attachments,al=Object.keys(av).length;if(0===al){return ah(null,ap)}Object.keys(av).forEach(function(aC){this._getAttachment(ap._id,aC,av[aC],{rev:ap._rev,binary:t.binary,ctx:aA},function(aE,aD){var aF=ap._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--al||ah(null,ap)})},af)}else{if(ap._attachments){for(var ak in ap._attachments){ap._attachments.hasOwnProperty(ak)&&(ap._attachments[ak].stub=!0)}}ah(null,ap)}})}if("all"===t.open_revs){this._getRevisionTree(ab,function(ak,aj){return ak?ah(ak):(aa=iP(aj).map(function(al){return al.rev}),void ac())})}else{if(!Array.isArray(t.open_revs)){return ah(hs(hl,"function_clause"))}aa=t.open_revs;for(var ag=0;ag<aa.length;ag++){var ad=aa[ag];if("string"!=typeof ad||!/^\d+-/.test(ad)){return ah(hs(dn))}}ac()}}),eu.prototype.getAttachment=fc("getAttachment",function(ab,ad,t,ac){var aa=this;t instanceof Function&&(ac=t,t={}),this._get(ab,t,function(af,ag){return af?ac(af):ag.doc._attachments&&ag.doc._attachments[ad]?(t.ctx=ag.ctx,t.binary=!0,aa._getAttachment(ab,ad,ag.doc._attachments[ad],t,ac),void 0):ac(hs(he))})}),eu.prototype.allDocs=fc("allDocs",function(t,aa){if("function"==typeof t&&(aa=t,t={}),t.skip="undefined"!=typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys" in t){if(!Array.isArray(t.keys)){return aa(new TypeError("options.keys must be an array"))}var ab=["startkey","endkey","key"].filter(function(ac){return ac in t})[0];if(ab){return void aa(hs(fn,"Query parameter `"+ab+"` is not compatible with multi-get"))}if("http"!==this.type()){return fq(this,t,aa)}}return this._allDocs(t,aa)}),eu.prototype.changes=function(aa,t){return"function"==typeof aa&&(t=aa,aa={}),new iT(this,aa,t)},eu.prototype.close=fc("close",function(t){return this._closed=!0,this._close(t)}),eu.prototype.info=fc("info",function(aa){var t=this;this._info(function(ab,ac){return ab?aa(ab):(ac.db_name=ac.db_name||t._db_name,ac.auto_compaction=!(!t.auto_compaction||"http"===t.type()),ac.adapter=t.type(),void aa(null,ac))})}),eu.prototype.id=fc("id",function(t){return this._id(t)}),eu.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},eu.prototype.bulkDocs=fc("bulkDocs",function(ab,ad,t){if("function"==typeof ad&&(t=ad,ad={}),ad=ad||{},Array.isArray(ab)&&(ab={docs:ab}),!ab||!ab.docs||!Array.isArray(ab.docs)){return t(hs(jm))}for(var ac=0;ac<ab.docs.length;++ac){if("object"!=typeof ab.docs[ac]||Array.isArray(ab.docs[ac])){return t(hs(gB))}}var aa;return ab.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){aa=aa||g5(ag)})}),aa?t(hs(ik,aa)):("new_edits" in ad||("new_edits" in ab?ad.new_edits=ab.new_edits:ad.new_edits=!0),ad.new_edits||"http"===this.type()||ab.docs.sort(ev),ct(ab.docs),this._bulkDocs(ab,ad,function(af,ag){return af?t(af):(ad.new_edits||(ag=ag.filter(function(ah){return ah.error})),void t(null,ag))}))}),eu.prototype.registerDependentDatabase=fc("registerDependentDatabase",function(ab,t){function aa(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[ab]?!1:(ad.dependentDbs[ab]=!0,ad)}var ac=new this.constructor(ab,this.__opts);i3(this,"_local/_pouch_dependentDbs",aa).then(function(){t(null,{db:ac})})["catch"](t)}),eu.prototype.destroy=fc("destroy",function(ab,ad){function t(){ac._destroy(ab,function(ag,af){return ag?ad(ag):(ac._destroyed=!0,ac.emit("destroyed"),void ad(null,af||{ok:!0}))})}"function"==typeof ab&&(ad=ab,ab={});var ac=this,aa="use_prefix" in ac?ac.use_prefix:!0;return"http"===ac.type()?t():void ac.get("_local/_pouch_dependentDbs",function(ah,ak){if(ah){return 404!==ah.status?ad(ah):t()}var ag=ak.dependentDbs,aj=ac.constructor,af=Object.keys(ag).map(function(al){var am=aa?al.replace(new RegExp("^"+aj.prefix),""):al;return new aj(am,ac.__opts).destroy()});gN.all(af).then(t,ad)})}),hn.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},hn.prototype.fail=function(t){this.failed=t,this.execute()},hn.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},hn.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},hx(O,eu),O.debug=iq,O.adapters={},O.preferredAdapters=[],O.prefix="_pouch_";var gL=new hi.EventEmitter;fW(O),O.parseAdapter=function(ab,t){var ah,ac,aa=ab.match(/([a-z\-]*):\/\/(.*)/);if(aa){if(ab=/http(s?)/.test(aa[1])?aa[1]+"://"+aa[2]:aa[2],ah=aa[1],!O.adapters[ah].valid()){throw"Invalid adapter"}return{name:ab,adapter:aa[1]}}var af="idb" in O.adapters&&"websql" in O.adapters&&ga()&&localStorage["_pouch__websqldb_"+O.prefix+ab];if(t.adapter){ac=t.adapter}else{if("undefined"!=typeof t&&t.db){ac="leveldb"}else{for(var ag=0;ag<O.preferredAdapters.length;++ag){if(ac=O.preferredAdapters[ag],ac in O.adapters){if(af&&"idb"===ac){jt("log",'PouchDB is downgrading "'+ab+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ah=O.adapters[ac];var ad=ah&&"use_prefix" in ah?ah.use_prefix:!0;return{name:ad?O.prefix+ab:ab,adapter:ac}},O.adapter=function(t,aa,ab){aa.valid()&&(O.adapters[t]=aa,ab&&O.preferredAdapters.push(t))},O.plugin=function(t){return"function"==typeof t?t(O):Object.keys(t).forEach(function(aa){O.prototype[aa]=t[aa]}),O},O.defaults=function(aa){function t(ab,ad,ac){return this instanceof t?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=fs.extend({},aa,ad),void O.call(this,ab,ad,ac)):new t(ab,ad,ac)}return hx(t,O),t.preferredAdapters=O.preferredAdapters.slice(),Object.keys(O).forEach(function(ab){ab in t||(t[ab]=O[ab])}),t};var ez="5.4.4";O.version=ez;var iB,q=g4(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),gt=g4(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),fm=function(t){return atob(t)},gu=function(t){return btoa(t)},bt=gl.setImmediate||gl.setTimeout,iU=32768,g2=5,h8="document-store",gv="by-sequence",hQ="attach-store",gH="attach-seq-store",ir="meta-store",J="local-store",iw="detect-blob-support",hV={running:!1,queue:[]},ie=new gi.Map,a2=new ee,o=new gi.Map;S.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var iL=7,gq=hX("document-store"),T=hX("by-sequence"),iH=hX("attach-store"),f=hX("local-store"),ff=hX("metadata-store"),i9=hX("attach-seq-store"),jb=new gi.Map,i0=new ee,U=1,gS="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+T+" (seq, deleted)",iR="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+T+" (doc_id, rev)",B="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+gq+" (winningseq)",hm="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+i9+" (seq)",a6="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+i9+" (digest, seq)",iG=T+".seq = "+gq+".winningseq",hP=T+".seq AS seq, "+T+".deleted AS deleted, "+T+".json AS data, "+T+".rev AS rev, "+gq+".json AS metadata";fT.valid=jg,fT.use_prefix=!0;var iY=i1(),h9=function(){},hJ=25,en=50,hp={},fl=1800,jp=iq("pouchdb:http");ar.valid=function(){return !0},gF.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},gF.prototype.finish=function(){return this.promise};var jr=function(aa,t){return t&&aa.then(function(ab){fp.nextTick(function(){t(null,ab)})},function(ab){fp.nextTick(function(){t(ab)})}),aa},jz=function(t){return io(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&jr(ab,aa),ab})},ic=function(aa,t){return aa.then(function(ab){return t().then(function(){return ab})},function(ab){return t().then(function(){throw ab})})},jj=function(aa,t){return function(){var ab=arguments,ac=this;return aa.add(function(){return t.apply(ac,ab)})}},hu=function(ab){for(var ad={},t=0,ac=ab.length;ac>t;t++){ad["$"+ab[t]]=!0}var aa=Object.keys(ad),af=new Array(aa.length);for(t=0,ac=aa.length;ac>t;t++){af[t]=aa[t].substring(1)}return af},iK={},p=new gF,hb=50,hh=jt.bind(null,"log"),ce={_sum:function(aa,t){return gJ(t)},_count:function(aa,t){return t.length},_stats:function(t,aa){function ab(ad){for(var ag=0,ah=0,af=ad.length;af>ah;ah++){var ac=ad[ah];ag+=ac*ac}return ag}return{sum:gJ(aa),min:Math.min.apply(null,aa),max:Math.max.apply(null,aa),count:aa.length,sumsqr:ab(aa)}}},C=jz(function(){var t=this;return"http"===t.type()?a5(t):"function"==typeof t._viewCleanup?gR(t):gm(t)}),dr=function(ab,ad,t){"function"==typeof ad&&(t=ad,ad={}),ad=ad?A(ad):{},"function"==typeof ab&&(ab={map:ab});var ac=this,aa=gN.resolve().then(function(){return et(ac,ab,ad)});return jr(aa,t),aa};hx(g8,Error),hx(iF,Error),hx(iZ,Error);var hC={query:dr,viewCleanup:C},K=1,gU="pouchdb",ia=5,gZ=0;ai.prototype.writeCheckpoint=function(t,aa){var ab=this;return this.updateTarget(t,aa).then(function(){return ab.updateSource(t,aa)})},ai.prototype.updateTarget=function(aa,t){return Q(this.target,this.id,aa,t,this.returnValue)},ai.prototype.updateSource=function(t,aa){var ab=this;return this.readOnlySource?gN.resolve(!0):Q(this.src,this.id,t,aa,this.returnValue)["catch"](function(ac){if(cr(ac)){return ab.readOnlySource=!0,!0}throw ac})};var hj={undefined:function(aa,t){return 0===gp.collate(aa.last_seq,t.last_seq)?t.last_seq:0},1:function(aa,t){return gg(t,aa).last_seq}};ai.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?gN.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return gZ}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hj?hj[ab](aa,ac):gZ},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:gZ}).then(function(){return gZ},function(ac){return cr(ac)?(t.readOnlySource=!0,aa.last_seq):gZ})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return gZ})};var fk=0;hx(je,hi.EventEmitter),je.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},je.prototype.ready=function(ab,ad){function t(){aa.cancel()}function ac(){ab.removeListener("destroyed",t),ad.removeListener("destroyed",t)}var aa=this;aa._readyCalled||(aa._readyCalled=!0,ab.once("destroyed",t),ad.once("destroyed",t),aa.once("complete",ac))},hx(hg,hi.EventEmitter),hg.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},O.plugin(ji).plugin(P).plugin(iN).plugin(hC).plugin(hO),a.exports=O}).call(this,e(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(h,b,e){function a(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}b.exports=a},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var h=arguments,k=this.useColors;if(h[0]=(k?"%c":"")+this.namespace+(k?" %c":" ")+h[0]+(k?"%c ":" ")+"+"+p.humanize(this.diff),!k){return h}var f="color: "+this.color;h=[h[0],f,"color: inherit"].concat(Array.prototype.slice.call(h,1));var j=0,g=0;return h[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(j++,"%c"===l&&(g=j))}),h.splice(g,0,f),h}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(f,u,o){function s(){return o.colors[i++%o.colors.length]}function r(g){function j(){}function h(){var q=h,m=+new Date,p=m-(e||m);q.diff=p,q.prev=e,q.curr=m,e=m,null==q.useColors&&(q.useColors=o.useColors()),null==q.color&&q.useColors&&(q.color=s());var w=Array.prototype.slice.call(arguments);w[0]=o.coerce(w[0]),"string"!=typeof w[0]&&(w=["%o"].concat(w));var l=0;w[0]=w[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}l++;var x=o.formatters[A];if("function"==typeof x){var z=w[l];y=x.call(q,z),w.splice(l,1),l--}return y}),"function"==typeof o.formatArgs&&(w=o.formatArgs.apply(q,w));var v=h.log||o.log||console.log.bind(console);v.apply(q,w)}j.enabled=!1,h.enabled=!0;var k=o.enabled(g)?h:j;return k.namespace=g,k}function n(h){o.save(h);for(var g=(h||"").split(/[\s,]+/),j=g.length,k=0;j>k;k++){g[k]&&(h=g[k].replace(/\*/g,".*?"),"-"===h[0]?o.skips.push(new RegExp("^"+h.substr(1)+"$")):o.names.push(new RegExp("^"+h+"$")))}}function b(){o.enable("")}function t(g){var j,h;for(j=0,h=o.skips.length;h>j;j++){if(o.skips[j].test(g)){return !1}}for(j=0,h=o.names.length;h>j;j++){if(o.names[j].test(g)){return !0}}return !1}function a(g){return g instanceof Error?g.stack||g.message:g}o=u.exports=r,o.coerce=a,o.disable=b,o.enable=n,o.enabled=t,o.humanize=f(11),o.names=[],o.skips=[],o.formatters={};var e,i=0},{11:11}],7:[function(e,a,b){(function(z){function n(){f=!0;for(var j,g,h=l.length;h;){for(g=l,l=[],j=-1;++j<h;){g[j]()}h=l.length}f=!1}function s(g){1!==l.push(g)||f||r()}var r,i=z.MutationObserver||z.WebKitMutationObserver;if(i){var y=0,u=new i(n),x=z.document.createTextNode("");u.observe(x,{characterData:!0}),r=function(){x.data=y=++y%2}}else{if(z.setImmediate||"undefined"==typeof z.MessageChannel){r="document" in z&&"onreadystatechange" in z.document.createElement("script")?function(){var g=z.document.createElement("script");g.onreadystatechange=function(){n(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},z.document.documentElement.appendChild(g)}:function(){setTimeout(n,0)}}else{var o=new z.MessageChannel;o.port1.onmessage=n,r=function(){o.port2.postMessage(0)}}}var f,l=[];a.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,a,b){"function"==typeof Object.create?a.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(e,a,b){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(m){if(m){for(var n in m){"object"==typeof m[n]&&h[n]?f.call(h,h[n],m[n]):h[n]=m[n]}}}),h};this.extend=f}).call(this)},{}],10:[function(f,u,o){function s(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=h,this.queue=[],this.outcome=void 0,g!==s&&y(this,g)}function a(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function e(j,k,g){t(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function p(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(g,k){function w(A){x||(x=!0,K.reject(g,A))}function j(A){x||(x=!0,K.resolve(g,A))}function q(){k(j,w)}var x=!1,z=r(q);"error"===z.status&&w(z.value)}function r(g,k){var q={};try{q.value=g(k),q.status="success"}catch(j){q.status="error",q.value=j}return q}function i(g){return g instanceof this?g:K.resolve(new this(s),g)}function n(g){var j=new this(s);return K.reject(j,g)}function m(B){function A(E,D){function C(F){w[D]=F,++z!==k||g||(g=!0,K.resolve(x,w))}j.resolve(E).then(C,function(F){g||(g=!0,K.reject(x,F))})}var j=this;if("[object Array]"!==Object.prototype.toString.call(B)){return this.reject(new TypeError("must be an array"))}var k=B.length,g=!1;if(!k){return this.resolve([])}for(var w=new Array(k),z=0,q=-1,x=new this(s);++q<k;){A(B[q],q)}return x}function l(g){function k(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(j,B))},function(B){x||(x=!0,K.reject(j,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(g)){return this.reject(new TypeError("must be an array"))}var q=g.length,x=!1;if(!q){return this.resolve([])}for(var z=-1,j=new this(s);++z<q;){k(g[z])}return j}var t=f(7),K={},L=["REJECTED"],b=["FULFILLED"],h=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(j,k){if("function"!=typeof j&&this.state===b||"function"!=typeof k&&this.state===L){return this}var q=new this.constructor(s);if(this.state!==h){var g=this.state===b?j:k;e(q,g,this.outcome)}else{this.queue.push(new a(q,j,k))}return q},a.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},a.prototype.otherCallFulfilled=function(g){e(this.promise,this.onFulfilled,g)},a.prototype.callRejected=function(g){K.reject(this.promise,g)},a.prototype.otherCallRejected=function(g){e(this.promise,this.onRejected,g)},K.resolve=function(j,w){var q=r(p,w);if("error"===q.status){return K.reject(j,q.value)}var k=q.value;if(k){y(j,k)}else{j.state=b,j.outcome=w;for(var g=-1,x=j.queue.length;++g<x;){j.queue[g].callFulfilled(w)}}return j},K.reject=function(g,k){g.state=L,g.outcome=k;for(var q=-1,j=g.queue.length;++q<j;){g.queue[q].callRejected(k)}return g},v.resolve=i,v.reject=n,v.all=m,v.race=l},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(h,l,D){function b(m){if(null!==m){switch(typeof m){case"boolean":return m?1:0;case"number":return n(m);case"string":return m.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var j=Array.isArray(m),w=j?m:Object.keys(m),q=-1,v=w.length,g="";if(j){for(;++q<v;){g+=D.toIndexableString(w[q])}}else{for(;++q<v;){var k=w[q];g+=D.toIndexableString(k)+D.toIndexableString(m[k])}}return g}}return""}function o(g,w){var k,q=w,m="1"===g[w];if(m){k=0,w++}else{var j="0"===g[w];w++;var y="",v=g.substring(w,w+i),x=parseInt(v,10)+t;for(j&&(x=-x),w+=i;;){var z=g[w];if("\x00"===z){break}y+=z,w++}y=y.split("."),k=1===y.length?parseInt(y,10):parseFloat(y[0]+"."+y[1]),j&&(k-=10),0!==x&&(k=parseFloat(k+"e"+x))}return{num:k,length:w-q}}function r(w,q){var j=w.pop();if(q.length){var g=q[q.length-1];j===g.element&&(q.pop(),g=q[q.length-1]);var v=g.element,m=g.index;if(Array.isArray(v)){v.push(j)}else{if(m===w.length-2){var k=w.pop();v[k]=j}else{w.push(j)}}}}function s(j,m){for(var k=Math.min(j.length,m.length),g=0;k>g;g++){var q=D.collate(j[g],m[g]);if(0!==q){return q}}return j.length===m.length?0:j.length>m.length?1:-1}function e(g,j){return g===j?0:g>j?1:-1}function u(m,j){for(var w=Object.keys(m),q=Object.keys(j),v=Math.min(w.length,q.length),g=0;v>g;g++){var k=D.collate(w[g],q[g]);if(0!==k){return k}if(k=D.collate(m[w[g]],j[q[g]]),0!==k){return k}}return w.length===q.length?0:w.length>q.length?1:-1}function p(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function n(v){if(0===v){return"1"}var k=v.toExponential().split(/e\+?/),x=parseInt(k[1],10),g=0>v,y=g?"0":"2",w=(g?-x:x)-t,q=a.padLeft(w.toString(),"0",i);y+=f+q;var j=Math.abs(parseFloat(k[0]));g&&(j=10-j);var m=j.toFixed(20);return m=m.replace(/\.?0+$/,""),y+=f+m}var t=-324,i=3,f="",a=h(13);D.collate=function(j,m){if(j===m){return 0}j=D.normalizeKey(j),m=D.normalizeKey(m);var k=p(j),g=p(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return e(j,m)}return Array.isArray(j)?s(j,m):u(j,m)},D.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var m=0;j>m;m++){g[m]=D.normalizeKey(k[m])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var q in k){if(k.hasOwnProperty(q)){var v=k[q];"undefined"!=typeof v&&(g[q]=D.normalizeKey(v))}}}}}return g},D.toIndexableString=function(g){var j="\x00";return g=D.normalizeKey(g),p(g)+f+b(g)+j},D.parseIndexableString=function(g){for(var w=[],m=[],q=0;;){var y=g[q++];if("\x00"!==y){switch(y){case"1":w.push(null);break;case"2":w.push("1"===g[q]),q++;break;case"3":var v=o(g,q);w.push(v.num),q+=v.length;break;case"4":for(var x="";;){var z=g[q];if("\x00"===z){break}x+=z,q++}x=x.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),w.push(x);break;case"5":var j={element:[],index:w.length};w.push(j.element),m.push(j);break;case"6":var k={element:{},index:w.length};w.push(k.element),m.push(k);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+y)}}else{if(1===w.length){return w.pop()}r(w,m)}}}},{13:13}],13:[function(h,b,e){function a(m,f,g){for(var n="",l=g-m.length;n.length<l;){n+=f}return n}e.padLeft=function(k,l,f){var g=a(k,l,f);return g+k},e.padRight=function(k,l,f){var g=a(k,l,f);return k+g},e.stringLexCompare=function(r,n){var g,o=r.length,f=n.length;for(g=0;o>g;g++){if(g===f){return 1}var i=r.charAt(g),q=n.charAt(g);if(i!==q){return q>i?-1:1}}return f>o?-1:0},e.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(e,j,a){function i(){this.store={}}function b(g){if(this.store=new i,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}a.Map=i,a.Set=b,i.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},i.prototype.unmangle=function(f){return f.substring(1)},i.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},i.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},i.prototype.has=function(f){var g=this.mangle(f);return g in this.store},i.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},i.prototype.forEach=function(h){for(var p=Object.keys(this.store),g=0,n=p.length;n>g;g++){var o=p[g],f=this.store[o];o=this.unmangle(o),h(f,o)}},b.prototype.add=function(f){return this.store.set(f,!0)},b.prototype.has=function(f){return this.store.has(f)},b.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(e,a,b){(function(){var h={}.hasOwnProperty,f=[].slice;a.exports=function(o,p){var q,g,n,r;g=[],r=[];for(q in p){h.call(p,q)&&(n=p[q],"this"!==q&&(g.push(q),r.push(n)))}return Function.apply(null,f.call(g).concat([o])).apply(p["this"],r)}}).call(this)},{}],16:[function(a,b,f){!function(i){if("object"==typeof f){b.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(p){function o(q,w,z,j,k,x){return w=i(i(w,q),i(j,x)),i(w<<k|w>>>32-k,z)}function u(j,A,k,w,q,z,x){return o(A&k|~A&w,j,A,q,z,x)}function n(j,A,k,w,q,z,x){return o(A&w|k&~w,j,A,q,z,x)}function Q(j,A,k,w,q,z,x){return o(A^k^w,j,A,q,z,x)}function r(j,A,k,w,q,z,x){return o(k^(A|~w),j,A,q,z,x)}function g(q,w){var z=q[0],j=q[1],x=q[2],k=q[3];z=u(z,j,x,k,w[0],7,-680876936),k=u(k,z,j,x,w[1],12,-389564586),x=u(x,k,z,j,w[2],17,606105819),j=u(j,x,k,z,w[3],22,-1044525330),z=u(z,j,x,k,w[4],7,-176418897),k=u(k,z,j,x,w[5],12,1200080426),x=u(x,k,z,j,w[6],17,-1473231341),j=u(j,x,k,z,w[7],22,-45705983),z=u(z,j,x,k,w[8],7,1770035416),k=u(k,z,j,x,w[9],12,-1958414417),x=u(x,k,z,j,w[10],17,-42063),j=u(j,x,k,z,w[11],22,-1990404162),z=u(z,j,x,k,w[12],7,1804603682),k=u(k,z,j,x,w[13],12,-40341101),x=u(x,k,z,j,w[14],17,-1502002290),j=u(j,x,k,z,w[15],22,1236535329),z=n(z,j,x,k,w[1],5,-165796510),k=n(k,z,j,x,w[6],9,-1069501632),x=n(x,k,z,j,w[11],14,643717713),j=n(j,x,k,z,w[0],20,-373897302),z=n(z,j,x,k,w[5],5,-701558691),k=n(k,z,j,x,w[10],9,38016083),x=n(x,k,z,j,w[15],14,-660478335),j=n(j,x,k,z,w[4],20,-405537848),z=n(z,j,x,k,w[9],5,568446438),k=n(k,z,j,x,w[14],9,-1019803690),x=n(x,k,z,j,w[3],14,-187363961),j=n(j,x,k,z,w[8],20,1163531501),z=n(z,j,x,k,w[13],5,-1444681467),k=n(k,z,j,x,w[2],9,-51403784),x=n(x,k,z,j,w[7],14,1735328473),j=n(j,x,k,z,w[12],20,-1926607734),z=Q(z,j,x,k,w[5],4,-378558),k=Q(k,z,j,x,w[8],11,-2022574463),x=Q(x,k,z,j,w[11],16,1839030562),j=Q(j,x,k,z,w[14],23,-35309556),z=Q(z,j,x,k,w[1],4,-1530992060),k=Q(k,z,j,x,w[4],11,1272893353),x=Q(x,k,z,j,w[7],16,-155497632),j=Q(j,x,k,z,w[10],23,-1094730640),z=Q(z,j,x,k,w[13],4,681279174),k=Q(k,z,j,x,w[0],11,-358537222),x=Q(x,k,z,j,w[3],16,-722521979),j=Q(j,x,k,z,w[6],23,76029189),z=Q(z,j,x,k,w[9],4,-640364487),k=Q(k,z,j,x,w[12],11,-421815835),x=Q(x,k,z,j,w[15],16,530742520),j=Q(j,x,k,z,w[2],23,-995338651),z=r(z,j,x,k,w[0],6,-198630844),k=r(k,z,j,x,w[7],10,1126891415),x=r(x,k,z,j,w[14],15,-1416354905),j=r(j,x,k,z,w[5],21,-57434055),z=r(z,j,x,k,w[12],6,1700485571),k=r(k,z,j,x,w[3],10,-1894986606),x=r(x,k,z,j,w[10],15,-1051523),j=r(j,x,k,z,w[1],21,-2054922799),z=r(z,j,x,k,w[8],6,1873313359),k=r(k,z,j,x,w[15],10,-30611744),x=r(x,k,z,j,w[6],15,-1560198380),j=r(j,x,k,z,w[13],21,1309151649),z=r(z,j,x,k,w[4],6,-145523070),k=r(k,z,j,x,w[11],10,-1120210379),x=r(x,k,z,j,w[2],15,718787259),j=r(j,x,k,z,w[9],21,-343485551),q[0]=i(z,q[0]),q[1]=i(j,q[1]),q[2]=i(x,q[2]),q[3]=i(k,q[3])}function t(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q.charCodeAt(j)+(q.charCodeAt(j+1)<<8)+(q.charCodeAt(j+2)<<16)+(q.charCodeAt(j+3)<<24)}return k}function v(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q[j]+(q[j+1]<<8)+(q[j+2]<<16)+(q[j+3]<<24)}return k}function P(C){var k,z,A,j,x,B,q=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(k=64;q>=k;k+=64){g(w,t(C.substring(k-64,k)))}for(C=C.substring(k-64),z=C.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=0;z>k;k+=1){A[k>>2]|=C.charCodeAt(k)<<(k%4<<3)}if(A[k>>2]|=128<<(k%4<<3),k>55){for(g(w,A),k=0;16>k;k+=1){A[k]=0}}return j=8*q,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),B=parseInt(j[1],16)||0,A[14]=x,A[15]=B,g(w,A),w}function O(C){var B,z,A,j,x,k,q=C.length,w=[1732584193,-271733879,-1732584194,271733878];for(B=64;q>=B;B+=64){g(w,v(C.subarray(B-64,B)))}for(C=q>B-64?C.subarray(B-64):new Uint8Array(0),z=C.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=0;z>B;B+=1){A[B>>2]|=C[B]<<(B%4<<3)}if(A[B>>2]|=128<<(B%4<<3),B>55){for(g(w,A),B=0;16>B;B+=1){A[B]=0}}return j=8*q,j=j.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(j[2],16),k=parseInt(j[1],16)||0,A[14]=x,A[15]=k,g(w,A),w}function s(q){var j,k="";for(j=0;4>j;j+=1){k+=h[q>>8*j+4&15]+h[q>>8*j&15]}return k}function m(j){var k;for(k=0;k<j.length;k+=1){j[k]=s(j[k])}return j.join("")}function y(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(q,w){var z,j=q.length,k=new ArrayBuffer(j),x=new Uint8Array(k);for(z=0;j>z;z+=1){x[z]=q.charCodeAt(z)}return w?x:k}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(q,w,k){var j=new Uint8Array(q.byteLength+w.byteLength);return j.set(new Uint8Array(q)),j.set(new Uint8Array(w),q.byteLength),k?j:j.buffer}function e(q){var w,k=[],j=q.length;for(w=0;j-1>w;w+=2){k.push(parseInt(q.substr(w,2),16))}return String.fromCharCode.apply(String,k)}function l(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==m(P("hello"))&&(i=function(q,w){var k=(65535&q)+(65535&w),j=(q>>16)+(w>>16)+(k>>16);return j<<16|65535&k}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(q,k){return q=0|q||0,0>q?Math.max(q+k,0):Math.min(q,k)}ArrayBuffer.prototype.slice=function(D,x){var k,A,w,q,z=this.byteLength,C=j(D,z),B=z;return x!==p&&(B=j(x,z)),C>B?new ArrayBuffer(0):(k=B-C,A=new ArrayBuffer(k),w=new Uint8Array(A),q=new Uint8Array(this,C,k),w.set(q),A)}}(),l.prototype.append=function(j){return this.appendBinary(y(j)),this},l.prototype.appendBinary=function(q){this._buff+=q,this._length+=q.length;var j,k=this._buff.length;for(j=64;k>=j;j+=64){g(this._hash,t(this._buff.substring(j-64,j)))}return this._buff=this._buff.substring(j-64),this},l.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j.charCodeAt(w)<<(w%4<<3)}return this._finish(x,k),z=m(this._hash),q&&(z=e(z)),this.reset(),z},l.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},l.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},l.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},l.prototype._finish=function(q,w){var z,j,k,x=w;if(q[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,q),x=0;16>x;x+=1){q[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(z[2],16),k=parseInt(z[1],16)||0,q[14]=j,q[15]=k,g(this._hash,q)},l.hash=function(j,k){return l.hashBinary(y(j),k)},l.hashBinary=function(q,w){var k=P(q),j=m(k);return w?e(j):j},l.ArrayBuffer=function(){this.reset()},l.ArrayBuffer.prototype.append=function(q){var w,k=T(this._buff.buffer,q,!0),j=k.length;for(this._length+=q.byteLength,w=64;j>=w;w+=64){g(this._hash,v(k.subarray(w-64,w)))}return this._buff=j>w-64?new Uint8Array(k.buffer.slice(w-64)):new Uint8Array(0),this},l.ArrayBuffer.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j[w]<<(w%4<<3)}return this._finish(x,k),z=m(this._hash),q&&(z=e(z)),this.reset(),z},l.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.ArrayBuffer.prototype.getState=function(){var j=l.prototype.getState.call(this);return j.buff=S(j.buff),j},l.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),l.prototype.setState.call(this,j)},l.ArrayBuffer.prototype.destroy=l.prototype.destroy,l.ArrayBuffer.prototype._finish=l.prototype._finish,l.ArrayBuffer.hash=function(q,w){var k=O(new Uint8Array(q)),j=m(k);return w?e(j):j},l})},{}],17:[function(h,b,e){function a(r,n,g){var o=g[g.length-1];r===o.element&&(g.pop(),o=g[g.length-1]);var f=o.element,i=o.index;if(Array.isArray(f)){f.push(r)}else{if(i===n.length-2){var q=n.pop();f[q]=r}else{n.push(r)}}}e.stringify=function(f){var g=[];g.push({obj:f});for(var l,F,u,n,i,E,D,r,s,o,C,t="";l=g.pop();){if(F=l.obj,u=l.prefix||"",n=l.val||"",t+=u,n){t+=n}else{if("object"!=typeof F){t+="undefined"==typeof F?null:JSON.stringify(F)}else{if(null===F){t+="null"}else{if(Array.isArray(F)){for(g.push({val:"]"}),i=F.length-1;i>=0;i--){E=0===i?"":",",g.push({obj:F[i],prefix:E})}g.push({val:"["})}else{D=[];for(r in F){F.hasOwnProperty(r)&&D.push(r)}for(g.push({val:"}"}),i=D.length-1;i>=0;i--){s=D[i],o=F[s],C=i>0?",":"",C+=JSON.stringify(s)+":",g.push({obj:o,prefix:C})}g.push({val:"{"})}}}}}return t},e.parse=function(i){for(var B,t,D,A,l,o,g,s,C,n=[],u=[],f=0;;){if(B=i[f++],"}"!==B&&"]"!==B&&"undefined"!=typeof B){switch(B){case" ":case"	":case"\n":case":":case",":break;case"n":f+=3,a(null,n,u);break;case"t":f+=3,a(!0,n,u);break;case"f":f+=4,a(!1,n,u);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(t="",f--;;){if(D=i[f++],!/[\d\.\-e\+]/.test(D)){f--;break}t+=D}a(parseFloat(t),n,u);break;case'"':for(A="",l=void 0,o=0;;){if(g=i[f++],'"'===g&&("\\"!==l||o%2!==1)){break}A+=g,l=g,"\\"===l?o++:o=0}a(JSON.parse('"'+A+'"'),n,u);break;case"[":s={element:[],index:n.length},n.push(s.element),u.push(s);break;case"{":C={element:{},index:n.length},n.push(C.element),u.push(C);break;default:throw new Error("unexpectedly reached end of input: "+B)}}else{if(1===n.length){return n.pop()}a(n.pop(),n,u)}}}},{}]},{},[3])(3)});