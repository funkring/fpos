!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(i,b,l){function k(h,f){if(!b[h]){if(!i[h]){var g="function"==typeof require&&require;if(!f&&g){return g(h,!0)}if(a){return a(h,!0)}var j=new Error("Cannot find module '"+h+"'");throw j.code="MODULE_NOT_FOUND",j}var n=b[h]={exports:{}};i[h][0].call(n.exports,function(p){var m=i[h][1][p];return k(m?m:p)},n,n.exports,d,i,b,l)}return b[h].exports}for(var a="function"==typeof require&&require,e=0;e<l.length;e++){k(l[e])}return k}({1:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],2:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var g="color: "+this.color;k=[k[0],g,"color: inherit"].concat(Array.prototype.slice.call(k,1));var f=0,j=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(f++,"%c"===l&&(j=f))}),k.splice(j,0,g),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(3),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{3:3}],3:[function(s,i,a){function e(){return a.colors[t++%a.colors.length]}function b(k){function h(){}function g(){var m=g,w=+new Date,l=w-(r||w);m.diff=l,m.prev=r,m.curr=w,r=w,null==m.useColors&&(m.useColors=a.useColors()),null==m.color&&m.useColors&&(m.color=e());var q=Array.prototype.slice.call(arguments);q[0]=a.coerce(q[0]),"string"!=typeof q[0]&&(q=["%o"].concat(q));var v=0;q[0]=q[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}v++;var x=a.formatters[A];if("function"==typeof x){var z=q[v];y=x.call(m,z),q.splice(v,1),v--}return y}),"function"==typeof a.formatArgs&&(q=a.formatArgs.apply(m,q));var p=g.log||a.log||console.log.bind(console);p.apply(m,q)}h.enabled=!1,g.enabled=!0;var j=a.enabled(k)?g:h;return j.namespace=k,j}function u(g){a.save(g);for(var k=(g||"").split(/[\s,]+/),h=k.length,j=0;h>j;j++){k[j]&&(g=k[j].replace(/\*/g,".*?"),"-"===g[0]?a.skips.push(new RegExp("^"+g.substr(1)+"$")):a.names.push(new RegExp("^"+g+"$")))}}function o(){a.enable("")}function f(g){var j,h;for(j=0,h=a.skips.length;h>j;j++){if(a.skips[j].test(g)){return !1}}for(j=0,h=a.names.length;h>j;j++){if(a.names[j].test(g)){return !0}}return !1}function n(g){return g instanceof Error?g.stack||g.message:g}a=i.exports=b,a.coerce=n,a.disable=o,a.enable=u,a.enabled=f,a.humanize=s(9),a.names=[],a.skips=[],a.formatters={};var r,t=0},{9:9}],4:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function p(f){return"number"==typeof f}function m(f){return"object"==typeof f&&null!==f}function i(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!p(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,h,r,f,l,j;if(this._events||(this._events={}),"error"===k&&(!this._events.error||m(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(h=this._events[k],i(h)){return !1}if(b(h)){switch(arguments.length){case 1:h.call(this);break;case 2:h.call(this,arguments[1]);break;case 3:h.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),h.apply(this,f)}}else{if(m(h)){for(f=Array.prototype.slice.call(arguments,1),j=h.slice(),r=j.length,l=0;r>l;l++){j[l].apply(this,f)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?m(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,m(this._events[f])&&!this._events[f].warned&&(h=i(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(j,g){function h(){this.removeListener(j,h),f||(f=!0,g.apply(this,arguments))}if(!b(g)){throw TypeError("listener must be a function")}var f=!1;return h.listener=g,this.on(j,h),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(m(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],5:[function(a,b,e){(function(o){function x(){r=!0;for(var h,j,g=u.length;g;){for(j=u,u=[],h=-1;++h<g;){j[h]()}g=u.length}r=!1}function f(g){1!==u.push(g)||r||z()}var z,s=o.MutationObserver||o.WebKitMutationObserver;if(s){var n=0,i=new s(x),l=o.document.createTextNode("");i.observe(l,{characterData:!0}),z=function(){l.data=n=++n%2}}else{if(o.setImmediate||"undefined"==typeof o.MessageChannel){z="document" in o&&"onreadystatechange" in o.document.createElement("script")?function(){var g=o.document.createElement("script");g.onreadystatechange=function(){x(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},o.document.documentElement.appendChild(g)}:function(){setTimeout(x,0)}}else{var y=new o.MessageChannel;y.port1.onmessage=x,z=function(){y.port2.postMessage(0)}}}var r,u=[];b.exports=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(a,b,e){"function"==typeof Object.create?b.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],7:[function(a,b,e){(function(f){f("object"==typeof e?e:this)}).call(this,function(j){var l=Array.prototype.slice,f=Array.prototype.forEach,k=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=l.call(arguments,1);return f.call(g,function(i){if(i){for(var n in i){"object"==typeof i[n]&&h[n]?k.call(h,h[n],i[n]):h[n]=i[n]}}}),h};j.extend=k})},{}],8:[function(l,u,t){function i(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=m,this.queue=[],this.outcome=void 0,g!==i&&y(this,g)}function b(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function h(j,k,g){s(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function a(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(j,q){function w(A){x||(x=!0,K.reject(j,A))}function k(A){x||(x=!0,K.resolve(j,A))}function g(){q(k,w)}var x=!1,z=f(g);"error"===z.status&&w(z.value)}function f(j,q){var g={};try{g.value=j(q),g.status="success"}catch(k){g.status="error",g.value=k}return g}function n(g){return g instanceof this?g:K.resolve(new this(i),g)}function r(g){var j=new this(i);return K.reject(j,g)}function p(g){function q(E,D){function C(F){x[D]=F,++B!==A||j||(j=!0,K.resolve(z,x))}k.resolve(E).then(C,function(F){j||(j=!0,K.reject(z,F))})}var k=this;if("[object Array]"!==Object.prototype.toString.call(g)){return this.reject(new TypeError("must be an array"))}var A=g.length,j=!1;if(!A){return this.resolve([])}for(var x=new Array(A),B=0,w=-1,z=new this(i);++w<A;){q(g[w],w)}return z}function o(j){function q(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(k,B))},function(B){x||(x=!0,K.reject(k,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(j)){return this.reject(new TypeError("must be an array"))}var g=j.length,x=!1;if(!g){return this.resolve([])}for(var z=-1,k=new this(i);++z<g;){q(j[z])}return k}var s=l(5),K={},L=["REJECTED"],e=["FULFILLED"],m=["PENDING"];u.exports=t=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(k,q){if("function"!=typeof k&&this.state===e||"function"!=typeof q&&this.state===L){return this}var g=new this.constructor(i);if(this.state!==m){var j=this.state===e?k:q;h(g,j,this.outcome)}else{this.queue.push(new b(g,k,q))}return g},b.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},b.prototype.otherCallFulfilled=function(g){h(this.promise,this.onFulfilled,g)},b.prototype.callRejected=function(g){K.reject(this.promise,g)},b.prototype.otherCallRejected=function(g){h(this.promise,this.onRejected,g)},K.resolve=function(k,w){var g=f(a,w);if("error"===g.status){return K.reject(k,g.value)}var q=g.value;if(q){y(k,q)}else{k.state=e,k.outcome=w;for(var j=-1,x=k.queue.length;++j<x;){k.queue[j].callFulfilled(w)}}return k},K.reject=function(j,q){j.state=L,j.outcome=q;for(var g=-1,k=j.queue.length;++g<k;){j.queue[g].callRejected(q)}return j},t.resolve=n,t.reject=r,t.all=p,t.race=o},{5:5}],9:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],10:[function(o,r,b){function s(q){if(null!==q){switch(typeof q){case"boolean":return q?1:0;case"number":return i(q);case"string":return q.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var g=Array.isArray(q),m=g?q:Object.keys(q),v=-1,j=m.length,w="";if(g){for(;++v<j;){w+=b.toIndexableString(m[v])}}else{for(;++v<j;){var k=m[v];w+=b.toIndexableString(k)+b.toIndexableString(q[k])}}return w}}return""}function h(k,y){var q,w=y,v="1"===k[y];if(v){q=0,y++}else{var m="0"===k[y];y++;var g="",x=k.substring(y,y+a),z=parseInt(x,10)+e;for(m&&(z=-z),y+=a;;){var j=k[y];if("\x00"===j){break}g+=j,y++}g=g.split("."),q=1===g.length?parseInt(g,10):parseFloat(g[0]+"."+g[1]),m&&(q-=10),0!==z&&(q=parseFloat(q+"e"+z))}return{num:q,length:y-w}}function l(m,v){var g=m.pop();if(v.length){var w=v[v.length-1];g===w.element&&(v.pop(),w=v[v.length-1]);var j=w.element,q=w.index;if(Array.isArray(j)){j.push(g)}else{if(q===m.length-2){var k=m.pop();j[k]=g}else{m.push(g)}}}}function n(q,j){for(var g=Math.min(q.length,j.length),m=0;g>m;m++){var k=b.collate(q[m],j[m]);if(0!==k){return k}}return q.length===j.length?0:q.length>j.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(q,g){for(var m=Object.keys(q),v=Object.keys(g),j=Math.min(m.length,v.length),w=0;j>w;w++){var k=b.collate(m[w],v[w]);if(0!==k){return k}if(k=b.collate(q[m[w]],g[v[w]]),0!==k){return k}}return m.length===v.length?0:m.length>v.length?1:-1}function D(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function i(w){if(0===w){return"1"}var m=w.toExponential().split(/e\+?/),y=parseInt(m[1],10),j=0>w,g=j?"0":"2",x=(j?-y:y)-e,v=p.padLeft(x.toString(),"0",a);g+=u+v;var k=Math.abs(parseFloat(m[0]));j&&(k=10-k);var q=k.toFixed(20);return q=q.replace(/\.?0+$/,""),g+=u+q}var e=-324,a=3,u="",p=o(11);b.collate=function(j,m){if(j===m){return 0}j=b.normalizeKey(j),m=b.normalizeKey(m);var k=D(j),g=D(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?n(j,m):f(j,m)},b.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var q=0;j>q;q++){g[q]=b.normalizeKey(k[q])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var v in k){if(k.hasOwnProperty(v)){var m=k[v];"undefined"!=typeof m&&(g[v]=b.normalizeKey(m))}}}}}return g},b.toIndexableString=function(g){var j="\x00";return g=b.normalizeKey(g),D(g)+u+s(g)+j},b.parseIndexableString=function(k){for(var y=[],v=[],w=0;;){var g=k[w++];if("\x00"!==g){switch(g){case"1":y.push(null);break;case"2":y.push("1"===k[w]),w++;break;case"3":var x=h(k,w);y.push(x.num),w+=x.length;break;case"4":for(var z="";;){var j=k[w];if("\x00"===j){break}z+=j,w++}z=z.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),y.push(z);break;case"5":var m={element:[],index:y.length};y.push(m.element),v.push(m);break;case"6":var q={element:{},index:y.length};y.push(q.element),v.push(q);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+g)}}else{if(1===y.length){return y.pop()}l(y,v)}}}},{11:11}],11:[function(b,h,a){function e(g,m,n){for(var l="",f=n-g.length;l.length<f;){l+=m}return l}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var o,f=n.length,g=r.length;for(o=0;f>o;o++){if(o===g){return 1}var q=n.charAt(o),i=r.charAt(o);if(q!==i){return i>q?-1:1}}return g>f?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],12:[function(b,i,j){function e(){this.store={}}function a(g){if(this.store=new e,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}j.Map=e,j.Set=a,e.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},e.prototype.unmangle=function(f){return f.substring(1)},e.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},e.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},e.prototype.has=function(f){var g=this.mangle(f);return g in this.store},e.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},e.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},a.prototype.add=function(f){return this.store.set(f,!0)},a.prototype.has=function(f){return this.store.has(f)},a.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],13:[function(b,s,l){function o(){e=!1,r.length?a=r.concat(a):i=-1,a.length&&n()}function n(){if(!e){var g=setTimeout(o);e=!0;for(var h=a.length;h;){for(r=a,a=[];++i<h;){r&&r[i].run()}i=-1,h=a.length}r=null,e=!1,clearTimeout(g)}}function f(g,h){this.fun=g,this.array=h}function u(){}var r,t=s.exports={},a=[],e=!1,i=-1;t.nextTick=function(h){var j=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){j[g-1]=arguments[g]}}a.push(new f(h,j)),1!==a.length||e||setTimeout(n,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=u,t.addListener=u,t.once=u,t.off=u,t.removeListener=u,t.removeAllListeners=u,t.emit=u,t.binding=function(g){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(g){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],14:[function(a,b,e){(function(){var h={}.hasOwnProperty,f=[].slice;b.exports=function(q,g){var n,o,p,r;o=[],r=[];for(n in g){h.call(g,n)&&(p=g[n],"this"!==n&&(o.push(n),r.push(p)))}return Function.apply(null,f.call(o).concat([q])).apply(g["this"],r)}}).call(this)},{}],15:[function(b,f,a){!function(i){if("object"==typeof a){f.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(t){function s(j,w,z,k,q,x){return w=i(i(w,j),i(k,x)),i(w<<q|w>>>32-q,z)}function O(j,w,k,q,A,z,x){return s(w&k|~w&q,j,w,A,z,x)}function p(j,w,k,q,A,z,x){return s(w&q|k&~q,j,w,A,z,x)}function P(j,w,k,q,A,z,x){return s(w^k^q,j,w,A,z,x)}function u(j,w,k,q,A,z,x){return s(k^(w|~q),j,w,A,z,x)}function g(j,w){var z=j[0],k=j[1],x=j[2],q=j[3];z=O(z,k,x,q,w[0],7,-680876936),q=O(q,z,k,x,w[1],12,-389564586),x=O(x,q,z,k,w[2],17,606105819),k=O(k,x,q,z,w[3],22,-1044525330),z=O(z,k,x,q,w[4],7,-176418897),q=O(q,z,k,x,w[5],12,1200080426),x=O(x,q,z,k,w[6],17,-1473231341),k=O(k,x,q,z,w[7],22,-45705983),z=O(z,k,x,q,w[8],7,1770035416),q=O(q,z,k,x,w[9],12,-1958414417),x=O(x,q,z,k,w[10],17,-42063),k=O(k,x,q,z,w[11],22,-1990404162),z=O(z,k,x,q,w[12],7,1804603682),q=O(q,z,k,x,w[13],12,-40341101),x=O(x,q,z,k,w[14],17,-1502002290),k=O(k,x,q,z,w[15],22,1236535329),z=p(z,k,x,q,w[1],5,-165796510),q=p(q,z,k,x,w[6],9,-1069501632),x=p(x,q,z,k,w[11],14,643717713),k=p(k,x,q,z,w[0],20,-373897302),z=p(z,k,x,q,w[5],5,-701558691),q=p(q,z,k,x,w[10],9,38016083),x=p(x,q,z,k,w[15],14,-660478335),k=p(k,x,q,z,w[4],20,-405537848),z=p(z,k,x,q,w[9],5,568446438),q=p(q,z,k,x,w[14],9,-1019803690),x=p(x,q,z,k,w[3],14,-187363961),k=p(k,x,q,z,w[8],20,1163531501),z=p(z,k,x,q,w[13],5,-1444681467),q=p(q,z,k,x,w[2],9,-51403784),x=p(x,q,z,k,w[7],14,1735328473),k=p(k,x,q,z,w[12],20,-1926607734),z=P(z,k,x,q,w[5],4,-378558),q=P(q,z,k,x,w[8],11,-2022574463),x=P(x,q,z,k,w[11],16,1839030562),k=P(k,x,q,z,w[14],23,-35309556),z=P(z,k,x,q,w[1],4,-1530992060),q=P(q,z,k,x,w[4],11,1272893353),x=P(x,q,z,k,w[7],16,-155497632),k=P(k,x,q,z,w[10],23,-1094730640),z=P(z,k,x,q,w[13],4,681279174),q=P(q,z,k,x,w[0],11,-358537222),x=P(x,q,z,k,w[3],16,-722521979),k=P(k,x,q,z,w[6],23,76029189),z=P(z,k,x,q,w[9],4,-640364487),q=P(q,z,k,x,w[12],11,-421815835),x=P(x,q,z,k,w[15],16,530742520),k=P(k,x,q,z,w[2],23,-995338651),z=u(z,k,x,q,w[0],6,-198630844),q=u(q,z,k,x,w[7],10,1126891415),x=u(x,q,z,k,w[14],15,-1416354905),k=u(k,x,q,z,w[5],21,-57434055),z=u(z,k,x,q,w[12],6,1700485571),q=u(q,z,k,x,w[3],10,-1894986606),x=u(x,q,z,k,w[10],15,-1051523),k=u(k,x,q,z,w[1],21,-2054922799),z=u(z,k,x,q,w[8],6,1873313359),q=u(q,z,k,x,w[15],10,-30611744),x=u(x,q,z,k,w[6],15,-1560198380),k=u(k,x,q,z,w[13],21,1309151649),z=u(z,k,x,q,w[4],6,-145523070),q=u(q,z,k,x,w[11],10,-1120210379),x=u(x,q,z,k,w[2],15,718787259),k=u(k,x,q,z,w[9],21,-343485551),j[0]=i(z,j[0]),j[1]=i(k,j[1]),j[2]=i(x,j[2]),j[3]=i(q,j[3])}function y(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j.charCodeAt(k)+(j.charCodeAt(k+1)<<8)+(j.charCodeAt(k+2)<<16)+(j.charCodeAt(k+3)<<24)}return q}function Q(j){var k,q=[];for(k=0;64>k;k+=4){q[k>>2]=j[k]+(j[k+1]<<8)+(j[k+2]<<16)+(j[k+3]<<24)}return q}function r(C){var x,q,z,w,k,A,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;B>=x;x+=64){g(j,y(C.substring(x-64,x)))}for(C=C.substring(x-64),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;q>x;x+=1){z[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(z[x>>2]|=128<<(x%4<<3),x>55){for(g(j,z),x=0;16>x;x+=1){z[x]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),A=parseInt(w[1],16)||0,z[14]=k,z[15]=A,g(j,z),j}function o(C){var A,q,z,w,k,x,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(A=64;B>=A;A+=64){g(j,Q(C.subarray(A-64,A)))}for(C=B>A-64?C.subarray(A-64):new Uint8Array(0),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=0;q>A;A+=1){z[A>>2]|=C[A]<<(A%4<<3)}if(z[A>>2]|=128<<(A%4<<3),A>55){for(g(j,z),A=0;16>A;A+=1){z[A]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,z[14]=k,z[15]=x,g(j,z),j}function v(j){var k,q="";for(k=0;4>k;k+=1){q+=h[j>>8*k+4&15]+h[j>>8*k&15]}return q}function n(j){var k;for(k=0;k<j.length;k+=1){j[k]=v(j[k])}return j.join("")}function l(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(j,w){var z,k=j.length,q=new ArrayBuffer(k),x=new Uint8Array(q);for(z=0;k>z;z+=1){x[z]=j.charCodeAt(z)}return w?x:q}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(j,w,q){var k=new Uint8Array(j.byteLength+w.byteLength);return k.set(new Uint8Array(j)),k.set(new Uint8Array(w),j.byteLength),q?k:k.buffer}function e(j){var w,q=[],k=j.length;for(w=0;k-1>w;w+=2){q.push(parseInt(j.substr(w,2),16))}return String.fromCharCode.apply(String,q)}function m(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==n(r("hello"))&&(i=function(j,w){var q=(65535&j)+(65535&w),k=(j>>16)+(w>>16)+(q>>16);return k<<16|65535&q}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(k,q){var A,x,D,B,C=this.byteLength,w=j(k,C),z=C;return q!==t&&(z=j(q,C)),w>z?new ArrayBuffer(0):(A=z-w,x=new ArrayBuffer(A),D=new Uint8Array(x),B=new Uint8Array(this,w,A),D.set(B),x)}}(),m.prototype.append=function(j){return this.appendBinary(l(j)),this},m.prototype.appendBinary=function(j){this._buff+=j,this._length+=j.length;var k,q=this._buff.length;for(k=64;q>=k;k+=64){g(this._hash,y(this._buff.substring(k-64,k)))}return this._buff=this._buff.substring(k-64),this},m.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k.charCodeAt(w)<<(w%4<<3)}return this._finish(x,q),z=n(this._hash),j&&(z=e(z)),this.reset(),z},m.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},m.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},m.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},m.prototype._finish=function(j,w){var z,k,q,x=w;if(j[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,j),x=0;16>x;x+=1){j[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(z[2],16),q=parseInt(z[1],16)||0,j[14]=k,j[15]=q,g(this._hash,j)},m.hash=function(j,k){return m.hashBinary(l(j),k)},m.hashBinary=function(j,w){var q=r(j),k=n(q);return w?e(k):k},m.ArrayBuffer=function(){this.reset()},m.ArrayBuffer.prototype.append=function(j){var w,q=T(this._buff.buffer,j,!0),k=q.length;for(this._length+=j.byteLength,w=64;k>=w;w+=64){g(this._hash,Q(q.subarray(w-64,w)))}return this._buff=k>w-64?new Uint8Array(q.buffer.slice(w-64)):new Uint8Array(0),this},m.ArrayBuffer.prototype.end=function(j){var w,z,k=this._buff,q=k.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;q>w;w+=1){x[w>>2]|=k[w]<<(w%4<<3)}return this._finish(x,q),z=n(this._hash),j&&(z=e(z)),this.reset(),z},m.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.ArrayBuffer.prototype.getState=function(){var j=m.prototype.getState.call(this);return j.buff=S(j.buff),j},m.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),m.prototype.setState.call(this,j)},m.ArrayBuffer.prototype.destroy=m.prototype.destroy,m.ArrayBuffer.prototype._finish=m.prototype._finish,m.ArrayBuffer.hash=function(j,w){var q=o(new Uint8Array(j)),k=n(q);return w?e(k):k},m})},{}],16:[function(b,h,a){function e(n,r,o){var f=o[o.length-1];n===f.element&&(o.pop(),f=o[o.length-1]);var g=f.element,q=f.index;if(Array.isArray(g)){g.push(n)}else{if(q===r.length-2){var i=r.pop();g[i]=n}else{r.push(n)}}}a.stringify=function(i){var g=[];g.push({obj:i});for(var D,F,u,n,E,f,s,t,l,o,r,C="";D=g.pop();){if(F=D.obj,u=D.prefix||"",n=D.val||"",C+=u,n){C+=n}else{if("object"!=typeof F){C+="undefined"==typeof F?null:JSON.stringify(F)}else{if(null===F){C+="null"}else{if(Array.isArray(F)){for(g.push({val:"]"}),E=F.length-1;E>=0;E--){f=0===E?"":",",g.push({obj:F[E],prefix:f})}g.push({val:"["})}else{s=[];for(t in F){F.hasOwnProperty(t)&&s.push(t)}for(g.push({val:"}"}),E=s.length-1;E>=0;E--){l=s[E],o=F[l],r=E>0?",":"",r+=JSON.stringify(l)+":",g.push({obj:o,prefix:r})}g.push({val:"{"})}}}}}return C},a.parse=function(f){for(var o,s,l,D,t,n,A,u,g,i=[],B=[],C=0;;){if(o=f[C++],"}"!==o&&"]"!==o&&"undefined"!=typeof o){switch(o){case" ":case"	":case"\n":case":":case",":break;case"n":C+=3,e(null,i,B);break;case"t":C+=3,e(!0,i,B);break;case"f":C+=4,e(!1,i,B);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(s="",C--;;){if(l=f[C++],!/[\d\.\-e\+]/.test(l)){C--;break}s+=l}e(parseFloat(s),i,B);break;case'"':for(D="",t=void 0,n=0;;){if(A=f[C++],'"'===A&&("\\"!==t||n%2!==1)){break}D+=A,t=A,"\\"===t?n++:n=0}e(JSON.parse('"'+D+'"'),i,B);break;case"[":u={element:[],index:i.length},i.push(u.element),B.push(u);break;case"{":g={element:{},index:i.length},i.push(g.element),B.push(g);break;default:throw new Error("unexpectedly reached end of input: "+o)}}else{if(1===i.length){return i.pop()}e(i.pop(),i,B)}}}},{}],17:[function(a,b,e){(function(p,jd){function h1(ad,aa){ad=ad||[],aa=aa||{};try{return new Blob(ad,aa)}catch(ab){if("TypeError"!==ab.name){throw ab}for(var t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ac=new t,af=0;af<ad.length;af+=1){ac.append(ad[af])}return ac.getBlob(aa.type)}}function hz(ab,t){if("undefined"==typeof FileReader){return t((new FileReaderSync).readAsArrayBuffer(ab))}var aa=new FileReader;aa.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);t(ac)},aa.readAsArrayBuffer(ab)}function hr(){for(var aa={},ac=new at(function(af,ad){aa.resolve=af,aa.reject=ad}),t=new Array(arguments.length),ab=0;ab<t.length;ab++){t[ab]=arguments[ab]}return aa.promise=ac,at.resolve().then(function(){return fetch.apply(null,t)}).then(function(ad){aa.resolve(ad)})["catch"](function(ad){aa.reject(ad)}),aa}function hK(ad,af){var ab,t,ac,aa=new Headers,ag={method:ad.method,credentials:"include",headers:aa};return ad.json&&(aa.set("Accept","application/json"),aa.set("Content-Type",ad.headers["Content-Type"]||"application/json")),ad.body&&ad.body instanceof Blob?hz(ad.body,function(ah){ag.body=ah}):ad.body&&ad.processData&&"string"!=typeof ad.body?ag.body=JSON.stringify(ad.body):"body" in ad?ag.body=ad.body:ag.body=null,Object.keys(ad.headers).forEach(function(ah){ad.headers.hasOwnProperty(ah)&&aa.set(ah,ad.headers[ah])}),ab=hr(ad.url,ag),ad.timeout>0&&(t=setTimeout(function(){ab.reject(new Error("Load timeout for resource: "+ad.url))},ad.timeout)),ab.promise.then(function(ah){return ac={statusCode:ah.status},ad.timeout>0&&clearTimeout(t),ac.statusCode>=200&&ac.statusCode<300?ad.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ac.statusCode>=200&&ac.statusCode<300?af(null,ac,ah):af(ah,ac)})["catch"](function(ah){af(ah,ac)}),{abort:ab.reject}}function gD(ac,aa){var ab,ad,ag=function(){ab.abort()};ab=ac.xhr?new ac.xhr:new XMLHttpRequest;try{ab.open(ac.method,ac.url)}catch(t){aa(t,{statusCode:413})}ab.withCredentials="withCredentials" in ac?ac.withCredentials:!0,"GET"===ac.method?delete ac.headers["Content-Type"]:ac.json&&(ac.headers.Accept="application/json",ac.headers["Content-Type"]=ac.headers["Content-Type"]||"application/json",ac.body&&ac.processData&&"string"!=typeof ac.body&&(ac.body=JSON.stringify(ac.body))),ac.binary&&(ab.responseType="arraybuffer"),"body" in ac||(ac.body=null);for(var af in ac.headers){ac.headers.hasOwnProperty(af)&&ab.setRequestHeader(af,ac.headers[af])}return ac.timeout>0&&(ad=setTimeout(ag,ac.timeout),ab.onprogress=function(){clearTimeout(ad),ad=setTimeout(ag,ac.timeout)},"undefined"!=typeof ab.upload&&(ab.upload.onprogress=ab.onprogress)),ab.onreadystatechange=function(){if(4===ab.readyState){var ah={statusCode:ab.status};if(ab.status>=200&&ab.status<300){var ak;ak=ac.binary?h1([ab.response||""],{type:ab.getResponseHeader("Content-Type")}):ab.responseText,aa(null,ah,ak)}else{var al={};try{al=JSON.parse(ab.response)}catch(aj){}aa(al,ah)}}},ac.body&&ac.body instanceof Blob?hz(ac.body,function(ah){ab.send(ah)}):ab.send(ac.body),{abort:ag}}function bn(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function fm(t,aa){return iE||t.xhr?gD(t,aa):hK(t,aa)}function iy(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function gA(aa,ac,t){function ab(af){for(var ad in aa){"function"!=typeof aa[ad]&&(this[ad]=aa[ad])}void 0!==t&&(this.name=t),void 0!==af&&(this.reason=af)}return ab.prototype=iy.prototype,new ab(ac)}function f6(ad){var aa,ab,t,ac,af;return ab=ad.error===!0&&"string"==typeof ad.name?ad.name:ad.error,af=ad.reason,t=hQ("name",ab,af),ad.missing||"missing"===af||"deleted"===af||"not_found"===ab?t=iF:"doc_validation"===ab?(t=jk,ac=af):"bad_request"===ab&&t.message!==af&&(t=bo),t||(t=hQ("status",ad.status,af)||hm),aa=gA(t,af,ab),ac&&(aa.message=ac),ad.id&&(aa.id=ad.id),ad.status&&(aa.status=ad.status),ad.missing&&(aa.missing=ad.missing),aa}function Y(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function iv(aa){if("function"==typeof aa.slice){return aa.slice(0)}var ac=new ArrayBuffer(aa.byteLength),t=new Uint8Array(ac),ab=new Uint8Array(aa);return t.set(ab),ac}function h7(ab){if(ab instanceof ArrayBuffer){return iv(ab)}var t=ab.size,aa=ab.type;return"function"==typeof ab.slice?ab.slice(0,t,aa):ab.webkitSlice(0,t,aa)}function gu(ad){var aa,ab,t;if(!ad||"object"!=typeof ad){return ad}if(Array.isArray(ad)){for(aa=[],ab=0,t=ad.length;t>ab;ab++){aa[ab]=gu(ad[ab])}return aa}if(ad instanceof Date){return ad.toISOString()}if(Y(ad)){return h7(ad)}aa={};for(ab in ad){if(Object.prototype.hasOwnProperty.call(ad,ab)){var ac=gu(ad[ab]);"undefined"!=typeof ac&&(aa[ab]=ac)}}return aa}function ce(){return""}function f0(ad,aa){function ab(ag,ah,af){if(!ad.binary&&ad.json&&"string"==typeof ag){try{ag=JSON.parse(ag)}catch(aj){return af(aj)}}Array.isArray(ag)&&(ag=ag.map(function(ak){return ak.error||ak.missing?f6(ak):ak})),ad.binary&&i4(ag,ah),af(null,ag,ah)}function t(ah,ak){var af,aj;if(ah.code&&ah.status){var ag=new Error(ah.message||ah.code);return ag.status=ah.status,ak(ag)}try{af=JSON.parse(ah.responseText),aj=f6(af)}catch(al){aj=f6(ah)}ak(aj)}ad=gu(ad);var ac={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ad=hy.extend(ac,ad),ad.json&&(ad.binary||(ad.headers.Accept="application/json"),ad.headers["Content-Type"]=ad.headers["Content-Type"]||"application/json"),ad.binary&&(ad.encoding=null,ad.json=!1),ad.processData||(ad.json=!1),fm(ad,function(ah,al,af){if(ah){return ah.status=al?al.statusCode:400,t(ah,aa)}var ak,am=al.headers&&al.headers["content-type"],ag=af||ce();if(!ad.binary&&(ad.json||!ad.processData)&&"object"!=typeof ag&&(/json/.test(am)||/^[\s]*\{/.test(ag)&&/\}[\s]*$/.test(ag))){try{ag=JSON.parse(ag.toString())}catch(aj){}}al.statusCode>=200&&al.statusCode<300?ab(ag,al,aa):(ak=f6(ag),ak.status=al.statusCode,aa(ak))})}function ew(t,ac){var ag=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",aa=-1!==ag.indexOf("safari")&&-1===ag.indexOf("chrome"),ah=-1!==ag.indexOf("msie"),ad=aa&&"POST"===t.method||ah&&"GET"===t.method,af="cache" in t?t.cache:!0;if(ad||!af){var ab=-1!==t.url.indexOf("?");t.url+=(ab?"&":"?")+"_nonce="+Date.now()}return f0(t,ac)}function N(t){var aa=!1;return w(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function ex(t){return w(function(ac){ac=gu(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){p.nextTick(function(){ad(ah,ag)})});var af=new at(function(aj,ak){var ag;try{var ah=N(function(ap,am){ap?ak(ap):aj(am)});ac.push(ah),ag=t.apply(aa,ac),ag&&"function"==typeof ag.then&&aj(ag)}catch(al){ak(al)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function gp(ab,t){function aa(ah,ac,af){if(T.enabled){for(var aj=[ah._db_name,ac],ag=0;ag<af.length-1;ag++){aj.push(af[ag])}T.apply(null,aj);var ad=af[af.length-1];af[af.length-1]=function(ak,am){var al=[ah._db_name,ac];al=al.concat(ak?["error",ak]:["success",am]),T.apply(null,al),ad(ak,am)}}}return ex(w(function(ad){if(this._closed){return at.reject(new Error("database is closed"))}var ac=this;return aa(ac,ab,ad),this.taskqueue.isReady?t.apply(this,ad):new at(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[ab].apply(ac,ad))})})}))}function gT(ad,aa){for(var ab={},t=0,ac=aa.length;ac>t;t++){var af=aa[t];af in ad&&(ab[af]=ad[af])}return ab}function ho(ab,t,aa){return new at(function(ad,ac){ab.get(t,function(aj,ag){if(aj){if(404!==aj.status){return ac(aj)}ag={}}var ah=ag._rev,af=aa(ag);return af?(af._id=t,af._rev=ah,void ad(I(ab,af,aa))):ad({updated:!1,rev:ah})})})}function I(ab,t,aa){return ab.put(t).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return ho(ab,t._id,aa)})}function h9(t){for(var ad,aa,ac,ab,am=t.rev_tree.slice();ab=am.pop();){var ag=ab.ids,al=ag[2],af=ab.pos;if(al.length){for(var ah=0,ak=al.length;ak>ah;ah++){am.push({pos:af+1,ids:al[ah]})}}else{var ap=!!ag[1].deleted,aj=ag[0];(!ad||(ac!==ap?ac:aa!==af?af>aa:aj>ad))&&(ad=aj,aa=af,ac=ap)}}return aa+"-"+ad}function iJ(t){return t.ids}function hG(ad,aa){aa||(aa=h9(ad));for(var ab,t=aa.substring(aa.indexOf("-")+1),ac=ad.rev_tree.map(iJ);ab=ac.pop();){if(ab[0]===t){return !!ab[1].deleted}ac=ac.concat(ab[2])}}function hN(t){return iq("return "+t+";",{})}function ee(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function h(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function F(t){var aa=h(t);return aa?aa.join("/"):null}function fz(ac,ak){for(var af,ah=ac.slice();af=ah.pop();){for(var ag=af.pos,ad=af.ids,aa=ad[2],aj=ak(0===aa.length,ag,ad[0],af.ctx,ad[1]),t=0,ab=aa.length;ab>t;t++){ah.push({pos:ag+1,ids:aa[t],ctx:aj})}}}function ht(t,aa){return t.pos-aa.pos}function a0(aa){var ac=[];fz(aa,function(ag,ad,ah,af,aj){ag&&ac.push({rev:ad+"-"+ah,pos:ad,opts:aj})}),ac.sort(ht).reverse();for(var t=0,ab=ac.length;ab>t;t++){delete ac[t].pos}return ac}function L(ac){for(var t=h9(ac),ag=a0(ac.rev_tree),ad=[],ab=0,aa=ag.length;aa>ab;ab++){var af=ag[ab];af.rev===t||af.opts.deleted||ad.push(af.rev)}return ad}function A(ac,t,ag){function ad(){ab.cancel()}ie.EventEmitter.call(this);var ab=this;this.db=ac,t=t?gu(t):{};var aa=t.complete=N(function(ah,aj){ah?ab.emit("error",ah):ab.emit("complete",aj),ab.removeAllListeners(),ac.removeListener("destroyed",ad)});ag&&(ab.on("complete",function(ah){ag(null,ah)}),ab.on("error",ag)),ac.once("destroyed",ad),t.onChange=function(ah){t.isCancelled||(ab.emit("change",ah),ab.startSeq&&ab.startSeq<=ah.seq&&(ab.startSeq=!1))};var af=new at(function(ah,aj){t.complete=function(al,ak){al?aj(al):ah(ak)}});ab.once("cancel",function(){ac.removeListener("destroyed",ad),t.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){aa(null,ah)},aa),ac.taskqueue.isReady?ab.doChanges(t):ac.taskqueue.addTask(function(){ab.isCancelled?ab.emit("cancel"):ab.doChanges(t)})}function gl(ad,aa,ab){var t=[{rev:ad._rev}];"all_docs"===ab.style&&(t=a0(aa.rev_tree).map(function(af){return{rev:af.rev}}));var ac={id:aa.id,changes:t,doc:ad};return hG(aa,ad._rev)&&(ac.deleted=!0),ab.conflicts&&(ac.doc._conflicts=L(aa),ac.doc._conflicts.length||delete ac.doc._conflicts),ac}function iQ(af,al,ag){function aj(){var am=[];t.forEach(function(ap){ap.docs.forEach(function(aq){am.push({id:ap.id,docs:[aq]})})}),ag(null,{results:am})}function ak(){++ac===ab&&aj()}function ah(aq,am,ap){t[aq]={id:am,docs:ap},ak()}var ad=Array.isArray(al)?al:al.docs,aa={};ad.forEach(function(am){am.id in aa?aa[am.id].push(am):aa[am.id]=[am]});var ab=Object.keys(aa).length,ac=0,t=new Array(ab);Object.keys(aa).forEach(function(ap,am){var av=aa[ap],aq=gT(av[0],["atts_since","attachments"]);aq.open_revs=av.map(function(aw){return aw.rev}),aq.open_revs=aq.open_revs.filter(function(aw){return aw});var au=function(aw){return aw};0===aq.open_revs.length&&(delete aq.open_revs,au=function(aw){return[{ok:aw}]}),["revs","attachments","binary"].forEach(function(aw){aw in al&&(aq[aw]=al[aw])}),af.get(ap,aq,function(aw,ax){ah(am,ap,aw?[{error:aw}]:au(ax))})})}function hs(t){return/^_local/.test(t)}function E(t){for(var ad,aa=[],ac=t.slice();ad=ac.pop();){var ab=ad.pos,am=ad.ids,ag=am[0],al=am[1],af=am[2],ah=0===af.length,ak=ad.history?ad.history.slice():[];ak.push({id:ag,opts:al}),ah&&aa.push({pos:ab+1-ak.length,ids:ak});for(var ap=0,aj=af.length;aj>ap;ap++){ac.push({pos:ab+1,ids:af[ap],history:ak})}}return aa.reverse()}function hw(t){return 0|Math.random()*t}function P(aa,ac){ac=ac||iH.length;var t="",ab=-1;if(aa){for(;++ab<aa;){t+=iH[hw(ac)]}return t}for(;++ab<36;){switch(ab){case 8:case 13:case 18:case 23:t+="-";break;case 19:t+=iH[3&hw(16)|8];break;default:t+=iH[hw(16)]}}return t}function Q(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function C(t){var aa;if(t?"string"!=typeof t?aa=gA(hW):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=gA(fx)):aa=gA(jh),aa){throw aa}}function hi(aa){if(!/^\d+\-./.test(aa)){return gA(g7)}var ac=aa.indexOf("-"),t=aa.substring(0,ac),ab=aa.substring(ac+1);return{prefix:parseInt(t,10),id:ab}}function H(ac,t){for(var ag=ac.start-ac.ids.length+1,ad=ac.ids,ab=[ad[0],t,[]],aa=1,af=ad.length;af>aa;aa++){ab=[ad[aa],{status:"missing"},[ab]]}return[{pos:ag,ids:ab}]}function fi(ac,ak){var af,ah,ag,ad={status:"available"};if(ac._deleted&&(ad.deleted=!0),ak){if(ac._id||(ac._id=P()),ah=P(32,16).toLowerCase(),ac._rev){if(ag=hi(ac._rev),ag.error){return ag}ac._rev_tree=[{pos:ag.prefix,ids:[ag.id,{status:"missing"},[[ah,ad,[]]]]}],af=ag.prefix+1}else{ac._rev_tree=[{pos:1,ids:[ah,ad,[]]}],af=1}}else{if(ac._revisions&&(ac._rev_tree=H(ac._revisions,ad),af=ac._revisions.start,ah=ac._revisions.ids[0]),!ac._rev_tree){if(ag=hi(ac._rev),ag.error){return ag}af=ag.prefix,ah=ag.id,ac._rev_tree=[{pos:af,ids:[ah,ad,[]]}]}}C(ac._id),ac._rev=af+"-"+ah;var aa={metadata:{},data:{}};for(var aj in ac){if(Object.prototype.hasOwnProperty.call(ac,aj)){var t="_"===aj[0];if(t&&!ja[aj]){var ab=gA(jk,aj);throw ab.message=jk.message+": "+aj,ab}t&&!hT[aj]?aa.metadata[aj.slice(1)]=ac[aj]:aa.data[aj]=ac[aj]}}return aa}function fe(t,aa){return aa>t?-1:t>aa?1:0}function hB(ab,t){for(var aa=0;aa<ab.length;aa++){if(t(ab[aa],aa)===!0){return ab[aa]}}}function i0(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function r(ad){for(var aa=0;aa<ad.length;aa++){var ab=ad[aa];if(ab._deleted){delete ab._attachments}else{if(ab._attachments){for(var t=Object.keys(ab._attachments),ac=0;ac<t.length;ac++){var af=t[ac];ab._attachments[af]=gT(ab._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function gG(ad,aa){var ab=fe(ad._id,aa._id);if(0!==ab){return ab}var t=ad._revisions?ad._revisions.start:0,ac=aa._revisions?aa._revisions.start:0;return fe(t,ac)}function eo(ab){var t={},aa=[];return fz(ab,function(af,ag,ad,ah){var ac=ag+"-"+ad;return af&&(t[ac]=0),void 0!==ah&&aa.push({from:ah,to:ac}),ac}),aa.reverse(),aa.forEach(function(ac){void 0===t[ac.from]?t[ac.from]=1+t[ac.to]:t[ac.from]=Math.min(t[ac.from],1+t[ac.to])}),t}function iw(ad,aa,ab){var t="limit" in aa?aa.keys.slice(aa.skip,aa.limit+aa.skip):aa.skip>0?aa.keys.slice(aa.skip):aa.keys;if(aa.descending&&t.reverse(),!t.length){return ad._allDocs({limit:0},ab)}var ac={offset:aa.skip};return at.all(t.map(function(af){var ag=hy.extend({key:af,deleted:"ok"},aa);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new at(function(ah,aj){ad._allDocs(ag,function(ak,al){return ak?aj(ak):(ac.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ac.rows=af,ac})}function hA(aa){var ac=aa._compactionQueue[0],ab=ac.opts,t=ac.callback;aa.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ab.last_seq=ad.last_seq),aa._compact(ab,function(ag,af){ag?t(ag):t(null,af),p.nextTick(function(){aa._compactionQueue.shift(),aa._compactionQueue.length&&hA(aa)})})})}function ez(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function i9(){ie.EventEmitter.call(this)}function V(){this.isReady=!1,this.failed=!1,this.queue=[]}function hY(t){t&&jd.debug&&console.error(t)}function hx(ac,t){function ag(){aa.emit("destroyed",ab),aa.emit(ab,"destroyed")}function ad(){ac.removeListener("destroyed",ag),ac.emit("destroyed",ac)}var ab=t.originalName,aa=ac.constructor,af=aa._destructionListeners;ac.once("destroyed",ag),af.has(ab)||af.set(ab,[]),af.get(ab).push(ad)}function ig(ad,aa,ab){if(!(this instanceof ig)){return new ig(ad,aa,ab)}var t=this;("function"==typeof aa||"undefined"==typeof aa)&&(ab=aa,aa={}),ad&&"object"==typeof ad&&(aa=ad,ad=void 0),"undefined"==typeof ab&&(ab=hY),ad=ad||aa.name,aa=gu(aa),delete aa.name,this.__opts=aa;var ac=ab;t.auto_compaction=aa.auto_compaction,t.prefix=ig.prefix,i9.call(t),t.taskqueue=new V;var af=new at(function(aj,al){ab=function(ap,am){return ap?al(ap):(delete am.then,void aj(am))},aa=gu(aa);var ah,ak,ag=aa.name||ad;return function(){try{if("string"!=typeof ag){throw ak=new Error("Missing/invalid DB name"),ak.code=400,ak}if(ah=ig.parseAdapter(ag,aa),aa.originalName=ag,aa.name=ah.name,aa.prefix&&"http"!==ah.adapter&&"https"!==ah.adapter&&(aa.name=aa.prefix+aa.name),aa.adapter=aa.adapter||ah.adapter,t._adapter=aa.adapter,gn("pouchdb:adapter")("Picked adapter: "+aa.adapter),t._db_name=ag,!ig.adapters[aa.adapter]){throw ak=new Error("Adapter is missing"),ak.code=404,ak}if(!ig.adapters[aa.adapter].valid()){throw ak=new Error("Invalid Adapter"),ak.code=404,ak}}catch(am){t.taskqueue.fail(am)}}(),ak?al(ak):(t.adapter=aa.adapter,t.replicate={},t.replicate.from=function(aq,am,ap){return t.constructor.replicate(aq,t,am,ap)},t.replicate.to=function(aq,am,ap){return t.constructor.replicate(t,aq,am,ap)},t.sync=function(aq,am,ap){return t.constructor.sync(t,aq,am,ap)},t.replicate.sync=t.sync,void ig.adapters[aa.adapter].call(t,aa,function(am){return am?(t.taskqueue.fail(am),void ab(am)):(hx(t,aa),t.emit("created",t),ig.emit("created",aa.originalName),t.taskqueue.ready(t),void ab(null,t))}))});af.then(function(ag){ac(null,ag)},ac),t.then=af.then.bind(af),t["catch"]=af["catch"].bind(af)}function K(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function ic(){return hJ}function g0(t){Object.keys(ie.EventEmitter.prototype).forEach(function(ab){"function"==typeof ie.EventEmitter.prototype[ab]&&(t[ab]=i1[ab].bind(i1))});var aa=t._destructionListeners=new id.Map;t.on("destroyed",function(ab){aa.has(ab)&&(aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab))})}function o(ad){for(var aa=ad.length,ab=new ArrayBuffer(aa),t=new Uint8Array(ab),ac=0;aa>ac;ac++){t[ac]=ad.charCodeAt(ac)}return ab}function hd(t,aa){return h1([o(t)],{type:aa})}function im(ac){for(var t=go.exec(ac),ag={},ad=14;ad--;){var ab=hR[ad],aa=t[ad]||"",af=-1!==["user","password"].indexOf(ab);ag[ab]=af?decodeURIComponent(aa):aa}return ag[fn]={},ag[hR[12]].replace(jc,function(ak,aj,ah){aj&&(ag[fn][aj]=ah)}),ag}function iR(ad,aa,ab){try{return !ad(aa,ab)}catch(t){var ac="Filter function threw: "+t.toString();return gA(bo,ac)}}function S(ab){var t={},aa=ab.filter&&"function"==typeof ab.filter;return t.query=ab.query_params,function(ad){ad.doc||(ad.doc={});var ac=aa&&iR(ab.filter,ad.doc,t);if("object"==typeof ac){return ac}if(ac){return !1}if(ab.include_docs){if(!ab.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function he(t,aa){"console" in jd&&"info" in console&&console.info("The above "+t+" is totally normal. "+aa)}function gk(ad,aa,ab,t,ac){return ad.get(aa)["catch"](function(af){if(404===af.status){return"http"===ad.type()&&he(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:t,_id:aa,history:[],replicator:ib,version:z}}throw af}).then(function(af){return ac.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==t}),af.history.unshift({last_seq:ab,session_id:t}),af.history=af.history.slice(0,h4),af.version=z,af.replicator=ib,af.session_id=t,af.last_seq=ab,ad.put(af)["catch"](function(ag){if(409===ag.status){return gk(ad,aa,ab,t,ac)}throw ag}))})}function B(aa,ac,t,ab){this.src=aa,this.target=ac,this.id=t,this.returnValue=ab}function iT(aa,ac){if(aa.session_id===ac.session_id){return{last_seq:aa.last_seq,history:aa.history||[]}}var t=aa.history||[],ab=ac.history||[];return hM(t,ab)}function hM(t,ac){var ag=t[0],aa=t.slice(1),ah=ac[0],ad=ac.slice(1);if(!ag||0===ac.length){return{last_seq:ft,history:[]}}var af=ag.session_id;if(i6(af,ac)){return{last_seq:ag.last_seq,history:t}}var ab=ah.session_id;return i6(ab,aa)?{last_seq:ah.last_seq,history:ad}:hM(aa,ad)}function i6(aa,ac){var t=ac[0],ab=ac.slice(1);return aa&&0!==ac.length?aa===t.session_id?!0:i6(aa,ab):!1}function J(aa,ac){aa=parseInt(aa,10)||0,ac=parseInt(ac,10),ac!==ac||aa>=ac?ac=(aa||1)<<1:ac+=1;var t=Math.random(),ab=ac-aa;return ~~(ab*t+aa)}function iM(t){var aa=0;return t||(aa=2000),J(t,aa)}function gZ(aa,ac,t,ab){return aa.retry===!1?(ac.emit("error",t),void ac.removeAllListeners()):("function"!=typeof aa.back_off_function&&(aa.back_off_function=iM),ac.emit("requestError",t),("active"===ac.state||"pending"===ac.state)&&(ac.emit("paused",t),ac.state="stopped",ac.once("active",function(){aa.current_back_off=gc})),aa.current_back_off=aa.current_back_off||gc,aa.current_back_off=aa.back_off_function(aa.current_back_off),void setTimeout(ab,aa.current_back_off))}function i8(t){return i2(t)}function gf(aa,ac,t,ab){(t>0||ab<ac.byteLength)&&(ac=new Uint8Array(ac,t,Math.min(ab,ac.byteLength)-t)),aa.append(ac)}function hI(aa,ac,t,ab){(t>0||ab<ac.length)&&(ac=ac.substring(t,ab)),aa.appendBinary(ac)}function i5(t){return Object.keys(t).sort(dr.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function h5(ac,t,ag){var ad=ag.doc_ids?ag.doc_ids.sort(dr.collate):"",ab=ag.filter?ag.filter.toString():"",aa="",af="";return ag.filter&&ag.query_params&&(aa=JSON.stringify(i5(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),at.all([ac.id(),t.id()]).then(function(aj){var ah=aj[0]+aj[1]+ab+af+aa+ad;return a6(ah)}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function hE(t){return/^1-/.test(t)}function hv(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0,attachments:!0,binary:!0}}function gj(ad,ab,ag){function aj(){var ak=hv(ab);if(ak.docs.length){return ad.bulkGet(ak).then(function(al){if(ag.cancelled){throw new Error("cancelled")}al.results.forEach(function(am){am.docs.forEach(function(ap){ap.ok&&t.push(ap.ok)})})})}}function ah(ak){return ak._attachments&&Object.keys(ak._attachments).length>0}function af(ak){return ad.allDocs({keys:ak,include_docs:!0}).then(function(al){if(ag.cancelled){throw new Error("cancelled")}al.rows.forEach(function(am){!am.deleted&&am.doc&&hE(am.value.rev)&&!ah(am.doc)&&(t.push(am.doc),delete ab[am.id])})})}function ac(){var ak=Object.keys(ab).filter(function(am){var al=ab[am].missing;return 1===al.length&&hE(al[0])});return ak.length>0?af(ak):void 0}function aa(){return t}ab=gu(ab);var t=[];return at.resolve().then(ac).then(aj).then(aa)}function gz(af,ad,aF,aM,aG){function az(){return aw?at.resolve():h5(af,ad,aF).then(function(aS){aa=aS,aw=new B(af,ad,aa,aM)})}function aJ(){if(am=[],0!==au.docs.length){var aS=au.docs;return ad.bulkDocs({docs:aS,new_edits:!1}).then(function(aU){if(aM.cancelled){throw ay(),new Error("cancelled")}var aX=[],aV={};aU.forEach(function(aY){aY.error&&(aG.doc_write_failures++,aX.push(aY),aV[aY.id]=aY)}),aR=aR.concat(aX),aG.docs_written+=au.docs.length-aX.length;var aW=aX.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aV[aZ._id];aY?aM.emit("denied",gu(aY)):am.push(aZ)}),aW.length>0){var aT=new Error("bulkDocs error");throw aT.other_errors=aX,aN("target.bulkDocs failed to write docs",aT),new Error("bulkWrite partial failure")}},function(aT){throw aG.doc_write_failures+=aS.length,aT})}}function ab(){aG.last_seq=aq=au.seq;var aS=gu(aG);return am.length&&(aS.docs=am,aM.emit("change",aS)),ax=!0,aw.writeCheckpoint(au.seq,aP).then(function(){if(ax=!1,aM.cancelled){throw ay(),new Error("cancelled")}au=void 0,aD()})["catch"](function(aT){throw ax=!1,aN("writeCheckpoint completed with error",aT),aT})}function aj(){var aS={};return au.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),ad.revsDiff(aS).then(function(aT){if(aM.cancelled){throw ay(),new Error("cancelled")}au.diffs=aT})}function aL(){return gj(af,au.diffs,aM).then(function(aS){aS.forEach(function(aT){delete au.diffs[aT._id],aG.docs_read++,au.docs.push(aT)})})}function ah(){if(!aM.cancelled&&!au){if(0===aB.length){return void aC(!0)}au=aB.shift(),aj().then(aL).then(aJ).then(ab).then(ah)["catch"](function(aS){aN("batch processing terminated with error",aS)})}}function aC(aS){return 0===aI.changes.length?void (0!==aB.length||au||((aA&&ac.live||aO)&&(aM.state="pending",aM.emit("paused")),aO&&ay())):void ((aS||aO||aI.changes.length>=aQ)&&(aB.push(aI),aI={seq:0,changes:[],docs:[]},("pending"===aM.state||"stopped"===aM.state)&&(aM.state="active",aM.emit("active")),ah()))}function aN(aS,aT){aE||(aT.message||(aT.message=aS),aG.ok=!1,aG.status="aborting",aG.errors.push(aT),aR=aR.concat(aT),aB=[],aI={seq:0,changes:[],docs:[]},ay())}function ay(){if(!(aE||aM.cancelled&&(aG.status="cancelled",ax))){aG.status=aG.status||"complete",aG.end_time=new Date,aG.last_seq=aq,aE=!0;var aS=aR.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=aR.pop();aR.length>0&&(aT.other_errors=aR),aT.result=aG,gZ(aF,aM,aT,function(){gz(af,ad,aF,aM)})}else{aG.errors=aR,aM.emit("complete",aG),aM.removeAllListeners()}}}function aH(aS){if(aM.cancelled){return ay()}var aT=S(aF)(aS);aT&&(aI.seq=aS.seq,aI.changes.push(aS),aC(0===aB.length))}function ak(aS){return ag=!1,aM.cancelled?ay():(aS.results.length>0?(ac.since=aS.last_seq,aD()):aA?(ac.live=!0,aD()):aO=!0,void aC(!0))}function t(aS){return ag=!1,aM.cancelled?ay():void aN("changes rejected",aS)}function aD(){function aU(){aS.cancel()}function aT(){aM.removeListener("cancel",aU)}if(!ag&&!aO&&aB.length<al){ag=!0,aM._changes&&(aM.removeListener("cancel",aM._abortChanges),aM._changes.cancel()),aM.once("cancel",aU);var aS=af.changes(ac).on("change",aH);aS.then(aT,aT),aS.then(ak)["catch"](t),aF.retry&&(aM._changes=aS,aM._abortChanges=aU)}}function ap(){az().then(function(){return aM.cancelled?void ay():aw.getCheckpoint().then(function(aS){aq=aS,ac={since:aq,limit:aQ,batch_size:aQ,style:"all_docs",doc_ids:av,return_docs:!0},aF.filter&&("string"!=typeof aF.filter?ac.include_docs=!0:ac.filter=aF.filter),"heartbeat" in aF&&(ac.heartbeat=aF.heartbeat),"timeout" in aF&&(ac.timeout=aF.timeout),aF.query_params&&(ac.query_params=aF.query_params),aF.view&&(ac.view=aF.view),aD()})})["catch"](function(aS){aN("getCheckpoint rejected with ",aS)})}function aK(aS){throw ax=!1,aN("writeCheckpoint completed with error",aS),aS}var au,aa,aw,aB=[],aI={seq:0,changes:[],docs:[]},ax=!1,aO=!1,aE=!1,aq=0,aA=aF.continuous||aF.live||!1,aQ=aF.batch_size||100,al=aF.batches_limit||10,ag=!1,av=aF.doc_ids,aR=[],am=[],aP=P();aG=aG||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var ac={};return aM.ready(af,ad),aM.cancelled?void ay():(aM._addedListeners||(aM.once("cancel",ay),"function"==typeof aF.complete&&(aM.once("error",aF.complete),aM.once("complete",function(aS){aF.complete(null,aS)})),aM._addedListeners=!0),void ("undefined"==typeof aF.since?ap():az().then(function(){return ax=!0,aw.writeCheckpoint(aF.since,aP)}).then(function(){return ax=!1,aM.cancelled?void ay():(aq=aF.since,void ap())})["catch"](aK)))}function gs(){ie.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new at(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function iO(ab,t){var aa=t.PouchConstructor;return"string"==typeof ab?new aa(ab,t):ab}function hD(ac,t,ag,ad){if("function"==typeof ag&&(ad=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw gA(bo,"`doc_ids` filter parameter is not a list.")}ag.complete=ad,ag=gu(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ab=new gs(ag),aa=iO(ac,ag),af=iO(t,ag);return gz(aa,af,ag,ab),ab}function fb(aa,ac,t,ab){return"function"==typeof t&&(ab=t,t={}),"undefined"==typeof t&&(t={}),t=gu(t),t.PouchConstructor=t.PouchConstructor||this,aa=fV.toPouch(aa,t),ac=fV.toPouch(ac,t),new gV(aa,ac,t,ab)}function gV(aq,ag,af,am){function ah(ay){aa.emit("change",{direction:"pull",change:ay})}function ab(ay){aa.emit("change",{direction:"push",change:ay})}function aj(ay){aa.emit("denied",{direction:"push",doc:ay})}function ad(ay){aa.emit("denied",{direction:"pull",doc:ay})}function av(){aa.pushPaused=!0,aa.pullPaused&&aa.emit("paused")}function al(){aa.pullPaused=!0,aa.pushPaused&&aa.emit("paused")}function t(){aa.pushPaused=!1,aa.pullPaused&&aa.emit("active",{direction:"push"})}function ac(){aa.pullPaused=!1,aa.pushPaused&&aa.emit("active",{direction:"pull"})}function ap(ay){return function(aC,aD){var az="change"===aC&&(aD===ah||aD===ab),aA="denied"===aC&&(aD===ad||aD===aj),aE="paused"===aC&&(aD===al||aD===av),aB="active"===aC&&(aD===ac||aD===t);(az||aA||aE||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&aa.removeAllListeners(aC))}}var aa=this;this.canceled=!1;var ak=af.push?hy.extend({},af,af.push):af,aw=af.pull?hy.extend({},af,af.pull):af;this.push=gW(aq,ag,ak),this.pull=gW(ag,aq,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};af.live&&(this.push.on("complete",aa.pull.cancel.bind(aa.pull)),this.pull.on("complete",aa.push.cancel.bind(aa.push))),this.on("newListener",function(ay){"change"===ay?(aa.pull.on("change",ah),aa.push.on("change",ab)):"denied"===ay?(aa.pull.on("denied",ad),aa.push.on("denied",aj)):"active"===ay?(aa.pull.on("active",ac),aa.push.on("active",t)):"paused"===ay&&(aa.pull.on("paused",al),aa.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(aa.pull.removeListener("change",ah),aa.push.removeListener("change",ab)):"denied"===ay?(aa.pull.removeListener("denied",ad),aa.push.removeListener("denied",aj)):"active"===ay?(aa.pull.removeListener("active",ac),aa.push.removeListener("active",t)):"paused"===ay&&(aa.pull.removeListener("paused",al),aa.push.removeListener("paused",av))}),this.pull.on("removeListener",ap("pull")),this.push.on("removeListener",ap("push"));var au=at.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return aa.emit("complete",az),am&&am(null,az),aa.removeAllListeners(),az},function(ay){if(aa.cancel(),am?am(ay):aa.emit("error",ay),aa.removeAllListeners(),am){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function gK(t,aa){return hd(hq(t),aa)}function iN(ad){for(var aa="",ab=new Uint8Array(ad),t=ab.byteLength,ac=0;t>ac;ac++){aa+=String.fromCharCode(ab[ac])}return aa}function fY(aa,ac){if("undefined"==typeof FileReader){return ac(iN((new FileReaderSync).readAsArrayBuffer(aa)))}var t=new FileReader,ab="function"==typeof t.readAsBinaryString;t.onloadend=function(af){var ad=af.target.result||"";return ab?ac(ad):void ac(iN(ad))},ab?t.readAsBinaryString(aa):t.readAsArrayBuffer(aa)}function gJ(t){return new at(function(aa){fY(t,function(ab){aa(i2(ab))})})}function M(aa){for(var ac=[],t=0,ab=aa.length;ab>t;t++){ac=ac.concat(aa[t])}return ac}function s(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=gK(ab.data,ab.content_type)})}function jb(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function gO(t){return t._attachments&&Object.keys(t._attachments)?at.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?gJ(aa.data).then(function(ac){aa.data=ac}):void 0})):at.resolve()}function f5(ab){var t=im(ab);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var aa=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=aa.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=aa.join("/"),t}function gC(t,aa){return gP(t,t.db+"/"+aa)}function gP(ab,t){var aa=ab.path?"/":"";return ab.protocol+"://"+ab.host+(ab.port?":"+ab.port:"")+"/"+ab.path+aa+t}function il(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function a4(ag,aq){function aa(ay,aw,ax){var av=ay.ajax||{},az=hy.extend(gu(ab),av,aw);return gE(az.method+" "+az.url),hO.ajax(az,ax)}function ah(av,aw){return new at(function(ax,ay){aa(av,aw,function(az,aA){return az?ay(az):void ax(aA)})})}function af(av,aw){return gp(av,w(function(ax){am().then(function(ay){return aw.apply(this,ax)})["catch"](function(az){var ay=ax.pop();ay(az)})}))}function am(){if(ag.skipSetup||ag.skip_setup){return at.resolve()}if(ap){return ap}var av={method:"GET",url:al};return ap=ah({},av)["catch"](function(aw){return aw&&aw.status&&404===aw.status?(he(404,"PouchDB is just detecting if the remote exists."),ah({},{method:"PUT",url:al})):at.reject(aw)})["catch"](function(aw){return aw&&aw.status&&412===aw.status?!0:at.reject(aw)}),ap["catch"](function(){ap=null}),ap}function au(av){return av.split("/").map(encodeURIComponent).join("/")}var ak=this,t=f5;ag.getHost&&(t=ag.getHost);var ac=t(ag.name,ag),al=gC(ac,"");ag=gu(ag);var ab=ag.ajax||{};if(ak.getUrl=function(){return al},ak.getHeaders=function(){return ab.headers||{}},ag.auth||ac.auth){var aj=ag.auth||ac.auth,ad=i2(aj.username+":"+aj.password);ab.headers=ab.headers||{},ab.headers.Authorization="Basic "+ad}var ap;setTimeout(function(){aq(null,ak)}),ak.type=function(){return"http"},ak.id=af("id",function(av){aa({},{method:"GET",url:gP(ac,"")},function(aw,ax){var ay=ax&&ax.uuid?ax.uuid+ac.db:gC(ac,"");av(null,ay)})}),ak.request=af("request",function(av,aw){av.url=gC(ac,av.url),aa({},av,aw)}),ak.compact=af("compact",function(av,aw){"function"==typeof av&&(aw=av,av={}),av=gu(av),aa(av,{url:gC(ac,"_compact"),method:"POST"},function(){function ax(){ak.info(function(az,ay){ay&&!ay.compact_running?aw(null,{ok:!0}):setTimeout(ax,av.interval||200)})}ax()})}),ak.bulkGet=gp("bulkGet",function(aB,aw){function aA(aC){var aD={};aB.revs&&(aD.revs=!0),aB.attachments&&(aD.attachments=!0),aa({},{url:gC(ac,"_bulk_get"+il(aD)),method:"POST",body:{docs:aB.docs}},aC)}function az(){function aC(aJ){return function(aL,aK){aG[aJ]=aK.results,++aI===aE&&aw(null,{results:M(aG)})}}for(var aF=hk,aE=Math.ceil(aB.docs.length/aF),aI=0,aG=new Array(aE),aH=0;aE>aH;aH++){var aD=gT(aB,["revs","attachments"]);aD.docs=aB.docs.slice(aH*aF,Math.min(aB.docs.length,(aH+1)*aF)),iQ(ax,aD,aC(aH))}}var ax=this,ay=gP(ac,""),av=hP[ay];"boolean"!=typeof av?aA(function(aE,aD){if(aE){var aC=Math.floor(aE.status/100);4===aC||5===aC?(hP[ay]=!1,he(aE.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),az()):aw(aE)}else{hP[ay]=!0,aw(null,aD)}}):av?aA(aw):az()}),ak._info=function(av){am().then(function(){aa({},{method:"GET",url:gC(ac,"")},function(ax,aw){return ax?av(ax):(aw.host=gC(ac,""),void av(null,aw))})})["catch"](av)},ak.get=af("get",function(aB,aw,aA){function az(aD){var aC=aD._attachments,aE=aC&&Object.keys(aC);return aC&&aE.length?at.all(aE.map(function(aF){var aH=aC[aF],aG=jb(aD._id)+"/"+au(aF)+"?rev="+aD._rev;return ah(aw,{method:"GET",url:gC(ac,aG),binary:!0}).then(function(aI){return aw.binary?aI:gJ(aI)}).then(function(aI){delete aH.stub,delete aH.length,aH.data=aI})})):void 0}function ax(aC){return Array.isArray(aC)?at.all(aC.map(function(aD){return aD.ok?az(aD.ok):void 0})):az(aC)}"function"==typeof aw&&(aA=aw,aw={}),aw=gu(aw);var av={};aw.revs&&(av.revs=!0),aw.revs_info&&(av.revs_info=!0),aw.open_revs&&("all"!==aw.open_revs&&(aw.open_revs=JSON.stringify(aw.open_revs)),av.open_revs=aw.open_revs),aw.rev&&(av.rev=aw.rev),aw.conflicts&&(av.conflicts=aw.conflicts),aB=jb(aB);var ay={method:"GET",url:gC(ac,aB+il(av))};ah(aw,ay).then(function(aC){return at.resolve().then(function(){return aw.attachments?ax(aC):void 0}).then(function(){aA(null,aC)})})["catch"](aA)}),ak.remove=af("remove",function(aw,av,ay,aA){var az;"string"==typeof av?(az={_id:aw,_rev:av},"function"==typeof ay&&(aA=ay,ay={})):(az=aw,"function"==typeof av?(aA=av,ay={}):(aA=ay,ay=av));var ax=az._rev||ay.rev;aa(ay,{method:"DELETE",url:gC(ac,jb(az._id))+"?rev="+ax},aA)}),ak.getAttachment=af("getAttachment",function(aw,ay,aA,av){"function"==typeof aA&&(av=aA,aA={});var az=aA.rev?"?rev="+aA.rev:"",ax=gC(ac,jb(aw))+"/"+au(ay)+az;aa(aA,{method:"GET",url:ax,binary:!0},av)}),ak.removeAttachment=af("removeAttachment",function(ay,aw,az,ax){var av=gC(ac,jb(ay)+"/"+au(aw))+"?rev="+az;aa({},{method:"DELETE",url:av},ax)}),ak.putAttachment=af("putAttachment",function(ax,aF,aD,aB,aA,aE){"function"==typeof aA&&(aE=aA,aA=aB,aB=aD,aD=null);var av=jb(ax)+"/"+au(aF),ay=gC(ac,av);if(aD&&(ay+="?rev="+aD),"string"==typeof aB){var az;try{az=hq(aB)}catch(aC){return aE(gA(f4,"Attachment is not a valid base64 string"))}aB=az?hd(az,aA):""}var aw={headers:{"Content-Type":aA},method:"PUT",url:ay,processData:!1,body:aB,timeout:ab.timeout||60000};aa({},aw,aE)}),ak._bulkDocs=function(aw,av,ax){aw.new_edits=av.new_edits,am().then(function(){return at.all(aw.docs.map(gO))}).then(function(){aa(av,{method:"POST",url:gC(ac,"_bulk_docs"),body:aw},function(ay,az){return ay?ax(ay):(az.forEach(function(aA){aA.ok=!0}),void ax(null,az))})})["catch"](ax)},ak.allDocs=af("allDocs",function(aB,aA){"function"==typeof aB&&(aA=aB,aB={}),aB=gu(aB);var aw,az={},ax="GET";aB.conflicts&&(az.conflicts=!0),aB.descending&&(az.descending=!0),aB.include_docs&&(az.include_docs=!0),aB.attachments&&(az.attachments=!0),aB.key&&(az.key=JSON.stringify(aB.key)),aB.start_key&&(aB.startkey=aB.start_key),aB.startkey&&(az.startkey=JSON.stringify(aB.startkey)),aB.end_key&&(aB.endkey=aB.end_key),aB.endkey&&(az.endkey=JSON.stringify(aB.endkey)),"undefined"!=typeof aB.inclusive_end&&(az.inclusive_end=!!aB.inclusive_end),"undefined"!=typeof aB.limit&&(az.limit=aB.limit),"undefined"!=typeof aB.skip&&(az.skip=aB.skip);var ay=il(az);if("undefined"!=typeof aB.keys){var av="keys="+encodeURIComponent(JSON.stringify(aB.keys));av.length+ay.length+1<=ct?ay+="&"+av:(ax="POST",aw={keys:aB.keys})}ah(aB,{method:ax,url:gC(ac,"_all_docs"+ay),body:aw}).then(function(aC){aB.include_docs&&aB.attachments&&aB.binary&&aC.rows.forEach(s),aA(null,aC)})["catch"](aA)}),ak._changes=function(aH){var aw="batch_size" in aH?aH.batch_size:x;aH=gu(aH),aH.timeout="timeout" in aH?aH.timeout:"timeout" in ab?ab.timeout:30000;var aG,aD=aH.timeout?{timeout:aH.timeout-5000}:{},ax="undefined"!=typeof aH.limit?aH.limit:!1;aG="return_docs" in aH?aH.return_docs:"returnDocs" in aH?aH.returnDocs:!0;var aI=ax;if(aH.style&&(aD.style=aH.style),(aH.include_docs||aH.filter&&"function"==typeof aH.filter)&&(aD.include_docs=!0),aH.attachments&&(aD.attachments=!0),aH.continuous&&(aD.feed="longpoll"),aH.conflicts&&(aD.conflicts=!0),aH.descending&&(aD.descending=!0),"heartbeat" in aH?aH.heartbeat&&(aD.heartbeat=aH.heartbeat):aD.heartbeat=10000,aH.filter&&"string"==typeof aH.filter&&(aD.filter=aH.filter,"_view"===aH.filter&&aH.view&&"string"==typeof aH.view&&(aD.view=aH.view)),aH.query_params&&"object"==typeof aH.query_params){for(var aC in aH.query_params){aH.query_params.hasOwnProperty(aC)&&(aD[aC]=aH.query_params[aC])}}var az,aB="GET";if(aH.doc_ids){aD.filter="_doc_ids";var aA=JSON.stringify(aH.doc_ids);aA.length<ct?aD.doc_ids=aA:(aB="POST",az={doc_ids:aH.doc_ids})}var aF,ay,aE=function(aK,aL){if(!aH.aborted){aD.since=aK,"object"==typeof aD.since&&(aD.since=JSON.stringify(aD.since)),aH.descending?ax&&(aD.limit=aI):aD.limit=!ax||aI>aw?aw:aI;var aM={method:aB,url:gC(ac,"_changes"+il(aD)),timeout:aH.timeout,body:az};ay=aK,aH.aborted||am().then(function(){aF=aa(aH,aM,aL)})["catch"](aL)}},av={results:[]},aJ=function(aN,aL){if(!aH.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,av.last_seq=aL.last_seq;var aK={};aK.query=aH.query_params,aL.results=aL.results.filter(function(aQ){aI--;var aP=S(aH)(aQ);return aP&&(aH.include_docs&&aH.attachments&&aH.binary&&s(aQ),aG&&av.results.push(aQ),aH.onChange(aQ)),aP})}else{if(aN){return aH.aborted=!0,void aH.complete(aN)}}aL&&aL.last_seq&&(ay=aL.last_seq);var aO=ax&&0>=aI||aL&&aw>aM||aH.descending;(!aH.continuous||ax&&0>=aI)&&aO?aH.complete(null,av):setTimeout(function(){aE(ay,aJ)},0)}};return aE(aH.since||0,aJ),{cancel:function(){aH.aborted=!0,aF&&aF.abort()}}},ak.revsDiff=af("revsDiff",function(aw,av,ax){"function"==typeof av&&(ax=av,av={}),aa(av,{method:"POST",url:gC(ac,"_revs_diff"),body:aw},ax)}),ak._close=function(av){av()},ak._destroy=function(aw,av){aa(aw,{url:gC(ac,""),method:"DELETE"},function(ax,ay){return ax&&ax.status&&404!==ax.status?av(ax):(ak.emit("destroyed"),ak.constructor.emit("destroyed",ag.name),void av(null,ay))})}}function gL(){this.promise=new at(function(t){t()})}function a2(t){return a5.hash(t)}function m(t){var ac=t.db,ag=t.viewName,aa=t.map,ah=t.reduce,ad=t.temporary,af=aa.toString()+(ah&&ah.toString())+"undefined";if(!ad&&ac._cachedViews){var ab=ac._cachedViews[af];if(ab){return at.resolve(ab)}}return ac.info().then(function(ak){function al(am){am.views=am.views||{};var aq=ag;-1===aq.indexOf("/")&&(aq=ag+"/"+ag);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ad?"temp":a2(af));return ho(ac,"_local/mrviews",al).then(function(){return ac.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ac,adapter:ac.adapter,mapFun:aa,reduceFun:ah};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ad||(ac._cachedViews=ac._cachedViews||{},ac._cachedViews[af]=aq,aq.db.once("destroyed",function(){delete ac._cachedViews[af]})),aq})})})})}function an(ad,aa,ab,t,ac,af){return iq("return ("+ad.replace(/;\s*$/,"")+");",{emit:aa,sum:ab,log:t,isArray:ac,toJSON:af})}function h0(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function gr(t){return 1===t.length&&/^1-/.test(t[0].rev)}function iV(ab,t){try{ab.emit("error",t)}catch(aa){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(t)}}function fp(aa,ac,t){try{return{output:ac.apply(null,t)}}catch(ab){return iV(aa,ab),{error:ab}}}function iZ(ab,t){var aa=iS(ab.key,t.key);return 0!==aa?aa:iS(ab.value,t.value)}function gx(ab,t,aa){return aa=aa||0,"number"==typeof t?ab.slice(aa,t+aa):aa>0?ab.slice(aa):ab}function gF(ab){var t=ab.value,aa=t&&"object"==typeof t&&t._id||ab.id;return aa}function gN(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=gK(ac.data,ac.content_type)})})}function gb(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&gN(aa),aa}}function ar(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new n(aa)}function gv(t){for(var ac=0,ag=0,aa=t.length;aa>ag;ag++){var ah=t[ag];if("number"!=typeof ah){if(!Array.isArray(ah)){throw ar("_sum")}ac="number"==typeof ac?[ac]:ac;for(var ad=0,af=ah.length;af>ad;ad++){var ab=ah[ad];if("number"!=typeof ab){throw ar("_sum")}"undefined"==typeof ac[ad]?ac.push(ab):ac[ad]+=ab}}else{"number"==typeof ac?ac+=ah:ac[0]+=ah}}return ac}function gY(ad,aa,ab,t){var ac=aa[ad];"undefined"!=typeof ac&&(t&&(ac=encodeURIComponent(JSON.stringify(ac))),ab.push(ad+"="+ac))}function ji(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function h3(t){return t.group_level=ji(t.group_level),t.limit=ji(t.limit),t.skip=ji(t.skip),t}function ij(t){if(t){if("number"!=typeof t){return new ge('Invalid value for integer: "'+t+'"')}if(0>t){return new ge('Invalid value for positive integer: "'+t+'"')}}}function g8(aa,ac){var t=aa.descending?"endkey":"startkey",ab=aa.descending?"startkey":"endkey";if("undefined"!=typeof aa[t]&&"undefined"!=typeof aa[ab]&&iS(aa[t],aa[ab])>0){throw new ge("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ac.reduce&&aa.reduce!==!1){if(aa.include_docs){throw new ge("{include_docs:true} is invalid for reduce")}if(aa.keys&&aa.keys.length>1&&!aa.group&&!aa.group_level){throw new ge("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=ij(aa[af]);if(ad){throw ad}})}function Z(ad,ab,ag){var aj,ah=[],af="GET";if(gY("reduce",ag,ah),gY("include_docs",ag,ah),gY("attachments",ag,ah),gY("limit",ag,ah),gY("descending",ag,ah),gY("group",ag,ah),gY("group_level",ag,ah),gY("skip",ag,ah),gY("stale",ag,ah),gY("conflicts",ag,ah),gY("startkey",ag,ah,!0),gY("start_key",ag,ah,!0),gY("endkey",ag,ah,!0),gY("end_key",ag,ah,!0),gY("inclusive_end",ag,ah),gY("key",ag,ah,!0),ah=ah.join("&"),ah=""===ah?"":"?"+ah,"undefined"!=typeof ag.keys){var ac=2000,aa="keys="+encodeURIComponent(JSON.stringify(ag.keys));aa.length+ah.length+1<=ac?ah+=("?"===ah[0]?"&":"?")+aa:(af="POST","string"==typeof ab?aj={keys:ag.keys}:ab.keys=ag.keys)}if("string"==typeof ab){var t=h0(ab);return ad.request({method:af,url:"_design/"+t[0]+"/_view/"+t[1]+ah,body:aj}).then(gb(ag))}return aj=aj||{},Object.keys(ab).forEach(function(ak){Array.isArray(ab[ak])?aj[ak]=ab[ak]:aj[ak]=ab[ak].toString()}),ad.request({method:"POST",url:"_temp_view"+ah,body:aj}).then(gb(ag))}function ha(ab,t,aa){return new at(function(ad,ac){ab._query(t,aa,function(af,ag){return af?ac(af):void ad(ag)})})}function ix(t){return new at(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function gI(t){return function(aa){if(404===aa.status){return t}throw aa}}function hf(af,al,ag){function aj(){return gr(t)?at.resolve(aa):al.db.get(ad)["catch"](gI(aa))}function ak(am){return am.keys.length?al.db.allDocs({keys:am.keys,include_docs:!0}):at.resolve({rows:[]})}function ah(aq,am){for(var ax=[],ay={},aw=0,av=am.rows.length;av>aw;aw++){var ap=am.rows[aw],az=ap.doc;if(az&&(ax.push(az),ay[az._id]=!0,az._deleted=!ac[az._id],!az._deleted)){var aA=ac[az._id];"value" in aA&&(az.value=aA.value)}}var au=Object.keys(ac);return au.forEach(function(aD){if(!ay[aD]){var aB={_id:aD},aC=ac[aD];"value" in aC&&(aB.value=aC.value),ax.push(aB)}}),aq.keys=fo(au.concat(aq.keys)),ax.push(aq),ax}var ad="_local/doc_"+af,aa={_id:ad,keys:[]},ab=ag[af],ac=ab.indexableKeysToKeyValues,t=ab.changes;return aj().then(function(am){return ak(am).then(function(ap){return ah(am,ap)})})}function j(aa,ac,t){var ab="_local/lastSeq";return aa.db.get(ab)["catch"](gI({_id:ab,seq:0})).then(function(af){var ad=Object.keys(ac);return at.all(ad.map(function(ag){return hf(ag,aa,ac)})).then(function(ag){var ah=M(ag);return af.seq=t,ah.push(af),aa.db.bulkDocs({docs:ah})})})}function v(ab){var t="string"==typeof ab?ab:ab.name,aa=iu[t];return aa||(aa=iu[t]=new gL),aa}function ii(t){return gt(v(t),function(){return gU(t)})()}function gU(ad){function ab(am,ak){var al={id:ah._id,key:ik(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=ik(ak)),aj.push(al)}function ag(ak,al){return function(){return j(ad,ak,al)}}var aj,ah,af;if("function"==typeof ad.mapFun&&2===ad.mapFun.length){var ac=ad.mapFun;af=function(ak){return ac(ak,ab)}}else{af=an(ad.mapFun.toString(),ab,gv,gg,Array.isArray,JSON.parse)}var aa=ad.seq||0,t=new gL;return new at(function(ap,ak){function al(){t.finish().then(function(){ad.seq=aa,ap()})}function am(){function aq(au){ak(au)}ad.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:aa,limit:f8}).on("complete",function(aD){var av=aD.results;if(!av.length){return al()}for(var au={},ax=0,aA=av.length;aA>ax;ax++){var aF=av[ax];if("_"!==aF.doc._id[0]){aj=[],ah=aF.doc,ah._deleted||fp(ad.sourceDB,af,[ah]),aj.sort(iZ);for(var ay,aG={},aC=0,aB=aj.length;aB>aC;aC++){var az=aj[aC],aw=[az.key,az.id];0===iS(az.key,ay)&&aw.push(aC);var aE=je(aw);aG[aE]=az,ay=az.key}au[aF.doc._id]={indexableKeysToKeyValues:aG,changes:aF.changes}}aa=aF.seq}return t.add(ag(au,aa)),av.length<f8?al():am()}).on("error",aq)}am()})}function i3(af,al,ag){0===ag.group_level&&delete ag.group_level;var aj,ak=ag.group||ag.group_level;aj=gB[af.reduceFun]?gB[af.reduceFun]:an(af.reduceFun.toString(),null,gv,gg,Array.isArray,JSON.parse);var ah=[],ad=ag.group_level;al.forEach(function(aq){var am=ah[ah.length-1],ap=ak?aq.key:null;return ak&&Array.isArray(ap)&&"number"==typeof ad&&(ap=ap.length>ad?ap.slice(0,ad):ap),am&&0===iS(am.key[0][0],ap)?(am.key.push([ap,aq.id]),void am.value.push(aq.value)):void ah.push({key:[[ap,aq.id]],value:[aq.value]})});for(var aa=0,ab=ah.length;ab>aa;aa++){var ac=ah[aa],t=fp(af.sourceDB,aj,[ac.key,ac.value,!1]);if(t.error&&t.error instanceof n){throw t.error}ac.value=t.error?null:t.output,ac.key=ac.key[0][0]}return{rows:gx(ah,ag.limit,ag.skip)}}function bt(t,aa){return gt(v(t),function(){return hX(t,aa)})()}function hX(t,ad){function aa(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ab=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=g4(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function ac(aq){var au;if(au=am?i3(t,aq,ad):{total_rows:ab,offset:ag,rows:aq},ad.include_docs){var av=fo(aq.map(gF));return t.sourceDB.allDocs({keys:av,include_docs:!0,conflicts:ad.conflicts,attachments:ad.attachments,binary:ad.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),aq.forEach(function(ay){var aA=gF(ay),az=ax["$"+aA];az&&(ay.doc=az)}),au})}return au}var ab,am=t.reduceFun&&ad.reduce!==!1,ag=ad.skip||0;if("undefined"==typeof ad.keys||ad.keys.length||(ad.limit=0,delete ad.keys),"undefined"!=typeof ad.keys){var al=ad.keys,af=al.map(function(aq){var au={startkey:je([aq]),endkey:je([aq,{}])};return aa(au)});return at.all(af).then(M).then(ac)}var ah={descending:ad.descending};if(ad.start_key&&(ad.startkey=ad.start_key),ad.end_key&&(ad.endkey=ad.end_key),"undefined"!=typeof ad.startkey&&(ah.startkey=je(ad.descending?[ad.startkey,{}]:[ad.startkey])),"undefined"!=typeof ad.endkey){var ak=ad.inclusive_end!==!1;ad.descending&&(ak=!ak),ah.endkey=je(ak?[ad.endkey,{}]:[ad.endkey])}if("undefined"!=typeof ad.key){var ap=je([ad.key]),aj=je([ad.key,{}]);ah.descending?(ah.endkey=ap,ah.startkey=aj):(ah.startkey=ap,ah.endkey=aj)}return am||("number"==typeof ad.limit&&(ah.limit=ad.limit),ah.skip=ag),aa(ah).then(ac)}function iP(t){return t.request({method:"POST",url:"_view_cleanup"})}function cn(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ad){var ag=h0(ad),af="_design/"+ag[0],ah=ag[1];aa[af]=aa[af]||{},aa[af][ah]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ad){var ah={};ad.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ah[au]=ah[au]||am})})});var af=Object.keys(ah).filter(function(aj){return !ah[aj]}),ag=af.map(function(aj){return gt(v(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return at.all(ag).then(function(){return{ok:!0}})})},gI({ok:!0}))}function hU(ah,ab,t){if("http"===ah.type()){return Z(ah,ab,t)}if("function"==typeof ah._query){return ha(ah,ab,t)}if("string"!=typeof ab){g8(t,ab);var ag={db:ah,viewName:"temp_view/temp_view",map:ab.map,reduce:ab.reduce,temporary:!0};return ir.add(function(){return m(ag).then(function(ak){function aj(){return ak.db.destroy()}return fl(ii(ak).then(function(){return bt(ak,t)}),aj)})}),ir.finish()}var ac=ab,af=h0(ac),aa=af[0],ad=af[1];return ah.get("_design/"+aa).then(function(al){var ak=al.views&&al.views[ad];if(!ak||"string"!=typeof ak.map){throw new X("ddoc "+aa+" has no view named "+ad)}g8(t,ak);var aj={db:ah,viewName:ac,map:ak.map,reduce:ak.reduce};return m(aj).then(function(am){return"ok"===t.stale||"update_after"===t.stale?("update_after"===t.stale&&p.nextTick(function(){ii(am)}),bt(am,t)):ii(am).then(function(){return bt(am,t)})})})}function ge(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,ge)}catch(aa){}}function X(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,X)}catch(aa){}}function n(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,n)}catch(aa){}}function hF(t){return"'"+t+"'"}function iK(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function g1(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function fZ(t){return delete t._id,delete t._rev,JSON.stringify(t)}function de(ab,t,aa){return ab=JSON.parse(ab),ab._id=t,ab._rev=aa,ab}function gi(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function u(ad,aa,ab,t,ac){return"SELECT "+ad+" FROM "+("string"==typeof aa?aa:aa.join(" JOIN "))+(ab?" ON "+ab:"")+(t?" WHERE "+("string"==typeof t?t:t.join(" AND ")):"")+(ac?" ORDER BY "+ac:"")}function fj(ac,t,ag){function ad(){++aa===ac.length&&ab()}function ab(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+fT+" WHERE seq IN "+gi(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+fT+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+fT+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new id.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+fT+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+gh+" WHERE digest=?",[az]))})})})}})}}if(ac.length){var aa=0,af=[];ac.forEach(function(ah){var aj="SELECT seq FROM "+U+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[t,ah],function(al,am){if(!am.rows.length){return ad()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+U+" WHERE seq=?",[ak],ad)})})}}function hV(t){return function(ad){console.error("WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(gA(q,ab,ac))}}function fd(t){if("size" in t){return 1000000*t.size}var aa=/Android/.test(window.navigator.userAgent);return aa?5000000:1}function ih(){return"undefined"!=typeof sqlitePlugin?sqlitePlugin.openDatabase.bind(sqlitePlugin):"undefined"!=typeof openDatabase?function(t){return openDatabase(t.name,t.version,t.description,t.size)}:void 0}function y(ab,t){try{return{db:ab(t)}}catch(aa){return{error:aa}}}function iU(ab){var t=fk[ab.name];if(!t){var aa=ih();t=fk[ab.name]=y(aa,ab),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)}return t}function a9(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}function cr(t){K()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):ic()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function gM(){ie.EventEmitter.call(this),this._listeners={},cr(this)}function hu(t){return decodeURIComponent(window.escape(t))}function eq(t){return 65>t?t-48:t-55}function k(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(eq(aa.charCodeAt(ac++))<<4|eq(aa.charCodeAt(ac++)))}return ab}function jj(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(eq(aa.charCodeAt(ac+2))<<12|eq(aa.charCodeAt(ac+3))<<8|eq(aa.charCodeAt(ac))<<4|eq(aa.charCodeAt(ac+1))),ac+=4}return ab}function ev(t,aa){return"UTF-8"===aa?hu(k(t,0,t.length)):jj(t,0,t.length)}function jg(t){try{return JSON.parse(t)}catch(aa){return f9.parse(t)}}function hC(t){try{return JSON.stringify(t)}catch(aa){return f9.stringify(t)}}function iW(aa,ad,ah){function ab(ak){try{return hq(ak)}catch(al){var aj=gA(f4,"Attachment is not a valid base64 string");return{error:aj}}}function t(al,aj){if(al.stub){return aj()}if("string"==typeof al.data){var ak=ab(al.data);if(ak.error){return aj(ak.error)}al.length=ak.length,"blob"===ad?al.data=hd(ak,al.content_type):"base64"===ad?al.data=i2(ak):al.data=ak,a6(ak).then(function(am){al.digest="md5-"+am,aj()})}else{hz(al.data,function(am){"binary"===ad?al.data=iN(am):"base64"===ad&&(al.data=i2(iN(am))),a6(am).then(function(ap){al.digest="md5-"+ap,al.length=am.byteLength,aj()})})}}function ag(){af++,aa.length===af&&(ac?ah(ac):ah())}if(!aa.length){return ah()}var ac,af=0;aa.forEach(function(ak){function am(aq){ac=aq,al++,al===aj.length&&ag()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ag()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&t(ak.data._attachments[ap],am)}})}function iC(t,aa){return t.pos-aa.pos}function ai(ad,aa,ab){for(var t,ac=0,af=ad.length;af>ac;){t=ac+af>>>1,ab(ad[t],aa)<0?ac=t+1:af=t}return ac}function iB(aa,ac,t){var ab=ai(aa,ac,t);aa.splice(ab,0,ac)}function gm(t,ac){for(var ag,aa,ah=ac,ad=t.length;ad>ah;ah++){var af=t[ah],ab=[af.id,af.opts,[]];aa?(aa[2].push(ab),aa=ab):ag=aa=ab}return ag}function h6(t,aa){return t[0]<aa[0]?-1:1}function hS(ac,ak){for(var af=[{tree1:ac,tree2:ak}],ah=!1;af.length>0;){var ag=af.pop(),ad=ag.tree1,aa=ag.tree2;(ad[1].status||aa[1].status)&&(ad[1].status="available"===ad[1].status||"available"===aa[1].status?"available":"missing");for(var aj=0;aj<aa[2].length;aj++){if(ad[2][0]){for(var t=!1,ab=0;ab<ad[2].length;ab++){ad[2][ab][0]===aa[2][aj][0]&&(af.push({tree1:ad[2][ab],tree2:aa[2][aj]}),t=!0)}t||(ah="new_branch",iB(ad[2],aa[2][aj],h6))}else{ah="new_leaf",ad[2][0]=aa[2][aj]}}}return{conflicts:ah,tree:ac}}function a7(t,ac,ab){var ag,av=[],ap=!1,af=!1;if(!t.length){return{tree:[ac],conflicts:"new_leaf"}}for(var aa=0,aw=t.length;aw>aa;aa++){var ad=t[aa];if(ad.pos===ac.pos&&ad.ids[0]===ac.ids[0]){ag=hS(ad.ids,ac.ids),av.push({pos:ad.pos,ids:ag.tree}),ap=ap||ag.conflicts,af=!0}else{if(ab!==!0){var aj=ad.pos<ac.pos?ad:ac,aq=ad.pos<ac.pos?ac:ad,ah=aq.pos-aj.pos,am=[],ax=[];for(ax.push({ids:aj.ids,diff:ah,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],al=0,ak=az.length;ak>al;al++){ax.push({ids:az[al],diff:ay.diff-1,parent:ay.ids,parentIdx:al})}}else{ay.ids[0]===aq.ids[0]&&am.push(ay)}}var au=am[0];au?(ag=hS(au.ids,aq.ids),au.parent[2][au.parentIdx]=ag.tree,av.push({pos:aj.pos,ids:aj.ids}),ap=ap||ag.conflicts,af=!0):av.push(ad)}else{av.push(ad)}}}return af||av.push(ac),av.sort(iC),{tree:av,conflicts:ap||"internal_node"}}function a1(ac,ak){for(var af,ah=E(ac),ag=0,ad=ah.length;ad>ag;ag++){var aa=ah[ag],aj=aa.ids,t=Math.max(0,aj.length-ak),ab={pos:aa.pos+t,ids:gm(aj,t)};af=af?a7(af,ab,!0).tree:[ab]}return af}function hL(aa,ac,t){var ab=a7(aa,ac);return{tree:a1(ab.tree,t),conflicts:ab.conflicts}}function ao(ac,ak){for(var af,ah=ac.slice(),ag=ak.split("-"),ad=parseInt(ag[0],10),aa=ag[1];af=ah.pop();){if(af.pos===ad&&af.ids[0]===aa){return !0}for(var aj=af.ids[2],t=0,ab=aj.length;ab>t;t++){ah.push({pos:af.pos+1,ids:aj[t]})}}return !1}function g(aa,aA,aq,ac,au,ah,aj,av){if(ao(aA.rev_tree,aq.metadata.rev)){return ac[au]=aq,ah()}var az=aA.winningRev||h9(aA),am="deleted" in aA?aA.deleted:hG(aA,az),aw="deleted" in aq.metadata?aq.metadata.deleted:hG(aq.metadata),ay=/^1-/.test(aq.metadata.rev);if(am&&!aw&&av&&ay){var af=aq.data;af._rev=az,af._id=aq.metadata.id,aq=fi(af,av)}var ag=hL(aA.rev_tree,aq.metadata.rev_tree[0],aa),t=av&&(am&&aw||!am&&"new_leaf"!==ag.conflicts||am&&!aw&&"new_branch"===ag.conflicts);if(t){var ax=gA(iX);return ac[au]=ax,ah()}var ak=aq.metadata.rev;aq.metadata.rev_tree=ag.tree,aA.rev_map&&(aq.metadata.rev_map=aA.rev_map);var ab,ad=h9(aq.metadata),al=hG(aq.metadata,ad),ap=am===al?0:al>am?-1:1;ab=ak===ad?al:hG(aq.metadata,ak),aj(aq,ad,al,ab,!0,ap,au,ah)}function a8(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function l(ag,aq,aa,ah,af,am,au,ak,t){function ac(aC,aw,aA){var ax=h9(aC.metadata),ay=hG(aC.metadata,ax);if("was_delete" in ak&&ay){return am[aw]=gA(iF,"deleted"),aA()}var av=ab&&a8(aC);if(av){var az=gA(iX);return am[aw]=az,aA()}var aB=ay?0:1;au(aC,ax,ay,ay,!1,aB,aw,aA)}function al(){++ad===ap&&t&&t()}ag=ag||1000;var ab=ak.new_edits,aj=new id.Map,ad=0,ap=aq.length;aq.forEach(function(ay,aw){if(ay._id&&hs(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void aa[av](ay,{ctx:af},function(aA,az){am[aw]=aA||az,al()})}var ax=ay.metadata.id;aj.has(ax)?(ap--,aj.get(ax).push([ay,aw])):aj.set(ax,[[ay,aw]])}),aj.forEach(function(aw,ay){function az(){++ax<aw.length?av():al()}function av(){var aC=aw[ax],aB=aC[0],aA=aC[1];if(ah.has(ay)){g(ag,ah.get(ay),aB,am,aA,az,au,ab)}else{var aD=hL([],aB.metadata.rev_tree[0],ag);aB.metadata.rev_tree=aD.tree,ac(aB,aA,az)}}var ax=0;av()})}function gd(t){var aa=[];return fz(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function g9(ab,av,aq,af,az,aA,ay){function au(){return ac?ay(ac):(aA.notify(af._name),af._docCount=-1,void ay(null,ah))}function al(aD,aE){var aC="SELECT count(*) as cnt FROM "+gh+" WHERE digest=?";aw.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=gA(fy,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function aj(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(ak.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){al(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function ap(aE,aI,aR,aF,aK,aP,aG,aL){function aC(){function aU(bf,bg){function bb(){return ++ba===bc.length&&bg(),!1}function bh(bk){var bj="INSERT INTO "+fT+" (digest, seq) VALUES (?,?)",bi=[aT._attachments[bk].digest,bf];aw.executeSql(bj,bi,bb,bb)}var ba=0,bc=Object.keys(aT._attachments||{});if(!bc.length){return bg()}for(var bd=0;bd<bc.length;bd++){bh(bc[bd])}}var aT=aE.data,aX=aF?1:0,aY=aT._id,aW=aT._rev,aZ=fZ(aT),aS="INSERT INTO "+U+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aV=[aY,aW,aZ,aX];aw.executeSql(aS,aV,function(bb,bc){var ba=bc.insertId;aU(ba,function(){aH(bb,ba)})},function(){var ba=u("seq",U,null,"doc_id=? AND rev=?");return aw.executeSql(ba,[aY,aW],function(bd,bf){var bb=bf.rows.item(0).seq,bc="UPDATE "+U+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",bg=[aZ,aX,aY,aW];bd.executeSql(bc,bg,function(bh){aU(bb,function(){aH(bh,bb)})})}),!1})}function aJ(aS){aM||(aS?(aM=aS,aL(aM)):aQ===aO.length&&aC())}function aN(aS){aQ++,aJ(aS)}function aD(){if(aK&&af.auto_compaction){var aT=aE.metadata.id,aS=gd(aE.metadata);fj(aS,aT,aw)}}function aH(aT,aV){aD(),aE.metadata.seq=aV,delete aE.metadata.rev;var aX=aK?"UPDATE "+f2+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+U+" WHERE doc_id="+f2+".id AND rev=?) WHERE id=?":"INSERT INTO "+f2+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aW=hC(aE.metadata),aU=aE.metadata.id,aS=aK?[aW,aV,aI,aU]:[aU,aV,aV,aW];aT.executeSql(aX,aS,function(){ah[aG]={ok:!0,id:aE.metadata.id,rev:aI},am.set(aU,aE.metadata),aL()})}var aM=null,aQ=0;aE.data._id=aE.metadata.id,aE.data._rev=aE.metadata.rev;var aO=Object.keys(aE.data._attachments||{});aF&&(aE.data._deleted=!0),aO.forEach(function(aV){var aU=aE.data._attachments[aV];if(aU.stub){aQ++,aJ()}else{var aT=aU.data;delete aU.data;var aS=aU.digest;aB(aS,aT,aN)}}),aO.length||aC()}function t(){l(ab.revs_limit,ak,af,am,aw,ah,ap,aq)}function ag(aD){function aE(){++aC===ak.length&&aD()}if(!ak.length){return aD()}var aC=0;ak.forEach(function(aG){if(aG._id&&hs(aG._id)){return aE()}var aF=aG.metadata.id;aw.executeSql("SELECT json FROM "+f2+" WHERE id = ?",[aF],function(aJ,aH){if(aH.rows.length){var aI=jg(aH.rows.item(0).json);am.set(aF,aI)}aE()})})}function aB(aD,aF,aC){var aE="SELECT digest FROM "+gh+" WHERE digest=?";aw.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+gh+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,iK(aF)],function(){aC()},function(){return aC(),!1}))})}var aa=aq.new_edits,ax=av.docs,ak=ax.map(function(aC){if(aC._id&&hs(aC._id)){return aC}var aD=fi(aC,aa);return aD}),ad=ak.filter(function(aC){return aC.error});if(ad.length){return ay(ad[0])}var aw,ac,ah=new Array(ak.length),am=new id.Map;iW(ak,"binary",function(aC){return aC?ay(aC):void az.transaction(function(aD){aw=aD,aj(function(aE){aE?ac=aE:ag(t)})},hV(ay),au)})}function ey(ad,ab,ag,aj,ah){function af(){++t===aa.length&&ah&&ah()}function ac(am,ak){var al=am._attachments[ak],ap={binary:ab.binary,ctx:aj};ag._getAttachment(al,ap,function(au,aq){am._attachments[ak]=hy.extend(gT(al,["digest","content_type"]),{data:aq}),af()})}var aa=Object.keys(ad._attachments||{});if(!aa.length){return ah&&ah()}var t=0;aa.forEach(function(ak){ab.attachments&&ab.include_docs?ac(ad,ak):(ad._attachments[ak].stub=!0,af())})}function ip(al,aa){function aq(){ic()&&(window.localStorage["_pouch__websqldb_"+ad._name]=!0),aa(null,ad)}function af(aC,aD){aC.executeSql(R),aC.executeSql("ALTER TABLE "+U+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aC.executeSql(fc),aC.executeSql("ALTER TABLE "+f2+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aC.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+f2+" (local, id)");var aE="SELECT "+f2+".winningseq AS seq, "+f2+".json AS metadata FROM "+U+" JOIN "+f2+" ON "+U+".seq = "+f2+".winningseq";aC.executeSql(aE,[],function(aH,aK){for(var aJ=[],aM=[],aF=0;aF<aK.rows.length;aF++){var aI=aK.rows.item(aF),aL=aI.seq,aG=JSON.parse(aI.metadata);hG(aG)&&aJ.push(aL),hs(aG.id)&&aM.push(aG.id)}aH.executeSql("UPDATE "+f2+"SET local = 1 WHERE id IN "+gi(aM.length),aM,function(){aH.executeSql("UPDATE "+U+" SET deleted = 1 WHERE seq IN "+gi(aJ.length),aJ,aD)})})})})}function az(aD,aE){var aC="CREATE TABLE IF NOT EXISTS "+g3+" (id UNIQUE, rev, json)";aD.executeSql(aC,[],function(){var aF="SELECT "+f2+".id AS id, "+U+".json AS data FROM "+U+" JOIN "+f2+" ON "+U+".seq = "+f2+".winningseq WHERE local = 1";aD.executeSql(aF,[],function(aJ,aH){function aK(){if(!aI.length){return aE(aJ)}var aL=aI.shift(),aM=JSON.parse(aL.data)._rev;aJ.executeSql("INSERT INTO "+g3+" (id, rev, json) VALUES (?,?,?)",[aL.id,aM,aL.data],function(aN){aN.executeSql("DELETE FROM "+f2+" WHERE id=?",[aL.id],function(aO){aO.executeSql("DELETE FROM "+U+" WHERE seq=?",[aL.seq],function(){aK()})})})}for(var aI=[],aG=0;aG<aH.rows.length;aG++){aI.push(aH.rows.item(aG))}aK()})})}function aA(aD,aF){function aC(aG){function aH(){if(!aG.length){return aF(aD)}var aI=aG.shift(),aK=ev(aI.hex,av),aN=aK.lastIndexOf("::"),aJ=aK.substring(0,aN),aL=aK.substring(aN+2),aM="UPDATE "+U+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aD.executeSql(aM,[aJ,aL,aK],function(){aH()})}aH()}var aE="ALTER TABLE "+U+" ADD COLUMN doc_id";aD.executeSql(aE,[],function(aG){var aH="ALTER TABLE "+U+" ADD COLUMN rev";aG.executeSql(aH,[],function(aI){aI.executeSql(fr,[],function(aJ){var aK="SELECT hex(doc_id_rev) as hex FROM "+U;aJ.executeSql(aK,[],function(aM,aO){for(var aN=[],aL=0;aL<aO.rows.length;aL++){aN.push(aO.rows.item(aL))}aC(aN)})})})})}function ak(aD,aF){function aC(aH){var aG="SELECT COUNT(*) AS cnt FROM "+gh;aH.executeSql(aG,[],function(aJ,aN){function aK(){var aO=u(g2+", "+f2+".id AS id",[f2,U],hn,null,f2+".id ");aO+=" LIMIT "+aM+" OFFSET "+aL,aL+=aM,aJ.executeSql(aO,[],function(aU,aZ){function aS(bc,bd){var bb=aX[bc]=aX[bc]||[];-1===bb.indexOf(bd)&&bb.push(bd)}if(!aZ.rows.length){return aF(aU)}for(var aX={},aT=0;aT<aZ.rows.length;aT++){for(var aP=aZ.rows.item(aT),aR=de(aP.data,aP.id,aP.rev),aW=Object.keys(aR._attachments||{}),aV=0;aV<aW.length;aV++){var aY=aR._attachments[aW[aV]];aS(aY.digest,aP.seq)}}var ba=[];if(Object.keys(aX).forEach(function(bb){var bc=aX[bb];bc.forEach(function(bd){ba.push([bb,bd])})}),!ba.length){return aK()}var aQ=0;ba.forEach(function(bc){var bb="INSERT INTO "+fT+" (digest, seq) VALUES (?,?)";aU.executeSql(bb,bc,function(){++aQ===ba.length&&aK()})})})}var aI=aN.rows.item(0).cnt;if(!aI){return aF(aJ)}var aL=0,aM=10;aK()})}var aE="CREATE TABLE IF NOT EXISTS "+fT+" (digest, seq INTEGER)";aD.executeSql(aE,[],function(aG){aG.executeSql(jf,[],function(aH){aH.executeSql(eu,[],aC)})})}function au(aD,aE){var aC="ALTER TABLE "+gh+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aD.executeSql(aC,[],aE)}function aj(aD,aE){var aC="ALTER TABLE "+f2+" ADD COLUMN max_seq INTEGER";aD.executeSql(aC,[],function(aG){var aF="UPDATE "+f2+" SET max_seq=(SELECT MAX(seq) FROM "+U+" WHERE doc_id=id)";aG.executeSql(aF,[],function(aH){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+f2+" (max_seq)";aH.executeSql(aI,[],aE)})})}function ay(aC,aD){aC.executeSql('SELECT HEX("a") AS hex',[],function(aF,aE){var aG=aE.rows.item(0).hex;av=2===aG.length?"UTF-8":"UTF-16",aD()})}function ax(){for(;t.length>0;){var aC=t.pop();aC(null,ap)}}function ag(aF,aI){if(0===aI){var aN="CREATE TABLE IF NOT EXISTS "+ae+" (dbid, db_version INTEGER)",aD="CREATE TABLE IF NOT EXISTS "+gh+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aH="CREATE TABLE IF NOT EXISTS "+fT+" (digest, seq INTEGER)",aE="CREATE TABLE IF NOT EXISTS "+f2+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aG="CREATE TABLE IF NOT EXISTS "+U+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aC="CREATE TABLE IF NOT EXISTS "+g3+" (id UNIQUE, rev, json)";aF.executeSql(aD),aF.executeSql(aC),aF.executeSql(aH,[],function(){aF.executeSql(eu),aF.executeSql(jf)}),aF.executeSql(aE,[],function(){aF.executeSql(R),aF.executeSql(aG,[],function(){aF.executeSql(fc),aF.executeSql(fr),aF.executeSql(aN,[],function(){var aP="INSERT INTO "+ae+" (db_version, dbid) VALUES (?,?)";ap=P();var aO=[i7,ap];aF.executeSql(aP,aO,function(){ax()})})})})}else{var aJ=function(){var aO=i7>aI;aO&&aF.executeSql("UPDATE "+ae+" SET db_version = "+i7);var aP="SELECT dbid FROM "+ae;aF.executeSql(aP,[],function(aR,aQ){ap=aQ.rows.item(0).dbid,ax()})},aM=[af,az,aA,ak,au,aj,aJ],aL=aI,aK=function(aO){aM[aL-1](aO,aK),aL++};aK(aF)}}function aw(){am.transaction(function(aC){ay(aC,function(){aB(aC)})},hV(aa),aq)}function aB(aC){var aD="SELECT sql FROM sqlite_master WHERE tbl_name = "+ae;aC.executeSql(aD,[],function(aE,aF){aF.rows.length?/db_version/.test(aF.rows.item(0).sql)?aE.executeSql("SELECT db_version FROM "+ae,[],function(aI,aG){var aH=aG.rows.item(0).db_version;ag(aI,aH)}):aE.executeSql("ALTER TABLE "+ae+" ADD COLUMN db_version INTEGER",[],function(){ag(aE,1)}):ag(aE,0)})}function ab(aD,aE){if(-1!==ad._docCount){return aE(ad._docCount)}var aC=u("COUNT("+f2+".id) AS 'num'",[f2,U],hn,U+".deleted=0");aD.executeSql(aC,[],function(aG,aF){ad._docCount=aF.rows.item(0).num,aE(ad._docCount)})}var av,ad=this,ap=null,ah=fd(al),t=[];ad._docCount=-1,ad._name=al.name;var ac=iU({name:ad._name,version:iI,description:ad._name,size:ah,location:al.location,createFromLocation:al.createFromLocation,androidDatabaseImplementation:al.androidDatabaseImplementation});if(ac.error){return hV(aa)(ac.error)}var am=ac.db;"function"!=typeof am.readTransaction&&(am.readTransaction=am.transaction),aw(),ad.type=function(){return"websql"},ad._id=ex(function(aC){aC(null,ap)}),ad._info=function(aC){am.readTransaction(function(aD){ab(aD,function(aE){var aF="SELECT MAX(seq) AS seq FROM "+U;aD.executeSql(aF,[],function(aG,aI){var aH=aI.rows.item(0).seq||0;aC(null,{doc_count:aE,update_seq:aH,sqlite_plugin:am._sqlitePlugin,websql_encoding:av})})})},hV(aC))},ad._bulkDocs=function(aE,aC,aD){g9(al,aE,aC,ad,am,ip.Changes,aD)},ad._get=function(aH,aD,aJ){function aC(){aJ(aF,{doc:aL,metadata:aI,ctx:aK})}var aL,aI,aF,aK=aD.ctx;if(!aK){return am.readTransaction(function(aM){ad._get(aH,hy.extend({ctx:aM},aD),aJ)})}var aE,aG;aD.rev?(aE=u(g2,[f2,U],f2+".id="+U+".doc_id",[U+".doc_id=?",U+".rev=?"]),aG=[aH,aD.rev]):(aE=u(g2,[f2,U],hn,f2+".id=?"),aG=[aH]),aK.executeSql(aE,aG,function(aO,aN){if(!aN.rows.length){return aF=gA(iF,"missing"),aC()}var aM=aN.rows.item(0);return aI=jg(aM.metadata),aM.deleted&&!aD.rev?(aF=gA(iF,"deleted"),aC()):(aL=de(aM.data,aI.id,aM.rev),void aC())})},ad._allDocs=function(aL,aE){var aH,aM=[],aK="startkey" in aL?aL.startkey:!1,aP="endkey" in aL?aL.endkey:!1,aG="key" in aL?aL.key:!1,aD="descending" in aL?aL.descending:!1,aF="limit" in aL?aL.limit:-1,aI="skip" in aL?aL.skip:0,aN=aL.inclusive_end!==!1,aC=[],aJ=[];if(aG!==!1){aJ.push(f2+".id = ?"),aC.push(aG)}else{if(aK!==!1||aP!==!1){if(aK!==!1&&(aJ.push(f2+".id "+(aD?"<=":">=")+" ?"),aC.push(aK)),aP!==!1){var aO=aD?">":"<";aN&&(aO+="="),aJ.push(f2+".id "+aO+" ?"),aC.push(aP)}aG!==!1&&(aJ.push(f2+".id = ?"),aC.push(aG))}}"ok"!==aL.deleted&&aJ.push(U+".deleted = 0"),am.readTransaction(function(aQ){ab(aQ,function(aS){if(aH=aS,0!==aF){var aR=u(g2,[f2,U],hn,aJ,f2+".id "+(aD?"DESC":"ASC"));aR+=" LIMIT "+aF+" OFFSET "+aI,aQ.executeSql(aR,aC,function(bb,aV){for(var aU=0,aT=aV.rows.length;aT>aU;aU++){var aY=aV.rows.item(aU),aW=jg(aY.metadata),aX=aW.id,aZ=de(aY.data,aX,aY.rev),ba=aZ._rev,bc={id:aX,key:aX,value:{rev:ba}};if(aL.include_docs&&(bc.doc=aZ,bc.doc._rev=ba,aL.conflicts&&(bc.doc._conflicts=L(aW)),ey(bc.doc,aL,ad,bb)),aY.deleted){if("ok"!==aL.deleted){continue}bc.value.deleted=!0,bc.doc=null}aM.push(bc)}})}})},hV(aE),function(){aE(null,{total_rows:aH,offset:aL.skip,rows:aM})})},ad._changes=function(aJ){function aF(){var aM=f2+".json AS metadata, "+f2+".max_seq AS maxSeq, "+U+".json AS winningDoc, "+U+".rev AS winningRev ",aL=f2+" JOIN "+U,aN=f2+".id="+U+".doc_id AND "+f2+".winningseq="+U+".seq",aO=["maxSeq > ?"],aR=[aJ.since];aJ.doc_ids&&(aO.push(f2+".id IN "+gi(aJ.doc_ids.length)),aR=aR.concat(aJ.doc_ids));var aK="maxSeq "+(aC?"DESC":"ASC"),aQ=u(aM,aL,aN,aO,aK),aS=S(aJ);aJ.view||aJ.filter||(aQ+=" LIMIT "+aG);var aP=aJ.since||0;am.readTransaction(function(aT){aT.executeSql(aQ,aR,function(bb,aZ){function ba(bf){return function(){aJ.onChange(bf)}}for(var bc=0,aV=aZ.rows.length;aV>bc;bc++){var aX=aZ.rows.item(bc),aY=jg(aX.metadata);aP=aX.maxSeq;var aW=de(aX.winningDoc,aY.id,aX.winningRev),bd=aJ.processChange(aW,aY,aJ);bd.seq=aX.maxSeq;var aU=aS(bd);if("object"==typeof aU){return aJ.complete(aU)}if(aU&&(aD++,aH&&aI.push(bd),aJ.attachments&&aJ.include_docs?ey(aW,aJ,ad,bb,ba(bd)):ba(bd)()),aD===aG){break}}})},hV(aJ.complete),function(){aJ.continuous||aJ.complete(null,{results:aI,last_seq:aP})})}if(aJ=gu(aJ),aJ.continuous){var aE=ad._name+":"+P();return ip.Changes.addListener(ad._name,aE,ad,aJ),ip.Changes.notify(ad._name),{cancel:function(){ip.Changes.removeListener(ad._name,aE)}}}var aC=aJ.descending;aJ.since=aJ.since&&!aC?aJ.since:0;var aG="limit" in aJ?aJ.limit:-1;0===aG&&(aG=1);var aH;aH="return_docs" in aJ?aJ.return_docs:"returnDocs" in aJ?aJ.returnDocs:!0;var aI=[],aD=0;aF()},ad._close=function(aC){aC()},ad._getAttachment=function(aJ,aF,aE){var aC,aG=aF.ctx,aH=aJ.digest,aI=aJ.content_type,aD="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+gh+" WHERE digest=?";aG.executeSql(aD,[aH],function(aK,aN){var aM=aN.rows.item(0),aL=aM.escaped?g1(aM.body):ev(aM.body,av);aC=aF.binary?hd(aL,aI):i2(aL),aE(null,aC)})},ad._getRevisionTree=function(aC,aD){am.readTransaction(function(aE){var aF="SELECT json AS metadata FROM "+f2+" WHERE id = ?";aE.executeSql(aF,[aC],function(aI,aH){if(aH.rows.length){var aG=jg(aH.rows.item(0).metadata);aD(null,aG.rev_tree)}else{aD(gA(iF))}})})},ad._doCompaction=function(aD,aE,aC){return aE.length?void am.transaction(function(aF){var aG="SELECT json AS metadata FROM "+f2+" WHERE id = ?";aF.executeSql(aG,[aD],function(aI,aK){var aJ=jg(aK.rows.item(0).metadata);fz(aJ.rev_tree,function(aP,aN,aQ,aO,aL){var aM=aN+"-"+aQ;-1!==aE.indexOf(aM)&&(aL.status="missing")});var aH="UPDATE "+f2+" SET json = ? WHERE id = ?";aI.executeSql(aH,[hC(aJ),aD])}),fj(aE,aD,aF)},hV(aC),function(){aC()}):aC()},ad._getLocal=function(aC,aD){am.readTransaction(function(aE){var aF="SELECT json, rev FROM "+g3+" WHERE id=?";aE.executeSql(aF,[aC],function(aI,aG){if(aG.rows.length){var aJ=aG.rows.item(0),aH=de(aJ.json,aC,aJ.rev);aD(null,aH)}else{aD(gA(iF))}})})},ad._putLocal=function(aK,aH,aD){function aF(aN){var aL,aM;aC?(aL="UPDATE "+g3+" SET rev=?, json=? WHERE id=? AND rev=?",aM=[aE,aI,aJ,aC]):(aL="INSERT INTO "+g3+" (id, rev, json) VALUES (?,?,?)",aM=[aJ,aE,aI]),aN.executeSql(aL,aM,function(aO,aP){aP.rowsAffected?(aG={ok:!0,id:aJ,rev:aE},aH.ctx&&aD(null,aG)):aD(gA(iX))},function(){return aD(gA(iX)),!1})}"function"==typeof aH&&(aD=aH,aH={}),delete aK._revisions;var aE,aC=aK._rev,aJ=aK._id;aE=aC?aK._rev="0-"+(parseInt(aC.split("-")[1],10)+1):aK._rev="0-1";var aG,aI=fZ(aK);aH.ctx?aF(aH.ctx):am.transaction(aF,hV(aD),function(){aG&&aD(null,aG)})},ad._removeLocal=function(aE,aG,aC){function aF(aJ){var aH="DELETE FROM "+g3+" WHERE id=? AND rev=?",aI=[aE._id,aE._rev];aJ.executeSql(aH,aI,function(aK,aL){return aL.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aC(null,aD))):aC(gA(iF))})}"function"==typeof aG&&(aC=aG,aG={});var aD;aG.ctx?aF(aG.ctx):am.transaction(aF,hV(aC),function(){aD&&aC(null,aD)})},ad._destroy=function(aC,aD){ip.Changes.removeAllListeners(ad._name),am.transaction(function(aE){var aF=[f2,U,gh,ae,g3,fT];aF.forEach(function(aG){aE.executeSql("DROP TABLE IF EXISTS "+aG,[])})},hV(aD),function(){ic()&&(delete window.localStorage["_pouch__websqldb_"+ad._name],delete window.localStorage[ad._name]),aD(null,{ok:!0})})}}function h8(aa,ac,t){try{aa.apply(ac,t)}catch(ab){"undefined"!=typeof PouchDB&&PouchDB.emit("error",ab)}}function ia(){if(!ff.running&&ff.queue.length){ff.running=!0;var t=ff.queue.shift();t.action(function(ab,aa){h8(t.callback,this,[ab,aa]),ff.running=!1,p.nextTick(ia)})}}function dn(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(gA(hH,aa,ab.type))}}function W(ab,t,aa){return{data:hC(ab),winningRev:t,deletedOrLocal:aa?"1":"0",seq:ab.seq,id:ab.id}}function hb(t){if(!t){return null}var aa=jg(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function gw(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function be(aa,ac,t,ab){t?ab(aa?"string"!=typeof aa?aa:gK(aa,ac):h1([""],{type:ac})):aa?"string"!=typeof aa?fY(aa,function(ad){ab(i2(ad))}):ab(aa):ab("")}function D(t,ac,ag,aa){function ah(){++ab===af.length&&aa&&aa()}function ad(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=ag.objectStore(gH).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ah()}}var af=Object.keys(t._attachments||{});if(!af.length){return aa&&aa()}var ab=0;af.forEach(function(aj){ac.attachments&&ac.include_docs?ad(t,aj):(t._attachments[aj].stub=!0,ah())})}function f7(t,aa){return at.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return at.all(ab.map(function(ah){var af=ac.doc._attachments[ah];if("body" in af){var ad=af.body,ag=af.content_type;return new at(function(aj){be(ad,ag,aa,function(ak){ac.doc._attachments[ah]=hy.extend(gT(af,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function fR(ac,ak,af){function ah(){ab--,ab||ag()}function ag(){ad.length&&ad.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||aj["delete"](am)}})}var ad=[],aa=af.objectStore(gX),aj=af.objectStore(gH),t=af.objectStore(en),ab=ac.length;ac.forEach(function(al){var am=aa.index("_doc_id_rev"),ap=ak+"::"+al;am.getKey(ap).onsuccess=function(av){var aq=av.target.result;if("number"!=typeof aq){return ah()}aa["delete"](aq);var au=t.index("seq").openCursor(IDBKeyRange.only(aq));au.onsuccess=function(aw){var ax=aw.target.result;if(ax){var ay=ax.value.digestSeq.split("::")[0];ad.push(ay),t["delete"](ax.primaryKey),ax["continue"]()}else{ah()}}}})}function hj(aa,ac,t){try{return{txn:aa.transaction(ac,t)}}catch(ab){return{error:ab}}}function G(av,aC,ab,aj,ak,aa,ad){function aw(){var aO=[fu,gX,gH,fw,g5,en],aP=hj(ak,aO,"readwrite");return aP.error?ad(aP.error):(al=aP.txn,al.onabort=dn(ad),al.ontimeout=dn(ad),al.oncomplete=aL,aH=al.objectStore(fu),ay=al.objectStore(gX),ax=al.objectStore(gH),aD=al.objectStore(en),void aN(function(aQ){return aQ?(aK=!0,ad(aQ)):void aq()}))}function t(){l(av.revs_limit,aF,aj,aJ,al,az,aE,ab)}function aq(){function aR(){++aP===aF.length&&t()}function aT(aV){var aW=hb(aV.target.result);aW&&aJ.set(aW.id,aW),aR()}if(aF.length){for(var aP=0,aS=0,aQ=aF.length;aQ>aS;aS++){var aU=aF[aS];if(aU._id&&hs(aU._id)){aR()}else{var aO=aH.get(aU.metadata.id);aO.onsuccess=aT}}}}function aL(){aK||(aa.notify(aj._meta.name),aj._meta.docCount+=aA,ad(null,az))}function af(aP,aQ){var aO=ax.get(aP);aO.onsuccess=function(aR){if(aR.target.result){aQ()}else{var aS=gA(fy,"unknown stub attachment with digest "+aP);aS.status=412,aQ(aS)}}}function aN(aQ){function aS(){++aP===aO.length&&aQ(aR)}var aO=[];if(aF.forEach(function(aT){aT.data&&aT.data._attachments&&Object.keys(aT.data._attachments).forEach(function(aU){var aV=aT.data._attachments[aU];aV.stub&&aO.push(aV.digest)})}),!aO.length){return aQ()}var aR,aP=0;aO.forEach(function(aT){af(aT,function(aU){aU&&!aR&&(aR=aU),aS()})})}function aE(aR,aX,aT,aV,aU,aS,aP,aW){aA+=aS,aR.metadata.winningRev=aX,aR.metadata.deleted=aT;var aO=aR.data;aO._id=aR.metadata.id,aO._rev=aR.metadata.rev,aV&&(aO._deleted=!0);var aQ=aO._attachments&&Object.keys(aO._attachments).length;return aQ?ac(aR,aX,aT,aU,aP,aW):void ah(aR,aX,aT,aU,aP,aW)}function am(aO){var aP=gd(aO.metadata);fR(aP,aO.metadata.id,al)}function ah(aU,aP,aY,aZ,aW,aR){function aO(bb){aZ&&aj.auto_compaction&&am(aU),aX.seq=bb.target.result,delete aX.rev;var bc=W(aX,aP,aY),ba=aH.put(bc);ba.onsuccess=aS}function aQ(bc){bc.preventDefault(),bc.stopPropagation();var ba=ay.index("_doc_id_rev"),bb=ba.getKey(aV._doc_id_rev);bb.onsuccess=function(bd){var bf=ay.put(aV,bd.target.result);bf.onsuccess=aO}}function aS(){az[aW]={ok:!0,id:aX.id,rev:aP},aJ.set(aU.metadata.id,aU.metadata),aB(aU,aX.seq,aR)}var aV=aU.data,aX=aU.metadata;aV._doc_id_rev=aX.id+"::"+aX.rev,delete aV._id,delete aV._rev;var aT=ay.put(aV);aT.onsuccess=aO,aT.onerror=aQ}function ac(aQ,aX,aT,aV,aU,aS){function aO(){aP===aR.length&&ah(aQ,aX,aT,aV,aU,aS)}function aW(){aP++,aO()}var aY=aQ.data,aP=0,aR=Object.keys(aY._attachments);aR.forEach(function(ba){var bc=aQ.data._attachments[ba];if(bc.stub){aP++,aO()}else{var bb=bc.data;delete bc.data;var aZ=bc.digest;aM(aZ,bb,aW)}})}function aB(aO,aR,aU){function aP(){++aS===aT.length&&aU()}function aV(aW){var aX=aO.data._attachments[aW].digest,aY=aD.put({seq:aR,digestSeq:aX+"::"+aR});aY.onsuccess=aP,aY.onerror=function(aZ){aZ.preventDefault(),aZ.stopPropagation(),aP()}}var aS=0,aT=Object.keys(aO.data._attachments||{});if(!aT.length){return aU()}for(var aQ=0;aQ<aT.length;aQ++){aV(aT[aQ])}}function aM(aP,aR,aO){var aQ=ax.count(aP);aQ.onsuccess=function(aS){var aV=aS.target.result;if(aV){return aO()}var aT={digest:aP,body:aR},aU=ax.put(aT);aU.onsuccess=aO}}for(var al,aH,ay,ax,aD,ap,aF=aC.docs,aA=0,aG=0,ag=aF.length;ag>aG;aG++){var aI=aF[aG];aI._id&&hs(aI._id)||(aI=aF[aG]=fi(aI,ab.new_edits),aI.error&&!ap&&(ap=aI))}if(ap){return ad(ap)}var az=new Array(aF.length),aJ=new id.Map,aK=!1,au=aj._meta.blobSupport?"blob":"base64";iW(aF,au,function(aO){return aO?ad(aO):void aw()})}function g6(ad,aa,ab,t,ac){try{if(ad&&aa){return ac?IDBKeyRange.bound(aa,ad,!ab,!1):IDBKeyRange.bound(ad,aa,!1,!ab)}if(ad){return ac?IDBKeyRange.upperBound(ad):IDBKeyRange.lowerBound(ad)}if(aa){return ac?IDBKeyRange.lowerBound(aa,!ab):IDBKeyRange.upperBound(aa,!ab)}if(t){return IDBKeyRange.only(t)}}catch(af){return{error:af}}return null}function iL(aa,ac,t,ab){return"DataError"===t.name&&0===t.code?ab(null,{total_rows:aa._meta.docCount,offset:ac.skip,rows:[]}):void ab(gA(hH,t.name,t.message))}function ei(ad,aa,ab,t){function ac(aF,aw){function ak(aK,aL,aN){var aM=aK.id+"::"+aN;ap.get(aM).onsuccess=function(aO){aL.doc=gw(aO.target.result),aF.conflicts&&(aL.doc._conflicts=L(aK)),D(aL.doc,aF,aJ)}}function av(aK,aN,aO){var aL={id:aO.id,key:aO.id,value:{rev:aN}},aM=aO.deleted;if("ok"===aF.deleted){az.push(aL),aM?(aL.value.deleted=!0,aL.doc=null):aF.include_docs&&ak(aO,aL,aN)}else{if(!aM&&aG--<=0&&(az.push(aL),aF.include_docs&&ak(aO,aL,aN),0===--ax)){return}}aK["continue"]()}function aH(aN){ag=aa._meta.docCount;var aL=aN.target.result;if(aL){var aK=hb(aL.value),aM=aK.winningRev;av(aL,aM,aK)}}function aj(){aw(null,{total_rows:ag,offset:aF.skip,rows:az})}function aA(){aF.attachments?f7(az,aF.binary).then(aj):aj()}var aq="startkey" in aF?aF.startkey:!1,aB="endkey" in aF?aF.endkey:!1,aE="key" in aF?aF.key:!1,aG=aF.skip||0,ax="number"==typeof aF.limit?aF.limit:-1,ah=aF.inclusive_end!==!1,am="descending" in aF&&aF.descending?"prev":null,aD=g6(aq,aB,ah,aE,am);if(aD&&aD.error){return iL(aa,aF,aD.error,aw)}var aC=[fu,gX];aF.attachments&&aC.push(gH);var ay=hj(ab,aC,"readonly");if(ay.error){return aw(ay.error)}var aJ=ay.txn,aI=aJ.objectStore(fu),au=aJ.objectStore(gX),al=am?aI.openCursor(aD,am):aI.openCursor(aD),ap=au.index("_doc_id_rev"),az=[],ag=0;aJ.oncomplete=aA,al.onsuccess=aH}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:aa._meta.docCount,offset:ag.skip,rows:[]}):void ac(ag,ah)}af(ad,t)}function gR(t){return new at(function(ab){var aa=h1([""]);t.objectStore(fq).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function iz(ab,t){var aa=this;ff.queue.push({action:function(ac){co(aa,ab,ac)},callback:t}),ia()}function co(aa,ad,am){function ak(av){var aw=av.createObjectStore(fu,{keyPath:"id"});av.createObjectStore(gX,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),av.createObjectStore(gH,{keyPath:"digest"}),av.createObjectStore(fw,{keyPath:"id",autoIncrement:!1}),av.createObjectStore(fq),aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),av.createObjectStore(g5,{keyPath:"_id"});var au=av.createObjectStore(en,{autoIncrement:!0});au.createIndex("seq","seq"),au.createIndex("digestSeq","digestSeq",{unique:!0})}function ah(av,aw){var au=av.objectStore(fu);au.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=hG(az);az.deletedOrLocal=ax?"1":"0",au.put(az),aA["continue"]()}else{aw()}}}function ap(au){au.createObjectStore(g5,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function af(ax,aw){var az=ax.objectStore(g5),ay=ax.objectStore(fu),av=ax.objectStore(gX),au=ay.openCursor();au.onsuccess=function(aA){var aD=aA.target.result;if(aD){var aJ=aD.value,aG=aJ.id,aH=hs(aG),aK=h9(aJ);if(aH){var aB=aG+"::"+aK,aE=aG+"::",aL=aG+"::~",aC=av.index("_doc_id_rev"),aF=IDBKeyRange.bound(aE,aL,!1,!1),aI=aC.openCursor(aF);aI.onsuccess=function(aN){if(aI=aN.target.result){var aM=aI.value;aM._doc_id_rev===aB&&az.put(aM),av["delete"](aI.primaryKey),aI["continue"]()}else{ay["delete"](aD.primaryKey),aD["continue"]()}}}else{aD["continue"]()}}else{aw&&aw()}}}function aj(au){var av=au.createObjectStore(en,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function aq(ax,aw){var az=ax.objectStore(gX),ay=ax.objectStore(gH),av=ax.objectStore(en),au=ay.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (az.openCursor().onsuccess=function(aK){var aE=aK.target.result;if(!aE){return aw()}for(var aF=aE.value,aC=aE.primaryKey,aI=Object.keys(aF._attachments||{}),aG={},aH=0;aH<aI.length;aH++){var aJ=aF._attachments[aI[aH]];aG[aJ.digest]=!0}var aL=Object.keys(aG);for(aH=0;aH<aL.length;aH++){var aD=aL[aH];av.put({seq:aC,digestSeq:aD+"::"+aC})}aE["continue"]()}):aw()}}function ab(ay){function aw(az){return az.data?hb(az):(az.deleted="1"===az.deletedOrLocal,az)}var av=ay.objectStore(gX),au=ay.objectStore(fu),ax=au.openCursor();ax.onsuccess=function(aC){function aD(){var aF=az.id+"::",aH=az.id+"::",aG=av.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return az.seq=aE,aA()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function aA(){var aE=W(az,az.winningRev,az.deleted),aF=au.put(aE);aF.onsuccess=function(){aB["continue"]()}}var aB=aC.target.result;if(aB){var az=aw(aB.value);return az.winningRev=az.winningRev||h9(az),az.seq?aA():void aD()}}}var al=ad.name,ac=null;aa._meta=null,aa.type=function(){return"idb"},aa._id=ex(function(au){au(null,aa._meta.instanceId)}),aa._bulkDocs=function(au,aw,av){G(ad,au,aw,aa,ac,iz.Changes,av)},aa._get=function(ax,aC,ay){function aA(){ay(aw,{doc:az,metadata:au,ctx:aB})}var az,au,aw,aB=aC.ctx;if(!aB){var av=hj(ac,[fu,gX,gH],"readonly");if(av.error){return ay(av.error)}aB=av.txn}aB.objectStore(fu).get(ax).onsuccess=function(aG){if(au=hb(aG.target.result),!au){return aw=gA(iF,"missing"),aA()}if(hG(au)&&!aC.rev){return aw=gA(iF,"deleted"),aA()}var aE=aB.objectStore(gX),aD=aC.rev||au.winningRev,aF=au.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return az=aH.target.result,az&&(az=gw(az)),az?void aA():(aw=gA(iF,"missing"),aA())}}},aa._getAttachment=function(aw,aA,av){var ay;if(aA.ctx){ay=aA.ctx}else{var au=hj(ac,[fu,gX,gH],"readonly");if(au.error){return av(au.error)}ay=au.txn}var ax=aw.digest,az=aw.content_type;ay.objectStore(gH).get(ax).onsuccess=function(aC){var aB=aC.target.result.body;be(aB,az,aA.binary,function(aD){av(null,aD)})}},aa._info=function(aA){if(null===ac||!fS[al]){var ay=new Error("db isn't open");return ay.id="idbNull",aA(ay)}var av,au,ax=hj(ac,[gX],"readonly");if(ax.error){return aA(ax.error)}var az=ax.txn,aw=az.objectStore(gX).openCursor(null,"prev");aw.onsuccess=function(aB){var aC=aB.target.result;av=aC?aC.key:0,au=aa._meta.docCount},az.oncomplete=function(){aA(null,{doc_count:au,update_seq:av,idb_attachment_format:aa._meta.blobSupport?"binary":"base64"})}},aa._allDocs=function(av,au){ei(av,aa,ac,au)},aa._changes=function(aG){function aC(aP){function aM(){return aS.seq!==aR?aP["continue"]():(aI=aR,aS.winningRev===aQ._rev?aN(aQ):void aO())}function aO(){var aU=aQ._id+"::"+aS.winningRev,aT=aL.get(aU);aT.onsuccess=function(aV){aN(gw(aV.target.result))}}function aN(aU){var aT=aG.processChange(aU,aS,aG);aT.seq=aS.seq;var aV=au(aT);return"object"==typeof aV?aG.complete(aV):(aV&&(aD++,aK&&az.push(aT),aG.attachments&&aG.include_docs?D(aU,aG,aB,function(){f7([aT],aG.binary).then(function(){aG.onChange(aT)})}):aG.onChange(aT)),void (aD!==aw&&aP["continue"]()))}var aQ=gw(aP.value),aR=aP.key;if(av&&!av.has(aQ._id)){return aP["continue"]()}var aS;return(aS=ay.get(aQ._id))?aM():void (aH.get(aQ._id).onsuccess=function(aT){aS=hb(aT.target.result),ay.set(aQ._id,aS),aM()})}function aF(aN){var aM=aN.target.result;aM&&aC(aM)}function ax(){var aM=[fu,gX];aG.attachments&&aM.push(gH);var aN=hj(ac,aM,"readonly");if(aN.error){return aG.complete(aN.error)}aB=aN.txn,aB.onabort=dn(aG.complete),aB.oncomplete=aA,aE=aB.objectStore(gX),aH=aB.objectStore(fu),aL=aE.index("_doc_id_rev");var aO;aO=aG.descending?aE.openCursor(null,"prev"):aE.openCursor(IDBKeyRange.lowerBound(aG.since,!0)),aO.onsuccess=aF}function aA(){function aM(){aG.complete(null,{results:az,last_seq:aI})}!aG.continuous&&aG.attachments?f7(az).then(aM):aM()}if(aG=gu(aG),aG.continuous){var aJ=al+":"+P();return iz.Changes.addListener(al,aJ,aa,aG),iz.Changes.notify(al),{cancel:function(){iz.Changes.removeListener(al,aJ)}}}var av=aG.doc_ids&&new id.Set(aG.doc_ids);aG.since=aG.since||0;var aI=aG.since,aw="limit" in aG?aG.limit:-1;0===aw&&(aw=1);var aK;aK="return_docs" in aG?aG.return_docs:"returnDocs" in aG?aG.returnDocs:!0;var aB,aE,aH,aL,az=[],aD=0,au=S(aG),ay=new id.Map;ax()},aa._close=function(au){return null===ac?au(gA(fv)):(ac.close(),delete fS[al],ac=null,void au())},aa._getRevisionTree=function(ay,aw){var av=hj(ac,[fu],"readonly");if(av.error){return aw(av.error)}var au=av.txn,ax=au.objectStore(fu).get(ay);ax.onsuccess=function(aA){var az=hb(aA.target.result);az?aw(null,az.rev_tree):aw(gA(iF))}},aa._doCompaction=function(aw,aA,av){var ay=[fu,gX,gH,en],au=hj(ac,ay,"readwrite");if(au.error){return av(au.error)}var ax=au.txn,az=ax.objectStore(fu);az.get(aw).onsuccess=function(aC){var aE=hb(aC.target.result);fz(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==aA.indexOf(aI)&&(aH.status="missing")}),fR(aA,aw,ax);var aD=aE.winningRev,aB=aE.deleted;ax.objectStore(fu).put(W(aE,aD,aB))},ax.onabort=dn(av),ax.oncomplete=function(){av()}},aa._getLocal=function(ay,aw){var av=hj(ac,[g5],"readonly");if(av.error){return aw(av.error)}var au=av.txn,ax=au.objectStore(g5).get(ay);ax.onerror=dn(aw),ax.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,aw(null,az)):aw(gA(iF))}},aa._putLocal=function(aD,ay,au){"function"==typeof ay&&(au=ay,ay={}),delete aD._revisions;var aw=aD._rev,av=aD._id;aw?aD._rev="0-"+(parseInt(aw.split("-")[1],10)+1):aD._rev="0-1";var aA,aB=ay.ctx;if(!aB){var ax=hj(ac,[g5],"readwrite");if(ax.error){return au(ax.error)}aB=ax.txn,aB.onerror=dn(au),aB.oncomplete=function(){aA&&au(null,aA)}}var az,aC=aB.objectStore(g5);aw?(az=aC.get(av),az.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===aw){var aG=aC.put(aD);aG.onsuccess=function(){aA={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&au(null,aA)}}else{au(gA(iX))}}):(az=aC.add(aD),az.onerror=function(aE){au(gA(iX)),aE.preventDefault(),aE.stopPropagation()},az.onsuccess=function(){aA={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&au(null,aA)})},aa._removeLocal=function(ax,aC,ay){"function"==typeof aC&&(ay=aC,aC={});var aA=aC.ctx;if(!aA){var az=hj(ac,[g5],"readwrite");if(az.error){return ay(az.error)}aA=az.txn,aA.oncomplete=function(){au&&ay(null,au)}}var au,aw=ax._id,aB=aA.objectStore(g5),av=aB.get(aw);av.onerror=dn(ay),av.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===ax._rev?(aB["delete"](aw),au={ok:!0,id:aw,rev:"0-0"},aC.ctx&&ay(null,au)):ay(gA(iF))}},aa._destroy=function(av,aw){iz.Changes.removeAllListeners(al),iz.openReqList[al]&&iz.openReqList[al].result&&(iz.openReqList[al].result.close(),delete fS[al]);var au=indexedDB.deleteDatabase(al);au.onsuccess=function(){iz.openReqList[al]&&(iz.openReqList[al]=null),ic()&&al in localStorage&&delete localStorage[al],aw(null,{ok:!0})},au.onerror=dn(aw)};var t=fS[al];if(t){return ac=t.idb,aa._meta=t.global,void p.nextTick(function(){am(null,aa)})}var ag;ag=ad.storage?gS(al,ad.storage):indexedDB.open(al,fU),"openReqList" in iz||(iz.openReqList={}),iz.openReqList[al]=ag,ag.onupgradeneeded=function(ax){function az(){var aA=av[au-1];au++,aA&&aA(ay,az)}var aw=ax.target.result;if(ax.oldVersion<1){return ak(aw)}var ay=ax.currentTarget.transaction;ax.oldVersion<3&&ap(aw),ax.oldVersion<4&&aj(aw);var av=[ah,af,aq,ab],au=ax.oldVersion;az()},ag.onsuccess=function(ay){ac=ay.target.result,ac.onversionchange=function(){ac.close(),delete fS[al]},ac.onabort=function(aA){console.error("Database has a global failure",aA.target.error),ac.close(),delete fS[al]};var az=ac.transaction([fw,fq,fu],"readwrite"),av=az.objectStore(fw).get(fw),aw=null,ax=null,au=null;av.onsuccess=function(aB){var aD=function(){null!==aw&&null!==ax&&null!==au&&(aa._meta={name:al,instanceId:au,blobSupport:aw,docCount:ax},fS[al]={idb:ac,global:aa._meta},am(null,aa))},aA=aB.target.result||{id:fw};al+"_id" in aA?(au=aA[al+"_id"],aD()):(au=P(),aA[al+"_id"]=au,az.objectStore(fw).put(aA).onsuccess=function(){aD()}),fa||(fa=gR(az)),fa.then(function(aE){aw=aE,aD()});var aC=az.objectStore(fu).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){ax=aE.target.result,aD()}}},ag.onerror=function(au){var av="Failed to open indexedDB, are you in private browsing mode?";console.error(av),am(gA(hH,av))}}function gS(ab,t){try{return indexedDB.open(ab,{version:fU,storage:t})}catch(aa){return indexedDB.open(ab,fU)}}var hy=a(7),gq="default" in hy?hy["default"]:hy,f3=a(6);f3="default" in f3?f3["default"]:f3;var id=a(12);id="default" in id?id["default"]:id;var ie=a(4),w=a(1);w="default" in w?w["default"]:w;var gn=a(2);gn="default" in gn?gn["default"]:gn;var dr=a(10),dt="default" in dr?dr["default"]:dr,a3=a(8);a3="default" in a3?a3["default"]:a3;var iq=a(14);iq="default" in iq?iq["default"]:iq;var a5=a(15);a5="default" in a5?a5["default"]:a5;var f9=a(16);f9="default" in f9?f9["default"]:f9;var at="function"==typeof Promise?Promise:a3,iE=bn();f3(iy,Error),iy.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var hc=new iy({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),fX=new iy({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),iF=new iy({status:404,error:"not_found",reason:"missing"}),iX=new iy({status:409,error:"conflict",reason:"Document update conflict"}),hW=new iy({status:400,error:"invalid_id",reason:"_id field must contain a string"}),jh=new iy({status:412,error:"missing_id",reason:"_id is required for puts"}),fx=new iy({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),fv=new iy({status:412,error:"precondition_failed",reason:"Database not open"}),hm=new iy({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),f4=new iy({status:500,error:"badarg",reason:"Some query argument is invalid"}),fW=new iy({status:400,error:"invalid_request",reason:"Request was invalid"}),iY=new iy({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),jk=new iy({status:500,error:"doc_validation",reason:"Bad special document member"}),bo=new iy({status:400,error:"bad_request",reason:"Something wrong with the request"}),br=new iy({status:400,error:"bad_request",reason:"Document must be a JSON object"}),h2=new iy({status:404,error:"not_found",reason:"Database not found"}),hH=new iy({status:500,error:"indexed_db_went_bad",reason:"unknown"}),q=new iy({status:500,error:"web_sql_went_bad",reason:"unknown"}),fg=new iy({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),gy=new iy({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),g7=new iy({status:400,error:"bad_request",reason:"Invalid rev format"}),iA=new iy({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),fy=new iy({status:412,error:"missing_stub"}),hp=new iy({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),hg={UNAUTHORIZED:hc,MISSING_BULK_DOCS:fX,MISSING_DOC:iF,REV_CONFLICT:iX,INVALID_ID:hW,MISSING_ID:jh,RESERVED_ID:fx,NOT_OPEN:fv,UNKNOWN_ERROR:hm,BAD_ARG:f4,INVALID_REQUEST:fW,QUERY_PARSE_ERROR:iY,DOC_VALIDATION:jk,BAD_REQUEST:bo,NOT_AN_OBJECT:br,DB_MISSING:h2,WSQ_ERROR:q,LDB_ERROR:fg,FORBIDDEN:gy,INVALID_REV:g7,FILE_EXISTS:iA,MISSING_STUB:fy,IDB_ERROR:hH,INVALID_URL:hp},hQ=function(ad,aa,ab){var t=Object.keys(hg).filter(function(af){var ag=hg[af];return"function"!=typeof ag&&ag[ad]===aa}),ac=ab&&t.filter(function(af){var ag=hg[af];return ag.message===ab})[0]||t[0];return ac?hg[ac]:null},i4=function(){},T=gn("pouchdb:api");f3(A,ie.EventEmitter),A.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},A.prototype.doChanges=function(ad){var aa=this,ab=ad.complete;if(ad=gu(ad),"live" in ad&&!("continuous" in ad)&&(ad.continuous=ad.live),ad.processChange=gl,"latest"===ad.since&&(ad.since="now"),ad.since||(ad.since=0),"now"===ad.since){return void this.db.info().then(function(af){return aa.isCancelled?void ab(null,{status:"cancelled"}):(ad.since=af.update_seq,void aa.doChanges(ad))},ab)}if(ad.continuous&&"now"!==ad.since&&this.db.info().then(function(af){aa.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ad.filter&&"string"==typeof ad.filter&&("_view"===ad.filter?ad.view=F(ad.view):ad.filter=F(ad.filter),"http"!==this.db.type()&&!ad.doc_ids)){return this.filterChanges(ad)}"descending" in ad||(ad.descending=!1),ad.limit=0===ad.limit?1:ad.limit,ad.complete=ab;var t=this.db._changes(ad);if(t&&"function"==typeof t.cancel){var ac=aa.cancel;aa.cancel=w(function(af){t.cancel(),ac.apply(this,af)})}},A.prototype.filterChanges=function(ad){var aa=this,ab=ad.complete;if("_view"===ad.filter){if(!ad.view||"string"!=typeof ad.view){var t=gA(bo,"`view` filter parameter not found or invalid.");return ab(t)}var ac=h(ad.view);this.db.get("_design/"+ac[0],function(ah,aj){if(aa.isCancelled){return ab(null,{status:"cancelled"})}if(ah){return ab(f6(ah))}var ag=aj&&aj.views&&aj.views[ac[1]]&&aj.views[ac[1]].map;return ag?(ad.filter=ee(ag),void aa.doChanges(ad)):ab(gA(iF,aj.views?"missing json key: "+ac[1]:"missing json key: views"))})}else{var af=h(ad.filter);if(!af){return aa.doChanges(ad)}this.db.get("_design/"+af[0],function(ag,aj){if(aa.isCancelled){return ab(null,{status:"cancelled"})}if(ag){return ab(f6(ag))}var ah=aj&&aj.filters&&aj.filters[af[1]];return ah?(ad.filter=hN(ah),void aa.doChanges(ad)):ab(gA(iF,aj&&aj.filters?"missing json key: "+af[1]:"missing json key: filters"))})}};var iH="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),ja=Q(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),hT=Q(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);f3(i9,ie.EventEmitter),i9.prototype.post=gp("post",function(ab,t,aa){return"function"==typeof t&&(aa=t,t={}),"object"!=typeof ab||Array.isArray(ab)?aa(gA(br)):void this.bulkDocs({docs:[ab]},t,i0(aa))}),i9.prototype.put=gp("put",w(function(ac){var t,ag,ad,ab,aa=ac.shift(),af="_id" in aa;if("object"!=typeof aa||Array.isArray(aa)){return(ab=ac.pop())(gA(br))}for(;;){if(t=ac.shift(),ag=typeof t,"string"!==ag||af?"string"!==ag||!af||"_rev" in aa?"object"===ag?ad=t:"function"===ag&&(ab=t):aa._rev=t:(aa._id=t,af=!0),!ac.length){break}}return ad=ad||{},C(aa._id),hs(aa._id)&&"function"==typeof this._putLocal?aa._deleted?this._removeLocal(aa,ab):this._putLocal(aa,ab):void this.bulkDocs({docs:[aa]},ad,i0(ab))})),i9.prototype.putAttachment=gp("putAttachment",function(t,ac,ag,aa,ah,ad){function af(aj){return aj._attachments=aj._attachments||{},aj._attachments[ac]={content_type:ah,data:aa},ab.put(aj)}var ab=this;return"function"==typeof ah&&(ad=ah,ah=aa,aa=ag,ag=null),"undefined"==typeof ah&&(ah=aa,aa=ag,ag=null),ab.get(t).then(function(aj){if(aj._rev!==ag){throw gA(iX)}return af(aj)},function(aj){if(aj.reason===iF.message){return af({_id:t})}throw aj})}),i9.prototype.removeAttachment=gp("removeAttachment",function(ad,aa,ab,t){var ac=this;ac.get(ad,function(af,ag){return af?void t(af):ag._rev!==ab?void t(gA(iX)):ag._attachments?(delete ag._attachments[aa],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ac.put(ag,t)):t()})}),i9.prototype.remove=gp("remove",function(ad,aa,ab,t){var ac;"string"==typeof aa?(ac={_id:ad,_rev:aa},"function"==typeof ab&&(t=ab,ab={})):(ac=ad,"function"==typeof aa?(t=aa,ab={}):(t=ab,ab=aa)),ab=ab||{},ab.was_delete=!0;var af={_id:ac._id,_rev:ac._rev||ab.rev};return af._deleted=!0,hs(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ac,t):void this.bulkDocs({docs:[af]},ab,i0(t))}),i9.prototype.revsDiff=gp("revsDiff",function(t,ac,ag){function aa(ak,aj){ab.has(ak)||ab.set(ak,{missing:[]}),ab.get(ak).missing.push(aj)}function ah(aj,ak){var al=t[aj].slice(0);fz(ak,function(ap,aq,av,am,aw){var ax=aq+"-"+av,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==aw.status&&aa(aj,ax))}),al.forEach(function(am){aa(aj,am)})}"function"==typeof ac&&(ag=ac,ac={});var ad=Object.keys(t);if(!ad.length){return ag(null,{})}var af=0,ab=new id.Map;ad.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ab.set(aj,{missing:t[aj]})}else{if(al){return ag(al)}ah(aj,am)}if(++af===ad.length){var ak={};return ab.forEach(function(ap,aq){ak[aq]=ap}),ag(null,ak)}})},this)}),i9.prototype.bulkGet=gp("bulkGet",function(t,aa){iQ(this,t,aa)}),i9.prototype.compactDocument=gp("compactDocument",function(aa,ac,t){var ab=this;this._getRevisionTree(aa,function(ad,ag){if(ad){return t(ad)}var aj=eo(ag),af=[],ah=[];Object.keys(aj).forEach(function(ak){aj[ak]>ac&&af.push(ak)}),fz(ag,function(aq,ak,am,au,ap){var al=ak+"-"+am;"available"===ap.status&&-1!==af.indexOf(al)&&ah.push(al)}),ab._doCompaction(aa,ah,t)})}),i9.prototype.compact=gp("compact",function(ab,t){"function"==typeof ab&&(t=ab,ab={});var aa=this;ab=ab||{},aa._compactionQueue=aa._compactionQueue||[],aa._compactionQueue.push({opts:ab,callback:t}),1===aa._compactionQueue.length&&hA(aa)}),i9.prototype._compact=function(ac,t){function ag(ah){af.push(ab.compactDocument(ah.id,0))}function ad(ah){var aj=ah.last_seq;at.all(af).then(function(){return ho(ab,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){t(null,{ok:!0})})["catch"](t)}var ab=this,aa={return_docs:!1,last_seq:ac.last_seq||0},af=[];ab.changes(aa).on("change",ag).on("complete",ad).on("error",t)},i9.prototype.get=gp("get",function(t,ac,ag){function aa(){var ak=[],aj=ah.length;return aj?void ah.forEach(function(al){ad.get(t,{rev:al,revs:ac.revs,attachments:ac.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||ag(null,ak)})}):ag(null,ak)}if("function"==typeof ac&&(ag=ac,ac={}),"string"!=typeof t){return ag(gA(hW))}if(hs(t)&&"function"==typeof this._getLocal){return this._getLocal(t,ag)}var ah=[],ad=this;if(!ac.open_revs){return this._get(t,ac,function(aA,ap){if(aA){return ag(aA)}var az=ap.doc,aq=ap.metadata,ay=ap.ctx;if(ac.conflicts){var ax=L(aq);ax.length&&(az._conflicts=ax)}if(hG(aq,az._rev)&&(az._deleted=!0),ac.revs||ac.revs_info){var aj=E(aq.rev_tree),au=hB(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(az._rev.split("-")[1])}),aB=au.ids.map(function(aC){return aC.id}).indexOf(az._rev.split("-")[1])+1,am=au.ids.length-aB;if(au.ids.splice(aB,am),au.ids.reverse(),ac.revs&&(az._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),ac.revs_info){var al=au.pos+au.ids.length;az._revs_info=au.ids.map(function(aC){return al--,{rev:al+"-"+aC.id,status:aC.opts.status}})}}if(ac.attachments&&az._attachments){var ak=az._attachments,aw=Object.keys(ak).length;if(0===aw){return ag(null,az)}Object.keys(ak).forEach(function(aC){this._getAttachment(ak[aC],{binary:ac.binary,ctx:ay},function(aE,aD){var aF=az._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aw||ag(null,az)})},ad)}else{if(az._attachments){for(var av in az._attachments){az._attachments.hasOwnProperty(av)&&(az._attachments[av].stub=!0)}}ag(null,az)}})}if("all"===ac.open_revs){this._getRevisionTree(t,function(ak,aj){return ak?ag(ak):(ah=a0(aj).map(function(al){return al.rev}),void aa())})}else{if(!Array.isArray(ac.open_revs)){return ag(gA(hm,"function_clause"))}ah=ac.open_revs;for(var af=0;af<ah.length;af++){var ab=ah[af];if("string"!=typeof ab||!/^\d+-/.test(ab)){return ag(gA(g7))}}aa()}}),i9.prototype.getAttachment=gp("getAttachment",function(ad,aa,ab,t){var ac=this;ab instanceof Function&&(t=ab,ab={}),this._get(ad,ab,function(af,ag){return af?t(af):ag.doc._attachments&&ag.doc._attachments[aa]?(ab.ctx=ag.ctx,ab.binary=!0,ac._getAttachment(ag.doc._attachments[aa],ab,t),void 0):t(gA(iF))})}),i9.prototype.allDocs=gp("allDocs",function(ab,t){if("function"==typeof ab&&(t=ab,ab={}),ab.skip="undefined"!=typeof ab.skip?ab.skip:0,ab.start_key&&(ab.startkey=ab.start_key),ab.end_key&&(ab.endkey=ab.end_key),"keys" in ab){if(!Array.isArray(ab.keys)){return t(new TypeError("options.keys must be an array"))}var aa=["startkey","endkey","key"].filter(function(ac){return ac in ab})[0];if(aa){return void t(gA(iY,"Query parameter `"+aa+"` is not compatible with multi-get"))}if("http"!==this.type()){return iw(this,ab,t)}}return this._allDocs(ab,t)}),i9.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new A(this,t,aa)},i9.prototype.close=gp("close",function(t){return this._closed=!0,this._close(t)}),i9.prototype.info=gp("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),i9.prototype.id=gp("id",function(t){return this._id(t)}),i9.prototype.bulkDocs=gp("bulkDocs",function(ad,aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa=aa||{},Array.isArray(ad)&&(ad={docs:ad}),!ad||!ad.docs||!Array.isArray(ad.docs)){return ab(gA(fX))}for(var t=0;t<ad.docs.length;++t){if("object"!=typeof ad.docs[t]||Array.isArray(ad.docs[t])){return ab(gA(br))}}var ac;return ad.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ac=ac||ez(ag)})}),ac?ab(gA(bo,ac)):("new_edits" in aa||("new_edits" in ad?aa.new_edits=ad.new_edits:aa.new_edits=!0),aa.new_edits||"http"===this.type()||ad.docs.sort(gG),r(ad.docs),this._bulkDocs(ad,aa,function(af,ag){return af?ab(af):(aa.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ab(null,ag))}))}),i9.prototype.registerDependentDatabase=gp("registerDependentDatabase",function(aa,ac){function t(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[aa]?!1:(ad.dependentDbs[aa]=!0,ad)}var ab=new this.constructor(aa,this.__opts);ho(this,"_local/_pouch_dependentDbs",t).then(function(){ac(null,{db:ab})})["catch"](ac)}),i9.prototype.destroy=gp("destroy",function(ad,aa){function ab(){t._destroy(ad,function(ag,af){return ag?aa(ag):(t.emit("destroyed"),void aa(null,af||{ok:!0}))})}"function"==typeof ad&&(aa=ad,ad={});var t=this,ac="use_prefix" in t?t.use_prefix:!0;return"http"===t.type()?ab():void t.get("_local/_pouch_dependentDbs",function(ak,ag){if(ak){return 404!==ak.status?aa(ak):ab()}var aj=ag.dependentDbs,af=t.constructor,ah=Object.keys(aj).map(function(al){var am=ac?al.replace(new RegExp("^"+af.prefix),""):al;return new af(am,t.__opts).destroy()});at.all(ah).then(ab,aa)})}),V.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},V.prototype.fail=function(t){this.failed=t,this.execute()},V.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},V.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},f3(ig,i9),ig.debug=gn;var hJ;if(K()){hJ=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),hJ=!!localStorage.getItem("_pouch_check_localstorage")}catch(et){hJ=!1}}ig.adapters={},ig.preferredAdapters=[],ig.prefix="_pouch_";var i1=new ie.EventEmitter;g0(ig),ig.parseAdapter=function(t,ac){var ag,aa,ah=t.match(/([a-z\-]*):\/\/(.*)/);if(ah){if(t=/http(s?)/.test(ah[1])?ah[1]+"://"+ah[2]:ah[2],ag=ah[1],!ig.adapters[ag].valid()){throw"Invalid adapter"}return{name:t,adapter:ah[1]}}var ad="idb" in ig.adapters&&"websql" in ig.adapters&&ic()&&localStorage["_pouch__websqldb_"+ig.prefix+t];if(ac.adapter){aa=ac.adapter}else{if("undefined"!=typeof ac&&ac.db){aa="leveldb"}else{for(var af=0;af<ig.preferredAdapters.length;++af){if(aa=ig.preferredAdapters[af],aa in ig.adapters){if(ad&&"idb"===aa){console.log('PouchDB is downgrading "'+t+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}ag=ig.adapters[aa];var ab=ag&&"use_prefix" in ag?ag.use_prefix:!0;return{name:ab?ig.prefix+t:t,adapter:aa}},ig.adapter=function(ab,t,aa){t.valid()&&(ig.adapters[ab]=t,aa&&ig.preferredAdapters.push(ab))},ig.plugin=function(t){return Object.keys(t).forEach(function(aa){ig.prototype[aa]=t[aa]}),ig},ig.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?(("function"==typeof ad||"undefined"==typeof ad)&&(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=hy.extend({},t,ad),void ig.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return f3(aa,ig),g0(aa),aa.preferredAdapters=ig.preferredAdapters.slice(),Object.keys(ig).forEach(function(ab){ab in aa||(aa[ab]=ig[ab])}),aa};var hq=function(t){return atob(t)},i2=function(t){return btoa(t)},hR=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],fn="queryKey",jc=/(?:^|&)([^&=]*)=?([^&]*)/g,go=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ga=gq.extend,hO={ajax:ew,parseUri:im,uuid:P,Promise:at,atob:hq,btoa:i2,binaryStringToBlobOrBuffer:hd,clone:gu,extend:ga,createError:gA},io=dt.collate,z=1,ib="pouchdb",h4=5,ft=0;B.prototype.writeCheckpoint=function(ab,t){var aa=this;return this.updateTarget(ab,t).then(function(){return aa.updateSource(ab,t)})},B.prototype.updateTarget=function(t,aa){return gk(this.target,this.id,t,aa,this.returnValue)},B.prototype.updateSource=function(ab,t){var aa=this;return this.readOnlySource?at.resolve(!0):gk(this.src,this.id,ab,t,this.returnValue)["catch"](function(ac){var ad="number"==typeof ac.status&&4===Math.floor(ac.status/100);if(ad){return aa.readOnlySource=!0,!0}throw ac})};var hh={undefined:function(t,aa){return 0===io(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return iT(aa,t).last_seq}};B.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return ft}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in hh?hh[ab](aa,ac):ft},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:ft}).then(function(){return ft},function(ac){return 401===ac.status?(t.readOnlySource=!0,aa.last_seq):ft})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return ft})};var gc=0,it=jd.setImmediate||jd.setTimeout,iD=32768,a6=ex(function(ac,ak){function af(){var aq=aj*ad,al=aq+ad;if(aj++,aa>aj){ab(t,ac,aq,al),it(af)}else{ab(t,ac,aq,al);var ap=t.end(!0),am=i8(ap);ak(null,am),t.destroy()}}var ah="string"==typeof ac,ag=ah?ac.length:ac.byteLength,ad=Math.min(iD,ag),aa=Math.ceil(ag/ad),aj=0,t=ah?new a5:new a5.ArrayBuffer,ab=ah?hI:gf;af()});f3(gs,ie.EventEmitter),gs.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},gs.prototype.ready=function(ad,aa){function ab(){ac.cancel()}function t(){ad.removeListener("destroyed",ab),aa.removeListener("destroyed",ab)}var ac=this;ac._readyCalled||(ac._readyCalled=!0,ad.once("destroyed",ab),aa.once("destroyed",ab),ac.once("complete",t))};var fV={replicate:hD,toPouch:iO},gW=fV.replicate;f3(gV,ie.EventEmitter),gV.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};var x=25,hk=50,hP={},ct=1800,gE=gn("pouchdb:http");a4.valid=function(){return !0};var hZ=function(t,aa){return aa&&t.then(function(ab){p.nextTick(function(){aa(null,ab)})},function(ab){p.nextTick(function(){aa(ab)})}),t},fh=function(t){return w(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&hZ(ab,aa),ab})},f1=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},gQ=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},f=function(ad){for(var aa={},ab=0,t=ad.length;t>ab;ab++){aa["$"+ad[ab]]=!0}var ac=Object.keys(aa),af=new Array(ac.length);for(ab=0,t=ac.length;t>ab;ab++){af[ab]=ac[ab].substring(1)}return af},er={uniq:f,sequentialize:gQ,fin:f1,callbackify:fh,promisedCallback:hZ};gL.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},gL.prototype.finish=function(){return this.promise};var gg,iS=dt.collate,je=dt.toIndexableString,ik=dt.normalizeKey,g4=dt.parseIndexableString;gg="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var iG=er.callbackify,gt=er.sequentialize,fo=er.uniq,fl=er.fin,hl=er.promisedCallback,iu={},ir=new gL,f8=50,gB={_sum:function(t,aa){return gv(aa)},_count:function(t,aa){return aa.length},_stats:function(ab,t){function aa(ag){for(var ac=0,ad=0,ah=ag.length;ah>ad;ad++){var af=ag[ad];ac+=af*af}return ac}return{sum:gv(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:aa(t)}}},i=iG(function(){var t=this;return"http"===t.type()?iP(t):"function"==typeof t._viewCleanup?ix(t):cn(t)}),O=function(ad,aa,ab){"function"==typeof aa&&(ab=aa,aa={}),aa=aa?h3(aa):{},"function"==typeof ad&&(ad={map:ad});var t=this,ac=at.resolve().then(function(){return hU(t,ad,aa)});return hl(ac,ab),ac};f3(ge,Error),f3(X,Error),f3(n,Error);var fs={query:O,viewCleanup:i},i7=7,f2=hF("document-store"),U=hF("by-sequence"),gh=hF("attach-store"),g3=hF("local-store"),ae=hF("metadata-store"),fT=hF("attach-seq-store"),fk={};f3(gM,ie.EventEmitter),gM.prototype.addListener=function(ac,t,ag,ad){function ab(){function aj(){af=!1}if(aa._listeners[t]){if(af){return void (af="waiting")}af=!0;var ah=gT(ad,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(ah).on("change",function(ak){ak.seq>ad.since&&!ad.cancelled&&(ad.since=ak.seq,ad.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ab()},0),af=!1}).on("error",aj)}}if(!this._listeners[t]){var aa=this,af=!1;this._listeners[t]=ab,this.on(ac,ab)}},gM.prototype.removeListener=function(t,aa){aa in this._listeners&&ie.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},gM.prototype.notifyLocalWindows=function(t){K()?chrome.storage.local.set({dbName:t}):ic()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},gM.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var iI=1,fc="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+U+" (seq, deleted)",fr="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+U+" (doc_id, rev)",R="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+f2+" (winningseq)",eu="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+fT+" (seq)",jf="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+fT+" (digest, seq)",hn=U+".seq = "+f2+".winningseq",g2=U+".seq AS seq, "+U+".deleted AS deleted, "+U+".json AS data, "+U+".rev AS rev, "+f2+".json AS metadata";ip.valid=a9,ip.Changes=new gM;var fa,fU=5,fu="document-store",gX="by-sequence",gH="attach-store",en="attach-seq-store",fw="meta-store",g5="local-store",fq="detect-blob-support",ff={running:!1,queue:[]},fS={};iz.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},iz.Changes=new gM;var es={idb:iz,websql:ip};ig.ajax=ew,ig.utils=hO,ig.Errors=hg,ig.replicate=fV.replicate,ig.sync=fb,ig.version="5.2.0",ig.adapter("http",a4),ig.adapter("https",a4),ig.plugin(fs),Object.keys(es).forEach(function(t){ig.adapter(t,es[t],!0)}),b.exports=ig}).call(this,a(13),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,13:13,14:14,15:15,16:16,2:2,4:4,6:6,7:7,8:8}]},{},[17])(17)});